var RM=Object.defineProperty,EM=Object.getOwnPropertyDescriptor,d=(t,e,i,o)=>{for(var s=o>1?void 0:o?EM(e,i):e,a=t.length-1,n;a>=0;a--)(n=t[a])&&(s=(o?n(e,i,s):n(s))||s);return o&&s&&RM(e,i,s),s};import{AgCharts as Ea,VERSION as $u,_Scene as wM,_Theme as _M,_Util as PM,setupCommunityModules as BM}from"ag-charts-community";var zM=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(t,e){let i=t[0],o=t[1],s=t[2],a=t[3];i=this.ff(i,o,s,a,e[0],7,-680876936),a=this.ff(a,i,o,s,e[1],12,-389564586),s=this.ff(s,a,i,o,e[2],17,606105819),o=this.ff(o,s,a,i,e[3],22,-1044525330),i=this.ff(i,o,s,a,e[4],7,-176418897),a=this.ff(a,i,o,s,e[5],12,1200080426),s=this.ff(s,a,i,o,e[6],17,-1473231341),o=this.ff(o,s,a,i,e[7],22,-45705983),i=this.ff(i,o,s,a,e[8],7,1770035416),a=this.ff(a,i,o,s,e[9],12,-1958414417),s=this.ff(s,a,i,o,e[10],17,-42063),o=this.ff(o,s,a,i,e[11],22,-1990404162),i=this.ff(i,o,s,a,e[12],7,1804603682),a=this.ff(a,i,o,s,e[13],12,-40341101),s=this.ff(s,a,i,o,e[14],17,-1502002290),o=this.ff(o,s,a,i,e[15],22,1236535329),i=this.gg(i,o,s,a,e[1],5,-165796510),a=this.gg(a,i,o,s,e[6],9,-1069501632),s=this.gg(s,a,i,o,e[11],14,643717713),o=this.gg(o,s,a,i,e[0],20,-373897302),i=this.gg(i,o,s,a,e[5],5,-701558691),a=this.gg(a,i,o,s,e[10],9,38016083),s=this.gg(s,a,i,o,e[15],14,-660478335),o=this.gg(o,s,a,i,e[4],20,-405537848),i=this.gg(i,o,s,a,e[9],5,568446438),a=this.gg(a,i,o,s,e[14],9,-1019803690),s=this.gg(s,a,i,o,e[3],14,-187363961),o=this.gg(o,s,a,i,e[8],20,1163531501),i=this.gg(i,o,s,a,e[13],5,-1444681467),a=this.gg(a,i,o,s,e[2],9,-51403784),s=this.gg(s,a,i,o,e[7],14,1735328473),o=this.gg(o,s,a,i,e[12],20,-1926607734),i=this.hh(i,o,s,a,e[5],4,-378558),a=this.hh(a,i,o,s,e[8],11,-2022574463),s=this.hh(s,a,i,o,e[11],16,1839030562),o=this.hh(o,s,a,i,e[14],23,-35309556),i=this.hh(i,o,s,a,e[1],4,-1530992060),a=this.hh(a,i,o,s,e[4],11,1272893353),s=this.hh(s,a,i,o,e[7],16,-155497632),o=this.hh(o,s,a,i,e[10],23,-1094730640),i=this.hh(i,o,s,a,e[13],4,681279174),a=this.hh(a,i,o,s,e[0],11,-358537222),s=this.hh(s,a,i,o,e[3],16,-722521979),o=this.hh(o,s,a,i,e[6],23,76029189),i=this.hh(i,o,s,a,e[9],4,-640364487),a=this.hh(a,i,o,s,e[12],11,-421815835),s=this.hh(s,a,i,o,e[15],16,530742520),o=this.hh(o,s,a,i,e[2],23,-995338651),i=this.ii(i,o,s,a,e[0],6,-198630844),a=this.ii(a,i,o,s,e[7],10,1126891415),s=this.ii(s,a,i,o,e[14],15,-1416354905),o=this.ii(o,s,a,i,e[5],21,-57434055),i=this.ii(i,o,s,a,e[12],6,1700485571),a=this.ii(a,i,o,s,e[3],10,-1894986606),s=this.ii(s,a,i,o,e[10],15,-1051523),o=this.ii(o,s,a,i,e[1],21,-2054922799),i=this.ii(i,o,s,a,e[8],6,1873313359),a=this.ii(a,i,o,s,e[15],10,-30611744),s=this.ii(s,a,i,o,e[6],15,-1560198380),o=this.ii(o,s,a,i,e[13],21,1309151649),i=this.ii(i,o,s,a,e[4],6,-145523070),a=this.ii(a,i,o,s,e[11],10,-1120210379),s=this.ii(s,a,i,o,e[2],15,718787259),o=this.ii(o,s,a,i,e[9],21,-343485551),t[0]=this.add32(i,t[0]),t[1]=this.add32(o,t[1]),t[2]=this.add32(s,t[2]),t[3]=this.add32(a,t[3])}cmn(t,e,i,o,s,a){return e=this.add32(this.add32(e,t),this.add32(o,a)),this.add32(e<<s|e>>>32-s,i)}ff(t,e,i,o,s,a,n){return this.cmn(e&i|~e&o,t,e,s,a,n)}gg(t,e,i,o,s,a,n){return this.cmn(e&o|i&~o,t,e,s,a,n)}hh(t,e,i,o,s,a,n){return this.cmn(e^i^o,t,e,s,a,n)}ii(t,e,i,o,s,a,n){return this.cmn(i^(e|~o),t,e,s,a,n)}md51(t){const e=t.length,i=[1732584193,-271733879,-1732584194,271733878];let o;for(o=64;o<=t.length;o+=64)this.md5cycle(i,this.md5blk(t.substring(o-64,o)));t=t.substring(o-64);const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<t.length;o++)s[o>>2]|=t.charCodeAt(o)<<(o%4<<3);if(s[o>>2]|=128<<(o%4<<3),o>55)for(this.md5cycle(i,s),o=0;o<16;o++)s[o]=0;return s[14]=e*8,this.md5cycle(i,s),i}md5blk(t){const e=[];for(let i=0;i<64;i+=4)e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24);return e}rhex(t){const e="0123456789abcdef".split("");let i="",o=0;for(;o<4;o++)i+=e[t>>o*8+4&15]+e[t>>o*8&15];return i}hex(t){for(let e=0;e<t.length;e++)t[e]=this.rhex(t[e]);return t.join("")}md5(t){return this.hex(this.md51(t))}add32(t,e){return this.ieCompatibility?this.add32Compat(t,e):this.add32Std(t,e)}add32Std(t,e){return t+e&4294967295}add32Compat(t,e){const i=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(i>>16)<<16|i&65535}};function uc(t){return t==null||t.length===0}var Hn={"01":"GRID","02":"CHARTS","0102":"BOTH"},Qu="https://ag-grid.com/charts/licensing/",gc=class zt{constructor(e){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new zM,this.md5.init()}validateLicense(){const e=this.getLicenseDetails(zt.licenseKey,zt.gridContext),i=`AG ${e.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`;let o="";if(e.suppliedLicenseType==="BOTH"?o="AG Grid and AG Charts Enterprise":e.suppliedLicenseType==="GRID"?o="AG Grid Enterprise":e.suppliedLicenseType!==void 0&&(o="AG Charts Enterprise"),e.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(e.expired){const s=zt.getChartsReleaseDate(),a=zt.formatDate(s);this.outputExpiredKey(e.expiry,a,o)}else e.valid?e.isTrial&&e.trialExpired&&this.outputExpiredTrialKey(e.expiry,i,o):this.outputInvalidLicenseKey(!!e.incorrectLicenseType,i,o)}static extractExpiry(e){const i=e.substring(e.lastIndexOf("_")+1,e.length);return new Date(parseInt(zt.decode(i),10))}static extractLicenseComponents(e){let i=e.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),e.length<=32)return{md5:null,license:e,version:null,isTrial:null};const o=i.length-32,s=i.substring(o),a=i.substring(0,o),[n,r,l]=zt.extractBracketedInformation(i);return{md5:s,license:a,version:n,isTrial:r,type:l}}getLicenseDetails(e,i=!1){const o="CHARTS";if(uc(e))return{licenseKey:e,valid:!1,missing:!0,currentLicenseType:o};const s=zt.getChartsReleaseDate(),{md5:a,license:n,version:r,isTrial:l,type:c}=zt.extractLicenseComponents(e);let h=a===this.md5.md5(n)&&e.indexOf("For_Trialing_ag-Grid_Only")===-1,p,u,g=null,y=!1,f;function m(){p=g<new Date,u=void 0}if(h&&(g=zt.extractExpiry(n),h=!isNaN(g.getTime()),h))switch(u=s>g,r){case"legacy":case"2":{h=!1;break}case"3":uc(c)?h=!1:(f=c,c!==Hn["02"]&&c!==Hn["0102"]?(h=!1,y=!0):l&&m())}return h?{licenseKey:e,valid:h,expiry:zt.formatDate(g),expired:u,version:r,isTrial:l,trialExpired:p,invalidLicenseTypeForCombo:i?f!=="BOTH":void 0,incorrectLicenseType:y,currentLicenseType:o,suppliedLicenseType:f}:{licenseKey:e,valid:h,incorrectLicenseType:y,currentLicenseType:o,suppliedLicenseType:f}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!uc(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage??""}getHostname(){if(!this.document)return"localhost";const e=this.document.defaultView??window;if(!e)return"localhost";const i=e.location,{hostname:o=""}=i;return o}isForceWatermark(){if(!this.document)return!1;const e=this.document?.defaultView??typeof window<"u"?window:void 0;if(!e)return!1;const{pathname:i}=e.location;return i?i.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){const e=this.getHostname();return/^((?:[\w-]+\.)?ag-grid\.com)$/.exec(e)!==null}isLocalhost(){const e=this.getHostname();return/^(?:127\.0\.0\.1|localhost)$/.exec(e)!==null}static formatDate(e){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],o=e.getDate(),s=e.getMonth(),a=e.getFullYear();return o+" "+i[s]+" "+a}static getChartsReleaseDate(){return new Date(parseInt(zt.decode(zt.RELEASE_INFORMATION),10))}static decode(e){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o="",s,a,n,r,l,c,h,p=0;const u=e.replace(/[^A-Za-z0-9+/=]/g,"");for(;p<u.length;)r=i.indexOf(u.charAt(p++)),l=i.indexOf(u.charAt(p++)),c=i.indexOf(u.charAt(p++)),h=i.indexOf(u.charAt(p++)),s=r<<2|l>>4,a=(l&15)<<4|c>>2,n=(c&3)<<6|h,o=o+String.fromCharCode(s),c!=64&&(o=o+String.fromCharCode(a)),h!=64&&(o=o+String.fromCharCode(n));return o=zt.utf8_decode(o),o}static utf8_decode(e){e=e.replace(/rn/g,"n");let i="";for(let o=0;o<e.length;o++){const s=e.charCodeAt(o);s<128?i+=String.fromCharCode(s):s>127&&s<2048?(i+=String.fromCharCode(s>>6|192),i+=String.fromCharCode(s&63|128)):(i+=String.fromCharCode(s>>12|224),i+=String.fromCharCode(s>>6&63|128),i+=String.fromCharCode(s&63|128))}return i}static setGridContext(e=!1){zt.gridContext=e}static setLicenseKey(e){zt.licenseKey=e}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const i=e.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const o=i.filter(r=>r==="TRIAL").length===1,s=i.filter(r=>r.startsWith("v"))[0],a=s?s.replace("v",""):"legacy",n=Hn[i.filter(r=>Hn[r])[0]];return[a,o,n]}centerPadAndOutput(e){const i=this.totalMessageLength-e.length;console.error(e.padStart(i/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e,i="*",o=""){console.error(e.padEnd(this.totalMessageLength-o.length,i)+o)}outputInvalidLicenseKey(e,i,o){zt.gridContext||(e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${o} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Qu}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${Qu}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,i,o){zt.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${o} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){zt.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,i,o){zt.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${o} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${o} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};gc.RELEASE_INFORMATION="MTczMzkwNTUyNzEyOQ==",gc.gridContext=!1;var _s=gc;import{_ModuleSupport as wa}from"ag-charts-community";import{_ModuleSupport as FM}from"ag-charts-community";function yc(t,e,i){const o=(a,n,r,l)=>{let c=t[0];for(let h=a;r>0?h<=n:h>n;h+=r){const p=t[h];if(l(c,p))return!0;c=p}return!1},s=Math.floor(t.length/2);return o(e,s,e,i)?!0:o(t.length-e,s,-e,i)}import{_ModuleSupport as VM}from"ag-charts-community";var{OR:GM,POSITIVE_NUMBER:WM,NAN:UM,AxisInterval:HM,Validate:KM}=VM,fc=class extends HM{constructor(){super(...arguments),this.minSpacing=NaN}};d([KM(GM(WM,UM))],fc.prototype,"minSpacing",2);import{_ModuleSupport as mc}from"ag-charts-community";import{_ModuleSupport as xc}from"ag-charts-community";import{_ModuleSupport as YM}from"ag-charts-community";var{BaseProperties:qu,ChartAxisDirection:jM,ARRAY:XM,BOOLEAN:Sc,COLOR_STRING:bc,FONT_STYLE:ZM,FONT_WEIGHT:$M,LINE_DASH:QM,NUMBER:Ju,OBJECT:qM,POSITIVE_NUMBER:JM,RATIO:tg,STRING:eg,UNION:ig,AND:tk,Validate:Dt,MATCHING_CROSSLINE_TYPE:og,createId:ek,Group:vc}=YM,Qe=class extends qu{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};d([Dt(Sc,{optional:!0})],Qe.prototype,"enabled",2),d([Dt(eg,{optional:!0})],Qe.prototype,"text",2),d([Dt(ZM,{optional:!0})],Qe.prototype,"fontStyle",2),d([Dt($M,{optional:!0})],Qe.prototype,"fontWeight",2),d([Dt(JM)],Qe.prototype,"fontSize",2),d([Dt(eg)],Qe.prototype,"fontFamily",2),d([Dt(Ju)],Qe.prototype,"padding",2),d([Dt(bc,{optional:!0})],Qe.prototype,"color",2),d([Dt(Sc,{optional:!0})],Qe.prototype,"parallel",2);var fe=class extends qu{constructor(){super(...arguments),this.id=ek(this),this.shape="polygon",this.label=new Qe,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=jM.X,this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new vc({name:this.id}),this.rangeGroup=new vc({name:this.id}),this.labelGroup=new vc({name:this.id}),this._isRange=void 0}assignCrossLineGroup(t,e){t!==this._isRange&&(t?this.rangeGroup.appendChild(e):this.lineGroup.appendChild(e)),this._isRange=t}setSectorNodeProps(t){t.fill=this.fill,t.fillOpacity=this.fillOpacity??1,t.stroke=this.stroke,t.strokeOpacity=this.strokeOpacity??1,t.strokeWidth=this.strokeWidth??1,t.lineDash=this.lineDash}setLabelNodeProps(t,e,i,o,s){const{label:a}=this;t.x=e,t.y=i,t.text=a.text,t.textAlign="center",t.textBaseline=o,t.rotation=s,t.rotationCenterX=e,t.rotationCenterY=i,t.fill=a.color,t.fontFamily=a.fontFamily,t.fontSize=a.fontSize,t.fontStyle=a.fontStyle,t.visible=!0}};d([Dt(Sc,{optional:!0})],fe.prototype,"enabled",2),d([Dt(ig(["range","line"],"a crossLine type"),{optional:!0})],fe.prototype,"type",2),d([Dt(tk(og("range"),XM.restrict({length:2})),{optional:!0})],fe.prototype,"range",2),d([Dt(og("value"),{optional:!0})],fe.prototype,"value",2),d([Dt(bc,{optional:!0})],fe.prototype,"fill",2),d([Dt(tg,{optional:!0})],fe.prototype,"fillOpacity",2),d([Dt(bc,{optional:!0})],fe.prototype,"stroke",2),d([Dt(Ju,{optional:!0})],fe.prototype,"strokeWidth",2),d([Dt(tg,{optional:!0})],fe.prototype,"strokeOpacity",2),d([Dt(QM,{optional:!0})],fe.prototype,"lineDash",2),d([Dt(ig(["polygon","circle"],"a shape"))],fe.prototype,"shape",2),d([Dt(qM)],fe.prototype,"label",2);var{ChartAxisDirection:ik,validateCrossLineValues:ok,normalizeAngle360:Mc,isNumberEqual:sg,Group:sk,Path:ag,Sector:ak,RotatableText:nk,ContinuousScale:rk}=xc,kc=class extends fe{constructor(){super(),this.direction=ik.X,this.polygonNode=new ag,this.sectorNode=new ak,this.lineNode=new ag,this.crossLineRange=new sk,this.labelNode=new nk,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}update(t){const{scale:e,shape:i,type:o,value:s,range:a}=this;if(!e||!o||!ok(o,s,a,e,()=>{if(!rk.is(e))return!0;const[r,l]=a??[s,void 0],c=e.getDomain?.()??e.domain;return r>=c[0]&&r<=c[1]&&(o==="line"||l>=r&&l<=c[1])})){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,o==="line"&&i==="circle"&&e instanceof xc.BandScale&&(this.type="range",this.range=[s,s]),this.updateLineNode(t),this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t)}updateLineNode(t){const{scale:e,type:i,value:o,lineNode:s}=this;if(!t||i!=="line"||!e){s.visible=!1;return}const a=e.convert(o);if(isNaN(a)){s.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this;s.visible=!0,s.stroke=this.stroke,s.strokeOpacity=this.strokeOpacity??1,s.strokeWidth=this.strokeWidth??1,s.fill=void 0,s.lineDash=this.lineDash;const l=r*Math.cos(a),c=r*Math.sin(a),h=n*Math.cos(a),p=n*Math.sin(a);s.path.clear(!0),s.path.moveTo(h,p),s.path.lineTo(l,c),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(t){const{polygonNode:e,range:i,scale:o,shape:s,type:a}=this;if(!t||a!=="range"||s!=="polygon"||!o||!i){e.visible=!1;return}const n=o.ticks?.();if(!n){e.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=n.indexOf(i[0]),h=n.indexOf(i[1]),u=(c<=h?n.slice(c,h+1):n.slice(c).concat(n.slice(0,h+1))).map(y=>o.convert(y));e.visible=!0,this.setSectorNodeProps(e);const{path:g}=e;g.clear(!0),u.forEach((y,f)=>{const m=l*Math.cos(y),S=l*Math.sin(y);f===0?g.moveTo(m,S):g.lineTo(m,S)}),r===0?g.lineTo(0,0):u.slice().reverse().forEach(y=>{const f=r*Math.cos(y),m=r*Math.sin(y);g.lineTo(f,m)}),e.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(t){const{sectorNode:e,range:i,scale:o,shape:s,type:a}=this;if(!t||a!=="range"||s!=="circle"||!o||!i){e.visible=!1;return}const{axisInnerRadius:n,axisOuterRadius:r}=this,l=i.map(p=>o.convert(p)),c=o.step??0,h=o instanceof xc.BandScale?c/2:0;e.visible=!0,this.setSectorNodeProps(e),e.centerX=0,e.centerY=0,e.innerRadius=n,e.outerRadius=r,e.startAngle=l[0]-h,e.endAngle=l[1]+h,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(t){const{label:e,labelNode:i,range:o,scale:s,type:a}=this;if(!t||e.enabled===!1||!e.text||!s||a==="range"&&!o){i.visible=!0;return}const{axisInnerRadius:n,axisOuterRadius:r}=this;let l,c,h,p;if(a==="line"){const u=Mc(s.convert(this.value)),g=1.5*Math.PI,y=sg(u,g)||u>g||u<Math.PI/2,f=(n+r)/2*Math.cos(u),m=(n+r)/2*Math.sin(u);l=f+e.padding*Math.cos(u+Math.PI/2),c=m+e.padding*Math.sin(u+Math.PI/2),p=y?"top":"bottom",h=y?u:u-Math.PI}else{const[u,g]=o.map(b=>Mc(s.convert(b)));let y=(u+g)/2;u>g&&(y-=Math.PI),y=Mc(y);const f=(sg(y,0)||y>0)&&y<Math.PI;let m;const S=s.ticks?.()??[];this.shape==="circle"||S.length<3?m=r-e.padding:m=r*Math.cos(Math.PI/S.length)-e.padding,l=m*Math.cos(y),c=m*Math.sin(y),p=f?"bottom":"top",h=f?y-Math.PI/2:y+Math.PI/2}this.setLabelNodeProps(i,l,c,p,h)}};kc.className="AngleCrossLine";var{ChartAxisDirection:lk,NUMBER:ng,UNION:ck,ProxyOnWrite:hk,TextWrapper:dk,TextUtils:pk,Validate:Ac,angleBetween:uk,isNumberEqual:Ps,toRadians:Kn,normalizeAngle360:Bs,normalizeAngle360Inclusive:gk,Path:yk,RotatableText:fk,Transformable:mk,BBox:xk}=mc,Dc=class extends mc.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};d([Ac(ck(["fixed","parallel","perpendicular"],"a label orientation"))],Dc.prototype,"orientation",2);var _a=class extends mc.PolarAxis{constructor(t,e){super(t,e),this.startAngle=0,this.endAngle=void 0,this.labelData=[],this.tickData=[],this.radiusLine=this.axisGroup.appendChild(new yk),this.includeInvisibleDomains=!0}get direction(){return lk.X}createLabel(){return new Dc}update(){this.updateScale(),this.updatePosition(),this.updateGridLines(),this.updateTickLines(),this.updateLabels(),this.updateRadiusLine(),this.updateCrossLines()}normalizedAngles(){const t=Bs(-Math.PI/2+Kn(this.startAngle)),e=this.endAngle!=null?gk(Kn(this.endAngle)-Kn(this.startAngle)):2*Math.PI,i=t+e;return[t,i]}computeRange(){this.range=this.normalizedAngles()}calculateAvailableRange(){const{range:t,gridLength:e}=this;return uk(t[0],t[1])*e}updatePosition(){const{translation:t,axisGroup:e,gridGroup:i,crossLineRangeGroup:o,crossLineLineGroup:s,crossLineLabelGroup:a}=this,n=Math.floor(t.x),r=Math.floor(t.y);e.translationX=n,e.translationY=r,i.translationX=n,i.translationY=r,o.translationX=n,o.translationY=r,s.translationX=n,s.translationY=r,a.translationX=n,a.translationY=r}updateRadiusLine(){const t=this.radiusLine,{path:e}=t;e.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();i.forEach(({x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0})=>{r?e.arc(s,a,l,c,h):n?e.moveTo(s,a):e.lineTo(s,a)}),o&&e.closePath(),t.visible=this.line.enabled,t.stroke=this.line.stroke,t.strokeWidth=this.line.width,t.fill=void 0}getAxisLinePoints(){const{scale:t,shape:e,gridLength:i}=this,[o,s]=this.range,a=Ps(s-o,2*Math.PI),n=[];if(e==="circle")a?n.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):n.push({x:i*Math.cos(o),y:i*Math.sin(o),moveTo:!0},{x:0,y:0,radius:i,startAngle:Bs(o),endAngle:Bs(s),arc:!0,moveTo:!1});else if(e==="polygon"){const r=t.ticks?.().map(l=>t.convert(l));r&&r.length>2&&r.forEach((l,c)=>{const h=i*Math.cos(l),p=i*Math.sin(l),u=c===0;n.push({x:h,y:p,moveTo:u})})}return{points:n,closePath:a}}updateGridLines(){const{scale:t,gridLength:e,gridLine:{enabled:i,style:o,width:s},innerRadiusRatio:a}=this;if(!(o&&e>0))return;const n=this.tickData,r=e*a,l=o.length,c=h=>h.value;this.gridLineGroupSelection.update(i?n:[],void 0,c).each((h,p,u)=>{const{value:g}=p,{stroke:y,lineDash:f}=o[u%l],m=t.convert(g);h.x1=r*Math.cos(m),h.y1=r*Math.sin(m),h.x2=e*Math.cos(m),h.y2=e*Math.sin(m),h.stroke=y,h.strokeWidth=s,h.lineDash=f,h.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:t,tickLabelGroupSelection:e}=this,i=this.tickData;e.update(t.enabled?i:[]).each((o,s,a)=>{const n=this.labelData[a];if(!n||n.hidden){o.visible=!1;return}o.text=n.text,o.setFont(t),o.fill=t.color,o.x=n.x,o.y=n.y,o.textAlign=n.textAlign,o.textBaseline=n.textBaseline,o.visible=!0,n.rotation?(o.rotation=n.rotation,o.rotationCenterX=n.x,o.rotationCenterY=n.y):o.rotation=0})}updateTickLines(){const{scale:t,gridLength:e,tick:i,tickLineGroupSelection:o}=this,s=this.tickData;o.update(i.enabled?s:[]).each((a,n)=>{const{value:r}=n,l=t.convert(r),c=Math.cos(l),h=Math.sin(l);a.x1=e*c,a.y1=e*h,a.x2=(e+i.size)*c,a.y2=(e+i.size)*h,a.stroke=i.stroke,a.strokeWidth=i.width})}createLabelNodeData(t,e,i){const{label:o,gridLength:s,scale:a,tick:n}=this;if(!o.enabled)return[];const r=new fk,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,h=t.map((p,u)=>{const{value:g}=p,y=s+o.spacing+n.size,f=a.convert(g),m=Math.cos(f),S=Math.sin(f),b=y*m,v=y*S,{textAlign:x,textBaseline:M}=this.getLabelAlign(f),k=u===t.length-1&&g!==t[0]&&Ps(Bs(f),Bs(a.convert(t[0]))),A=this.getLabelRotation(f);let I=String(g);if(o.formatter){const{callbackCache:T}=this.moduleCtx;I=T.call(o.formatter,{value:g,index:u})??""}r.text=I,r.x=b,r.y=v,r.setFont(o),r.textAlign=x,r.textBaseline=M,r.rotation=A,A&&(r.rotationCenterX=b,r.rotationCenterY=v);let O=A?mk.toCanvas(r):r.getBBox();if(O&&e.hideWhenNecessary&&!A){const T=l-O.x,L=O.x+O.width-c,C=1;if(T>C||L>C){const D=O.width-Math.max(T,L);I=dk.wrapText(I,{maxWidth:D,font:o,textWrap:"never"}),I===pk.EllipsisChar&&(I=""),r.text=I,O=r.getBBox()}}return{text:I,x:b,y:v,textAlign:x,textBaseline:M,hidden:I===""||p.hidden||k,rotation:A,box:O}});return o.avoidCollisions&&this.avoidLabelCollisions(h),h}computeLabelsBBox(t,e){this.tickData=this.generateAngleTicks(),this.labelData=this.createLabelNodeData(this.tickData,t,e);const i=this.labelData.map(({box:o})=>o).filter(o=>o!=null);return!this.label.enabled||i.length===0?null:xk.merge(i)}getLabelOrientation(){const{label:t}=this;return t instanceof Dc?t.orientation:"fixed"}getLabelRotation(t){let e=Kn(this.label.rotation??0);t=Bs(t);const i=this.getLabelOrientation();return i==="parallel"?(e+=t,t>=0&&t<Math.PI?e-=Math.PI/2:e+=Math.PI/2):i==="perpendicular"&&(e+=t,t>=Math.PI/2&&t<1.5*Math.PI&&(e+=Math.PI)),e}getLabelAlign(t){const e=Math.cos(t),i=Math.sin(t);let o,s;const a=this.getLabelOrientation(),n=Ps(e,0),r=Ps(i,0),l=Ps(e,1),c=Ps(i,-1),h=e>0&&!n,p=i>0&&!r;return a==="parallel"?(o="center",s=l&&r||p?"top":"bottom"):a==="perpendicular"?(o=c||h?"left":"right",s="middle"):(o="right",n?o="center":h&&(o="left"),s="bottom",r?s="middle":p&&(s="top")),{textAlign:o,textBaseline:s}}updateCrossLines(){this.crossLines.forEach(t=>{if(t instanceof kc){const{shape:e,gridLength:i,innerRadiusRatio:o}=this;t.shape=e,t.axisOuterRadius=i,t.axisInnerRadius=i*o}}),super.updateCrossLines()}};_a.CrossLineConstructor=kc,d([hk("rotation"),Ac(ng)],_a.prototype,"startAngle",2),d([Ac(ng,{optional:!0})],_a.prototype,"endAngle",2);var{RATIO:rg,OBJECT:Sk,Validate:Ic,isNumberEqual:lg,BandScale:bk}=FM,Ko=class extends _a{constructor(t){super(t,new bk),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new fc}generateAngleTicks(){const{scale:t,gridLength:e}=this,{values:i,minSpacing:o}=this.interval,s=i??t.ticks()??[];if(s.length<2||isNaN(o))return s.map(c=>({value:c,visible:!0}));const a=s[0],n=t.convert(a),r=e*Math.cos(n),l=e*Math.sin(n);for(let c=1;c<s.length-1;c++){const h=s[c],p=t.convert(h);if(p-n>Math.PI)break;const u=e*Math.cos(p),g=e*Math.sin(p);if(Math.sqrt((u-r)**2+(g-l)**2)>o){const f=new Set([a]);return yc(s,c,(m,S)=>{f.add(S)}),s.map(m=>{const S=f.has(m);return{value:m,visible:S}})}}return[{value:a,visible:!0}]}avoidLabelCollisions(t){let{minSpacing:e}=this.label;if(Number.isFinite(e)||(e=0),t.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;const h=l.box.clone().grow(e/2),p=c.box.clone().grow(e/2);return h.collidesBBox(p)},o=t[0],s=t.at(-1),a=new Set([o]),n=lg(o.x,s.x)&&lg(o.y,s.y),r=Math.floor(t.length/2);for(let l=1;l<=r;l++){const c=n?t.slice(0,-1):t;if(!yc(c,l,i)){yc(c,l,(p,u)=>{a.add(u)});break}}t.forEach(l=>{a.has(l)||(l.hidden=!0,l.box=void 0)})}};Ko.className="AngleCategoryAxis",Ko.type="angle-category",d([Ic(rg)],Ko.prototype,"groupPaddingInner",2),d([Ic(rg)],Ko.prototype,"paddingInner",2),d([Ic(Sk)],Ko.prototype,"interval",2);var vk={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",moduleFactory:t=>new Ko(t)};import{_ModuleSupport as Mk}from"ag-charts-community";import{_ModuleSupport as kk}from"ag-charts-community";var{range:cg,isDenseInterval:Ak,isNumberEqual:Dk,LinearScale:Ik,Invalidating:Tk}=kk,hg=class extends Ik{constructor(){super(...arguments),this.arcLength=0,this.niceTickStep=0}ticks(){if(!this.domain||this.domain.length<2||this.domain.some(s=>!isFinite(s))||this.arcLength<=0)return[];this.refresh();const{interval:t}=this,[e,i]=this.getDomain();if(t){const s=Math.abs(t),a=this.getPixelRange();if(!Ak((i-e)/s,a))return cg(e,i,s)}const o=this.nice&&this.niceTickStep?this.niceTickStep:this.getTickStep(e,i);return cg(e,i,o)}hasNiceRange(){const t=this.range.slice().sort((i,o)=>i-o);return[Math.PI,2*Math.PI].some(i=>Dk(i,t[1]-t[0]))}getNiceStepAndTickCount(){const[t,e]=this.niceDomain;let i=this.getTickStep(t,e);const o=isNaN(this.maxTickCount)?1/0:this.maxTickCount,s=Math.abs(e-t)/i;let a=Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)));return a>o&&(a/=2,i*=2),{count:a,step:i}}updateNiceDomain(){if(super.updateNiceDomain(),!this.hasNiceRange())return;const t=this.niceDomain[0]>this.niceDomain[1],e=t?this.niceDomain[1]:this.niceDomain[0],{step:i,count:o}=this.getNiceStepAndTickCount(),s=1/i,a=i>=1?Math.ceil(e/i+o)*i:Math.ceil((e+o*i)*s)/s;this.niceDomain=t?[a,e]:[e,a],this.niceTickStep=i}getPixelRange(){return this.arcLength}};d([Tk],hg.prototype,"arcLength",2);var{AND:dg,Default:pg,GREATER_THAN:Ok,LESS_THAN:Lk,NUMBER_OR_NAN:ug,OBJECT:Nk,Validate:Tc,angleBetween:Ck,isNumberEqual:gg,normalisedExtentWithMetadata:Rk,findMinMax:Ek}=Mk,zs=class extends _a{constructor(t){super(t,new hg),this.shape="circle",this.min=NaN,this.max=NaN,this.interval=new fc}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=Rk(t,e,i);return{domain:o,clipped:s}}getRangeArcLength(){const{range:t}=this,e=Math.min(...t),i=Math.max(...t),o=Ck(e,i)||2*Math.PI,s=this.gridLength;return o*s}generateAngleTicks(){const t=this.getRangeArcLength(),{scale:e,range:i}=this,{values:o,minSpacing:s,maxSpacing:a}=this.interval,n=a?Math.floor(t/a):1,r=s?Math.floor(t/s):1/0,l=Math.floor(4/Math.PI*Math.abs(i[0]-i[1]));e.tickCount=Math.max(n,Math.min(r,l)),e.minTickCount=n,e.maxTickCount=r,e.arcLength=t;let c;if(o!=null){const[h,p]=Ek(e.getDomain().map(Number));c=o.filter(u=>u>=h&&u<=p).sort((u,g)=>u-g)}else c=e.ticks();return c.map(h=>({value:h,visible:!0}))}avoidLabelCollisions(t){let{minSpacing:e}=this.label;Number.isFinite(e)||(e=0);const i=(a,n)=>{if(a.hidden||n.hidden)return!1;const r=a.box.clone().grow(e/2),l=n.box.clone().grow(e/2);return r.collidesBBox(l)},o=t[0],s=t.at(-1);o!==s&&gg(o.x,s.x)&&gg(o.y,s.y)&&(s.hidden=!0);for(let a=1;a<t.length;a*=2){let n=!1;for(let r=a;r<t.length;r+=a){const l=t[r],c=t[r-a];if(i(c,l)){n=!0;break}}if(!n){t.forEach((r,l)=>{l%a>0&&(r.hidden=!0,r.box=void 0)});return}}t.forEach((a,n)=>{n>0&&(a.hidden=!0,a.box=void 0)})}};zs.className="AngleNumberAxis",zs.type="angle-number",d([Tc(dg(ug,Lk("max"))),pg(NaN)],zs.prototype,"min",2),d([Tc(dg(ug,Ok("min"))),pg(NaN)],zs.prototype,"max",2),d([Tc(Nk)],zs.prototype,"interval",2);var wk={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",moduleFactory:t=>new zs(t)};import{_ModuleSupport as yg}from"ag-charts-community";var{OrdinalTimeScale:_k,sortAndUniqueDates:Pk}=yg,Oc=class extends yg.CategoryAxis{constructor(t){super(t,new _k),this._lastSetDomain=void 0}normaliseDataDomain(t){return{domain:t,clipped:!1}}setDomain(t){if(this._lastSetDomain===t)return;this._lastSetDomain=t;const e=Pk(t);super.setDomain(e)}onFormatChange(t,e,i,o){o?super.onFormatChange(t,e,i,o):this.labelFormatter=this.scale.tickFormat({ticks:t,domain:i})}};Oc.className="OrdinalTimeAxis",Oc.type="ordinal-time";var Bk={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",moduleFactory:t=>new Oc(t)};import{_ModuleSupport as zk}from"ag-charts-community";import{_ModuleSupport as Lc}from"ag-charts-community";import{_ModuleSupport as Nc}from"ag-charts-community";var{ChartAxisDirection:Fk,Validate:Vk,NUMBER:Gk,validateCrossLineValues:Wk,clamp:fg,normalizeAngle360:Uk,toRadians:Hk,isNumberEqual:Kk,Group:Yk,Path:jk,Sector:Xk,RotatableText:Zk}=Nc,mg=class extends Qe{constructor(){super(...arguments),this.positionAngle=void 0}};d([Vk(Gk,{optional:!0})],mg.prototype,"positionAngle",2);var Cc=class extends fe{constructor(){super(),this.direction=Fk.Y,this.label=new mg,this.polygonNode=new jk,this.sectorNode=new Xk,this.crossLineRange=new Yk,this.labelNode=new Zk,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(t){const{scale:e,type:i,value:o,range:s}=this;if(!e||!i||!Wk(i,o,s,e)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}i==="line"&&e instanceof Nc.BandScale&&(this.type="range",this.range=[o,o]),this.updateRadii();const{innerRadius:a,outerRadius:n}=this;t&&(t=a>=this.axisInnerRadius&&n<=this.axisOuterRadius),this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t),this.assignCrossLineGroup(this.type==="range",this.crossLineRange)}updateRadii(){const{range:t,scale:e,type:i,axisInnerRadius:o,axisOuterRadius:s}=this;if(!e)return{innerRadius:0,outerRadius:0};const a=l=>s+o-l;let n=0,r=0;if(i==="line")n=a(e.convert(this.value)),r=n;else{const l=Math.abs(e?.bandwidth??0),c=t.map(h=>e.convert(h));n=a(Math.max(...c)),r=a(Math.min(...c))+l}this.outerRadius=n,this.innerRadius=r}drawPolygon(t,e,i){e.forEach((o,s)=>{const a=t*Math.cos(o),n=t*Math.sin(o);s===0?i.path.moveTo(a,n):i.path.lineTo(a,n)}),i.path.closePath()}updatePolygonNode(t){const{gridAngles:e,polygonNode:i,scale:o,shape:s,type:a,innerRadius:n,outerRadius:r}=this;if(!t||s!=="polygon"||!o||!e){i.visible=!1;return}i.visible=!0;const l=this.getPadding();i.path.clear(!0),this.drawPolygon(r-l,e,i);const c=e.slice().reverse(),h=a==="line"?r-l:n+l;this.drawPolygon(h,c,i),this.setSectorNodeProps(i)}updateSectorNode(t){const{axisInnerRadius:e,axisOuterRadius:i,scale:o,sectorNode:s,shape:a,innerRadius:n,outerRadius:r}=this;if(!t||a!=="circle"||!o){s.visible=!1;return}s.visible=!0,s.startAngle=0,s.endAngle=2*Math.PI;const l=this.getPadding(),c=fg(e,n+l,i),h=fg(e,r-l,i);s.innerRadius=Math.min(c,h),s.outerRadius=Math.max(c,h),this.setSectorNodeProps(s)}updateLabelNode(t){const{innerRadius:e,label:i,labelNode:o,scale:s,shape:a,type:n}=this;if(!t||i.enabled===!1||!i.text||!s){o.visible=!1;return}const r=Uk(Hk((i.positionAngle??0)-90)),l=(Kk(r,0)||r>0)&&r<Math.PI,c=l?r-Math.PI/2:r+Math.PI/2;let h=0;const p=this.gridAngles??[];n==="line"?h=e+i.padding:a==="circle"||p.length<3?h=e-i.padding:h=e*Math.cos(Math.PI/p.length)-i.padding;const u=h*Math.cos(r),g=h*Math.sin(r);let y;n==="line"?y=l?"top":"bottom":y=l?"bottom":"top",this.setLabelNodeProps(o,u,g,y,c)}getPadding(){const{scale:t}=this;if(!t)return 0;const e=Math.abs(t.bandwidth??0),i=Math.abs(t.step??0);return t instanceof Nc.BandScale?(i-e)/2:0}};Cc.className="RadiusCrossLine";var{ChartAxisDirection:$k,Default:Qk,ZIndexMap:qk,NUMBER:xg,BOOLEAN:Jk,Validate:Rc,isNumberEqual:tA,normalizeAngle360:Sg,toRadians:eA,Caption:iA,Group:oA,Path:sA,Selection:aA}=Lc,Ec=class extends Lc.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};d([Rc(Jk,{optional:!0})],Ec.prototype,"autoRotate",2),d([Rc(xg)],Ec.prototype,"autoRotateAngle",2);var Yn=class extends Lc.PolarAxis{constructor(){super(...arguments),this.positionAngle=0,this.gridPathGroup=this.gridGroup.appendChild(new oA({name:`${this.id}-gridPaths`,zIndex:qk.AXIS_GRID})),this.gridPathSelection=aA.select(this.gridPathGroup,sA)}get direction(){return $k.Y}getAxisTransform(){const t=this.scale.range[0],{translation:e,positionAngle:i,innerRadiusRatio:o}=this,s=t*o,a=eA(i);return{translationX:e.x,translationY:e.y-t-s,rotation:a,rotationCenterX:0,rotationCenterY:t+s}}updateSelections(t,e,i){super.updateSelections(t,e,i);const{gridLine:{enabled:o,style:s,width:a},shape:n}=this;if(!s)return;const r=this.prepareTickData(e),l=s.length,c=(f,m)=>{const{stroke:S,lineDash:b}=s[m%l];f.stroke=S,f.strokeWidth=a,f.lineDash=b,f.fill=void 0},[h,p]=this.gridRange??[0,2*Math.PI],u=tA(p-h,2*Math.PI),g=(f,m)=>{const{path:S}=f;S.clear(!0);const b=this.getTickRadius(m);u?(S.moveTo(b,0),S.arc(0,0,b,0,2*Math.PI)):(S.moveTo(b*Math.cos(h),b*Math.sin(h)),S.arc(0,0,b,Sg(h),Sg(p))),u&&S.closePath()},y=(f,m)=>{const{path:S}=f,b=this.gridAngles;if(S.clear(!0),!b||b.length<3)return;const v=this.getTickRadius(m);b.forEach((x,M)=>{const k=v*Math.cos(x),A=v*Math.sin(x);M===0?S.moveTo(k,A):S.lineTo(k,A),b.forEach((I,O)=>{const T=v*Math.cos(I),L=v*Math.sin(I);O===0?S.moveTo(T,L):S.lineTo(T,L)}),S.closePath()}),S.closePath()};this.gridPathSelection.update(o?r:[]).each((f,m,S)=>{c(f,S),n==="circle"?g(f,m):y(f,m)})}updateTitle(){const t=r=>r.defaultValue,{title:e,range:i,moduleCtx:{callbackCache:o}}=this,{formatter:s=t}=this.title;e.caption.enabled=e.enabled,e.caption.fontFamily=e.fontFamily,e.caption.fontSize=e.fontSize,e.caption.fontStyle=e.fontStyle,e.caption.fontWeight=e.fontWeight,e.caption.color=e.color,e.caption.wrapping=e.wrapping;let a=!1;const n=e.caption.node;e.enabled&&(a=!0,n.rotation=Math.PI/2,n.x=Math.floor((i[0]+i[1])/2),n.y=-iA.SMALL_PADDING,n.textAlign="center",n.textBaseline="bottom",n.text=o.call(s,this.getTitleFormatterParams())),n.visible=a}updateCrossLines(){this.crossLines.forEach(t=>{if(t instanceof Cc){const{shape:e,gridAngles:i,range:o,innerRadiusRatio:s}=this,a=o[0];t.shape=e,t.gridAngles=i,t.axisOuterRadius=a,t.axisInnerRadius=a*s}}),super.updateCrossLines()}createLabel(){return new Ec}};Yn.CrossLineConstructor=Cc,d([Rc(xg),Qk(0)],Yn.prototype,"positionAngle",2);var{RATIO:wc,ProxyPropertyOnWrite:bg,Validate:_c,BandScale:vg}=zk,Yo=class extends Yn{constructor(t){super(t,new vg),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}prepareTickData(t){return t.slice().reverse()}getTickRadius(t){const{scale:e,innerRadiusRatio:i}=this,o=e.range[0],s=o*i;if(e instanceof vg){const a=e.ticks(),n=a.length-1-a.indexOf(t.tickId);return n===0?s:e.inset+e.step*(n-.5)+e.bandwidth/2}else{const a=(o-s)/e.domain.length;return o-t.translationY+s-a/2}}};Yo.className="RadiusCategoryAxis",Yo.type="radius-category",d([_c(wc)],Yo.prototype,"groupPaddingInner",2),d([bg("scale","paddingInner"),_c(wc)],Yo.prototype,"paddingInner",2),d([bg("scale","paddingOuter"),_c(wc)],Yo.prototype,"paddingOuter",2);var nA={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",moduleFactory:t=>new Yo(t)};import{_ModuleSupport as rA}from"ag-charts-community";var{AND:Mg,Default:kg,GREATER_THAN:lA,LESS_THAN:cA,NUMBER_OR_NAN:Ag,Validate:Dg,normalisedExtentWithMetadata:hA,LinearScale:dA}=rA,Pa=class extends Yn{constructor(t){super(t,new dA),this.shape="polygon",this.min=NaN,this.max=NaN}prepareTickData(t){const{scale:e}=this,i=e.getDomain?.()[1];return t.filter(({tick:o})=>o!==i).sort((o,s)=>s.tick-o.tick)}getTickRadius(t){const{scale:e}=this,i=e.range[0],o=i*this.innerRadiusRatio;return i-t.translationY+o}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=hA(t,e,i);return{domain:o,clipped:s}}};Pa.className="RadiusNumberAxis",Pa.type="radius-number",d([Dg(Mg(Ag,cA("max"))),kg(NaN)],Pa.prototype,"min",2),d([Dg(Mg(Ag,lA("min"))),kg(NaN)],Pa.prototype,"max",2);var pA={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",moduleFactory:t=>new Pa(t)};import{_ModuleSupport as Ig}from"ag-charts-community";var{BOOLEAN:uA,POSITIVE_NUMBER:gA,ObserveChanges:Tg,Validate:Og}=Ig,Pc=class extends Ig.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,t.animationManager.skip(!1)}};d([Tg((t,e)=>{t.ctx.animationManager.skip(!e)}),Og(uA)],Pc.prototype,"enabled",2),d([Tg((t,e)=>{t.ctx.animationManager.defaultDuration=e}),Og(gA,{optional:!0})],Pc.prototype,"duration",2);var yA={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new Pc(t),themeTemplate:{animation:{enabled:!0}}};import{_ModuleSupport as jn}from"ag-charts-community";import{_ModuleSupport as Bc}from"ag-charts-community";var fA='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>',{focusCursorAtEnd:mA}=Bc,Lg="text-input",Ng="canvas-overlay",xA=class extends Bc.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=t.domManager.addChild(Ng,Lg),this.element.classList.add("ag-charts-text-input"),this.destroyFns.push(()=>t.domManager.removeChild(Ng,Lg))}setKeyDownHandler(t){this.element.addEventListener("keydown",t),this.destroyFns.push(()=>this.element.removeEventListener("keydown",t))}show(t){this.element.innerHTML=fA;const e=this.element.firstElementChild;e.isContentEditable||(e.contentEditable="true"),e.setAttribute("placeholder",this.ctx.localeManager.t(t.placeholderText??"inputTextareaPlaceholder")),t.styles?.placeholderColor&&e.style.setProperty("--ag-charts-input-placeholder-color",t.styles?.placeholderColor),e.innerText=t.text??"",e.style.color=t.styles?.color??"inherit",e.style.fontFamily=t.styles?.fontFamily??"inherit",e.style.fontSize=t.styles?.fontSize?`${t.styles.fontSize}px`:"inherit",e.style.fontStyle=t.styles?.fontStyle??"inherit",e.style.fontWeight=typeof t.styles?.fontWeight=="number"?`${t.styles.fontWeight}`:t.styles?.fontWeight??"inherit",mA(e),e.addEventListener("input",()=>{this.updatePosition(),t.onChange?.(this.getValue(),this.getBBox())}),e.addEventListener("click",i=>{i.stopPropagation()}),t.layout&&(this.layout=t.layout,this.updatePosition()),t.onChange?.(this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(t){this.element.firstElementChild&&(this.element.firstElementChild.style.color=t)}updateFontSize(t){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${t}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){const{element:t}=this,e=t.firstElementChild;if(!e)return;const i=this.ctx.domManager.getBoundingClientRect(),{width:o,getTextInputCoords:s,getTextPosition:a,alignment:n,textAlign:r}=this.layout;t.style.setProperty("width",o?`${o}px`:"unset");const l=e.getBoundingClientRect(),c=s(l.height);let h=c.x;n==="center"?h-=(o??l.width)/2:n==="right"&&(h-=o??l.width);const p=a();let u=c.y;p==="center"?u-=l.height/2:p==="bottom"&&(u-=l.height),t.style.setProperty("top",`${u}px`),t.style.setProperty("left",`${h}px`),t.style.setProperty("max-width",`${i.width-h}px`),t.style.setProperty("text-align",n),e.style.setProperty("text-align",r)}getBBox(){const{left:t,top:e,width:i,height:o}=this.element.getBoundingClientRect();return new Bc.BBox(t,e,i,o)}};import{_ModuleSupport as SA}from"ag-charts-community";var{BOOLEAN:bA,BaseProperties:vA,Validate:Cg,UNION:MA}=SA,kA=MA(["x","y","xy"],"an axis type"),zc=class extends vA{constructor(){super(...arguments),this.enabled=!0,this.axes="y"}};d([Cg(bA)],zc.prototype,"enabled",2),d([Cg(kA,{optional:!0})],zc.prototype,"axes",2);import{_ModuleSupport as AA}from"ag-charts-community";var Fc=(t=>(t.Line="line",t.HorizontalLine="horizontal-line",t.VerticalLine="vertical-line",t.DisjointChannel="disjoint-channel",t.ParallelChannel="parallel-channel",t.FibonacciRetracement="fibonacci-retracement",t.Callout="callout",t.Comment="comment",t.Note="note",t.Text="text",t.Arrow="arrow",t.ArrowUp="arrow-up",t.ArrowDown="arrow-down",t.DateRange="date-range",t.PriceRange="price-range",t.DatePriceRange="date-price-range",t.QuickDatePriceRange="quick-date-price-range",t))(Fc||{}),DA=Object.values(Fc);function IA(t){for(const e of DA)if(e===t)return e}import{_ModuleSupport as TA}from"ag-charts-community";import{_ModuleSupport as OA}from"ag-charts-community";import{_ModuleSupport as LA}from"ag-charts-community";var{BOOLEAN:Ba,COLOR_STRING:Vc,DATE:Gc,FONT_STYLE:NA,FONT_WEIGHT:CA,FUNCTION:RA,LINE_DASH:EA,LINE_STYLE:wA,NUMBER:jo,OBJECT:za,OR:Wc,POSITIVE_NUMBER:Uc,RATIO:Rg,STRING:Fs,TEXT_ALIGN:_A,UNION:Xn,BaseProperties:po,Validate:et,generateUUID:PA}=LA,Zn=class extends po{};d([et(Wc(Fs,jo,Gc))],Zn.prototype,"x",2),d([et(jo)],Zn.prototype,"y",2);var BA=class extends ie(Bi(Pg(po))){},Hc=class extends ie(Bi(fi(jc($o(po))))){constructor(){super(...arguments),this.cornerRadius=2}};d([et(Ba)],Hc.prototype,"enabled",2),d([et(Uc)],Hc.prototype,"cornerRadius",2);var zA=class extends fi(po){},FA=class extends ie(Bi(fi(po))){},Xo=class extends $o(po){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};d([et(Fs)],Xo.prototype,"label",2),d([et(Xn(["top","center","bottom"]),{optional:!0})],Xo.prototype,"position",2),d([et(Xn(["left","center","right"]),{optional:!0})],Xo.prototype,"alignment",2);var VA=class extends $o(po){},Fa=class extends $o(po){constructor(){super(...arguments),this.label=""}};d([et(Fs)],Fa.prototype,"label",2),d([et(Xn(["top","inside","bottom"]),{optional:!0})],Fa.prototype,"position",2),d([et(Xn(["left","center","right"]),{optional:!0})],Fa.prototype,"alignment",2);function Zo(t){class e extends WA(Pg(t)){constructor(){super(...arguments),this.id=PA()}isValidWithContext(o,s){return super.isValid(s)}}return e}function Kc(t){class e extends t{constructor(){super(...arguments),this.start=new Zn,this.end=new Zn}}return d([et(za)],e.prototype,"start",2),d([et(za)],e.prototype,"end",2),e}function Eg(t){class e extends t{}return d([et(Wc(Fs,jo,Gc))],e.prototype,"x",2),d([et(jo)],e.prototype,"y",2),e}function wg(t){class e extends t{}return d([et(Wc(Fs,jo,Gc))],e.prototype,"value",2),e}function Yc(t){class e extends t{constructor(){super(...arguments),this.background=new zA}}return d([et(za,{optional:!0})],e.prototype,"background",2),e}function uo(t){class e extends t{constructor(){super(...arguments),this.handle=new FA}}return d([et(za,{optional:!0})],e.prototype,"handle",2),e}function _g(t){class e extends t{constructor(){super(...arguments),this.axisLabel=new Hc}}return d([et(za,{optional:!0})],e.prototype,"axisLabel",2),e}function jc(t){class e extends t{constructor(){super(...arguments),this.textAlign="center"}}return d([et(Uc,{optional:!0})],e.prototype,"padding",2),d([et(_A,{optional:!0})],e.prototype,"textAlign",2),d([et(RA,{optional:!0})],e.prototype,"formatter",2),e}function GA(t){class e extends t{}return e}function Xc(t){class e extends t{}return d([et(Ba,{optional:!0})],e.prototype,"extendStart",2),d([et(Ba,{optional:!0})],e.prototype,"extendEnd",2),e}function WA(t){class e extends t{}return d([et(Ba,{optional:!0})],e.prototype,"locked",2),e}function Zc(t){class e extends t{setLocaleManager(o){this.localeManager??(this.localeManager=o)}}return e}function Pg(t){class e extends t{}return d([et(Ba,{optional:!0})],e.prototype,"visible",2),e}function fi(t){class e extends t{}return d([et(Vc,{optional:!0})],e.prototype,"fill",2),d([et(Rg,{optional:!0})],e.prototype,"fillOpacity",2),e}function ie(t){class e extends t{}return d([et(Vc,{optional:!0})],e.prototype,"stroke",2),d([et(Rg,{optional:!0})],e.prototype,"strokeOpacity",2),d([et(jo,{optional:!0})],e.prototype,"strokeWidth",2),e}function Bi(t){class e extends t{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return d([et(EA,{optional:!0})],e.prototype,"lineDash",2),d([et(jo,{optional:!0})],e.prototype,"lineDashOffset",2),d([et(wA,{optional:!0})],e.prototype,"lineStyle",2),e}function $o(t){class e extends t{constructor(){super(...arguments),this.fontSize=12,this.fontFamily="Verdana, sans-serif"}}return d([et(NA,{optional:!0})],e.prototype,"fontStyle",2),d([et(CA,{optional:!0})],e.prototype,"fontWeight",2),d([et(Uc)],e.prototype,"fontSize",2),d([et(Fs)],e.prototype,"fontFamily",2),d([et(Vc,{optional:!0})],e.prototype,"color",2),e}import{_ModuleSupport as UA}from"ag-charts-community";function zi(t,e){if(t.start==null||t.end==null)return;const i=Ft(t.start,e),o=Ft(t.end,e);if(!(i==null||o==null))return{x1:i.x,y1:i.y,x2:o.x,y2:o.y}}function Ft(t,e){const i=Qo(t.x,e.xAxis),o=Qo(t.y,e.yAxis);return{x:i,y:o}}function Qo(t,e){if(t==null)return 0;const i=(e.scale.bandwidth??0)/2;return e.scale.convert(t)+i}function St(t,e){const i=Va(t.x,e.xAxis),o=Va(t.y,e.yAxis);return{x:i,y:o}}function Va(t,e){const i=(e.scale.bandwidth??0)/2;return e.continuous?e.scaleInvert(t-i):e.scaleInvertNearest(t-i)}import{_ModuleSupport as HA}from"ag-charts-community";var{BaseProperties:KA}=HA,$c=class extends Zo(Kc(uo(KA))){constructor(){super(...arguments),this.snapToAngle=45}isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){}getDefaultOpacity(t){}},{STRING:YA,Validate:jA}=UA,Bg=class extends Zc(jc($o($c))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){const{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){const t=this.text.length==0;let e=this.text;return t&&(e=this.placeholderText??"",this.localeManager&&(e=this.localeManager.t(e))),{text:e,isPlaceholder:t}}getTextInputCoords(t,e){return Ft(this.end,t)}getTextPosition(){return this.position}};d([jA(YA)],Bg.prototype,"text",2);var{STRING:XA,Validate:ZA,isObject:$A,Color:zg}=OA,QA={top:6,right:12,bottom:9,left:12},qe=class extends fi(ie(Bg)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(t){return $A(t)&&t.type==="callout"}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:t,g:e,b:i}=zg.fromString(this.color??"#888888");return new zg(t,e,i,.66).toString()}getPadding(){const{padding:t}=this;return t==null?{...QA}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const i=super.getTextInputCoords(t,e),o=this.getPadding(),s=typeof o=="number"?o:o?.left??0,a=typeof o=="number"?o:o?.bottom??0;return{x:i.x+s,y:i.y-a}}};d([ZA(XA)],qe.prototype,"type",2);import{_ModuleSupport as qA}from"ag-charts-community";import{_ModuleSupport as JA}from"ag-charts-community";var{STRING:tD,BaseProperties:eD,Validate:iD}=JA,$n=class extends Zo(Eg(uo(jc($o(eD))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){const{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){const t=this.text.length==0;return{text:t?this.placeholderText??"":this.text,isPlaceholder:t}}getTextInputCoords(t,e){return Ft(this,t)}getTextPosition(){return this.position}};d([iD(tD)],$n.prototype,"text",2);var{STRING:oD,Validate:sD,isObject:aD,Color:Fg}=qA,Qn={top:8,right:14,bottom:8,left:14},mi=class extends fi(ie($n)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(t){return aD(t)&&t.type==="comment"}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:t,g:e,b:i}=Fg.fromString(this.color??"#888888");return new Fg(t,e,i,.66).toString()}getPadding(){const{padding:t,fontSize:e}=this;return t==null?{top:Math.max(e*.4,Qn.top),bottom:Math.max(e*.4,Qn.bottom),left:Math.max(e*.8,Qn.left),right:Math.max(e*.8,Qn.right)}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const i=super.getTextInputCoords(t,e),o=this.getPadding();return{x:i.x+o.left,y:i.y-o.bottom}}};d([sD(oD)],mi.prototype,"type",2);import{_ModuleSupport as nD}from"ag-charts-community";import{_ModuleSupport as rD}from"ag-charts-community";var{Vec2:qo}=rD;function Ga(t,e){return t?"dashed":e??"solid"}function Vg(t,e){switch(e){case"solid":return[];case"dashed":return[t*4,t*2];case"dotted":return[0,t*2]}}function Vs(t,e,i,o){const s=Ga(t,i);return e??t??Vg(o??1,s)}function Gs(t,e,i){const o=Ga(e,i);return t??o==="dotted"?"round":void 0}function lD(t,e){const[i,o]=qo.from(t),s=e.height,a=qo.gradient(o,i,s),n=qo.intercept(o,a,s),r=[{x:i.x,y:s??0},{x:i.x,y:s==null?e.height:s-e.height}];if(a===1/0)return r;let l=[qo.intersectAtY(a,n,0,s),qo.intersectAtY(a,n,e.height,s),qo.intersectAtX(a,n,0,s),qo.intersectAtX(a,n,e.width,s)];return l=l.filter(c=>c.x>=e.x&&c.x<=e.width&&c.y>=e.y&&c.y<=e.height).sort((c,h)=>c.x===h.x?0:c.x<h.x?-1:1),l.length!==2?r:l}var{BOOLEAN:qn,OBJECT:Ws,STRING:Jn,BaseProperties:Qc,Validate:me,isObject:tr}=nD,cD=class extends ie(Qc){},qc=class extends $o(fi(ie(Qc))){constructor(){super(...arguments),this.divider=new cD}};d([me(Ws,{optional:!0})],qc.prototype,"divider",2);var Jc=class extends fi(ie(uo(Qc))){constructor(){super(...arguments),this.statistics=new qc}};d([me(Ws,{optional:!0})],Jc.prototype,"statistics",2);var Us=class extends Zc(Yc(ie(Bi($c)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new qc,this.getVolume=()=>{},this.text=new Xo}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Vs(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Gs(this.lineCap,this.lineDash,this.lineStyle)}};d([me(Ws,{optional:!0})],Us.prototype,"statistics",2),d([me(Ws,{optional:!0})],Us.prototype,"text",2);function th(t){class e extends t{constructor(){super(...arguments),this.hasDateRange=!0}}return e}function eh(t){class e extends t{constructor(){super(...arguments),this.hasPriceRange=!0}}return e}var Fe=class extends th(Us){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(t){return tr(t)&&t.type==="date-range"}};d([me(Jn)],Fe.prototype,"type",2),d([me(qn,{optional:!0})],Fe.prototype,"extendAbove",2),d([me(qn,{optional:!0})],Fe.prototype,"extendBelow",2);var Ve=class extends eh(Us){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(t){return tr(t)&&t.type==="price-range"}};d([me(Jn)],Ve.prototype,"type",2),d([me(qn,{optional:!0})],Ve.prototype,"extendLeft",2),d([me(qn,{optional:!0})],Ve.prototype,"extendRight",2);var Fi=class extends th(eh(Us)){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(t){return tr(t)&&t.type==="date-price-range"}};d([me(Jn)],Fi.prototype,"type",2);var Oe=class extends th(eh(Us)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new Jc,this.down=new Jc,this.direction="both"}static is(t){return tr(t)&&t.type==="quick-date-price-range"}};d([me(Jn)],Oe.prototype,"type",2),d([me(Ws,{optional:!0})],Oe.prototype,"up",2),d([me(Ws,{optional:!0})],Oe.prototype,"down",2);import{_ModuleSupport as hD}from"ag-charts-community";import{_ModuleSupport as dD}from"ag-charts-community";var{TextWrapper:pD,CachedTextMeasurerPool:uD,BBox:gD}=dD,er=1.38;function Gg(t){return{font:{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},textAlign:t.textAlign,textBaseline:t.position=="center"?"middle":t.position,lineHeight:er,avoidOrphans:!1,textWrap:"always"}}function ir(t,e,i){return i?pD.wrapText(e,{...Gg(t),maxWidth:i}):e}function yD(t,e){const i=Gg(t),{lineMetrics:o,width:s}=uD.measureLines(e,i),a=o.length*(t.fontSize??14)*er;return{width:s,height:a}}function ih(t,e,i,o){let s=o?.width??0,a=o?.height??0;if(!o){const n=t.width!=null?ir(t,e,t.width):e;({width:s,height:a}=yD(t,n))}return new gD(i.x,i.y,s,a)}function Wg(t,e,i,o,{x:s,y:a}){const{visible:n=!0,fontFamily:r,fontSize:l=14,fontStyle:c,fontWeight:h,textAlign:p}=o,u=l*er,g=o.position=="center"?"middle":o.position,y=i?o.getPlaceholderColor():o.color;t.setProperties({x:s,y:a,visible:n,text:e,fill:y,fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h,textAlign:p,lineHeight:u,textBaseline:g})}var{OBJECT:fD,STRING:mD,BaseProperties:xD,Validate:Ug,isObject:SD,clamp:bD}=hD,vD=10,MD=11,Hg=20,kD=22,AD=10,Kg=Hg+AD,Yg=34,DD=class extends fi(ie(xD)){},xe=class extends fi(ie($n)){constructor(){super(...arguments),this.type="note",this.background=new DD,this.position="bottom",this.alignment="center",this.width=200}static is(t){return SD(t)&&t.type==="note"}getDefaultColor(t){switch(t){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(t){switch(t){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){const t=this.padding??vD;return{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const{width:i,text:o}=this,s=super.getTextInputCoords(t,e),a=this.getPadding().top,n=ih(this,o,s);n.x=bD(i/2,n.x,t.seriesRect.width-i/2);const r=n.y-Kg-a*2,l=n.y+MD+a*2,c=Math.max(n.height,e);return r-c-Yg<0?(n.y=l,this.position="top"):(n.y=r+a,this.position="bottom"),{x:n.x,y:n.y}}};d([Ug(mD)],xe.prototype,"type",2),d([Ug(fD,{optional:!0})],xe.prototype,"background",2);import{_ModuleSupport as ID}from"ag-charts-community";var{BaseProperties:TD}=ID,OD=class extends Zo(Eg(uo(TD))){isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){}getDefaultOpacity(t){}},oh=class OM extends fi(OD){constructor(){super(...arguments),this.size=32}static is(e){return e instanceof OM}getDefaultColor(e){return e==="fill-color"?this.fill:void 0}getDefaultOpacity(e){return e==="fill-color"?this.fillOpacity:void 0}};import{_ModuleSupport as LD}from"ag-charts-community";import{_ModuleSupport as ND}from"ag-charts-community";var{Logger:sh}=ND;function Wa(t,e,i,o){let s=!0;return s&&(s=Je(t,e.start,i,o&&`${o}[start] `)),s&&(s=Je(t,e.end,i,o&&`${o}[end] `)),s}function jg(t,e,i){const o=e.direction==="horizontal"?t.yAxis:t.xAxis,s=ah(e.value,o);return!s&&i&&sh.warnOnce(`${i}is outside the axis domain, ignoring. - value: [${e.value}]]`),s}function Je(t,e,i,o){if(e.x==null||e.y==null)return o&&sh.warnOnce(`${o}requires both an [x] and [y] property, ignoring.`),!1;const s=i?.x===!1?!0:ah(e.x,t.xAxis),a=i?.y===!1?!0:ah(e.y,t.yAxis);if(!s||!a){let n="x & y domains";return s&&(n="y domain"),a&&(n="x domain"),o&&sh.warnOnce(`${o}is outside the ${n}, ignoring. - x: [${e.x}], y: ${e.y}]`),!1}return!0}function ah(t,e){const i=e.scale.getDomain?.();return i&&e.continuous?t>=i[0]&&t<=i.at(-1):!0}function CD(t){return t?.x!=null&&t?.y!=null}var{OBJECT:Xg,STRING:Zg,BaseProperties:$g,Validate:or,isObject:Qg}=LD,oe=class extends Zo(wg(uo(_g(ie(Bi($g)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new Xo}static is(t){return Qg(t)&&t.type==="horizontal-line"}isValidWithContext(t,e){return super.isValid(e)&&jg(t,this,e)}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Vs(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Gs(this.lineCap,this.lineDash,this.lineStyle)}};d([or(Zg)],oe.prototype,"type",2),d([or(Xg,{optional:!0})],oe.prototype,"text",2);var xi=class extends Zo(wg(uo(_g(ie(Bi($g)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new Xo}static is(t){return Qg(t)&&t.type==="vertical-line"}isValidWithContext(t,e){return super.isValid(e)&&jg(t,this,e)}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Vs(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Gs(this.lineCap,this.lineDash,this.lineStyle)}};d([or(Zg)],xi.prototype,"type",2),d([or(Xg,{optional:!0})],xi.prototype,"text",2);import{_ModuleSupport as RD}from"ag-charts-community";var{NUMBER:qg,OBJECT:ED,STRING:wD,BaseProperties:_D,Validate:sr,isObject:PD,Logger:BD}=RD,Ge=class extends Zo(Yc(Kc(uo(Xc(ie(Bi(_D))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new Fa,this.snapToAngle=45}static is(t){return PD(t)&&t.type==="disjoint-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.startHeight,t.end.y-=this.endHeight):BD.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}isValidWithContext(t,e){return super.isValid(e)&&Wa(t,this,{y:!1},e)&&Wa(t,this.bottom,{y:!1},e)}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Vs(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Gs(this.lineCap,this.lineDash,this.lineStyle)}};d([sr(wD)],Ge.prototype,"type",2),d([sr(qg)],Ge.prototype,"startHeight",2),d([sr(qg)],Ge.prototype,"endHeight",2),d([sr(ED,{optional:!0})],Ge.prototype,"text",2);import{_ModuleSupport as zD}from"ag-charts-community";import{_ModuleSupport as FD}from"ag-charts-community";import{_ModuleSupport as VD}from"ag-charts-community";var{OBJECT:GD,STRING:Jg,Validate:nh,isObject:ty}=VD,ar=class extends Zc(GA(Xc(ie(Bi($c))))){constructor(){super(...arguments),this.text=new Xo}isValidWithContext(t,e){return super.isValid(e)&&Wa(t,this,void 0,e)}getDefaultColor(t){switch(t){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return Vs(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Gs(this.lineCap,this.lineDash,this.lineStyle)}};d([nh(GD,{optional:!0})],ar.prototype,"text",2);var Vi=class extends ar{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(t){return ty(t)&&t.type==="arrow"}};d([nh(Jg)],Vi.prototype,"type",2);var Gi=class extends ar{constructor(){super(...arguments),this.type="line"}static is(t){return ty(t)&&t.type==="line"}};d([nh(Jg)],Gi.prototype,"type",2);var{OBJECT:WD,BOOLEAN:rh,COLOR_STRING:UD,COLOR_STRING_ARRAY:HD,Validate:Jo,predicateWithMessage:KD,isFiniteNumber:YD}=FD,jD=[10,6,4],XD=KD(t=>YD(t)&&jD.includes(t),"Number of fibonacci ranges, 10, 6 or 4"),go=class extends ar{constructor(){super(...arguments),this.label=new VA,this.reverse=!1,this.showFill=!0,this.isMultiColor=!0,this.strokes=[],this.bands=10}getDefaultColor(t){switch(t){case"line-color":return this.rangeStroke??this.stroke;case"text-color":return this.text.color}}};d([Jo(WD,{optional:!0})],go.prototype,"label",2),d([Jo(rh,{optional:!0})],go.prototype,"reverse",2),d([Jo(rh,{optional:!0})],go.prototype,"showFill",2),d([Jo(rh,{optional:!0})],go.prototype,"isMultiColor",2),d([Jo(HD,{optional:!0})],go.prototype,"strokes",2),d([Jo(UD,{optional:!0})],go.prototype,"rangeStroke",2),d([Jo(XD,{optional:!0})],go.prototype,"bands",2);var{STRING:ZD,Validate:$D,isObject:QD}=zD,Wi=class extends go{constructor(){super(...arguments),this.type="fibonacci-retracement"}static is(t){return QD(t)&&t.type==="fibonacci-retracement"}};d([$D(ZD)],Wi.prototype,"type",2);import{_ModuleSupport as qD}from"ag-charts-community";var{NUMBER:JD,STRING:tI,OBJECT:ey,BaseProperties:eI,Validate:nr,isObject:iI,Logger:oI}=qD,We=class extends Zo(Yc(Kc(uo(Xc(ie(Bi(eI))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new BA,this.text=new Fa,this.snapToAngle=45}static is(t){return iI(t)&&t.type==="parallel-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.height,t.end.y-=this.height):oI.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}isValidWithContext(t,e){return super.isValid(e)&&Wa(t,this,{y:!1},e)&&Wa(t,this.bottom,{y:!1},e)}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Vs(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Gs(this.lineCap,this.lineDash,this.lineStyle)}};d([nr(tI)],We.prototype,"type",2),d([nr(JD)],We.prototype,"height",2),d([nr(ey,{optional:!0})],We.prototype,"middle",2),d([nr(ey,{optional:!0})],We.prototype,"text",2);import{_ModuleSupport as sI}from"ag-charts-community";var{STRING:aI,Validate:nI,isObject:rI}=sI,Ui=class extends $n{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(t){return rI(t)&&t.type==="text"}};d([nI(aI)],Ui.prototype,"type",2);function yo(t){return Oe.is(t)}function rr(t){return Gi.is(t)||oe.is(t)||xi.is(t)||Vi.is(t)||iy(t)}function Hi(t){return Ge.is(t)||We.is(t)}function iy(t){return Wi.is(t)}function Si(t){return qe.is(t)||mi.is(t)||xe.is(t)||Ui.is(t)}function Ua(t){return Fe.is(t)||Ve.is(t)||Fi.is(t)||Oe.is(t)}var{isObject:lI}=TA;function lh(t){return Si(t)&&!xe.is(t)}function fo(t){return rr(t)||Hi(t)||Ua(t)&&!Oe.is(t)}function cI(t){return rr(t)||Hi(t)||Ua(t)||qe.is(t)||xe.is(t)}function hI(t){return xe.is(t)}function dI(t){return Hi(t)||Ua(t)||qe.is(t)||mi.is(t)||oh.is(t)}function pI(t){return Si(t)&&!xe.is(t)}function Hs(t){return(rr(t)||Hi(t)||Ua(t))&&!yo(t)&&lI(t.text)}function uI(t,e){"fontSize"in t&&(t.fontSize=e),Hs(t)&&(t.text.fontSize=e)}function oy(t,e){const i=e?.strokeWidth??t.strokeWidth??1,o=e?.type??t.lineStyle,s=o??Ga(t.lineDash,o),a=Vg(i,s);t.strokeWidth=i,t.computedLineDash=a,t.lineStyle=s,t.lineCap=s==="dotted"?"round":void 0}function lr(t,e,i,o,s,a){switch(e){case"fill-color":{"fill"in t&&(t.fill=o),"fillOpacity"in t&&(t.fillOpacity=s),"background"in t&&(t.background.fill=o,t.background.fillOpacity=s);break}case"line-color":{"axisLabel"in t&&(t.axisLabel.fill=o,t.axisLabel.fillOpacity=s,t.axisLabel.stroke=o,t.axisLabel.strokeOpacity=s),"fill"in t&&"fillOpacity"in t&&hI(t)?(t.fill=o,t.fillOpacity=s):("strokeOpacity"in t&&(t.strokeOpacity=s),"isMultiColor"in t&&"rangeStroke"in t?(t.isMultiColor=a,t.rangeStroke=o):"stroke"in t&&(t.stroke=o));break}case"text-color":{"color"in t&&(t.color=i),Hs(t)&&(t.text.color=o);break}}}var{deepClone:Ue}=AA,gI=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(Fc).map(t=>[t,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.fibonacciBands=new Map([["fibonacci-retracement",void 0]])}createMemento(){return{colors:Ue(this.colors),fontSizes:Ue(this.fontSizes),lineStyles:Ue(this.lineStyles),lineTextAlignments:Ue(this.lineTextAlignments),lineTextPositions:Ue(this.lineTextPositions),fibonacciBands:Ue(this.fibonacciBands)}}guardMemento(t){return!0}restoreMemento(t,e,i){this.colors=Ue(i.colors),this.fontSizes=Ue(i.fontSizes),this.lineStyles=Ue(i.lineStyles),this.lineTextAlignments=Ue(i.lineTextAlignments),this.lineTextPositions=Ue(i.lineTextPositions),this.fibonacciBands=Ue(i.fibonacciBands)}setDefaultColor(t,e,i,o,s,a){this.colors.get(t)?.set(e,[i,o,s,a])}setDefaultFontSize(t,e){this.fontSizes.set(t,e)}setDefaultLineStyleType(t,e){const i=this.lineStyles.get(t);i?i.type=e:this.lineStyles.set(t,{type:e})}setDefaultLineStyleWidth(t,e){const i=this.lineStyles.get(t);i?i.strokeWidth=e:this.lineStyles.set(t,{strokeWidth:e})}setDefaultLineTextAlignment(t,e){this.lineTextAlignments.set(t,e)}setDefaultLineTextPosition(t,e){this.lineTextPositions.set(t,e)}setDefaultFibonacciBands(t,e){t=="fibonacci-retracement"&&this.fibonacciBands.set(t,e)}applyDefaults(t){for(const[e,i]of this.colors)if(t.type===e)for(const[o,[s,a,n,r]=[]]of i)s&&a&&n!=null&&r!=null&&lr(t,o,s,a,n,r);for(const[e,i]of this.fontSizes)t.type!==e||i==null||uI(t,i);for(const[e,i]of this.lineStyles)t.type!==e||i==null||oy(t,i);for(const[e,i]of this.lineTextPositions)t.type!==e||i==null||(t.text.position=i);for(const[e,i]of this.lineTextAlignments)t.type!==e||i==null||(t.text.alignment=i);for(const[e,i]of this.fibonacciBands)t.type!==e||i==null||(t.bands=i)}};import{_ModuleSupport as sy}from"ag-charts-community";import{_ModuleSupport as ay}from"ag-charts-community";var yI='<div class="ag-charts-color-picker__palette" tabindex="0"></div><div class="ag-charts-color-picker__color-row"><button class="ag-charts-color-picker__multi-color-button" tabindex="0" type="button"></button> <input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"></div><input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field"><span class="ag-charts-color-picker__color-label">Color</span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',{createElement:fI,Color:ch,clamp:cr}=ay,ny=t=>{try{const e=ch.fromString(t),[i,o,s]=e.toHSB();return[i,o,s,e.a]}catch{return}},ry=class extends ay.AnchoredPopover{constructor(t,e){super(t,"color-picker",e),this.hasChanged=!1,this.hideFns.push(()=>{this.hasChanged&&this.onChangeHide?.()})}show(t){this.hasChanged=!1,this.onChangeHide=t.onChangeHide;const{element:e,initialFocus:i}=this.createColorPicker(t),o=this.showWithChildren([e],{initialFocus:i,...t});o.classList.add("ag-charts-color-picker"),o.setAttribute("role","dialog")}createColorPicker(t){let e=t.isMultiColor??!1,[i,o,s,a]=ny(t.color??"#f00")??[0,1,.5,1];a=t.opacity??a;const n=fI("div","ag-charts-color-picker__content");n.innerHTML=yI,n.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");const r=n.querySelector(".ag-charts-color-picker__palette"),l=n.querySelector(".ag-charts-color-picker__hue-input"),c=n.querySelector(".ag-charts-color-picker__multi-color-button"),h=n.querySelector(".ag-charts-color-picker__alpha-input"),p=n.querySelector(".ag-charts-color-picker__color-input"),u=n.querySelector(".ag-charts-color-picker__color-label");c.classList.toggle("ag-charts-color-picker__multi-color-button--hidden",!t.hasMultiColorOption);const g=(f=!0)=>{const S=ch.fromHSB(i,o,s,a).toHexString();if(n.style.setProperty("--h",`${i}`),n.style.setProperty("--s",`${o}`),n.style.setProperty("--v",`${s}`),n.style.setProperty("--a",`${a}`),n.style.setProperty("--color",S.slice(0,7)),n.style.setProperty("--color-a",S),l.value=`${i}`,h.value=`${a}`,h.classList.toggle("ag-charts-color-picker__alpha-input--opaque",a===1),c.classList.toggle("ag-charts-color-picker__multi-color-button--active",e),u.classList.toggle("ag-charts-color-picker__color-label--multi-color",e),document.activeElement!==p&&(p.value=e?"Multi Colour":S.toUpperCase()),f||t.color==null){const b=ch.fromHSB(i,o,s,1).toHexString();t.onChange?.(S,b,a,e)}f&&(this.hasChanged=!0)};g(!1);const y=f=>{f.preventDefault();const m=f.currentTarget;m.focus();const S=m.getBoundingClientRect(),b=({pageX:v,pageY:x})=>{e=!1,o=Math.min(Math.max((v-S.left)/S.width,0),1),s=1-Math.min(Math.max((x-S.top)/S.height,0),1),g()};b(f),window.addEventListener("mousemove",b),window.addEventListener("mouseup",()=>window.removeEventListener("mousemove",b),{once:!0})};return n.addEventListener("mousedown",f=>{f.stopPropagation()}),n.addEventListener("keydown",f=>{switch(f.stopPropagation(),f.key){case"Enter":case"Escape":this.hide();break;default:return}f.preventDefault()}),r.addEventListener("mousedown",y),r.addEventListener("keydown",f=>{if(f.key==="ArrowLeft")o=cr(0,o-.01,1);else if(f.key==="ArrowRight")o=cr(0,o+.01,1);else if(f.key==="ArrowUp")s=cr(0,s+.01,1);else if(f.key==="ArrowDown")s=cr(0,s-.01,1);else return;f.preventDefault(),g()}),c.addEventListener("click",()=>{e=!e,g()}),l.addEventListener("input",f=>{e=!1,i=f.currentTarget.valueAsNumber??0,g()}),h.addEventListener("input",f=>{e=!1,a=f.currentTarget.valueAsNumber??0,g()}),p.addEventListener("input",f=>{e=!1;const m=ny(f.currentTarget.value);m!=null&&([i,o,s,a]=m,g())}),p.addEventListener("blur",()=>g()),p.addEventListener("keydown",f=>{f.key==="Enter"&&(f.currentTarget.blur(),g())}),{element:n,initialFocus:r}}},mI=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel"},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel"}],xI=[{label:"toolbarAnnotationsFibonacciRetracement",icon:"fibonacci-retracement-drawing",value:"fibonacci-retracement"}],SI=[{label:"Fibonacci - Extended",value:10},{label:"Fibonacci - 6 Band",value:6},{label:"Fibonacci - 4 Band",value:4}],bI=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],vI=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],MI=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],ly=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],Ha=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],cy=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}],{ARRAY:kI,BOOLEAN:AI,NUMBER:DI,OBJECT:II,STRING:TI,UNION:OI,Color:hy,FloatingToolbar:LI,InteractionState:dy,Listeners:NI,Menu:hh,PropertiesArray:CI,ToolbarButtonProperties:py,ToolbarButtonWidget:RI,Validate:ts}=sy,Ks=class extends py{constructor(){super(...arguments),this.checkedOverrides=new py}};d([ts(OI(["line-stroke-width","line-style-type","line-color","fill-color","text-color","text-size","delete","settings","lock"]))],Ks.prototype,"value",2),d([ts(II,{optional:!0})],Ks.prototype,"checkedOverrides",2),d([ts(TI,{optional:!0})],Ks.prototype,"color",2),d([ts(DI,{optional:!0})],Ks.prototype,"strokeWidth",2),d([ts(Boolean,{optional:!0})],Ks.prototype,"isMultiColor",2);var EI=class extends RI{update(t){super.update(t),t.value==="line-stroke-width"&&this.updateLineStrokeWidth(t),(t.value==="fill-color"||t.value==="line-color"||t.value==="text-color")&&this.updateFillColor(t)}updateFillColor(t){const e=this.getElement();e.classList.add("ag-charts-annotations__color-picker-button"),e.classList.toggle("ag-charts-annotations__color-picker-button--multi-color",t.isMultiColor),e.style.setProperty("--color",t.color??null)}updateLineStrokeWidth(t){const e=this.getElement();e.classList.add("ag-charts-annotations__stroke-width-button"),e.style.setProperty("--stroke-width",`${t.strokeWidth}px`)}},wI=class extends LI{createButtonWidget(){return new EI(this.localeManager)}},dh=class extends sy.BaseProperties{constructor(t,e){super(),this.ctx=t,this.getActiveDatum=e,this.enabled=!0,this.buttons=new CI(Ks),this.destroyFns=[],this.events=new NI,this.visibleButtons=[],this.toolbar=new wI(this.ctx,"annotation-options"),this.colorPicker=new ry(this.ctx),this.textSizeMenu=new hh(this.ctx,"text-size"),this.lineStyleTypeMenu=new hh(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new hh(this.ctx,"annotations-line-stroke-width");const i=t.regionManager.getRegion("series");this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("toolbar-moved",this.onToolbarMoved.bind(this)),i.addListener("drag-start",this.onDragStart.bind(this),dy.All),i.addListener("drag-end",this.onDragEnd.bind(this),dy.All),()=>this.colorPicker.destroy())}onDragStart(){this.toolbar.ignorePointerEvents()}onDragEnd(){this.toolbar.capturePointerEvents()}destroy(){for(const t of this.destroyFns)t()}addListener(t,e){return this.events.addListener(t,e)}show(){this.toolbar.show({})}hide(){this.toolbar.hide()}updateButtons(t){const e={"line-style-type":fo(t),"line-stroke-width":fo(t),"line-color":cI(t),"text-color":pI(t),"fill-color":dI(t),"text-size":lh(t),settings:Hs(t),lock:!0,delete:!0};this.visibleButtons=this.buttons.filter(i=>e[i.value]),this.toolbar.clearButtons(),this.toolbar.updateButtons(this.visibleButtons),this.refreshButtons(t)}setAnchorScene(t){this.toolbar.hasBeenDragged()||this.toolbar.setAnchor(t.getAnchor())}hideOverlays(){this.toolbar.clearActiveButton(),this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.dispatch("hid-overlays")}clearActiveButton(){this.toolbar.clearActiveButton()}updateColors(t){this.updateColorPickerColor("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),"isMultiColor"in t&&t?.isMultiColor),this.updateColorPickerColor("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),"isMultiColor"in t&&t?.isMultiColor),this.updateColorPickerColor("text-color",t.getDefaultColor("text-color"),t.getDefaultOpacity("text-color"),"isMultiColor"in t&&t?.isMultiColor)}updateColorPickerColor(t,e,i,o){if(e!=null&&i!=null){const{r:s,g:a,b:n}=hy.fromString(e);e=hy.fromArray([s,a,n,i]).toHexString()}this.updateButtonByValue(t,{color:e,isMultiColor:o})}updateFontSize(t){this.updateButtonByValue("text-size",{label:t!=null?String(t):void 0})}updateLineStyleType(t){this.updateButtonByValue("line-style-type",{icon:t.icon})}updateStrokeWidth(t){this.updateButtonByValue("line-stroke-width",{label:t.label,strokeWidth:t.value})}dispatch(t,e){this.events.dispatch(t,e)}onButtonPress({event:t,button:e}){const i=this.getActiveDatum();if(i)switch(this.hideOverlays(),e.value){case"line-style-type":{const o=fo(i)?Ga(i.lineDash,i.lineStyle):void 0;this.lineStyleTypeMenu.show({items:Ha,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:o,sourceEvent:t.sourceEvent,onPress:s=>this.onLineStyleTypeMenuPress(s,i),class:"ag-charts-annotations__line-style-type-menu"});break}case"line-stroke-width":{const o=fo(i)?i.strokeWidth:void 0;this.lineStrokeWidthMenu.show({items:ly,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:o,sourceEvent:t.sourceEvent,onPress:s=>this.onLineStrokeWidthMenuPress(s,i),class:"ag-charts-annotations__line-stroke-width-menu"});break}case"line-color":case"fill-color":case"text-color":{this.toolbar.toggleActiveButtonByIndex(e.index),this.colorPicker.show({color:i?.getDefaultColor(e.value),opacity:i?.getDefaultOpacity(e.value),sourceEvent:t.sourceEvent,hasMultiColorOption:"isMultiColor"in i,isMultiColor:"isMultiColor"in i&&i?.isMultiColor,onChange:i!=null?this.onColorPickerChange.bind(this,e.value,i):void 0,onChangeHide:(o=>{this.dispatch("saved-color",{type:i.type,colorPickerType:e.value,color:i.getDefaultColor(o)})}).bind(this,e.value)});break}case"text-size":{const o=Si(i)?i.fontSize:void 0;this.textSizeMenu.show({items:cy,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:o,sourceEvent:t.sourceEvent,onPress:s=>this.onTextSizeMenuPress(s,i),class:"ag-charts-annotations__text-size-menu"});break}case"delete":{this.dispatch("pressed-delete");break}case"lock":{i.locked=!i.locked,this.refreshButtons(i),this.dispatch("pressed-lock");break}case"settings":{this.toolbar.toggleActiveButtonByIndex(e.index),this.dispatch("pressed-settings",t);break}}}onToolbarMoved(t){const{buttonBounds:e,popoverBounds:i}=t,o={x:i.x,y:i.y+i.height+4},s={y:i.y-4};this.colorPicker.setAnchor(o,s);for(const[a,n]of e.entries()){const r=this.visibleButtons.at(a);if(!r)continue;const l={x:n.x,y:n.y+n.height-1},c={y:n.y};switch(r.value){case"line-stroke-width":this.lineStrokeWidthMenu.setAnchor(l,c);break;case"line-style-type":this.lineStyleTypeMenu.setAnchor(l,c);break;case"text-size":this.textSizeMenu.setAnchor(l,c);break}}}onColorPickerChange(t,e,i,o,s,a){this.dispatch("updated-color",{type:e.type,colorPickerType:t,colorOpacity:i,color:o,opacity:s,isMultiColor:a}),this.updateColorPickerColor(t,i,s,a)}onTextSizeMenuPress(t,e){if(!lh(e))return;const i=t.value;this.dispatch("updated-font-size",{type:e.type,fontSize:i}),this.textSizeMenu.hide(),this.updateFontSize(i)}onLineStyleTypeMenuPress(t,e){if(!fo(e))return;const i=t.value;this.dispatch("updated-line-style",{type:e.type,lineStyleType:i}),this.lineStyleTypeMenu.hide(),this.updateLineStyleType(t)}onLineStrokeWidthMenuPress(t,e){if(!fo(e))return;const i=t.value;this.dispatch("updated-line-width",{type:e.type,strokeWidth:i}),this.lineStrokeWidthMenu.hide(),this.updateStrokeWidth(t)}refreshButtons(t){const e=t.locked??!1;for(const[i,o]of this.visibleButtons.entries())o&&(o.value==="lock"?(this.toolbar.toggleSwitchCheckedByIndex(i,e),this.updateButtonByIndex(i,e?o.checkedOverrides.toJson():o.toJson())):this.toolbar.toggleButtonEnabledByIndex(i,!e));lh(t)&&this.updateFontSize(t.fontSize),this.updateColors(t),this.updateLineStyles(t)}updateLineStyles(t){if(!fo(t))return;const e=t.strokeWidth??1,i=Ga(t.lineDash,t.lineStyle);this.updateStrokeWidth({strokeWidth:e,value:e,label:String(e)}),this.updateLineStyleType(Ha.find(o=>o.value===i)??Ha[0])}updateButtonByValue(t,e){const i=this.visibleButtons.findIndex(o=>o.value===t);i!==-1&&this.updateButtonByIndex(i,e)}updateButtonByIndex(t,e){const i=this.visibleButtons.at(t);i&&this.toolbar.updateButtonByIndex(t,{...i.toJson(),...e,value:e.value??i.value})}};d([ts(AI)],dh.prototype,"enabled",2),d([ts(kI)],dh.prototype,"buttons",2);import{_ModuleSupport as _I}from"ag-charts-community";var{StateMachine:uy,StateMachineProperty:ph,Vec2:gy,Debug:PI}=_I,Nt=class extends uy{constructor(t){const e=({context:i})=>{this.node?.drag(this.datum,this.offset,i,this.snapping),t.update()};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:i,context:o})=>{this.hasMoved=!1,this.dragStart=i,this.offset=i,this.node?.dragStart(this.datum,i,o)}}},dragging:{keyDown:e,keyUp:e,drag:({offset:i,context:o})=>{this.hasMoved=gy.lengthSquared(gy.sub(i,this.dragStart))>0,this.offset=i,this.node?.drag(this.datum,i,o,this.snapping),t.update()},dragEnd:{target:uy.parent,action:()=>{this.node?.stopDragging(),t.stopInteracting(),this.hasMoved&&t.recordAction("Move annotation"),t.update()}}}}),this.debug=PI.create(!0,"annotations"),this.hasMoved=!1,this.snapping=!1}};d([ph()],Nt.prototype,"snapping",2),d([ph()],Nt.prototype,"datum",2),d([ph()],Nt.prototype,"node",2);import{_ModuleSupport as BI}from"ag-charts-community";var{STRING:zI,Validate:FI,isObject:VI}=BI,mo=class extends oh{constructor(){super(...arguments),this.type="arrow-down"}static is(t){return VI(t)&&t.type==="arrow-down"}};d([FI(zI)],mo.prototype,"type",2);import{_ModuleSupport as GI}from"ag-charts-community";import{_ModuleSupport as hr}from"ag-charts-community";import{_ModuleSupport as es}from"ag-charts-community";var yy=class LM extends es.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(e){const{handle:i,locked:o}=this;return o?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:e,offset:{x:e.x-i.x,y:e.y-i.y}}}toggleActive(e){this.active=e,e||(this.handle.strokeWidth=LM.INACTIVE_STROKE_WIDTH)}toggleHovered(e){this.glow.visible=!this.locked&&e,this.glow.dirtyPath=!0}toggleDragging(e){this.locked||(this.handle.visible=!e,this.glow.visible=this.glow.visible&&!e,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(e){this.locked=e}getCursor(){}containsPoint(e,i){return this.handle.containsPoint(e,i)}};yy.INACTIVE_STROKE_WIDTH=2;var xo=yy,uh=class NM extends xo{constructor(){super(),this.handle=new es.Circle,this.glow=new es.Circle,this.append([this.handle]),this.handle.size=NM.HANDLE_SIZE,this.handle.strokeWidth=xo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(e){this.handle.setProperties({...e,strokeWidth:xo.INACTIVE_STROKE_WIDTH})}drag(e){return{point:e,offset:{x:0,y:0}}}};uh.HANDLE_SIZE=7,uh.GLOW_SIZE=9;var So=uh,dr=class Ie extends xo{constructor(){super(),this.handle=new es.Rect,this.glow=new es.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=Ie.CORNER_RADIUS,this.handle.width=Ie.HANDLE_SIZE,this.handle.height=Ie.HANDLE_SIZE,this.handle.strokeWidth=xo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=Ie.CORNER_RADIUS,this.glow.width=Ie.GLOW_SIZE,this.glow.height=Ie.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){if(super.toggleLocked(e),e){const i=(Ie.HANDLE_SIZE-So.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=So.HANDLE_SIZE,this.handle.height=So.HANDLE_SIZE,this.glow.width=So.GLOW_SIZE,this.glow.height=So.GLOW_SIZE}else this.handle.cornerRadius=Ie.CORNER_RADIUS,this.handle.width=Ie.HANDLE_SIZE,this.handle.height=Ie.HANDLE_SIZE,this.glow.width=Ie.GLOW_SIZE,this.glow.height=Ie.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(e){if(this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked){delete e.fill,delete e.strokeWidth;const i=(Ie.HANDLE_SIZE-So.HANDLE_SIZE)/2;e.x-=i,e.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(e),this.glow.setProperties({...e,x:(e.x??this.glow.x)-2,y:(e.y??this.glow.y)-2,strokeWidth:0,fill:e.stroke})}drag(e){return this.locked?{point:e,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:e.x,y:this.handle.y},offset:{x:e.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:e.y},offset:{x:0,y:e.y-this.handle.y}}}getCursor(){if(!this.locked)return this.gradient==="vertical"?"col-resize":"row-resize"}};dr.HANDLE_SIZE=12,dr.GLOW_SIZE=16,dr.CORNER_RADIUS=4;var Ys=dr,gh=class Gn extends xo{constructor(){super(),this.handle=new es.Circle,this.glow=new es.Circle,this.append([this.glow,this.handle]),this.handle.size=Gn.HANDLE_SIZE,this.handle.strokeWidth=xo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=Gn.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){super.toggleLocked(e),e?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=So.HANDLE_SIZE,this.glow.size=So.GLOW_SIZE):(this.handle.size=Gn.HANDLE_SIZE,this.glow.size=Gn.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(e){this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked&&(delete e.fill,delete e.strokeWidth),this.handle.setProperties(e),this.glow.setProperties({...e,strokeWidth:0,fill:e.stroke})}getCursor(){return"pointer"}};gh.HANDLE_SIZE=11,gh.GLOW_SIZE=17;var Ct=gh,{ZIndexMap:WI,isObject:UI}=hr,Xt=class extends hr.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=WI.CHART_ANNOTATION}static isCheck(t,e){return UI(t)&&Object.hasOwn(t,"type")&&t.type===e}toggleHovered(t){this.toggleHandles(t)}*nonHandleChildren(){for(const t of this.children())t instanceof xo||(yield t)}computeBBoxWithoutHandles(){return hr.Transformable.toCanvas(this,hr.Group.computeChildrenBBox(this.nonHandleChildren()))}updateNode(t,e,i){if(!i&&e){this.removeChild(e);return}return i&&e==null&&(e=new t,this.appendChild(e)),e}};import{_ModuleSupport as HI}from"ag-charts-community";import{_ModuleSupport as KI}from"ag-charts-community";var{Vec2:fy,toRadians:YI}=KI;function yh(t,e,i=!1,o,s=1){if(!i)return St(t,e);const a=o?Ft(o,e):fy.origin();return St(pr(t,a,s),e)}function pr({x:t,y:e},i,o,s=1){const{x:a,y:n}=i,r=Math.sqrt(Math.pow(t-a,2)+Math.pow(e-n,2)),l=Math.atan2(e-n,t-a),c=YI(o),h=Math.round(l/c)*c;return{x:a+r*Math.cos(h),y:n+r*Math.sin(h)*s}}function fh(t,e){const i={};return Object.entries(t).forEach(([o,s])=>{i[o]=Ft(s,e)}),i}function my(t,e,i){const o=[],s={};Object.entries(t).forEach(([h,p])=>{const u=fy.add(p,e);o.push(u);const g=St(u,i);s[h]=g});const{xAxis:a,yAxis:n}=i,r=(h,p,u)=>p>=h&&p<=u,l=o.every(h=>r(a.bounds.x,h.x,a.bounds.x+a.bounds.width)),c=o.every(h=>r(n.bounds.y,h.y,n.bounds.y+n.bounds.height));return{vectors:s,translateX:l,translateY:c}}var{Vec2:mh}=HI,xy=class extends Xt{constructor(){super(...arguments),this.handle=new Ct,this.anchor={x:0,y:0,position:"above"}}update(t,e){const i=Ft(t,e);this.updateHandle(t,i),this.anchor=this.updateAnchor(t,i,e)}dragStart(t,e,i){this.dragState={offset:e,...fh({handle:t},i)}}drag(t,e,i){const{dragState:o}=this;if(t.locked||!o)return;const s=mh.add(o.handle,mh.sub(e,o.offset)),a=St(s,i);Je(i,a)&&(t.x=a.x,t.y=a.y)}translate(t,e,i){const o=mh.add(Ft(t,i),e),s=St(o,i);Je(i,s)&&(t.x=s.x,t.y=s.y)}toggleHandles(t){this.handle.visible=!!t,this.handle.toggleHovered(this.activeHandle==="handle")}toggleActive(t){this.toggleHandles(t),this.handle.toggleActive(t)}stopDragging(){this.handle.toggleDragging(!1)}copy(t,e,i){const o=Ft(t,i),s=St({x:o.x-30,y:o.y-30},i);return e.x=s.x,e.y=s.y,e}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){const{handle:i}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="handle",!0):!1}getNodeAtCoords(t,e){if(this.handle.containsPoint(t,e))return"handle"}updateHandle(t,e,i){const{x:o,y:s}=this.getHandleCoords(t,e,i),a=this.getHandleStyles(t);this.handle.update({...a,x:o,y:s}),this.handle.toggleLocked(t.locked??!1)}updateAnchor(t,e,i){const o=this.getHandleCoords(t,e);return{x:o.x+i.seriesRect.x,y:o.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i){return{x:e.x,y:e.y}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},Sy=class extends xy{constructor(){super(),this.append([this.handle])}update(t,e){super.update(t,e);const i=Ft(t,e);this.updateShape(t,i)}updateShape(t,e){this.updateShapeStyles(t),this.updateShapePath(t,e)}updateShapeStyles(t){const{shape:e}=this;e.fill=t.fill,e.fillOpacity=t.fillOpacity??1}updateShapePath(t,e){const{shape:i}=this;i.x=e.x,i.y=e.y,i.size=t.size}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}getNodeAtCoords(t,e){return this.shape.containsPoint(t,e)?"shape":super.getNodeAtCoords(t,e)}},ur=class extends Sy{constructor(){super(),this.type="arrow-down",this.shape=new GI.ArrowDown,this.append([this.shape])}static is(t){return Xt.isCheck(t,"arrow-down")}updateAnchor(t,e,i){const o=super.updateAnchor(t,e,i);return o.y-=t.size,o}getHandleCoords(t,e){const i=Ct.HANDLE_SIZE/2,o=super.getHandleCoords(t,e);return o.y+=i,o}};import{_ModuleSupport as jI}from"ag-charts-community";var{StateMachine:gr,StateMachineProperty:XI,Debug:ZI}=jI,xh=class extends gr{constructor(t){const e=({point:o})=>{const s=this.createDatum();s.set({x:o.x,y:o.y}),t.create(s)},i=()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},cancel:gr.parent,reset:gr.parent},"waiting-first-render":{render:{target:gr.parent,action:i}}}),this.debug=ZI.create(!0,"annotations")}};d([XI()],xh.prototype,"node",2);var $I=class extends xh{createDatum(){return new mo}},by={type:"arrow-down",datum:mo,scene:ur,isDatum:mo.is,translate:(t,e,i,o)=>{mo.is(e)&&ur.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(mo.is(e)&&mo.is(i)&&ur.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{mo.is(e)&&ur.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new $I({...t,create:e("arrow-down")}),dragState:t=>new Nt(t)};import{_ModuleSupport as QI}from"ag-charts-community";var{STRING:qI,Validate:JI,isObject:tT}=QI,bo=class extends oh{constructor(){super(...arguments),this.type="arrow-up"}static is(t){return tT(t)&&t.type==="arrow-up"}};d([JI(qI)],bo.prototype,"type",2);import{_ModuleSupport as eT}from"ag-charts-community";var yr=class extends Sy{constructor(){super(),this.type="arrow-up",this.shape=new eT.ArrowUp,this.append([this.shape])}static is(t){return Xt.isCheck(t,"arrow-up")}getHandleCoords(t,e){const i=Ct.HANDLE_SIZE/2,o=super.getHandleCoords(t,e);return o.y-=i,o}},iT=class extends xh{createDatum(){return new bo}},vy={type:"arrow-up",datum:bo,scene:yr,isDatum:bo.is,translate:(t,e,i,o)=>{bo.is(e)&&yr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(bo.is(e)&&bo.is(i)&&yr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{bo.is(e)&&yr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new iT({...t,create:e("arrow-up")}),dragState:t=>new Nt(t)};import{_ModuleSupport as oT}from"ag-charts-community";import{_ModuleSupport as My}from"ag-charts-community";import{_ModuleSupport as sT}from"ag-charts-community";import{_ModuleSupport as aT}from"ag-charts-community";var{Vec2:nT,Vec4:ky}=aT,Ay=class extends Xt{extendLine({x1:t,y1:e,x2:i,y2:o},s,a){const n={x1:t,y1:e,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const[r,l]=lD(n,a.yAxis.bounds),c=n.x2<n.x1,h=n.y1>=n.y2,p=n.x2===n.x1;return s.extendEnd&&(p?n.y2=h?l.y:r.y:(n.x2=c?r.x:l.x,n.y2=c?r.y:l.y)),s.extendStart&&(p?n.y1=h?r.y:l.y:(n.x1=c?l.x:r.x,n.y1=c?l.y:r.y)),n}dragStart(t,e,i){this.dragState={offset:e,...fh({start:t.start,end:t.end},i)}}drag(t,e,i,o){t.locked||(this.activeHandle?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}dragAll(t,e,i){const{dragState:o}=this;o&&this.translatePoints(t,o.start,o.end,nT.sub(e,o.offset),i)}translatePoints(t,e,i,o,s){const{vectors:a,translateX:n,translateY:r}=my({start:e,end:i},o,s);n&&(t.start.x=a.start?.x,t.end.x=a.end?.x),(this.ignoreYBounds||r)&&(t.start.y=a.start?.y,t.end.y=a.end?.y)}translate(t,e,i){this.translatePoints(t,Ft(t.start,i),Ft(t.end,i),e,i)}copy(t,e,i){const o=zi(t,i);if(!o)return;const s=this.computeBBoxWithoutHandles(),a={x:-s.width/2,y:-s.height/2};return this.translatePoints(e,ky.start(o),ky.end(o),a,i),e}},{Vec4:Dy}=sT,Sh=class extends Ay{constructor(){super(...arguments),this.start=new Ct,this.end=new Ct,this.anchor={x:0,y:0,position:"above"}}update(t,e){const i=zi(t,e);i!=null&&(this.updateHandles(t,i),this.updateAnchor(t,i,e))}toggleHandles(t){if(typeof t=="boolean")this.start.visible=t,this.end.visible=t;else for(const[e,i]of Object.entries(t))this[e].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(t,e,i):St(this[s].drag(e).point,i);!n||!Je(i,n)||(t[s].x=n.x,t[s].y=n.y)}snapToAngle(t,e,i){const{activeHandle:o}=this,a=["start","end"].find(r=>r!==o);if(!o||!a)return;this[o].toggleDragging(!0);const n=Ft(t[a],i);return St(pr(e,n,t.snapToAngle),i)}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):!1}getNodeAtCoords(t,e){if(this.start.containsPoint(t,e)||this.end.containsPoint(t,e))return"handle"}updateHandles(t,e,i){this.start.update({...this.getHandleStyles(t,"start"),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t,"end"),...this.getHandleCoords(t,e,"end",i)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}updateAnchor(t,e,i,o){this.anchor={x:e.x1+i.seriesRect.x,y:e.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i,o){return i==="start"?Dy.start(e):Dy.end(e)}getHandleStyles(t,e){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},{Vec2:Iy,Vec4:Ty}=My,rT=class extends Sh{constructor(){super(...arguments),this.label=new My.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty()}update(t,e){const i=zi(t,e);if(i==null)return;const o=this.getTextBBox(t,i);this.updateLabel(t,o,i),this.updateHandles(t,i,o),this.updateShape(t,o,i),this.updateAnchor(t,i,e,o)}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=Iy.add(a.end,Iy.sub(e,a.offset)),r=o?this.snapToAngle(t,n,i):St(n,i);!r||!Je(i,r)||(t[s].x=r.x,t[s].y=r.y)}containsPoint(t,e){const{label:i}=this;return super.containsPoint(t,e)||i.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e){const{text:i}=t.getText();return ih(t,i,Ty.end(e),this.textInputBBox)}updateLabel(t,e,i){const{text:o,isPlaceholder:s}=t.getText();Wg(this.label,o,s,t,this.getLabelCoords(t,e,i))}updateShape(t,e,i){}getLabelCoords(t,e,i){return Ty.end(i)}getHandleStyles(t,e){return{...super.getHandleStyles(t,e),stroke:t.handle.stroke??t.color}}},{drawCorner:lT,Path:cT}=oT,fr=class extends rT{constructor(){super(),this.type="callout",this.shape=new cT,this.append([this.shape,this.label,this.start,this.end])}static is(t){return Xt.isCheck(t,"callout")}drag(t,e,i,o){t.locked||(this.activeHandle==="end"?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}getLabelCoords(t,e,i){const o=t.getPadding(),{bodyBounds:s={x:0,y:0,width:0,height:0}}=this.getDimensions(t,e,i)??{};return{x:s.x+o.left,y:s.y-o.bottom}}getHandleStyles(t,e){return e==="start"?{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(t,e,i,o){const{bodyBounds:s}=this.getDimensions(t,o,e)??{},a=s??o;this.anchor={x:a.x+i.seriesRect.x,y:a.y+i.seriesRect.y-a.height,position:this.anchor.position}}updateShape(t,e,i){const{shape:o}=this;o.fill=t.fill,o.fillOpacity=t.fillOpacity??1,o.stroke=t.stroke,o.strokeWidth=t.strokeWidth??1,o.strokeOpacity=t.strokeOpacity??1;const{tailPoint:s,bodyBounds:a}=this.getDimensions(t,e,i)??{};!s||!a||this.updatePath(s,a)}updatePath(t,e){const{x:i,y:o}=t,{x:s,y:a,width:n,height:r}=e,l=a-r,c=s+n,h=this.calculateCalloutPlacement({x:i,y:o},e),p=8,u=[{coordinates:{x0:s,x1:s+p,y0:l+p,y1:l,cx:h==="topLeft"?i:s+p,cy:h==="topLeft"?o:l+p},type:h==="topLeft"?"calloutCorner":"corner"},{coordinates:{x0:s+p,x1:c-p,y0:l,y1:l,cx:i,cy:o},type:h==="top"?"calloutSide":"side"},{coordinates:{x0:c-p,x1:c,y0:l,y1:l+p,cx:h==="topRight"?i:c-p,cy:h==="topRight"?o:l+p},type:h==="topRight"?"calloutCorner":"corner"},{coordinates:{x0:c,x1:c,y0:l+p,y1:a-p,cx:i,cy:o},type:h==="right"?"calloutSide":"side"},{coordinates:{x0:c,x1:c-p,y0:a-p,y1:a,cx:h==="bottomRight"?i:c-p,cy:h==="bottomRight"?o:a-p},type:h==="bottomRight"?"calloutCorner":"corner"},{coordinates:{x0:c-p,x1:s+p,y0:a,y1:a,cx:i,cy:o},type:h==="bottom"?"calloutSide":"side"},{coordinates:{x0:s+p,x1:s,y0:a,y1:a-p,cx:h==="bottomLeft"?i:s+p,cy:h==="bottomLeft"?o:a-p},type:h==="bottomLeft"?"calloutCorner":"corner"},{coordinates:{x0:s,x1:s,y0:a-p,y1:l+p,cx:i,cy:o},type:h==="left"?"calloutSide":"side"}],{path:g}=this.shape;g.clear(),g.moveTo(s,l+p),u.forEach(({coordinates:y,type:f})=>{this.drawPath(g,y,p,f)}),g.closePath()}drawPath(t,{x0:e,y0:i,x1:o,y1:s,cx:a,cy:n},r,l){switch(l){case"calloutCorner":{t.lineTo(a,n),t.lineTo(o,s);break}case"corner":{lT(t,{x0:e,x1:o,y0:i,y1:s,cx:a,cy:n},r,!1);break}case"calloutSide":{if(e!==o){const h=e>o?-1:1,p=Math.min(e,o)+Math.abs(o-e)/2;t.lineTo(p-6*h,i),t.lineTo(a,n),t.lineTo(p+6*h,i),t.lineTo(o,s)}else{const h=i>s?-1:1,p=Math.min(i,s)+Math.abs(i-s)/2;t.lineTo(e,p-6*h),t.lineTo(a,n),t.lineTo(e,p+6*h),t.lineTo(o,s)}break}case"side":default:{t.lineTo(o,s);break}}}calculateCalloutPlacement(t,e){const i=e.x+e.width,o=e.y-e.height;let s,a;return t.x>i?s="right":t.x<e.x&&(s="left"),t.y>e.y?a="bottom":t.y<o&&(a="top"),s&&a?`${a}${s[0].toUpperCase()}${s.substring(1)}`:a??s}getDimensions(t,e,i){const{fontSize:o}=t,s=t.getPadding(),a=s.left+s.right,n=s.top+s.bottom,r=e.width+a,l=Math.max(e.height+n,o+n);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:e.x,y:e.y,width:r,height:l}}}containsPoint(t,e){const{start:i,end:o,shape:s}=this;if(this.activeHandle=void 0,i.containsPoint(t,e))return this.activeHandle="start",!0;const a=o.containsPoint(t,e)||s.containsPoint(t,e);return a&&(this.activeHandle="end"),a}};import{_ModuleSupport as hT}from"ag-charts-community";function bh({key:t}){return t==="Escape"}function vh({key:t,shiftKey:e}){return!e&&t==="Enter"}var{StateMachine:ti,StateMachineProperty:Oy,Debug:dT}=hT,Mh=class extends ti{constructor(t){const e=({point:u})=>{const g=this.createDatum();g.set({start:u,end:u,visible:!0}),t.create(g)},i=()=>{const{node:u}=this;u?.toggleActive(!0),u?.toggleHandles({start:!0})},o=()=>{t.showTextInput(),this.datum&&(this.datum.visible=!1)},s=()=>{t.hideTextInput(),this.datum&&(this.datum.visible=!0),t.deselect()},a=u=>{this.node?.setTextInputBBox(u),t.update()},n=({point:u})=>{const{datum:g,node:y}=this;g?.set({end:u}),y?.toggleActive(!0),y?.toggleHandles({end:!1}),t.update()},r=()=>{t.showAnnotationOptions(),this.node?.toggleHandles({end:!0})},l=({colorPickerType:u,colorOpacity:g,color:y,opacity:f,isMultiColor:m})=>{const{datum:S}=this;S&&(u==="text-color"&&t.updateTextInputColor(y),lr(S,u,g,y,f,m),t.update())},c=u=>{const{datum:g,node:y}=this;!g||!y||!Si(g)||(g.fontSize=u,t.updateTextInputFontSize(u),t.update())},h=()=>{t.delete()},p=({textInputValue:u,bbox:g})=>{const{datum:y}=this;if(g!=null&&u!=null&&u.length>0){if(!Si(y))return;const f=ir(y,u,g.width);y?.set({text:f}),t.update(),t.recordAction(`Create ${y?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:ti.parent,reset:ti.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:n,drag:n,click:{target:"edit",action:r},dragEnd:{target:"edit",action:r},reset:{target:ti.parent,action:h},cancel:{target:ti.parent,action:h}},edit:{onEnter:o,updateTextInputBBox:a,color:l,fontSize:c,textInput:[{guard:bh,target:ti.parent,action:h},{guard:vh,target:ti.parent,action:p}],click:{target:ti.parent,action:p},dragStart:{target:ti.parent,action:p},resize:{target:ti.parent,action:p},onExit:s,cancel:{target:ti.parent,action:h}}}),this.debug=dT.create(!0,"annotations")}};d([Oy()],Mh.prototype,"datum",2),d([Oy()],Mh.prototype,"node",2);var pT=class extends Mh{createDatum(){return new qe}},Ly={type:"callout",datum:qe,scene:fr,isDatum:qe.is,translate:(t,e,i,o)=>{if(qe.is(e)&&fr.is(t))return t.translate(e,i,o)},copy:(t,e,i,o)=>{if(qe.is(e)&&qe.is(i)&&fr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{qe.is(e)&&fr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new pT({...t,create:e("callout")}),dragState:t=>new Nt(t)};import{_ModuleSupport as Ny}from"ag-charts-community";import{_ModuleSupport as uT}from"ag-charts-community";var kh=class extends xy{constructor(){super(...arguments),this.label=new uT.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty()}update(t,e){const i=Ft(t,e),o=this.getTextBBox(t,i,e);this.updateLabel(t,o),this.updateHandle(t,i,o),this.updateShape(t,o),this.anchor=this.updateAnchor(t,o,e)}copy(t,e,i){const o=Ft(t,i),s=this.getTextBBox(t,o,i),a=t.getPadding(),n=a.left+a.right,r=a.top+a.bottom,l=(s.width+n)/2,c=s.height+r,h=St({x:o.x-l,y:o.y-c},i);return e.x=h.x,e.y=h.y,e}containsPoint(t,e){const{label:i}=this;return super.containsPoint(t,e)||i.visible&&i.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.visible&&this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e,i){const{text:o}=t.getText();return ih(t,o,{x:e.x,y:e.y},this.textInputBBox)}updateLabel(t,e){const{text:i,isPlaceholder:o}=t.getText();Wg(this.label,i,o,t,this.getLabelCoords(t,e))}updateShape(t,e){}updateAnchor(t,e,i){return{x:e.x+i.seriesRect.x,y:e.y+i.seriesRect.y-e.height,position:this.anchor.position}}getLabelCoords(t,e){return e}getHandleCoords(t,e,i){return i}getHandleStyles(t){const e=super.getHandleStyles(t);return e.stroke=t.handle.stroke??t.color,e}},{drawCorner:Ah}=Ny,mr=class extends kh{constructor(){super(),this.type="comment",this.shape=new Ny.Path,this.append([this.shape,this.label,this.handle])}static is(t){return Xt.isCheck(t,"comment")}updateShape(t,e){const{shape:i}=this;i.fill=t.fill,i.fillOpacity=t.fillOpacity??1,i.stroke=t.stroke??"transparent",i.strokeWidth=t.strokeWidth??1,i.strokeOpacity=t.strokeOpacity??1,this.updatePath(t,e)}getLabelCoords(t,e){const i=t.getPadding();return{x:e.x+i.left,y:e.y-i.bottom}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}updateAnchor(t,e,i){const o=super.updateAnchor(t,e,i),s=t.getPadding();return o.y-=s.bottom+s.top,o}updatePath(t,e){const i=t.getPadding(),{x:o,y:s}=e;let{width:a,height:n}=e;const{fontSize:r}=t,l=i.left+i.right,c=i.top+i.bottom;a=a+l,n=Math.max(n+c,r+c);const h=s-n,p=o+a,u=(r*er+c)/2,{path:g}=this.shape;g.clear(),g.moveTo(o,s),g.lineTo(o,h+u),Ah(g,{x0:o,x1:o+u,y0:h+u,y1:h,cx:o+u,cy:h+u},u,!1),g.lineTo(p-u,h),Ah(g,{x0:p-u,x1:p,y0:h,y1:h+u,cx:p-u,cy:h+u},u,!1),g.lineTo(p,s-u),Ah(g,{x0:p,x1:p-u,y0:s-u,y1:s,cx:p-u,cy:s-u},u,!1),g.closePath()}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}};import{_ModuleSupport as gT}from"ag-charts-community";var{StateMachine:Ki,StateMachineProperty:Cy,Debug:yT}=gT,Ka=class extends Ki{constructor(t){const e=({point:h})=>{const p=this.createDatum();p.set({x:h.x,y:h.y}),t.create(p)},i=()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()},o=()=>{t.showTextInput(),this.datum&&(this.datum.visible=!1)},s=()=>{t.hideTextInput(),this.datum&&(this.datum.visible=!0),t.deselect()},a=h=>{this.node?.setTextInputBBox(h),t.update()},n=({colorPickerType:h,colorOpacity:p,color:u,opacity:g,isMultiColor:y})=>{this.datum&&(h==="text-color"&&t.updateTextInputColor(u),lr(this.datum,h,p,u,g,y),t.update())},r=h=>{const{datum:p,node:u}=this;!p||!u||!Si(p)||(p.fontSize=h,t.updateTextInputFontSize(h),t.update())},l=()=>{t.delete()},c=({textInputValue:h,bbox:p})=>{if(p!=null&&h!=null&&h.length>0){const{datum:u}=this;if(!Si(u))return;const g=ir(u,h,p.width);u?.set({text:g}),t.update(),t.recordAction(`Create ${u?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:Ki.parent,reset:Ki.parent},"waiting-first-render":{render:{target:"edit",action:i}},edit:{onEnter:o,updateTextInputBBox:a,color:n,fontSize:r,textInput:[{guard:bh,target:Ki.parent,action:l},{guard:vh,target:Ki.parent,action:c}],click:{target:Ki.parent,action:c},dragStart:{target:Ki.parent,action:c},resize:{target:Ki.parent,action:c},onExit:s,cancel:{target:Ki.parent,action:l}}}),this.debug=yT.create(!0,"annotations")}};d([Cy()],Ka.prototype,"datum",2),d([Cy()],Ka.prototype,"node",2);var fT=class extends Ka{createDatum(){return new mi}},Ry={type:"comment",datum:mi,scene:mr,isDatum:mi.is,translate:(t,e,i,o)=>{mi.is(e)&&mr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(mi.is(e)&&mi.is(i)&&mr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{mi.is(e)&&mr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new fT({...t,create:e("comment")}),dragState:t=>new Nt(t)};import{_ModuleSupport as mT}from"ag-charts-community";import{_ModuleSupport as xr}from"ag-charts-community";var{calculateLabelTranslation:xT,ChartAxisDirection:ST}=xr,Ey=class extends xr.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new xr.Text({zIndex:1}),this.rect=new xr.Rect;const{label:t}=this;t.fontSize=12,t.fontFamily="Verdana, sans-serif",t.fill="black",t.textBaseline="middle",t.textAlign="center",this.append([this.rect,this.label])}update(t){this.updateLabel(t),this.updateRect(t),this.updatePosition(t)}updateLabel({value:t,styles:e,context:i}){const{fontWeight:o,fontSize:s,fontStyle:a,fontFamily:n,textAlign:r,color:l="white",formatter:c=i.scaleValueFormatter()}=e;this.label.setProperties({fontWeight:o,fontSize:s,fontStyle:a,fontFamily:n,textAlign:r,fill:l,text:c(t)})}updateRect({styles:t}){const{rect:e}=this,{cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n}=t;e.setProperties({cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n})}updatePosition({x:t,y:e,context:i,styles:{padding:o}}){const{label:s,rect:a}=this,n=s.getBBox()?.clone(),r=o??8,l=o??5;n.grow(r,"horizontal"),n.grow(l,"vertical");const c=i.direction===ST.X?l/2:r,{xTranslation:h,yTranslation:p}=xT({yDirection:!0,padding:i.labelPadding-c,position:i.position??"left",bbox:n}),u=t+h,g=e+p;s.x=u,s.y=g,a.x=u-n.width/2,a.y=g-n.height/2,a.height=n.height,a.width=n.width}};Ey.className="AxisLabel";import{_ModuleSupport as Sr}from"ag-charts-community";var{Vec2:bi}=Sr,Le=class extends Sr.Line{constructor(){super(...arguments),this.growCollisionBox=9,this.clipMask=new Map}setProperties(t,e){return super.setProperties(t,e),this.updateCollisionBBox(),this}updateCollisionBBox(){const{growCollisionBox:t,strokeWidth:e,x1:i,y1:o,x2:s,y2:a}=this;let n=e+t;n%2===0&&(n+=1);const r=bi.from(i,o-Math.floor(n/2)),l=bi.from(s,a),c=bi.distance(r,l);this.collisionBBox=new Sr.BBox(r.x,r.y,c,n)}isPointInPath(t,e){const{collisionBBox:i,x1:o,y1:s,x2:a,y2:n}=this;if(!i)return!1;const r=bi.from(o,s),l=bi.from(a,n),c=bi.sub(bi.from(t,e),r),h=bi.sub(l,r),p=bi.rotate(c,bi.angle(c,h),r);return i.containsPoint(p.x,p.y)??!1}render(t){this.applyClipMask(t.ctx),super.render(t),this.closeClipMask(t.ctx)}setClipMask(t,e){const i=this.clipMask.get(t);Sr.jsonDiff(i,e)!=null&&this.markDirty(),e?this.clipMask.set(t,e):this.clipMask.delete(t)}applyClipMask(t){const{clipMask:e}=this;e.size!==0&&this.clipMask.forEach(i=>{const{x:o,y:s,radius:a}=i;t.save(),t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.ellipse(o,s,a,a,0,Math.PI*2,0,!0),t.clip()})}closeClipMask(t){this.clipMask.size!==0&&t.restore()}};import{_ModuleSupport as bT}from"ag-charts-community";var is=class extends bT.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(t,e){const i=this.fromParentPoint(t,e),o=this.computeBBoxWithoutTransforms();return o?o.grow(this.growCollisionBox).containsPoint(i.x,i.y):!1}};import{_ModuleSupport as vT}from"ag-charts-community";var{Vec2:se}=vT;function js(t,e,i,o,s,a,n){const{alignment:r,position:l}=i;if(!a||!s){e.setClipMask(t);return}const c=_y(o,i.fontSize,n),{point:h,textBaseline:p}=Py(c,l,r);By(s,a,i,h,c.angle,p);const{x:u,y:g,width:y,height:f}=s.getBBox(),m=se.length(se.from(y,f)),S={x:u+y/2,y:g+f/2,radius:m/2+se.length(c.offset)};return l==="center"?e.setClipMask(t,S):e.setClipMask(t),{clipMask:S,numbers:c}}function wy(t,e,i,o,s,a,n){if(!n||!a)return;const{alignment:r,position:l}=o,[c,h]=e.y1<=i.y1?[e,i]:[i,e];let p=c;l==="bottom"?p=h:l==="inside"&&(p={x1:(c.x1+h.x1)/2,y1:(c.y1+h.y1)/2,x2:(c.x2+h.x2)/2,y2:(c.y2+h.y2)/2});const u=_y(p,o.fontSize,s),{point:g,textBaseline:y}=Py(u,l==="inside"?"center":l,r,t);By(a,n,o,g,u.angle,y)}function _y(t,e,i){let[o,s]=se.from(t);o.x>s.x&&([o,s]=[s,o]);const a=se.normalized(se.sub(s,o)),n=se.angle(a),r=se.multiply(a,Ct.HANDLE_SIZE/2+(e??14)/2),l=se.multiply(a,(i??2)/2+(e??14)/3);return{left:o,right:s,normal:a,angle:n,inset:r,offset:l}}function Py({left:t,right:e,normal:i,angle:o,inset:s,offset:a},n,r,l){let c;r==="right"?c=se.sub(e,s):r==="center"?c=se.add(t,se.multiply(i,se.distance(t,e)/2)):c=se.add(t,s);let h="bottom";return n==="bottom"?(c=se.rotate(a,o+Math.PI/2,c),h="top"):n==="center"&&!l?h="middle":c=se.rotate(a,o-Math.PI/2,c),{point:c,textBaseline:h}}function By(t,e,i,o,s,a){t.setProperties({text:e,x:o.x,y:o.y,rotation:s,rotationCenterX:o.x,rotationCenterY:o.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:a})}var{ChartAxisDirection:MT,Vec2:Xs,Vec4:Dh}=mT,vo=class extends Xt{constructor(){super(),this.type="cross-line",this.line=new Le,this.middle=new Ys,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(t){return Xt.isCheck(t,"cross-line")}update(t,e){const{seriesRect:i}=e;this.seriesRect=i,this.isHorizontal=oe.is(t);const o=this.isHorizontal?e.yAxis:e.xAxis,s=this.convertCrossLine(t,o);if(s==null){this.visible=!1;return}this.visible=t.visible??!0,this.visible&&(this.updateLine(t,s),this.updateHandle(t,s),this.updateText(t,s),this.updateAxisLabel(t,o,s))}updateLine(t,e){const{line:i}=this,{lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n}=t,{x1:r,y1:l,x2:c,y2:h}=e;i.setProperties({x1:r,y1:l,x2:c,y2:h,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n,fillOpacity:0})}updateHandle(t,e){const{middle:i}=this,{locked:o,stroke:s,strokeWidth:a,strokeOpacity:n}=t,r={fill:t.handle.fill,stroke:t.handle.stroke??s,strokeOpacity:t.handle.strokeOpacity??n,strokeWidth:t.handle.strokeWidth??a},l=Xs.sub(Dh.center(e),Xs.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update({...r,...l}),i.toggleLocked(o??!1)}updateText(t,e){this.text=this.updateNode(is,this.text,!!t.text.label),js(this.line.id,this.line,t.text,e,this.text,t.text.label,t.strokeWidth)}createAxisLabel(t){const e=new Ey;return t.attachLabel(e),e}updateAxisLabel(t,e,i){this.axisLabel||(this.axisLabel=this.createAxisLabel(e));const{axisLabel:o,seriesRect:s}=this,{direction:a,position:n}=e;if(t.axisLabel.enabled){o.visible=this.visible;const r=n==="left"||n==="top"?Dh.start(i):Dh.end(i),l=a===MT.X?r.x:r.y;if(!e.inRange(l)){o.visible=!1;return}o.update({...Xs.add(r,Xs.required(s)),value:t.value,styles:t.axisLabel,context:e})}else o.visible=!1}toggleHandles(t){this.middle.visible=t,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(t){this.toggleHandles(t),this.middle.toggleActive(t)}dragStart(t,e,i){const o=oe.is(t)?{x:e.x,y:Qo(t.value,i.yAxis)}:{x:Qo(t.value,i.xAxis),y:e.y};this.dragState={offset:e,middle:o}}drag(t,e,i){const{activeHandle:o,dragState:s}=this;if(t.locked)return;let a;if(o)this[o].toggleDragging(!0),a=this[o].drag(e).point;else if(s)a=Xs.add(s.middle,Xs.sub(e,s.offset));else return;const n=St(a,i),r=oe.is(t);t.set({value:r?n.y:n.x})}translate(t,{x:e,y:i},o){if(t.locked)return;const{axisContext:s,translation:a}=oe.is(t)?{axisContext:o.yAxis,translation:i}:{axisContext:o.xAxis,translation:e},n=Qo(t.value,s)+a,r=Va(n,s);isNaN(r)||t.set({value:r})}stopDragging(){this.middle.toggleDragging(!1)}copy(t,e,i){const o=oe.is(t),s=this.isHorizontal?i.yAxis:i.xAxis,a=this.convertCrossLine(t,s);if(!a)return;const n=o?-30:0,r=o?0:-30,l=St({x:a.x1+r,y:a.y1+n},i);return e.set({value:o?l.y:l.x}),e}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(t,e){const{middle:i,line:o,text:s}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="middle",!0):o.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.line.isPointInPath(t,e))return"line";if(this.middle.containsPoint(t,e))return"handle"}getAnchor(){const t=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:t.x+t.width/2,y:t.y}:{x:t.x+t.width,y:t.y+t.height/2,position:"right"}}convertCrossLine(t,e){if(t.value==null)return;let i=0,o=0,s=0,a=0;const{bounds:n,scale:r}=e,l=(r.bandwidth??0)/2,c=r.convert(t.value)+l;return oe.is(t)?(o=n.width,s=c,a=c):(i=c,o=c,a=n.height),{x1:i,y1:s,x2:o,y2:a}}};import{_ModuleSupport as kT}from"ag-charts-community";var{StateMachine:br,StateMachineProperty:AT,Debug:DT}=kT,Ih=class extends br{constructor(t,e){const i=({point:s})=>{const a=t==="horizontal",n=a?new oe:new xi;n.set({value:a?s.y:s.x}),e.create(n),e.recordAction(`Create ${a?"horizontal-line":"vertical-line"} annotation`)},o=()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:br.parent,cancel:br.parent},"waiting-first-render":{render:{target:br.parent,action:o}}}),this.debug=DT.create(!0,"annotations")}};d([AT()],Ih.prototype,"node",2);var zy={type:"horizontal-line",datum:oe,scene:vo,isDatum:oe.is,translate:(t,e,i,o)=>{oe.is(e)&&vo.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(oe.is(e)&&oe.is(i)&&vo.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{oe.is(e)&&vo.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new Ih("horizontal",{...t,create:e("horizontal-line")}),dragState:t=>new Nt(t)},Fy={type:"vertical-line",datum:xi,scene:vo,isDatum:xi.is,translate:(t,e,i,o)=>{xi.is(e)&&vo.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(xi.is(e)&&xi.is(i)&&vo.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{xi.is(e)&&vo.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new Ih("vertical",{...t,create:e("vertical-line")}),dragState:t=>new Nt(t)};import{_ModuleSupport as IT}from"ag-charts-community";import{_ModuleSupport as Vy}from"ag-charts-community";import{_ModuleSupport as TT}from"ag-charts-community";var{Vec4:OT}=TT,Gy=class{static updateBackground(t,e,i,o){const{background:s}=this,{seriesRect:a}=o;s.path.clear(!0);const n=OT.from(0,0,a.width,a.height),r=this.getBackgroundPoints(t,e,i,n);for(let c=0;c<r.length;c++){const h=r[c];c===0?s.path.moveTo(h.x,h.y):s.path.lineTo(h.x,h.y)}s.path.closePath(),s.checkPathDirty();const l=this.getBackgroundStyles?.(t)??t.background;s.setProperties({fill:l.fill,fillOpacity:l.fillOpacity})}},Wy=class extends Ay{constructor(){super(...arguments),this.handles={},this.topLine=new Le,this.bottomLine=new Le,this.background=new Vy.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=Gy.updateBackground.bind(this)}update(t,e){const{locked:i,visible:o}=t,s=zi(t,e),a=zi(t.bottom,e);if(s==null||a==null){this.visible=!1;return}else this.visible=o??!0;const n=this.extendLine(s,t,e),r=this.extendLine(a,t,e);this.updateLines(t,n,r,e,s,a),this.updateHandles(t,s,a),this.updateText(t,s,a),this.updateBackground(t,n,r,e),this.updateAnchor(s,a);for(const l of Object.values(this.handles))l.toggleLocked(i??!1)}snapToAngle(t,e,i,o,s,a){const{handles:n}=this,r=n[o].handle,l=n[i].drag(t).point;return St(pr(l,r,s,a),e)}toggleHandles(t){const{handles:e}=this;if(typeof t=="boolean"){for(const[i,o]of Object.entries(e))o.visible=t,o.toggleHovered(this.activeHandle===i);return}for(const[i,o]of Object.entries(t)){const s=e[i];s.visible=o??!0,s.toggleHovered(this.activeHandle===i)}}toggleActive(t){this.toggleHandles(t);for(const e of Object.values(this.handles))e.toggleActive(t)}stopDragging(){const{activeHandle:t,handles:e}=this;t!=null&&e[t].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(t,e){const{handles:i,topLine:o,bottomLine:s,text:a}=this;this.activeHandle=void 0;for(const[n,r]of Object.entries(i))if(r.containsPoint(t,e))return this.activeHandle=n,!0;return o.containsPoint(t,e)||s.containsPoint(t,e)||!!a?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.topLine.containsPoint(t,e)||this.bottomLine.containsPoint(t,e))return"line";for(const[i,o]of Object.entries(this.handles))if(o.containsPoint(t,e))return"handle"}updateAnchor(t,e){const{x:i,y:o}=Vy.Transformable.toCanvasPoint(this.topLine,(t.x1+t.x2)/2,Math.min(t.y1,t.y2,e.y1,e.y2));this.anchor.x=i,this.anchor.y=o}},{Vec2:Mo,Vec4:vr}=IT,Mr=class extends Wy{constructor(){super(),this.type="disjoint-channel",this.ignoreYBounds=!0,this.handles={topLeft:new Ct,topRight:new Ct,bottomLeft:new Ct,bottomRight:new Ys},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return Xt.isCheck(t,"disjoint-channel")}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0);const r=h=>St(h,i),l=t.toJson(),c=t.snapToAngle;switch(s){case"topLeft":case"bottomLeft":{const h=s==="topLeft"?1:-1,p=o?this.snapToAngle(e,i,"topLeft","topRight",c,h):r({x:a.topLeft.handle.x+n.x,y:a.topLeft.handle.y+n.y*h}),u=o?this.snapToAngle(e,i,"bottomLeft","bottomRight",c,-h):r({x:a.bottomLeft.handle.x+n.x,y:a.bottomLeft.handle.y+n.y*-h});if(p?.y==null||u?.y==null||t.start.y==null)return;const g=t.startHeight+(p.y-t.start.y)*2;t.start.x=p.x,t.start.y=p.y,t.startHeight=g;break}case"topRight":{const h=o?this.snapToAngle(e,i,"topRight","topLeft",c):r({x:a.topRight.handle.x+n.x,y:a.topRight.handle.y+n.y});if(h?.y==null||t.end.y==null)return;const p=t.endHeight+(h.y-t.end.y)*2;t.end.x=h.x,t.end.y=h.y,t.endHeight=p;break}case"bottomRight":{const h=r({x:a.bottomLeft.handle.x+n.x,y:a.bottomLeft.handle.y+n.y}),p=r({x:a.bottomRight.handle.x+n.x,y:a.bottomRight.handle.y+n.y});if(!h||!p||t.start.y==null||t.end.y==null)return;const u=t.end.y-p.y,g=t.startHeight-(t.endHeight-u);t.startHeight=g,t.endHeight=u}}t.isValidWithContext(i)||t.set(l)}updateLines(t,e,i){const{topLine:o,bottomLine:s}=this,{lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l}=t,c={lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l};o.setProperties({...e,...c}),s.setProperties({...i,...c})}updateHandles(t,e,i){const{handles:{topLeft:o,topRight:s,bottomLeft:a,bottomRight:n}}=this,r={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...r,...vr.start(e)}),s.update({...r,...vr.end(e)}),a.update({...r,...vr.start(i)}),n.update({...r,...Mo.sub(vr.end(i),Mo.from(n.handle.width/2,n.handle.height/2))})}updateText(t,e,i){this.text=this.updateNode(is,this.text,!!t.text.label),wy(!1,e,i,t.text,t.strokeWidth,this.text,t.text.label)}getBackgroundPoints(t,e,i,o){const s=e.x1>e.x2,a=e.y1>e.y2,n=a?o.y2:o.y1,r=a?o.y1:o.y2,l=Mo.from(e);return t.extendEnd&&e.y2===r&&l.push(Mo.from(s?o.x1:o.x2,a?o.y1:o.y2)),t.extendEnd&&i.y2===n&&l.push(Mo.from(s?o.x1:o.x2,a?o.y2:o.y1)),l.push(...Mo.from(i).reverse()),t.extendStart&&i.y1===r&&l.push(Mo.from(s?o.x2:o.x1,a?o.y1:o.y2)),t.extendStart&&e.y1===n&&l.push(Mo.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{_ModuleSupport as LT}from"ag-charts-community";var{StateMachine:ko,StateMachineProperty:Th,Debug:NT}=LT,kr=class extends ko{constructor(t){const e=({point:l})=>{const c=new Ge;c.set({start:l,end:l,startHeight:0,endHeight:0}),t.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1})},o=({offset:l,context:c})=>{const{datum:h,snapping:p}=this;h&&(h.set({end:yh(l,c,p,h.start,h.snapToAngle)}),t.update())},s=()=>{this.node?.toggleHandles({topRight:!0}),t.update()},a=({point:l})=>{const{datum:c,node:h}=this;if(c?.start.y==null||c?.end.y==null)return;const p=c.end.y-(l.y??0),u=(c.start.y-c.end.y)*2+p,g={x:c.start.x,y:c.start.y-u},y={x:c.end.x,y:l.y};h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!t.validatePoint(g)||!t.validatePoint(y))&&(c.set({startHeight:u,endHeight:p}),t.update())},n=({point:l})=>{const{datum:c,node:h}=this;if(c?.start.y==null||c?.end.y==null)return;const p=c.end.y-(l.y??0),u=(c.start.y-c.end.y)*2+p,g={x:c.start.x,y:c.start.y-p},y={x:c.end.x,y:l.y};h?.toggleHandles(!0),!(!t.validatePoint(g)||!t.validatePoint(y))&&(c.set({startHeight:u,endHeight:p}),t.recordAction("Create disjoint-channel annotation"),t.showAnnotationOptions(),t.update())},r=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:ko.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,drag:o,click:{target:"height",action:s},dragEnd:{target:"height",action:s},reset:{target:ko.parent,action:r},cancel:{target:ko.parent,action:r}},height:{hover:a,click:{target:ko.parent,action:n},drag:{target:ko.parent,action:n},reset:{target:ko.parent,action:r},cancel:{target:ko.parent,action:r}}}),this.debug=NT.create(!0,"annotations"),this.snapping=!1}};d([Th()],kr.prototype,"datum",2),d([Th()],kr.prototype,"node",2),d([Th()],kr.prototype,"snapping",2);var Uy={type:"disjoint-channel",datum:Ge,scene:Mr,isDatum:Ge.is,translate:(t,e,i,o)=>{Ge.is(e)&&Mr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ge.is(e)&&Ge.is(i)&&Mr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ge.is(e)&&Mr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new kr({...t,create:e("disjoint-channel")}),dragState:t=>new Nt(t)};import{_ModuleSupport as CT}from"ag-charts-community";import{_ModuleSupport as Yi}from"ag-charts-community";var Oh=[0,23.6,38.2,50,61.8,78.6,100],RT=[161.8,261.8,361.8,423.6],ET=[...Oh,...RT],wT={10:ET,6:Oh,4:Oh.filter(t=>t!==78.6&&t!==23.6)},_T=10;function PT({x1:t,y1:e,x2:i,y2:o},s,a,n=10){const r=o-e,l=a?1:-1,c=a?e:o;let h=c;const p=[];return wT[n].forEach((u,g)=>{const y=c+r*(u/100)*l,f=s.yAxis.scaleInvert(y);p.push({id:g,x1:t,x2:i,y1:h,y2:y,tag:u==100?0:1,label:{x1:Math.min(t,i)-_T,x2:i,y1:y,y2:y,text:`${(u/100).toFixed(3)} (${f.toFixed(2)})`}}),h=y}),p}var{Vec2:BT,Vec4:Hy}=Yi,zT=class extends Xt{constructor(){super(),this.trendLine=new Le,this.rangeFillsGroup=new Yi.Group({name:`${this.id}-range-fills`}),this.rangeFillsGroupSelection=Yi.Selection.select(this.rangeFillsGroup,Yi.Range),this.rangeStrokesGroup=new Yi.Group({name:`${this.id}-range-strokes`}),this.rangeStrokesGroupSelection=Yi.Selection.select(this.rangeStrokesGroup,Le),this.labelsGroup=new Yi.Group({name:`${this.id}-ranges-labels`}),this.labelsGroupSelection=Yi.Selection.select(this.labelsGroup,is),this.anchor={x:0,y:0,position:"above"},this.append([this.trendLine,this.rangeFillsGroup,this.rangeStrokesGroup,this.labelsGroup])}update(t,e){let i=zi(t,e);if(i==null){this.visible=!1;return}if(i=Hy.round(i),this.visible=t.visible??!0,!this.visible)return;this.updateTrendLine(t,i),this.updateHandles(t,i),this.updateAnchor(t,i,e);const{reverse:o}=t,s=this.extendLine(i,t,e);this.updateRanges(t,s,e);const a=o?i.y2:i.y1,n={...s,y1:a,y2:a};this.updateText(t,n)}extendLine({x1:t,y1:e,x2:i,y2:o},s,a){const n={x1:t,y1:e,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const{x:r,width:l}=a.xAxis.bounds;return s.extendEnd&&(n[t>i?"x1":"x2"]=r+l),s.extendStart&&(n[t>i?"x2":"x1"]=r),n}updateTrendLine(t,e){const{trendLine:i}=this,{lineDashOffset:o,strokeWidth:s,strokeOpacity:a,stroke:n}=t;i.setProperties({...e,lineCap:t.getLineCap(),lineDash:[3,4],lineDashOffset:o,strokeWidth:s,strokeOpacity:a,fillOpacity:0,stroke:n})}updateRangeStrokes(t){const{lineDashOffset:e,strokeWidth:i,strokeOpacity:o,strokes:s,rangeStroke:a,isMultiColor:n}=t;this.rangeStrokesGroupSelection.each((r,{x1:l,x2:c,y2:h,tag:p},u)=>{const g=h,y=n?s[u%s.length]:a;r.setProperties({x1:l,x2:c,y1:g,y2:g,stroke:y,strokeOpacity:o,strokeWidth:i,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,tag:p})})}updateRanges(t,e,i){const o=PT(e,i,t.reverse,t.bands),s=a=>a.id;this.rangeFillsGroupSelection.update(o,void 0,s),this.rangeStrokesGroupSelection.update(o,void 0,s),this.labelsGroupSelection.update(o,void 0,s),this.updateRangeFills(t),this.updateRangeStrokes(t),this.updateRangeLabels(t,i)}updateRangeFills(t){const{lineDashOffset:e,strokeWidth:i,strokeOpacity:o,strokes:s,rangeStroke:a,showFill:n,isMultiColor:r}=t;this.rangeFillsGroupSelection.each((l,{x1:c,x2:h,y1:p,y2:u},g)=>{const y=r?s[g%s.length]:a;if(!n){l.visible=!1;return}l.setProperties({x1:c,x2:h,y1:p,y2:u,startLine:!1,endLine:!1,isRange:!0,stroke:y,strokeOpacity:o,fill:y,fillOpacity:(o??1)*.15,strokeWidth:i,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,visible:!0})})}updateRangeLabels(t,{xAxis:e}){const{rangeStrokesGroupSelection:i}=this,{strokes:o,strokeWidth:s,rangeStroke:a,isMultiColor:n,label:{color:r,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:p}}=t;this.labelsGroupSelection.each((u,g,y)=>{const f=r??(n?o[y%o.length]:a),m=i.at(y);if(!m)return;const{text:S,...b}=g.label,v={label:S,position:"center",alignment:"left",color:f,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:p};js(u.id,m,v,b,u),u.setProperties({text:S,x:b.x1,y:b.y1,textBaseline:"middle",textAlign:"end",fill:f,fontFamily:l,fontSize:c,fontStyle:h,fontWeight:p});const{x}=u.getBBox();x>=e.bounds.x&&x<=e.bounds.x+e.bounds.width||js(u.id,m,v,b,u,S,s)})}updateText(t,e){const i=this.rangeStrokesGroupSelection.selectByTag(0)[0],{text:o,strokeWidth:s}=t;this.text=this.updateNode(is,this.text,!!o.label),js(i.id,i,o,e,this.text,o.label,s)}updateAnchor(t,e,i,o){const s=Hy.topCenter(e);BT.apply(this.anchor,Yi.Transformable.toCanvasPoint(this.trendLine,s.x,s.y))}containsPoint(t,e){const{trendLine:i,rangeStrokesGroupSelection:o,text:s}=this;let a=!1;return o.each(n=>a||(a=n.isPointInPath(t,e))),a||i.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.trendLine.isPointInPath(t,e))return"line"}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}drag(t,e,i,o){t.locked||(this.activeHandle?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}getAnchor(){return this.anchor}getCursor(){return"pointer"}},{Vec2:FT,Vec4:Ky}=CT,Ar=class extends zT{constructor(){super(),this.type="fibonacci-retracement",this.start=new Ct,this.end=new Ct,this.append([this.start,this.end])}static is(t){return Xt.isCheck(t,"fibonacci-retracement")}containsPoint(t,e){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):super.containsPoint(t,e)}getNodeAtCoords(t,e){return this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":super.getNodeAtCoords(t,e)}dragStart(t,e,i){this.dragState={offset:e,...fh({start:t.start,end:t.end},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}dragAll(t,e,i){const{dragState:o}=this;o&&this.translatePoints({datum:t,start:o.start,end:o.end,translation:FT.sub(e,o.offset),context:i})}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(t,e,i):St(this[s].drag(e).point,i);!n||!Je(i,n)||(t[s].x=n.x,t[s].y=n.y)}snapToAngle(t,e,i){const{activeHandle:o}=this,a=["start","end"].find(r=>r!==o);if(!o||!a)return;this[o].toggleDragging(!0);const n=Ft(t[a],i);return St(pr(e,n,t.snapToAngle),i)}translatePoints({datum:t,start:e,end:i,translation:o,context:s}){const{vectors:a,translateX:n,translateY:r}=my({start:e,end:i},o,s);n&&(t.start.x=a.start?.x,t.end.x=a.end?.x),(this.ignoreYBounds||r)&&(t.start.y=a.start?.y,t.end.y=a.end?.y)}translate(t,e,i){this.translatePoints({datum:t,start:Ft(t.start,i),end:Ft(t.end,i),translation:e,context:i})}copy(t,e,i){const o=zi(t,i);if(!o)return;const s=this.computeBBoxWithoutHandles();return this.translatePoints({datum:e,start:{x:o.x1,y:o.y1},end:{x:o.x2,y:o.y2},translation:{x:-s.width/2,y:-s.height/2},context:i}),e}toggleHandles(t){if(typeof t=="boolean")this.start.visible=t,this.end.visible=t;else for(const[e,i]of Object.entries(t))this[e].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}updateHandles(t,e,i){this.start.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"end",i)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}getHandleCoords(t,e,i,o){return i==="start"?Ky.start(e):Ky.end(e)}};import{_ModuleSupport as VT}from"ag-charts-community";var{StateMachine:Zs,StateMachineProperty:Lh,Debug:GT}=VT,$s=class extends Zs{constructor(t){const e=({point:r})=>{const l=this.createDatum();l.set({start:r,end:r}),t.create(l)},i=()=>{const{node:r}=this;r?.toggleActive(!0),r?.toggleHandles({start:!0,end:!1})},o=({offset:r,context:l})=>{const{datum:c,snapping:h}=this;c&&(c.set({end:yh(r,l,h,c.start,c.snapToAngle)}),t.update())},s=()=>{this.node?.toggleHandles({end:!0}),t.update()},a=()=>t.delete(),n=()=>{t.showAnnotationOptions(),t.recordAction(`Create ${this.datum?.type} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:Zs.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,click:{target:Zs.parent,action:s},drag:o,dragEnd:{target:Zs.parent,action:s},reset:{target:Zs.parent,action:a},cancel:{target:Zs.parent,action:a},onExit:n}}),this.debug=GT.create(!0,"annotations"),this.snapping=!1}};d([Lh()],$s.prototype,"datum",2),d([Lh()],$s.prototype,"node",2),d([Lh()],$s.prototype,"snapping",2);var WT=class extends $s{createDatum(){return new Vi}},UT=class extends $s{createDatum(){return new Gi}},HT=class extends $s{createDatum(){return new Wi}},Yy={type:"fibonacci-retracement",datum:Wi,scene:Ar,isDatum:Wi.is,translate:(t,e,i,o)=>{Wi.is(e)&&Ar.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Wi.is(e)&&Wi.is(i)&&Ar.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Wi.is(e)&&Ar.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new HT({...t,create:e("fibonacci-retracement")}),dragState:t=>new Nt(t)};import{_ModuleSupport as jy}from"ag-charts-community";import{_ModuleSupport as Nh}from"ag-charts-community";var{Vec2:Ya}=Nh,KT=class extends Nh.Group{},Dr=class extends KT{constructor(){super(),this.type="arrow",this.path=new Nh.Path,this.armLength=6,this.append([this.path])}update(t){const{path:e}=this,{x:i,y:o,angle:s,...a}=t,n=Ya.from(i,o),r=3*Math.PI/4,l=this.armLength+(t.strokeWidth??0)*2,c=Ya.rotate(Ya.from(0,l),s+r,n),h=Ya.rotate(Ya.from(l,0),s-r,n);e.setProperties(a),e.fillOpacity=0,e.path.clear(),e.path.moveTo(c.x,c.y),e.path.lineTo(n.x,n.y),e.path.lineTo(h.x,h.y)}},{Vec2:ei,Vec4:Xy}=jy,Ao=class extends Sh{constructor(){super(),this.type="line",this.line=new Le,this.append([this.line,this.start,this.end])}static is(t){return Xt.isCheck(t,"line")}update(t,e){let i=zi(t,e);if(i==null){this.visible=!1;return}i=Xy.round(i),this.visible=t.visible??!0,this.visible&&(this.updateLine(t,i,e),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateAnchor(t,i,e))}updateLine(t,e,i){const{line:o}=this,{lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r}=t,l=this.extendLine(e,t,i);o.setProperties({...l,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r,fillOpacity:0})}updateText(t,e){this.text=this.updateNode(is,this.text,!!t.text.label),js(this.line.id,this.line,t.text,e,this.text,t.text.label,t.strokeWidth)}updateCaps(t,e){if(!t.startCap&&this.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),!t.endCap&&this.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),!t.startCap&&!t.endCap)return;const{stroke:i,strokeWidth:o,strokeOpacity:s}=t,[a,n]=ei.from(e),r=ei.angle(ei.sub(n,a));t.startCap&&(this.startCap&&this.startCap.type!==t.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),this.startCap==null&&(this.startCap=new Dr,this.append([this.startCap])),this.startCap.update({x:a.x,y:a.y,angle:r-Math.PI,stroke:i,strokeWidth:o,strokeOpacity:s})),t.endCap&&(this.endCap&&this.endCap.type!==t.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),this.endCap==null&&(this.endCap=new Dr,this.append([this.endCap])),this.endCap.update({x:n.x,y:n.y,angle:r,stroke:i,strokeWidth:o,strokeOpacity:s}))}updateAnchor(t,e,i,o){const s=Xy.topCenter(e);ei.apply(this.anchor,jy.Transformable.toCanvasPoint(this.line,s.x,s.y))}containsPoint(t,e){const{line:i,text:o}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.line.isPointInPath(t,e)?"line":super.getNodeAtCoords(t,e)}getHandleCoords(t,e,i,o){const{startCap:s,endCap:a}=this;let[n,r]=ei.from(e);const l=ei.angle(ei.sub(r,n));return s&&(n=ei.rotate(ei.from(0,-Ct.HANDLE_SIZE/2),l,n)),a&&(r=ei.rotate(ei.from(0,Ct.HANDLE_SIZE/2),l,r)),i==="start"?n:r}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}},Zy={type:"line",datum:Gi,scene:Ao,isDatum:Gi.is,translate:(t,e,i,o)=>{Gi.is(e)&&Ao.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Gi.is(e)&&Gi.is(i)&&Ao.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Gi.is(e)&&Ao.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new UT({...t,create:e("line")}),dragState:t=>new Nt(t)},$y={type:"arrow",datum:Vi,scene:Ao,isDatum:Vi.is,translate:(t,e,i,o)=>{Vi.is(e)&&Ao.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Vi.is(e)&&Vi.is(i)&&Ao.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Vi.is(e)&&Ao.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new WT({...t,create:e("arrow")}),dragState:t=>new Nt(t)};import{_ModuleSupport as Ch}from"ag-charts-community";import{_ModuleSupport as He}from"ag-charts-community";import{_ModuleSupport as Qy}from"ag-charts-community";function qy(t,e=0,i=0){let o=e;for(const s of t)if(Array.isArray(s)){for(const a of s)Jy(a,o);o+=Qy.Group.computeChildrenBBox(s).width+i}else Jy(s,o),o+=s.getBBox().width+i}function YT(t,e=0,i=0){let o=e;for(const s of t)if(Array.isArray(s)){for(const a of s)tf(a,o);o+=Qy.Group.computeChildrenBBox(s).height+i}else tf(s,o),o+=s.getBBox().height+i}function Jy(t,e){"x1"in t?(t.x2=e+(t.x2-t.x1),t.x1=e):t.x=e}function tf(t,e){"y1"in t?(t.y2=e+(t.y2-t.y1),t.y1=e):t.y=e}function ef(t,e){"x1"in t?(t.x1+=e,t.x2+=e):t.x+=e}function of(t,e){"y1"in t?(t.y1+=e,t.y2+=e):t.y+=e}var{Vec4:jT}=He,sf=class extends He.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new He.Rect,this.dateRangeBarsText=new He.Text,this.dateRangeDivider=new He.Line,this.dateRangeValueText=new He.Text,this.priceRangeValueText=new He.Text,this.priceRangeDivider=new He.Line,this.priceRangePercentageText=new He.Text,this.volumeText=new He.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(t,e,i,o,s,a){this.verticalDirection=s;const n=this.updateStatistics(t,e,i,a),r=He.Group.computeChildrenBBox(n.flat()),l=10;r.grow(l),this.updateBackground(t,r,l),this.reposition(n,l,o)}updateStatistics(t,e,i,o){const{dateRangeBarsText:s,dateRangeDivider:a,dateRangeValueText:n,priceRangeValueText:r,priceRangeDivider:l,priceRangePercentageText:c,volumeText:h}=this,p=8,u=6,g=t.statistics.fontSize+3,y=-2,f=this.getTextStyles(t),m={...this.getDividerStyles(t),x1:0,y1:0,x2:0,y2:g},S=[s,a,n],b=[r,l,c],v=[];return e.priceRange&&(r.setProperties({...f,text:this.formatPriceRangeValue(e.priceRange.value,o)}),l.setProperties(m),c.setProperties({...f,text:this.formatPriceRangePercentage(e.priceRange.percentage,o)}),qy(b,i.x,p),v.push(b)),e.dateRange&&(s.setProperties({...f,text:this.formatDateRangeBars(e.dateRange.bars,o)}),a.setProperties(m),n.setProperties({...f,text:this.formatDateRangeValue(e.dateRange.value)}),qy(S,i.x,p),v.push(S)),e.volume!=null?(h.setProperties({...f,x:i.x,text:this.formatVolume(e.volume,o),visible:!0}),v.push(h)):h.visible=!1,YT(v,i.y,u),l.y1+=y,l.y2+=y,a.y1+=y,a.y2+=y,v}updateBackground(t,e,i){const o=this.getBackgroundStyles(t);this.background.setProperties({...o,...e,x:e.x-e.width/2+i,y:e.y})}reposition(t,e,i){const{width:o,height:s}=i.seriesRect,a=jT.from(this.background.getBBox());let n=0;a.x1<0&&(n=-a.x1),a.x2>o&&(n=o-a.x2);const r=Math.min(e,s-a.y2);for(const l of t)if(Array.isArray(l)){const c=He.Group.computeChildrenBBox(l).width;for(const h of l)ef(h,n-c/2),of(h,r)}else ef(l,n-l.getBBox().width/2),of(l,r);this.background.x+=n,this.background.y+=r}getTextStyles(t){return{fill:t.statistics.color,fontFamily:t.statistics.fontFamily,fontSize:t.statistics.fontSize,fontStyle:t.statistics.fontStyle,fontWeight:t.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(t){return{stroke:t.statistics.divider.stroke,strokeOpacity:t.statistics.divider.strokeOpacity,strokeWidth:t.statistics.divider.strokeWidth}}getBackgroundStyles(t){return{fill:t.statistics.fill,stroke:t.statistics.stroke,strokeOpacity:t.statistics.strokeOpacity,strokeWidth:t.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(t,e){return e?.t("measurerDateRangeBars",{value:t})??`${t}`}formatDateRangeValue(t){const e=[],i=t>=0?"":"-";t=Math.abs(t);const o=1e3*60,s=o*60,a=s*24,n=Math.floor(t/o),r=Math.floor(t/s),l=Math.floor(t/a),c=r%(a/s),h=n%(s/o);return l>=1&&e.push(`${l}d`),r>=1&&(t<a||c!==0)&&e.push(`${c}h`),(t<s||h!==0)&&e.push(`${h}m`),e[0]=`${i}${e[0]}`,e.join(" ")}formatPriceRangeValue(t,e){return e?.t("measurerPriceRangeValue",{value:Number(t.toFixed(2))})??`${t}`}formatPriceRangePercentage(t,e){return e?.t("measurerPriceRangePercent",{value:t})??`${t}`}formatVolume(t,e){const i=isNaN(t)?"":this.volumeFormatter.format(t);return e?.t("measurerVolume",{value:i})??i}},XT=class extends sf{getDirectionStyles(t){return this.verticalDirection==="down"?t.down.statistics:t.up.statistics}getTextStyles(t){const e=this.getDirectionStyles(t);return{...super.getTextStyles(t),fill:e.color,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight}}getDividerStyles(t){const e=this.getDirectionStyles(t);return{stroke:e.divider.stroke,strokeOpacity:e.divider.strokeOpacity,strokeWidth:e.divider.strokeWidth}}getBackgroundStyles(t){const e=this.getDirectionStyles(t);return{...super.getBackgroundStyles(t),fill:e.fill,stroke:e.stroke,strokeOpacity:e.strokeOpacity,strokeWidth:e.strokeWidth}}},{Vec2:vi,Vec4:os}=Ch,Ne=class extends Sh{constructor(){super(),this.type="measurer",this.horizontalLine=new Le,this.verticalLine=new Le,this.horizontalStartLine=new Le,this.horizontalEndLine=new Le,this.verticalStartLine=new Le,this.verticalEndLine=new Le,this.horizontalEndCap=new Dr,this.verticalEndCap=new Dr,this.background=new Ch.Path({zIndex:-1}),this.updateBackground=Gy.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(t){return Xt.isCheck(t,"measurer")}createStatisticsScene(){return new sf}update(t,e){const i=zi(t,e);if(i==null){this.visible=!1;return}if(this.visible=t.visible??!0,!this.visible)return;const o=this.extendPerpendicular(i,t,e),s={...o,y2:o.y1},a={...o,y1:o.y2};this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(t),this.updateLines(t,i),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateBoundingLines(t,o),this.updateBackground(t,s,a,e),this.updateStatistics(t,i,e),this.updateAnchor(t,i,e)}extendPerpendicular(t,e,i){const o={x1:Math.min(t.x1,t.x2),x2:Math.max(t.x1,t.x2),y1:Math.min(t.y1,t.y2),y2:Math.max(t.y1,t.y2)},[s,a]=vi.from(i.yAxis.bounds);return Fe.is(e)?(e.extendAbove&&(o.y1=s.y),e.extendBelow&&(o.y2=a.y)):Ve.is(e)&&(e.extendLeft&&(o.x1=s.x),e.extendRight&&(o.x2=a.x)),o}updateVisibilities(t){const{horizontalStartLine:e,horizontalEndLine:i,horizontalEndCap:o,verticalStartLine:s,verticalEndLine:a,verticalEndCap:n}=this,{direction:r}=t;s.visible=r!=="vertical",a.visible=r!=="vertical",o.visible=r!=="vertical",e.visible=r!=="horizontal",i.visible=r!=="horizontal",n.visible=r!=="horizontal"}updateLines(t,e){const{horizontalLine:i,verticalLine:o}=this,{direction:s}=t,{x1:a,y1:n,x2:r,y2:l}=e,c=vi.round(os.center(e)),h=this.getLineStyles(t);s!=="vertical"&&i.setProperties({...h,x1:a,x2:r,y1:c.y,y2:c.y}),s!=="horizontal"&&o.setProperties({...h,x1:c.x,x2:c.x,y1:n,y2:l})}updateText(t,e){const{direction:i}=t,o=vi.round(os.center(e));let s;const a={...e};i==="vertical"?(s=this.verticalLine,a.x1=o.x,a.x2=o.x):(s=this.horizontalLine,a.y1=o.y,a.y2=o.y),this.text=this.updateNode(is,this.text,!!t.text.label);const{id:n}=s,r=js(n,s,t.text,a,this.text,t.text.label,t.strokeWidth);let l;if(i==="both"&&r&&this.text){const c=os.from(this.text.getBBox()),{offset:h}=r.numbers;c.x1<=o.x+h.x&&c.x2>=o.x-h.x&&(l={x:o.x,y:r.clipMask.y,radius:this.text.getBBox().height/2+vi.length(h)})}this.verticalLine.setClipMask(n,l)}updateCaps(t,e){const{horizontalEndCap:i,verticalEndCap:o}=this,{direction:s}=t,{x1:a,y1:n,x2:r,y2:l}=e,c=vi.round(os.center(e)),{stroke:h,strokeWidth:p,strokeOpacity:u}=this.getLineStyles(t),g={stroke:h,strokeWidth:p,strokeOpacity:u};if(s!=="vertical"){const y=a<=r?0:Math.PI;let f=r;s==="horizontal"&&(f+=a<=r?-2:2),i.update({...g,x:f,y:c.y,angle:y})}if(s!=="horizontal"){const y=n<=l?Math.PI/2:Math.PI/-2;let f=l;s==="vertical"&&(f+=n<=l?-2:2),o.update({...g,x:c.x,y:f,angle:y})}}updateBoundingLines(t,e){const{verticalStartLine:i,verticalEndLine:o,horizontalStartLine:s,horizontalEndLine:a}=this,{direction:n}=t,{x1:r,y1:l,x2:c,y2:h}=e,p=this.getLineStyles(t);n==="horizontal"&&(i.setProperties({...p,x1:r,y1:l,x2:r,y2:h}),o.setProperties({...p,x1:c,y1:l,x2:c,y2:h})),n==="vertical"&&(s.setProperties({...p,x1:r,y1:l,x2:c,y2:l}),a.setProperties({...p,x1:r,y1:h,x2:c,y2:h}))}updateStatistics(t,e,i){const o=vi.add(os.bottomCenter(e),vi.from(0,10)),s={volume:this.getVolume(t)};t.hasPriceRange&&(s.priceRange={percentage:this.getPriceRangePercentage(t),value:this.getPriceRangeValue(t)}),t.hasDateRange&&(s.dateRange={bars:this.getDateRangeBars(e,i),value:this.getDateRangeValue(t)}),this.statistics.update(t,s,o,i,this.verticalDirection,t.localeManager)}updateAnchor(t,e,i,o){const s=os.topCenter(e);vi.apply(this.anchor,Ch.Transformable.toCanvasPoint(this.horizontalLine,s.x,s.y))}getBackgroundPoints(t,e,i,o){const[s,a]=vi.from(e),[n,r]=vi.from(i);return[s,a,r,n]}getLineStyles(t){const{lineDashOffset:e,stroke:i,strokeWidth:o,strokeOpacity:s}=t;return{lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,stroke:i,strokeWidth:o,strokeOpacity:s,fillOpacity:0}}getBackgroundStyles(t){const{background:e}=t;return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}containsPoint(t,e){const{horizontalLine:i,text:o,verticalLine:s,horizontalStartLine:a,horizontalEndLine:n,verticalStartLine:r,verticalEndLine:l}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||s.isPointInPath(t,e)||a.visible&&a.isPointInPath(t,e)||n.visible&&n.isPointInPath(t,e)||r.visible&&r.isPointInPath(t,e)||l.visible&&l.isPointInPath(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":"line"}getDateRangeBars(t,e){const{step:i}=e.xAxis.scale,o=t.x1<=t.x2?1:-1;return i?Math.round(os.width(t)/i)*o:0}getDateRangeValue(t){if(t.start.x==null||t.end.x==null||!(t.start.x instanceof Date)||!(t.end.x instanceof Date))throw new Error("Can not create a date range measurement of non-date x-axis.");return t.end.x.getTime()-t.start.x.getTime()}getPriceRangePercentage(t){if(t.start.y==null||t.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");return(t.end.y-t.start.y)/t.start.y}getPriceRangeValue(t){if(t.start.y==null||t.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");return t.end.y-t.start.y}getVolume(t){return t.getVolume(t.start.x,t.end.x)}},Ir=class extends Ne{constructor(){super(...arguments),this.type="quick-measurer"}static is(t){return Xt.isCheck(t,"quick-measurer")}createStatisticsScene(){return new XT}getDirectionStyles(t){return this.verticalDirection==="down"?t.down:t.up}getLineStyles(t){const e=this.getDirectionStyles(t);return{...super.getLineStyles(t),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity}}getBackgroundStyles(t){const e=this.getDirectionStyles(t);return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){const e=this.getDirectionStyles(t);return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}};import{_ModuleSupport as ZT}from"ag-charts-community";var{StateMachine:Qs,StateMachineProperty:af,Debug:$T}=ZT,qs=class extends Qs{constructor(t){const e=({point:n})=>{const r=this.createDatum();r.set({start:n,end:n}),t.create(r)},i=({point:n})=>{const{datum:r,node:l}=this;r?.set({end:n}),l?.toggleActive(!0),l?.toggleHandles({end:!1}),t.update()},o=()=>{this.node?.toggleHandles({end:!0})},s=()=>t.delete(),a=()=>{t.showAnnotationOptions(),!yo(this.datum)&&t.recordAction(`Create ${this.node?.type} annotation`)};super("start",{start:{reset:Qs.parent,click:{target:"end",action:e},drag:{target:"end",action:e}},end:{hover:i,drag:i,click:{target:Qs.parent,action:o},dragEnd:{target:Qs.parent,action:o},reset:{target:Qs.parent,action:s},cancel:{target:Qs.parent,action:s},onExit:a}}),this.debug=$T.create(!0,"annotations")}};d([af()],qs.prototype,"datum",2),d([af()],qs.prototype,"node",2);var QT=class extends qs{createDatum(){return new Fe}},qT=class extends qs{createDatum(){return new Ve}},JT=class extends qs{createDatum(){return new Fi}},tO=class extends qs{createDatum(){return new Oe}},nf={type:"date-range",datum:Fe,scene:Ne,isDatum:Fe.is,translate:(t,e,i,o)=>{Fe.is(e)&&Ne.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Fe.is(e)&&Fe.is(i)&&Ne.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Fe.is(e)&&Ne.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new QT({...t,create:e("date-range")}),dragState:t=>new Nt(t)},rf={type:"price-range",datum:Ve,scene:Ne,isDatum:Ve.is,translate:(t,e,i,o)=>{Ve.is(e)&&Ne.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ve.is(e)&&Ve.is(i)&&Ne.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ve.is(e)&&Ne.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new qT({...t,create:e("date-range")}),dragState:t=>new Nt(t)},lf={type:"date-price-range",datum:Fi,scene:Ne,isDatum:Fi.is,translate:(t,e,i,o)=>{Fi.is(e)&&Ne.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Fi.is(e)&&Fi.is(i)&&Ne.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Fi.is(e)&&Ne.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new JT({...t,create:e("date-range")}),dragState:t=>new Nt(t)},cf={type:"quick-date-price-range",datum:Oe,scene:Ir,isDatum:Oe.is,translate:(t,e,i,o)=>{Oe.is(e)&&Ir.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Oe.is(e)&&Oe.is(i)&&Ir.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Oe.is(e)&&Ir.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new tO({...t,create:e("quick-date-price-range")}),dragState:t=>new Nt(t)};import{_ModuleSupport as ja}from"ag-charts-community";var{ZIndexMap:hf,TextWrapper:eO,clamp:iO}=ja,Tr=class extends kh{constructor(){super(),this.type="note",this.shape=new ja.Rect,this.iconBackground=new ja.SvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new ja.SvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new ja.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(t){return Xt.isCheck(t,"note")}update(t,e){this.updateIcon(t,e),super.update(t,e)}getTextBBox(t,e,i){const o=super.getTextBBox(t,e,i);o.x-=t.width/2,o.x=iO(0,o.x,i.seriesRect.width-t.width);const s=t.getPadding().top,a=o.y-Kg-s*2,n=o.y+Ct.HANDLE_SIZE+s*2;return a-o.height-Yg<0?(o.y=n,t.position="top"):(o.y=a+s,t.position="bottom"),o}updateLabel(t,e){const i=t.visible===!1?!1:this.label.visible;super.updateLabel(t,e),this.label.visible=i,this.label.text=eO.wrapText(t.text,{font:{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},avoidOrphans:!1,textAlign:t.textAlign,textBaseline:"hanging",textWrap:"always",maxWidth:200})}updateShape(t,e){const{shape:i}=this;i.fill=t.background.fill,i.fillOpacity=t.background.fillOpacity??1,i.stroke=t.background.stroke,i.strokeOpacity=t.background.strokeOpacity??1,i.strokeWidth=t.background.strokeWidth??1,i.cornerRadius=4;const o=t.getPadding().top,s=t.position==="top";i.x=e.x-o,i.width=t.width+o*2,i.height=e.height+o*2,i.y=e.y+(s?0:-e.height)-o}updateIcon(t,e){const{active:i,iconBackground:o,iconLines:s}=this,{x:a,y:n}=Ft(t,e);o.x=a-kD/2,o.y=n-Hg,s.x=o.x,s.y=o.y,o.fill=t.fill,o.fillOpacity=t.fillOpacity??1,o.stroke=t.stroke,o.strokeOpacity=t.strokeOpacity??1,o.strokeWidth=t.strokeWidth??1,s.fill=t.stroke,i?o.fillShadow.color=t.fill??"rgba(0, 0, 0, 0.22)":o.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(t,e,i){const o=t.getPadding().top,s=t.position==="top",a=s?1:-1;return{x:e.x+i.seriesRect.x+t.width/2,y:e.y+i.seriesRect.y+a*(e.height+o),position:s?"below":"above"}}getLabelCoords(t,e){const i=t.position==="top",o=t.getPadding().top;return{x:e.x,y:e.y+(i?o/2:0)}}getHandleCoords(t,e,i){return{x:e.x,y:e.y+Ct.HANDLE_SIZE/2+4}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}toggleHovered(t){super.toggleHovered(t),this.label.visible=t,this.shape.visible=t,this.zIndex=t?hf.CHART_ANNOTATION_FOCUSED:hf.CHART_ANNOTATION}toggleActive(t){super.toggleActive(t),this.label.visible=t,this.shape.visible=t,this.active=t}containsPoint(t,e){return this.shape.visible&&this.shape.containsPoint(t,e)||this.iconBackground.containsPoint(t,e)?!0:super.containsPoint(t,e)}},oO=class extends Ka{createDatum(){return new xe}},df={type:"note",datum:xe,scene:Tr,isDatum:xe.is,translate:(t,e,i,o)=>{xe.is(e)&&Tr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(xe.is(e)&&xe.is(i)&&Tr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{xe.is(e)&&Tr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oO({...t,create:e("note")}),dragState:t=>new Nt(t)};import{_ModuleSupport as sO}from"ag-charts-community";var{Vec2:Mi,Vec4:Js}=sO,Or=class extends Wy{constructor(){super(),this.type="parallel-channel",this.ignoreYBounds=!0,this.handles={topLeft:new Ct,topMiddle:new Ys,topRight:new Ct,bottomLeft:new Ct,bottomMiddle:new Ys,bottomRight:new Ct},this.middleLine=new Le,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return Xt.isCheck(t,"parallel-channel")}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0);const r=t.toJson();let l=[],c=[];switch(s){case"topLeft":case"bottomLeft":l=["topLeft","bottomLeft"],c=["topRight","bottomRight"];break;case"topMiddle":l=["topLeft","topRight"],n.y-=Ys.HANDLE_SIZE/2;break;case"topRight":case"bottomRight":l=["topRight","bottomRight"],c=["topLeft","bottomLeft"];break;case"bottomMiddle":l=["bottomLeft","bottomRight"],n.y-=Ys.HANDLE_SIZE/2;break}const h=t.snapToAngle,p=l.map((u,g)=>o&&c[g]?this.snapToAngle(e,i,u,c[g],h):St(Mi.add(a[u].handle,n),i)).filter(CD);if(!p.some(u=>!Je(i,u,{y:!1}))){if((s==="topMiddle"||s==="bottomMiddle")&&t.start.y!=null){const u=St(Mi.add(a.topLeft.handle,n),i);Je(i,u)&&(s==="topMiddle"?t.height+=u.y-t.start.y:t.height-=u.y-t.start.y)}for(const[u,g]of p.entries())switch(l[u]){case"topLeft":t.start.x=g.x,t.start.y=g.y;break;case"topRight":t.end.x=g.x,t.end.y=g.y;break}t.isValidWithContext(i)||t.set(r)}}containsPoint(t,e){return super.containsPoint(t,e)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)}getNodeAtCoords(t,e){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)?"line":super.getNodeAtCoords(t,e)}updateLines(t,e,i,o,s,a){const{topLine:n,middleLine:r,bottomLine:l}=this,{lineDashOffset:c,stroke:h,strokeOpacity:p,strokeWidth:u}=t,g=t.getLineDash(),y={lineCap:t.getLineCap(),lineDash:g,lineDashOffset:c,stroke:h,strokeOpacity:p,strokeWidth:u};n.setProperties({...e,...y}),l.setProperties({...i,...y});const f=this.extendLine({x1:s.x1,y1:a.y1+(s.y1-a.y1)/2,x2:s.x2,y2:a.y2+(s.y2-a.y2)/2},t,o);r.setProperties({...f,lineDash:t.middle.lineDash??g,lineDashOffset:t.middle.lineDashOffset??c,stroke:t.middle.stroke??h,strokeOpacity:t.middle.strokeOpacity??p,strokeWidth:t.middle.strokeWidth??u,visible:t.middle.visible??!0})}updateHandles(t,e,i){const{handles:{topLeft:o,topMiddle:s,topRight:a,bottomLeft:n,bottomMiddle:r,bottomRight:l}}=this,c={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...c,...Js.start(e)}),a.update({...c,...Js.end(e)}),n.update({...c,...Js.start(i)}),l.update({...c,...Js.end(i)}),s.update({...c,...Mi.sub(Js.center(e),Mi.from(s.handle.width/2,s.handle.height/2))}),r.update({...c,...Mi.sub(Js.center(i),Mi.from(r.handle.width/2,r.handle.height/2))})}updateText(t,e,i){this.text=this.updateNode(is,this.text,!!t.text.label),wy(!0,e,i,t.text,t.strokeWidth,this.text,t.text.label)}getBackgroundPoints(t,e,i,o){const s=e.x1>e.x2,a=e.y1>e.y2,n=e.x1!==i.x1&&e.y1!==i.y1,r=e.x2!==i.x2&&e.y2!==i.y2,l=Mi.from(e);return t.extendEnd&&r&&l.push(Mi.from(s?o.x1:o.x2,a?o.y1:o.y2)),l.push(...Mi.from(i).reverse()),t.extendStart&&n&&l.push(Mi.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{_ModuleSupport as aO}from"ag-charts-community";var{StateMachine:Do,StateMachineProperty:Rh,Debug:nO}=aO,Lr=class extends Do{constructor(t){const e=({point:l})=>{const c=new We;c.set({start:l,end:l,height:0}),t.create(c)},i=()=>{const{node:l}=this;l?.toggleActive(!0),l?.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})},o=({offset:l,context:c})=>{const{datum:h,snapping:p}=this;h&&(h.set({end:yh(l,c,p,h.start,h.snapToAngle)}),t.update())},s=()=>{this.node?.toggleHandles({topRight:!0}),t.update()},a=({point:l})=>{const{datum:c,node:h}=this;if(c?.start.y==null||c?.end.y==null)return;const p=c.end.y-(l.y??0),u=c.start.y-p;h?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!t.validatePoint({x:c.start.x,y:u})||!t.validatePoint({x:c.end.x,y:l.y}))&&(c.set({height:p}),t.update())},n=({point:l})=>{const{datum:c,node:h}=this;if(c?.start.y==null||c?.end.y==null)return;const p=c.end.y-(l.y??0),u=c.start.y-p;h?.toggleHandles(!0),!(!t.validatePoint({x:c.start.x,y:u})||!t.validatePoint({x:c.end.x,y:l.y}))&&(c.set({height:p}),t.recordAction("Create parallel-channel annotation"),t.showAnnotationOptions(),t.update())},r=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:Do.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:o,drag:o,click:{target:"height",action:s},dragEnd:{target:"height",action:s},reset:{target:Do.parent,action:r},cancel:{target:Do.parent,action:r}},height:{hover:a,click:{target:Do.parent,action:n},drag:{target:Do.parent,action:n},reset:{target:Do.parent,action:r},cancel:{target:Do.parent,action:r}}}),this.debug=nO.create(!0,"annotations"),this.snapping=!1}};d([Rh()],Lr.prototype,"datum",2),d([Rh()],Lr.prototype,"node",2),d([Rh()],Lr.prototype,"snapping",2);var pf={type:"parallel-channel",datum:We,scene:Or,isDatum:We.is,translate:(t,e,i,o)=>{We.is(e)&&Or.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(We.is(e)&&We.is(i)&&Or.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{We.is(e)&&Or.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new Lr({...t,create:e("parallel-channel")}),dragState:t=>new Nt(t)},Nr=class extends kh{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(t){return Xt.isCheck(t,"text")}getHandleCoords(t,e){const i=Ct.HANDLE_SIZE/2;return{x:e.x+i,y:e.y+2+i}}},rO=class extends Ka{createDatum(){return new Ui}},uf={type:"text",datum:Ui,scene:Nr,isDatum:Ui.is,translate:(t,e,i,o)=>{Ui.is(e)&&Nr.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ui.is(e)&&Ui.is(i)&&Nr.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ui.is(e)&&Nr.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new rO({...t,create:e("text")}),dragState:t=>new Nt(t)},Ce={[Zy.type]:Zy,[zy.type]:zy,[Fy.type]:Fy,[pf.type]:pf,[Uy.type]:Uy,[Yy.type]:Yy,[Ly.type]:Ly,[Ry.type]:Ry,[df.type]:df,[uf.type]:uf,[$y.type]:$y,[vy.type]:vy,[by.type]:by,[nf.type]:nf,[rf.type]:rf,[lf.type]:lf,[cf.type]:cf};function ss(t){for(const{isDatum:e}of Object.values(Ce))if(e(t))return t}import{_ModuleSupport as lO}from"ag-charts-community";var{ActionOnSet:cO,ParallelStateMachine:hO,StateMachine:Eh,StateMachineProperty:ki,Debug:dO}=lO,Cr=class extends hO{constructor(t){super(new pO(e=>{this.snapping=e}),new uO(()=>{this.node=this.active==null?void 0:t.node(this.active)}),new Io(t,e=>{this.active=e,this.datum=this.active==null?void 0:t.datum(this.active),this.node=this.active==null?void 0:t.node(this.active)})),this.snapping=!1}getActive(){return this.active}isActive(t){return t===this.active}};d([ki()],Cr.prototype,"snapping",2),d([ki()],Cr.prototype,"datum",2),d([ki()],Cr.prototype,"node",2);var pO=class extends Eh{constructor(t){super("idle",{idle:{hover:({shiftKey:e})=>t(e),keyDown:({shiftKey:e})=>t(e),keyUp:({shiftKey:e})=>t(e),click:({shiftKey:e})=>t(e),drag:({shiftKey:e})=>t(e)},dragging:{},"text-input":{}})}},uO=class extends Eh{constructor(t){super("idle",{idle:{onEnter:t,render:t},dragging:{onEnter:t,render:t},"text-input":{render:t}})}},Io=class extends Eh{constructor(t,e){const i=v=>x=>{t.create(v,x),this.active=t.selectLast()},o=()=>{this.active!=null&&t.delete(this.active),this.active=void 0,t.select()},s={createDatum:i},a={...t,delete:o,showTextInput:()=>{this.active!=null&&t.showTextInput(this.active)},deselect:()=>{const v=this.active;this.active=void 0,this.hovered=void 0,t.select(this.active,v)},showAnnotationOptions:()=>{this.active!=null&&t.showAnnotationOptions(this.active)}},n=Object.fromEntries(Object.entries(Ce).map(([v,x])=>[v,x.createState(a,s)])),r=Object.fromEntries(Object.entries(Ce).map(([v,x])=>[v,x.dragState(t,s)])),l=({colorPickerType:v,colorOpacity:x,color:M,opacity:k,isMultiColor:A})=>{this.datum&&(v==="text-color"&&t.updateTextInputColor(M),lr(this.datum,v,x,M,k,A),t.update())},c=v=>{const{datum:x,node:M}=this;!x||!M||(Si(x)?(x.fontSize=v,t.updateTextInputFontSize(v)):Hs(x)&&(x.text.fontSize=v),t.update())},h=v=>{const{datum:x,node:M}=this;!x||!M||!fo(x)||(oy(x,v),t.update())},p=v=>{const{node:x}=this;!x||!("setTextInputBBox"in x)||(x.setTextInputBBox(v),t.update())},u=({textInputValue:v,bbox:x})=>{const{datum:M}=this;if(x!=null&&v!=null&&v.length>0){if(!Si(M))return;const k=ir(M,v,x.width);M.set({text:k}),t.update(),t.recordAction(`Change ${M.type} annotation text`)}else t.delete(this.active),t.recordAction(`Delete ${M?.type} annotation`)},g=()=>{t.updateTextInputBBox(void 0)},y=()=>this.active!=null,f=()=>this.copied!=null,m=()=>{const{active:v,datum:x}=this;return v==null||!x?!1:Hs(x)&&!x.locked},S=()=>this.active!=null&&!yo(this.datum),b=()=>this.hovered!=null;super("idle",{idle:{onEnter:()=>{t.select(this.active,this.active),this.hoverCoords&&(this.hovered=t.hoverAtCoords(this.hoverCoords,this.active))},hover:({offset:v})=>{this.hovered=t.hoverAtCoords(v,this.active),this.hoverCoords=v},translate:{guard:y,action:({translation:v})=>{t.startInteracting(),t.translate(this.active,v),t.update()}},translateEnd:{guard:y,action:()=>{t.stopInteracting()}},copy:{guard:S,action:()=>{this.copied=t.copy(this.active)}},cut:{guard:S,action:()=>{this.copied=t.copy(this.active),o()}},paste:{guard:f,action:()=>{t.paste(this.copied)}},selectLast:()=>{const v=this.active;this.active=t.selectLast(),t.select(this.active,v)},click:[{guard:()=>{const{active:v,hovered:x,datum:M}=this;return v==null||x!==v||!M?!1:Si(M)&&!M.locked},target:"text-input"},{action:()=>{const v=this.active;this.active=this.hovered,t.select(this.active,v)}}],dblclick:{guard:m,action:({offset:v})=>{const x=t.getNodeAtCoords(v,this.active)==="text"?"text":"line";t.showAnnotationSettings(this.active,void 0,x)}},dragStart:[{guard:b,target:"dragging",action:()=>{const v=this.active;this.active=this.hovered,t.select(this.active,v),t.startInteracting()}},{action:()=>{const v=this.active;this.active=this.hovered,t.select(this.active,v)}}],color:{guard:y,action:l},fontSize:{guard:y,action:c},lineProps:{guard:y,action:v=>{const x=ss(this.datum);x?.set(v),t.update(),t.recordAction(`Change ${x?.type} ${Object.entries(v).map(([M,k])=>`${M} to ${k}`).join(", ")}`)}},lineStyle:{guard:y,action:h},lineText:{guard:y,action:v=>{const x=ss(this.datum);Hs(x)&&(Hi(x)&&v.position==="center"&&(v.position="inside"),x.text.set(v),t.update())}},updateTextInputBBox:{guard:y,action:p},toolbarPressSettings:{guard:m,action:v=>{t.showAnnotationSettings(this.active,v)}},reset:()=>{this.active!=null&&this.node?.toggleActive(!1),this.hovered=void 0,this.active=void 0,t.select(this.active,this.active),t.resetToIdle()},delete:()=>{this.active!=null&&(t.delete(this.active),!yo(this.datum)&&t.recordAction(`Delete ${this.datum?.type} annotation`))},deleteAll:()=>{t.deleteAll()},...n},dragging:{onEnter:(v,x)=>{if(this.active==null)return;const M=t.getAnnotationType(this.active);M&&(this.transitionRoot(M),this.transitionRoot("dragStart",x))},...r},"text-input":{onEnter:()=>{if(this.active==null)return;const v=ss(this.datum);!v||!("getTextInputCoords"in v)||(t.startInteracting(),t.showTextInput(this.active),v.visible=!1,t.update())},updateTextInputBBox:{guard:y,action:p},resize:{target:"idle",action:u},click:{target:"idle",action:u},drag:{target:"idle",action:u},textInput:[{guard:bh,target:"idle",action:g},{guard:vh,target:"idle",action:u}],color:{guard:y,action:l},fontSize:{guard:y,action:c},cancel:{target:"idle",action:g},onExit:()=>{t.stopInteracting(),t.hideTextInput();const v=this.active;if(this.active=this.hovered=void 0,t.select(this.active,v),v==null)return;const x=t.datum(v),M=t.node(v);!x||!M||(x.visible=!0)}}}),this.setActive=e,this.debug=dO.create(!0,"annotations"),this.snapping=!1}};d([cO({changeValue(t){this.setActive(t)}}),ki()],Io.prototype,"active",2),d([ki()],Io.prototype,"hovered",2),d([ki()],Io.prototype,"hoverCoords",2),d([ki()],Io.prototype,"copied",2),d([ki()],Io.prototype,"snapping",2),d([ki()],Io.prototype,"datum",2),d([ki()],Io.prototype,"node",2);import{_ModuleSupport as wh}from"ag-charts-community";var{ARRAY:gO,BOOLEAN:yO,UNION:fO,ActionOnSet:mO,LayoutElement:xO,Menu:SO,PropertiesArray:bO,ToolbarButtonProperties:vO,Validate:_h}=wh,gf=class extends vO{};d([_h(fO(["line-menu","fibonacci-menu","text-menu","shape-menu","measurer-menu","clear"]))],gf.prototype,"value",2);var Ph=class extends wh.BaseProperties{constructor(t){super(),this.ctx=t,this.enabled=!0,this.buttons=new bO(gf),this.events=new wh.Listeners,this.annotationMenu=new SO(this.ctx,"annotations"),this.destroyFns=[],this.toolbar=t.sharedToolbar.getSharedToolbar("annotations");const e=this.onKeyDown.bind(this);this.toolbar.addListener("keydown",e),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onToolbarButtonPress.bind(this)),t.layoutManager.registerElement(xO.ToolbarLeft,this.onLayoutStart.bind(this)),()=>{this.toolbar.removeListener("keydown",e),this.toolbar.destroy()})}destroy(){for(const t of this.destroyFns)t()}addListener(t,e){return this.events.addListener(t,e)}toggleVisibility(t){this.toolbar.setHidden(!t)}toggleClearButtonEnabled(t){const e=this.buttons.findIndex(i=>i.value==="clear");this.toolbar.toggleButtonEnabledByIndex(e,t)}resetButtonIcons(){for(const[t,e]of this.buttons.entries())switch(e.value){case"line-menu":this.updateButtonByIndex(t,{icon:"trend-line-drawing",value:"line-menu"});break;case"fibonacci-menu":this.updateButtonByIndex(t,{icon:"fibonacci-retracement-drawing",value:"fibonacci-menu"});break;case"text-menu":this.updateButtonByIndex(t,{icon:"text-annotation",value:"text-menu"});break;case"shape-menu":this.updateButtonByIndex(t,{icon:"arrow-drawing",value:"shape-menu"});break}}hideOverlays(){this.annotationMenu.hide()}clearActiveButton(){this.toolbar.clearActiveButton()}dispatch(t,e){this.events.dispatch(t,e)}onLayoutStart(t){this.enabled&&(this.toolbar.updateButtons(this.buttons),this.toolbar.layout(t.layoutBox))}onToolbarButtonPress({event:t,button:e,buttonBounds:i}){switch(e.value){case"clear":this.dispatch("pressed-clear");break;case"line-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsLineAnnotations",mI);break;case"fibonacci-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsFibonacciAnnotations",xI);break;case"text-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsTextAnnotations",bI);break;case"shape-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsShapeAnnotations",vI);break;case"measurer-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsMeasurerAnnotations",MI);break}}onToolbarButtonPressShowMenu(t,e,i,o,s){this.dispatch("pressed-show-menu");const a=this.buttons.findIndex(n=>n.value===i);this.toolbar.toggleActiveButtonByIndex(a),this.annotationMenu.setAnchor({x:e.x+e.width+6,y:e.y}),this.annotationMenu.show({items:s,ariaLabel:this.ctx.localeManager.t(o),class:"ag-charts-annotations__toolbar-menu",sourceEvent:t.sourceEvent,onPress:this.onButtonPressMenuCreateAnnotation.bind(this,i)})}onButtonPressMenuCreateAnnotation(t,e){const i=this.buttons.findIndex(o=>o.value===t);this.updateButtonByIndex(i,{icon:e.icon}),this.dispatch("pressed-create-annotation",{annotation:e.value}),this.annotationMenu.hide()}onKeyDown({sourceEvent:t}){t.key==="Escape"&&this.dispatch("cancel-create-annotation")}updateButtonByIndex(t,e){const i=this.buttons.at(t);i&&(i.set({...i.toJson(),...e,value:e.value??i.value}),this.toolbar.updateButtonByIndex(t,{...i.toJson()}))}};d([_h(yO),mO({changeValue(t){this.toolbar?.setHidden(!t)}})],Ph.prototype,"enabled",2),d([_h(gO)],Ph.prototype,"buttons",2);import{_ModuleSupport as MO,_Widget as kO}from"ag-charts-community";var{BaseModuleInstance:AO,InteractionState:Xa,Validate:DO,BOOLEAN:IO,ChartAxisDirection:TO,getIconClassNames:OO}=MO,as="ag-charts-annotations__axis-button",yf=class extends AO{constructor(t,e,i,o){super(),this.ctx=t,this.axisCtx=e,this.onButtonClick=i,this.seriesRect=o,this.enabled=!0,this.snap=!1,this.padding=0;const{button:s,wrapper:a}=this.setup();this.wrapper=a,this.button=s,this.toggleVisibility(!1),this.updateButtonElement(),this.snap=!!e.scale.bandwidth;const n=this.ctx.regionManager.getRegion("series"),r=Xa.Default|Xa.Annotations|Xa.AnnotationsSelected;t.domManager.addEventListener("focusin",({target:l})=>{const c=l instanceof HTMLElement?l:void 0;!(c&&t.domManager.contains(c,"series-area"))&&c!==this.button.getElement()&&this.hide()}),this.destroyFns.push(n.addListener("hover",l=>this.show(l),r),n.addListener("drag",l=>this.show(l),Xa.Annotations|Xa.AnnotationsSelected),n.addListener("leave",()=>this.hide(),r),t.highlightManager.addListener("highlight-change",l=>this.onHighlightChange(l)),t.keyNavManager.addListener("nav-hori",()=>this.onKeyPress()),t.keyNavManager.addListener("nav-vert",()=>this.onKeyPress()),t.zoomManager.addListener("zoom-pan-start",()=>this.hide()),t.zoomManager.addListener("zoom-change",()=>this.hide()),()=>this.destroyElements(),()=>this.wrapper.remove(),()=>this.button.destroy())}update(t,e){this.seriesRect=t,this.padding=e}setup(){const t=this.ctx.domManager.addChild("canvas-overlay",`${as}-${this.axisCtx.axisId}`);t.classList.add(`${as}-wrapper`);const e=new kO.ButtonWidget;return e.addClass(as),e.setTabIndex(-1),e.setAriaLabel(this.ctx.localeManager.t("ariaLabelAddHorizontalLine")),t.appendChild(e.getElement()),{wrapper:t,button:e}}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",as)}show(t){const{canvasX:e,canvasY:i}=t;if(!(this.enabled&&this.seriesRect.containsPoint(e,i))){this.hide();return}this.toggleVisibility(!0);const o=this.getButtonCoordinates({x:e,y:i});this.coords=this.getAxisCoordinates(o),this.updatePosition(o)}hide(){this.toggleVisibility(!1)}onHighlightChange(t){t.currentHighlight||this.hide()}onKeyPress(){this.snap||this.hide()}getButtonCoordinates({x:t,y:e}){const{axisCtx:{direction:i,position:o},seriesRect:s,snap:a,axisCtx:n,padding:r}=this,{clientWidth:l,clientHeight:c}=this.button,[h,p]=[s.y,s.y+s.height],[u,g]=[s.x,s.x+s.width];if(a&&(t=Qo(Va(t-s.x,n),n)+s.x,e=Qo(Va(e-s.y,n),n)+s.y),i===TO.X){const f=c-Math.max(0,r-5);t=t-l/2,e=o==="top"?h-c+f:p-f}else{const f=l-Math.max(0,r-9);t=o==="left"?u-l+f:g-f,e=e-c/2}return{x:t,y:e}}getAxisCoordinates(t){const{seriesRect:e}=this,{clientWidth:i,clientHeight:o}=this.button,s=t.x-e.x+i/2,a=t.y-e.y+o/2;return{x:s,y:a}}toggleVisibility(t){const{button:e}=this;if(e==null)return;const i=this.enabled&&t;this.toggleClass("-hidden",!i)}toggleClass(t,e){this.wrapper.classList.toggle(`${as}-wrapper-${t}`,e)}updatePosition({x:t,y:e}){this.wrapper.style.transform=`translate(${Math.round(t)}px, ${Math.round(e)}px)`}updateButtonElement(){const{button:t}=this;t.addListener("click",()=>this.onButtonClick(this.coords)),t.addListener("drag-start",()=>{}),t.setInnerHTML(`<span class="${OO("zoom-in")} ${as}-icon"></span>`)}};d([DO(IO)],yf.prototype,"enabled",2);import{_ModuleSupport as LO}from"ag-charts-community";import{_ModuleSupport as NO}from"ag-charts-community";var{Color:ff,DraggablePopover:CO,NativeWidget:Bh,Vec2:Rt,createButton:Rr,createCheckbox:RO,createElement:ji,createElementId:mf,createSelect:EO,createTextArea:wO,initRovingTabIndex:xf,getIconClassNames:_O,getWindow:PO,mapValues:zh,setAttribute:BO,setAttributes:Fh}=NO,Sf=class ju extends CO{constructor(e,i){super(e,i),this.dragHandleDraggingClass="ag-charts-dialog__drag-handle--dragging",this.colorPicker=new ry(this.ctx,{detached:!0}),this.destroyFns.push(e.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(e,i){const o=super.showWithChildren(e,i);return o.classList.add("ag-charts-dialog"),o.setAttribute("role","dialog"),o.addEventListener("mousedown",s=>{s.target.classList?.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),o.addEventListener("keydown",this.onKeyDown.bind(this)),PO().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),o}updatePosition(e){super.updatePosition(e);const{anchor:i,fallbackAnchor:o}=this.getColorPickerAnchors()??{};i&&this.colorPicker.setAnchor(i,o)}createTabs(e,i,o){const s=ji("div","ag-charts-dialog__tabs"),a=zh(o,()=>mf("ag-charts-dialog__tab")),n=zh(o,()=>mf("ag-charts-dialog__tab-panel"));for(const[g,y]of Object.entries(o))Fh(y.panel,{id:n[g],role:"tabpanel","aria-labelledby":a[g]});const r=g=>{for(const[y,f]of Object.entries(o))f.panel.classList.toggle("ag-charts-dialog__tab-panel--active",y===g),h[y].classList.toggle("ag-charts-dialog__tab-button--active",y===g),BO(h[y],"aria-selected",y===g),y===g&&f.onShow?.()},l=new Bh(ji("div","ag-charts-dialog__header"));l.addListener("drag-start",g=>{const{sourceEvent:y}=g;y.target instanceof Element&&y.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(g)}),l.addListener("drag-move",g=>this.onDragMove(g)),l.addListener("drag-end",()=>this.onDragEnd());const c=new FO;this.setDragHandle(c);const h=zh(o,(g,y)=>Rr({label:this.ctx.localeManager.t(g.label),onPress:()=>r(y)},{id:a[y],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":n[y]})),p=ji("div","ag-charts-dialog__tab-list");Fh(p,{role:"tablist","aria-label":this.ctx.localeManager.t(e)}),p.append(...Object.values(h));const u=this.createHeaderCloseButton();return l.getElement().append(c.getElement(),p,u),s.append(l.getElement(),...Object.values(o).map(g=>g.panel)),r(i),xf({orientation:"horizontal",buttons:Object.values(h)}),{tabs:s,initialFocus:h[i]}}createTabPanel(){return ji("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return ji("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:e,options:i,value:o,onChange:s}){const a=this.createInputGroup(e);Fh(a,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(e)});const n="ag-charts-dialog__button--active",r=[];for(const l of i){const{icon:c,altText:h}=l,p=this.ctx.localeManager.t(h),u=Rr({icon:c,altText:p,onPress:()=>{for(const g of Array.from(a.children))g.classList.remove(n),g.ariaChecked="false";u.classList.add(n),u.ariaChecked="true",s(l.value)}},{"aria-checked":l.value===o,class:"ag-charts-dialog__button",role:"radio",title:p});l.value===o&&u.classList.add(n),a.appendChild(u),r.push(u)}return xf({orientation:"horizontal",buttons:r}),a}createSelect({altText:e,label:i,options:o,value:s,onChange:a}){const n=this.createInputGroup(i),r=this.ctx.localeManager.t(e),l=EO({value:s,options:o,onChange:a},{class:"ag-charts-dialog__select","aria-label":r,title:r});return n.append(l),n}createTextArea({placeholder:e,value:i,onChange:o}){const s=e?this.ctx.localeManager.t(e):void 0;return wO({value:i,onChange:o},{placeholder:s})}createCheckbox({label:e,checked:i,onChange:o}){const s=`ag-charts__${e}`,a=this.createInputGroup(e,{for:s}),n=RO({checked:i,onChange:o},{class:"ag-charts-dialog__checkbox",role:"switch",id:s});return a.append(n),a}createColorPicker({color:e,opacity:i,label:o,altText:s,onChange:a,onChangeHide:n,isMultiColor:r,hasMultiColorOption:l}){const c=this.createInputGroup(o),h=this.ctx.localeManager.t(s),p=Rr({label:h,onPress:u=>{const{anchor:g,fallbackAnchor:y}=this.getColorPickerAnchors(p)??{};this.colorPicker.show({anchor:g,fallbackAnchor:y,color:e,opacity:i,isMultiColor:r,hasMultiColorOption:l,sourceEvent:u,onChange:(f,m,S,b)=>{p.style.setProperty("--color",f),p.classList.toggle("ag-charts-dialog__color-picker-button--multi-color",b),a(f,m,S,b)},onChangeHide:n})}},{"aria-label":h,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:h});if(r)p.classList.toggle("ag-charts-dialog__color-picker-button--multi-color");else if(e){const u=ff.fromHexString(e),g=new ff(u.r,u.g,u.b,i);p.style.setProperty("--color",g.toHexString())}return c.append(p),this.hideFns.push(()=>{this.colorPicker.hide()}),c}createHeaderCloseButton(){return Rr({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(e,i){const o=ji("div","ag-charts-dialog__input-group"),s=ji("label","ag-charts-dialog__input-group-label");return s.innerText=this.ctx.localeManager.t(e),i?.for&&s.setAttribute("for",i.for),o.appendChild(s),o}onLayoutComplete(e){this.seriesRect=e.series.paddedRect,this.reposition()}onKeyDown(e){e.altKey||e.ctrlKey||e.metaKey||e.isComposing||e.key!=="Escape"||this.hide()}reposition(){const{seriesRect:e,ctx:i}=this,o=i.domManager.getBoundingClientRect(),s=this.getPopoverElement();if(!e||!s)return;const a=Rt.from(0,e.y),n=Rt.from(o.width,e.height),r=Rt.from(s),l=Rt.from(.5,1);let c;if(e.width>1e3){const h=Rt.sub(Rt.add(a,Rt.multiply(n,l)),Rt.multiply(r,l));c=Rt.sub(h,Rt.from(0,ju.offset))}else{const h=Rt.sub(Rt.add(a,n),r);c=Rt.sub(h,ju.offset)}this.updatePosition(c)}getColorPickerAnchors(e){if(e&&(this.colorPickerAnchorElement=e),!this.colorPickerAnchorElement)return;const i=this.colorPickerAnchorElement.getBoundingClientRect(),o=this.ctx.domManager.getBoundingClientRect(),s=Rt.sub(Rt.from(i.x,i.y),Rt.from(o.left,o.top)),a=Rt.add(s,Rt.from(0,i.height+5)),n=Rt.sub(s,Rt.from(0,5));return{anchor:a,fallbackAnchor:n}}};Sf.offset=60;var zO=Sf,FO=class extends Bh{constructor(){super(ji("div","ag-charts-dialog__drag-handle"));const t=new Bh(ji("span",_O("drag-handle")));t.setAriaHidden(!0),this.addChild(t)}},{Listeners:VO,focusCursorAtEnd:GO}=LO,WO=class extends zO{constructor(t){super(t,"settings"),this.events=new VO,this.hideFns.push(()=>this.events.dispatch("hidden"))}addListener(t,e){return this.events.addListener(t,e)}show(t,e){const i=this.createLinearLineTab(t,e),o=this.createLinearTextTab(t,e);let s="dialogHeaderLine";Hi(t)?s="dialogHeaderChannel":iy(t)?s="dialogHeaderFibonacciRange":t.type==="date-range"?s="dialogHeaderDateRange":t.type==="price-range"?s="dialogHeaderPriceRange":t.type==="date-price-range"&&(s="dialogHeaderDatePriceRange");const{tabs:a,initialFocus:n}=this.createTabs("ariaLabelSettingsTabBar",e.initialSelectedTab,{line:{label:s,panel:i},text:{label:"dialogHeaderText",panel:o.panel,onShow:o.onShow}});e.initialFocus=n,this.showWithChildren([a],e).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(t,e){const i=this.createTabPanel(),o=this.createInputGroupLine(),s=this.createInputGroupLine(),a="isMultiColor"in t,n=this.createColorPickerInput("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),a?t.isMultiColor:!1,a,e.onChangeLineColor,e.onChangeHideLineColor),r=this.createStrokeWidthSelect(t.strokeWidth??2,e.onChangeLineStyleWidth),l=this.createLineStyleRadioGroup(t.lineStyle??"solid",e.onChangeLineStyleType);if(o.append(n),"background"in t){const c=this.createColorPickerInput("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),!1,!1,e.onChangeFillColor,e.onChangeHideFillColor);o.append(c),s.append(r)}else"showFill"in t?(o.append(this.createCheckbox({label:"dialogInputShowFill",checked:t.showFill??!0,onChange:c=>e.onChangeLine({showFill:c})})),s.append(r)):o.append(r);return s.append(l),i.append(o,s),"bands"in t&&i.append(this.createFibonacciRatioSelect(t.bands??10,c=>e.onChangeLine({bands:c}))),"extendStart"in t&&"extendEnd"in t&&i.append(this.createCheckbox({label:Hi(t)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:t.extendStart??!1,onChange:c=>e.onChangeLine({extendStart:c})}),this.createCheckbox({label:Hi(t)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:t.extendEnd??!1,onChange:c=>e.onChangeLine({extendEnd:c})})),"extendAbove"in t&&"extendBelow"in t&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:t.extendAbove??!1,onChange:c=>e.onChangeLine({extendAbove:c})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:t.extendBelow??!1,onChange:c=>e.onChangeLine({extendBelow:c})})),"extendLeft"in t&&"extendRight"in t&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:t.extendLeft??!1,onChange:c=>e.onChangeLine({extendLeft:c})}),this.createCheckbox({label:"dialogInputExtendRight",checked:t.extendRight??!1,onChange:c=>e.onChangeLine({extendRight:c})})),"reverse"in t&&"showFill"in t&&i.append(this.createCheckbox({label:"dialogInputReverse",checked:t.reverse??!1,onChange:c=>e.onChangeLine({reverse:c})})),i}createLinearTextTab(t,e){const i=this.createTabPanel(),o=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:t.text.label,onChange:p=>e.onChangeText({label:p})}),s=this.createInputGroupLine(),a=this.createFontSizeSelect(t.text.fontSize,e.onChangeTextFontSize),n=this.createColorPickerInput("text-color",t.text.color,1,!1,!1,e.onChangeTextColor,e.onChangeHideTextColor);s.append(a,n);const r=this.createInputGroupLine(),l=t.text.position==="inside"?"center":t.text.position,c=this.createPositionRadioGroup(l??"top",p=>e.onChangeText({position:p})),h=this.createAlignmentRadioGroup(t.text.alignment??"center",p=>e.onChangeText({alignment:p}));return r.append(c,h),i.append(o,s,r),{panel:i,onShow:()=>GO(o)}}createColorPickerInput(t,e,i,o,s,a,n){const r=t==="fill-color"?"dialogInputFillColorPicker":"dialogInputColorPicker",l=t==="fill-color"?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText";return this.createColorPicker({label:r,altText:l,color:e,opacity:i,isMultiColor:o,hasMultiColorOption:s,onChange:a,onChangeHide:n})}createStrokeWidthSelect(t,e){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:ly.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(t),onChange:i=>e(Number(i))})}createFibonacciRatioSelect(t,e){return this.createSelect({label:"dialogInputFibonacciBands",altText:"dialogInputFibonacciBandsAltText",options:SI.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(t),onChange:i=>e(Number(i))})}createLineStyleRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:t,onChange:e})}createFontSizeSelect(t,e){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:cy.map(({label:i,value:o})=>({label:i,value:String(o)})),value:String(t),onChange:i=>e(Number(i))})}createPositionRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:t,onChange:e})}createAlignmentRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:t,onChange:e})}};function Vh(t){return t.gridPadding+t.seriesAreaPadding+t.tickSize+t.label.spacing}function UO(t,e,i){for(const{update:o}of Object.values(Ce))o(t,e,i)}var{BOOLEAN:HO,OBJECT:Gh,ChartUpdateType:KO,InteractionState:Ai,ObserveChanges:YO,PropertiesArray:jO,Validate:Er,ChartAxisDirection:XO,Vec2:ns,isValidDate:Wh,keyProperty:ZO,valueProperty:$O,Selection:QO,BBox:qO}=jn,Za=class CM extends jn.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,this.toolbar=new Ph(this.ctx),this.optionsToolbar=new dh(this.ctx,()=>{const i=this.state.getActive();if(i!=null)return ss(this.annotationData.at(i))}),this.axesButtons=new zc,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new jO(CM.createAnnotationDatum),this.defaults=new gI,this.container=new jn.Group({name:"static-annotations"}),this.annotations=new QO(this.container,this.createAnnotationScene.bind(this)),this.settingsDialog=new WO(this.ctx),this.textInput=new xA(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.setupDOM(),this.ctx.historyManager.addMementoOriginator(e.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this))}setupStateMachine(){const{ctx:e}=this;return new Cr({resetToIdle:()=>{e.cursorManager.updateCursor("annotations"),e.interactionManager.popState(Ai.Annotations),e.tooltipManager.unsuppressTooltip("annotations"),this.hideOverlays(),this.optionsToolbar.hide(),this.deleteEphemeralAnnotations(),this.update()},hoverAtCoords:(i,o)=>{let s;return this.annotations.each((a,n,r)=>{const l=a.containsPoint(i.x,i.y);l&&(s??(s=r)),a.toggleHovered(l||o===r)}),this.ctx.cursorManager.updateCursor("annotations",s==null?void 0:this.annotations.at(s)?.getCursor()),s},getNodeAtCoords:(i,o)=>{const s=this.annotations.at(o);if(s)return s.getNodeAtCoords(i.x,i.y)},translate:(i,o)=>{const s=this.annotations.at(i),a=ss(this.annotationData.at(i));if(!(!s||!a))return this.translateNode(s,a,o)},copy:i=>{const o=this.annotations.at(i),s=ss(this.annotationData.at(i));if(!(!o||!s))return this.createAnnotationDatumCopy(o,s)},paste:i=>{this.createAnnotation(i.type,i,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(i,o)=>{const{annotations:s,optionsToolbar:a,toolbar:n,ctx:{interactionManager:r,tooltipManager:l}}=this;this.hideOverlays(),n.clearActiveButton(),n.resetButtonIcons();const c=i!=null?s.at(i):null,h=o!=null?s.at(o):null;h===c&&c!=null||(h?.toggleActive(!1),a.hide(),c?(r.pushState(Ai.AnnotationsSelected),c.toggleActive(!0),l.suppressTooltip("annotations"),a.updateButtons(this.annotationData.at(i)),this.postUpdateFns.push(()=>{a.show(),a.setAnchorScene(c)})):(r.popState(Ai.AnnotationsSelected),r.popState(Ai.Annotations),l.unsuppressTooltip("annotations")),this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.ctx.interactionManager.pushState(Ai.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.ctx.interactionManager.pushState(Ai.Annotations)},stopInteracting:()=>{this.ctx.interactionManager.popState(Ai.Annotations)},create:(i,o)=>{this.createAnnotation(i,o)},delete:i=>{this.annotationData.splice(i,1)},deleteAll:()=>{this.annotationData.splice(0,this.annotationData.length)},validatePoint:i=>{const o=this.getAnnotationContext();return o?Je(o,i):!0},getAnnotationType:i=>IA(this.annotationData[i].type),datum:i=>this.annotationData.at(i),node:i=>this.annotations.at(i),recordAction:i=>{this.recordActionAfterNextUpdate(i)},update:()=>{this.postUpdateFns.push(()=>{const i=this.state.getActive(),o=i!=null?this.annotations.at(i):null;o!=null&&this.optionsToolbar.setAnchorScene(o)}),this.update()},showTextInput:i=>{const o=ss(this.annotationData.at(i));if(!this.annotations.at(i)||!o||!("getTextInputCoords"in o)||!("getTextPosition"in o))return;const a={color:o.color,fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight,placeholderColor:o.getPlaceholderColor()},n=this.getAnnotationContext(),r=c=>ns.add(o.getTextInputCoords(n,c),ns.required(this.seriesRect)),l=()=>o.getTextPosition();this.textInput.show({styles:a,layout:{getTextInputCoords:r,getTextPosition:l,alignment:o.alignment,textAlign:o.textAlign,width:o.width},text:o.text,placeholderText:o.placeholderText,onChange:(c,h)=>{this.state.transition("updateTextInputBBox",h)}}),this.ctx.cursorManager.updateCursor("annotations")},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:i=>{this.textInput.updateColor(i)},updateTextInputFontSize:i=>{const o=this.textInput.updateFontSize(i);this.state.transition("updateTextInputBBox",o)},updateTextInputBBox:i=>{this.state.transition("updateTextInputBBox",i)},showAnnotationOptions:i=>{const o=this.annotations.at(i);!o||yo(this.annotationData.at(i))||(this.optionsToolbar.updateButtons(this.annotationData.at(i)),this.optionsToolbar.show(),this.optionsToolbar.setAnchorScene(o))},showAnnotationSettings:(i,o,s="line")=>{const a=this.annotationData.at(i);if(!rr(a)&&!Hi(a)&&!Ua(a)||yo(a))return;const n=c=>(h,p,u,g)=>{this.setColorAndDefault(a.type,c,h,p,u,g),this.optionsToolbar.updateColorPickerColor(c,p,u,g)},r=c=>()=>{this.recordActionAfterNextUpdate(`Change ${a.type} ${c} to ${a.getDefaultColor(c)}`,["annotations","defaults"]),this.update()},l={initialSelectedTab:s,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:o,onChangeLine:c=>{this.state.transition("lineProps",c),c.bands&&this.defaults.setDefaultFibonacciBands(a.type,c.bands)},onChangeText:c=>{this.state.transition("lineText",c),c.alignment&&this.defaults.setDefaultLineTextAlignment(a.type,c.alignment),c.position&&this.defaults.setDefaultLineTextPosition(a.type,c.position),this.recordActionAfterNextUpdate(`Change ${a.type} text ${Object.entries(c).map(([h,p])=>`${h} to ${p}`).join(", ")}`)},onChangeFillColor:n("fill-color"),onChangeHideFillColor:r("fill-color"),onChangeLineColor:n("line-color"),onChangeHideLineColor:r("line-color"),onChangeLineStyleType:c=>{this.setLineStyleTypeAndDefault(a.type,c),this.optionsToolbar.updateLineStyleType(Ha.find(h=>h.value===c)??Ha[0])},onChangeLineStyleWidth:c=>{this.setLineStyleWidthAndDefault(a.type,c),this.optionsToolbar.updateStrokeWidth({strokeWidth:c,value:c,label:String(c)})},onChangeTextColor:n("text-color"),onChangeHideTextColor:r("text-color"),onChangeTextFontSize:c=>{this.setFontSizeAndDefault(a.type,c)}};this.settingsDialog.show(a,l)}})}setupListeners(){const{ctx:e,optionsToolbar:i,settingsDialog:o,toolbar:s}=this,{All:a,Default:n,Annotations:r,AnnotationsSelected:l,ZoomDrag:c}=Ai,h=e.regionManager.getRegion("series"),p=e.regionManager.getRegion("root"),u=n|c|r|l;this.destroyFns.push(h.addListener("hover",this.onHover.bind(this),a),h.addListener("click",this.onClick.bind(this),a),h.addListener("dblclick",this.onDoubleClick.bind(this),a),h.addListener("drag-start",this.onDragStart.bind(this),u),h.addListener("drag",this.onDrag.bind(this),u),h.addListener("drag-end",this.onDragEnd.bind(this),a),e.interactionManager.addListener("keydown",this.onKeyDown.bind(this),a),e.interactionManager.addListener("keyup",this.onKeyUp.bind(this),a),p.addListener("click",this.onCancel.bind(this),a),e.annotationManager.addListener("restore-annotations",this.onRestoreAnnotations.bind(this)),e.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),e.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),e.zoomManager.addListener("zoom-change",()=>this.onResize()),e.domManager.addListener("resize",()=>this.onResize()),s.addListener("cancel-create-annotation",()=>{this.cancel(),this.reset(),this.update()}),s.addListener("pressed-create-annotation",({annotation:g})=>{this.cancel(),this.ctx.interactionManager.pushState(Ai.Annotations),this.state.transition(g),this.update()}),s.addListener("pressed-clear",()=>{this.clear()}),s.addListener("pressed-show-menu",()=>{this.cancel(),this.reset()}),s.addListener("pressed-unrelated",()=>{this.reset()}),i.addListener("pressed-delete",()=>{this.cancel(),this.delete(),this.reset()}),i.addListener("pressed-settings",({sourceEvent:g})=>{this.state.transition("toolbarPressSettings",g)}),i.addListener("pressed-lock",()=>{this.update()}),i.addListener("hid-overlays",()=>{this.settingsDialog.hide()}),i.addListener("saved-color",({type:g,colorPickerType:y,color:f})=>{this.recordActionAfterNextUpdate(`Change ${g} ${y} to ${f}`,["annotations","defaults"])}),i.addListener("updated-color",({type:g,colorPickerType:y,colorOpacity:f,color:m,opacity:S,isMultiColor:b})=>{this.setColorAndDefault(g,y,f,m,S,b)}),i.addListener("updated-font-size",({type:g,fontSize:y})=>{this.setFontSizeAndDefault(g,y)}),i.addListener("updated-line-style",({type:g,lineStyleType:y})=>{this.setLineStyleTypeAndDefault(g,y)}),i.addListener("updated-line-width",({type:g,strokeWidth:y})=>{this.setLineStyleWidthAndDefault(g,y)}),o.addListener("hidden",()=>{this.optionsToolbar.clearActiveButton()}))}setupDOM(){const{ctx:e,toolbar:i}=this;this.destroyFns.push(e.annotationManager.attachNode(this.container),()=>e.domManager.removeStyles(as),()=>i.destroy())}async processData(e){if(!this.enabled||this.data==null||this.xKey==null||this.volumeKey==null)return;const i=[ZO(this.xKey,void 0,{id:"date"}),$O(this.volumeKey,"number",{id:"volume"})],{dataModel:o,processedData:s}=await e.request("annotations",this.data,{props:i});this.dataModel=o,this.processedData=s}createAnnotationScene(e){if(e.type in Ce)return new Ce[e.type].scene;throw new Error(`AG Charts - Cannot create annotation scene of type [${e.type}], expected one of [${Object.keys(Ce)}], ignoring.`)}static createAnnotationDatum(e){if(e.type in Ce)return new Ce[e.type].datum().set(e);throw new Error(`AG Charts - Cannot create annotation datum of unknown type [${e.type}], expected one of [${Object.keys(Ce)}], ignoring.`)}createAnnotation(e,i,o=!0){if(this.annotationData.push(i),o){const s=this.ctx.annotationManager.getAnnotationTypeStyles(e);s&&i.set(s),this.defaults.applyDefaults(i)}this.injectDatumDependencies(i),this.update()}injectDatumDependencies(e){"setLocaleManager"in e&&e.setLocaleManager(this.ctx.localeManager),"getVolume"in e&&(e.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(e,i){const{dataModel:o,processedData:s}=this;if(!Wh(e)||!Wh(i)||!o||!s||this.volumeKey==null)return;e>i&&([e,i]=[i,e]);const a=o.resolveKeysById({id:"annotations"},"date",s),n=o.resolveColumnById({id:"annotations"},"volume",s);return s.rawData.reduce((r,l,c)=>{const h=a[c];return Wh(h)&&h>=e&&h<=i?r+n[c]:r},0)}translateNode(e,i,o){const s=this.getAnnotationConfig(i),a=this.getAnnotationContext();a&&s.translate(e,i,o,a)}createAnnotationDatumCopy(e,i){const o=this.getAnnotationConfig(i),s=new o.datum;s.set(i.toJson());const a=this.getAnnotationContext();if(a)return o.copy(e,i,s,a)}getAnnotationConfig(e){if(e.type in Ce)return Ce[e.type];throw new Error(`AG Charts - Cannot get annotation config of unknown type [${e.type}], expected one of [${Object.keys(Ce)}], ignoring.`)}onRestoreAnnotations(e){this.enabled&&(this.clear(),this.annotationData.set(e.annotations),this.update())}onLayoutComplete(e){const i=e.series.paddedRect;this.seriesRect=i;for(const o of e.axes??[])o.direction===jn.ChartAxisDirection.X?this.xAxis=this.getAxis(o,i,this.xAxis?.button):this.yAxis=this.getAxis(o,i,this.yAxis?.button)}onPreRender(){this.updateAnnotations(),this.state.transition("render")}getAxis(e,i,o){const s=this.ctx.axisManager.getAxisContext(e.direction)[0],{position:a="bottom",direction:n}=s,r=e.gridPadding+e.seriesAreaPadding,l=new qO(0,0,i.width,i.height).grow(r,a),c=s.direction===XO.X?"vertical":"horizontal",{axesButtons:h}=this;if(this.enabled&&h.enabled&&(h.axes==="xy"||h.axes===n)){o??(o=new yf(this.ctx,s,g=>this.onAxisButtonClick(g,c),i));const u=Vh(e);o.update(i,u)}else o?.destroy(),o=void 0;return{layout:e,context:s,bounds:l,button:o}}recordActionAfterNextUpdate(e,i=["annotations"]){const{defaults:o,ctx:{annotationManager:s,historyManager:a}}=this,n=i.map(r=>r==="defaults"?o:s);this.postUpdateFns.push(()=>{a.record(e,...n)})}setColorAndDefault(e,i,o,s,a,n){this.state.transition("color",{colorPickerType:i,colorOpacity:o,color:s,opacity:a,isMultiColor:n}),this.defaults.setDefaultColor(e,i,o,s,a,n)}setFontSizeAndDefault(e,i){this.state.transition("fontSize",i),this.defaults.setDefaultFontSize(e,i),this.recordActionAfterNextUpdate(`Change ${e} font size to ${i}`,["annotations","defaults"])}setLineStyleTypeAndDefault(e,i){this.state.transition("lineStyle",{type:i}),this.defaults.setDefaultLineStyleType(e,i),this.recordActionAfterNextUpdate(`Change ${e} line style to ${i}`,["annotations","defaults"])}setLineStyleWidthAndDefault(e,i){this.state.transition("lineStyle",{strokeWidth:i}),this.defaults.setDefaultLineStyleWidth(e,i),this.recordActionAfterNextUpdate(`Change ${e} stroke width to ${i}`,["annotations","defaults"])}updateAnnotations(){const{annotationData:e,annotations:i,seriesRect:o,ctx:{annotationManager:s}}=this,a=this.getAnnotationContext();!o||!a||(s.updateData(e.toJson().filter(n=>!yo(n))),this.toolbar.toggleClearButtonEnabled(e.length>0),i.update(e??[],void 0,n=>n.id).each((n,r)=>{if(!this.validateDatum(r)){n.visible=!1;return}this.injectDatumDependencies(r),UO(n,r,a)}),this.postUpdateFns.forEach(n=>n()),this.postUpdateFns=[])}validateDatum(e){const i=this.getAnnotationContext();return i?e.isValidWithContext(i,`Annotation [${e.type}] `):!0}getAnnotationContext(){const{seriesRect:e,xAxis:i,yAxis:o}=this;if(e&&i&&o)return{seriesRect:e,xAxis:{...i.context,bounds:i.bounds,labelPadding:Vh(i.layout)},yAxis:{...o.context,bounds:o.bounds,labelPadding:Vh(i.layout)}}}onHover(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=e.sourceEvent.shiftKey,a=ns.from(e),n=St(a,o);i.transition("hover",{offset:a,point:n,shiftKey:s,context:o})}onClick(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=e.sourceEvent.shiftKey,a=St(ns.from(e),o),n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("click",{point:a,shiftKey:s,textInputValue:n,bbox:r})}onDoubleClick(e){const{state:i}=this;if(!this.getAnnotationContext())return;const s=ns.from(e);i.transition("dblclick",{offset:s})}onAxisButtonClick(e,i){this.cancel(),this.reset();const o=this.getAnnotationContext();if(!this.annotationData||!o)return;const{state:s,ctx:{interactionManager:a}}=this;a.pushState(Ai.Annotations);const n=i==="horizontal";if(s.transition(n?"horizontal-line":"vertical-line"),this.optionsToolbar.hide(),!e)return;const r=St(e,o);Je(o,r)&&(s.transition("click",{point:r,shiftKey:!1}),this.update())}onResize(){const e=this.textInput.getValue(),i=this.textInput.getBBox();this.state.transition("resize",{textInputValue:e,bbox:i})}onDragStart(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=ns.from(e),a=St(s,o),n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("dragStart",{context:o,offset:s,point:a,textInputValue:n,bbox:r})}onDrag(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const s=ns.from(e),a=St(s,o),n=e.sourceEvent.shiftKey,r=this.textInput.getValue(),l=this.textInput.getBBox();i.transition("drag",{context:o,offset:s,point:a,shiftKey:n,textInputValue:r,bbox:l})}onDragEnd(){this.state.transition("dragEnd")}onCancel(){this.cancel(),this.reset()}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const{key:s,shiftKey:a}=e,n=this.textInput.getValue(),r=this.textInput.getBBox();i.transition("textInput",{key:s,shiftKey:a,textInputValue:n,bbox:r,context:o})}onKeyDown(e){const{state:i}=this,o=this.getAnnotationContext();if(!o)return;const{sourceEvent:s}=e,{shiftKey:a,ctrlKey:n,metaKey:r}=s,l=n||r,c=n||a;this.state.transition("keyDown",{shiftKey:a,context:o});const h={x:0,y:0},p=Math.max(o?.xAxis.scale.bandwidth??0,c?10:1),u=Math.max(o?.yAxis.scale.bandwidth??0,c?10:1);switch(s.key){case"ArrowDown":h.y=u;break;case"ArrowUp":h.y=-u;break;case"ArrowLeft":h.x=-p;break;case"ArrowRight":h.x=p;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((h.x||h.y)&&(i.transition("translate",{translation:h}),s.stopPropagation(),s.preventDefault()),!!l)switch(s.key){case"c":i.transition("copy");return;case"x":i.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":i.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(e){const{shiftKey:i}=e.sourceEvent,o=this.getAnnotationContext();o&&(this.state.transition("keyUp",{shiftKey:i,context:o}),this.state.transition("translateEnd"))}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){for(const[e,i]of this.annotationData.entries())yo(i)&&this.annotationData.splice(e,1)}hideOverlays(){this.settingsDialog.hide(),this.toolbar.hideOverlays(),this.optionsToolbar.hideOverlays()}update(e=KO.PRE_SCENE_RENDER){this.ctx.updateService.update(e,{skipAnimations:!0})}};d([YO((t,e,i)=>{const{ctx:{annotationManager:o,stateManager:s}}=t;e!==i&&(t.toolbar?.toggleVisibility(!!e),i===!1&&e===!0?s.restoreState(o):e===!1&&t.clear())}),Er(HO)],Za.prototype,"enabled",2),d([Er(Gh)],Za.prototype,"toolbar",2),d([Er(Gh)],Za.prototype,"optionsToolbar",2),d([Er(Gh)],Za.prototype,"axesButtons",2);var JO=Za;import{_ModuleSupport as t0}from"ag-charts-community";var{ThemeSymbols:nt}=t0,ii={stroke:nt.DEFAULT_ANNOTATION_COLOR,strokeOpacity:1,strokeWidth:2},ae={fill:nt.DEFAULT_ANNOTATION_HANDLE_FILL,strokeOpacity:1,strokeWidth:2},$a={color:nt.DEFAULT_TEXT_ANNOTATION_COLOR,fontSize:14,fontFamily:nt.DEFAULT_FONT_FAMILY},bf={...$a,enabled:!0,color:"white",fill:nt.DEFAULT_ANNOTATION_COLOR,fontSize:12},wr={...$a,color:nt.DEFAULT_TEXT_ANNOTATION_COLOR,textAlign:"left"},To={...$a,position:"top",alignment:"center",color:nt.DEFAULT_ANNOTATION_COLOR},Uh={...$a,fontSize:12,color:nt.DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:nt.DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:nt.DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:nt.DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}},Hh={...ii,background:{fill:nt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...ae},text:{...To},statistics:{...Uh}},e0={buttons:[{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"fibonacci-retracement-drawing",tooltip:"toolbarAnnotationsFibonacciAnnotations",value:"fibonacci-menu"},{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"measurer-drawing",tooltip:"toolbarAnnotationsMeasurerAnnotations",value:"measurer-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}]},i0={buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color"},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color"},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color"},{tooltip:"toolbarAnnotationsTextSize",value:"text-size"},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width"},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type"},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings"},{icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]},o0={enabled:!1,line:{...ii,handle:{...ae},text:{...To}},"horizontal-line":{...ii,handle:{...ae},axisLabel:{...bf},text:{...To}},"vertical-line":{...ii,handle:{...ae},axisLabel:{...bf},text:{...To}},"disjoint-channel":{...ii,background:{fill:nt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...ae},text:{...To}},"parallel-channel":{...ii,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:nt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...ae},text:{...To}},"fibonacci-retracement":{...ii,strokes:nt.DEFAULT_FIBONACCI_STROKES,rangeStroke:nt.DEFAULT_ANNOTATION_COLOR,handle:{...ae},text:{...To,position:"center"},label:{...$a,color:void 0,fontSize:10}},callout:{...ii,...wr,color:nt.DEFAULT_LABEL_COLOUR,handle:{...ae},fill:nt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},comment:{...wr,color:"white",fontWeight:700,handle:{...ae},fill:nt.DEFAULT_ANNOTATION_COLOR},note:{...wr,color:nt.DEFAULT_TEXTBOX_COLOR,fill:nt.DEFAULT_ANNOTATION_COLOR,stroke:nt.DEFAULT_ANNOTATION_HANDLE_FILL,strokeWidth:1,strokeOpacity:1,handle:{...ae},background:{fill:nt.DEFAULT_TEXTBOX_FILL,stroke:nt.DEFAULT_TEXTBOX_STROKE,strokeWidth:1}},text:{...wr,handle:{...ae}},arrow:{...ii,handle:{...ae},text:{...To}},"arrow-up":{fill:nt.PALETTE_UP_FILL,handle:{...ae,stroke:nt.DEFAULT_ANNOTATION_COLOR}},"arrow-down":{fill:nt.PALETTE_DOWN_FILL,handle:{...ae,stroke:nt.DEFAULT_ANNOTATION_COLOR}},"date-range":{...Hh},"price-range":{...Hh},"date-price-range":{...Hh},"quick-date-price-range":{up:{...ii,fill:nt.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:{...ae},statistics:{...Uh,color:"#fff",fill:nt.DEFAULT_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...ii,stroke:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:{...ae,stroke:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE},statistics:{...Uh,color:"#fff",fill:nt.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{enabled:!0},toolbar:e0,optionsToolbar:i0},s0={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new JO(t),themeTemplate:{annotations:o0}};import{_ModuleSupport as Kh}from"ag-charts-community";import{_ModuleSupport as vf}from"ag-charts-community";var{BaseProperties:a0,ObserveChanges:n0,ProxyProperty:r0,Validate:rs,NUMBER:_r,POSITIVE_NUMBER:Mf,RATIO:l0,createElement:c0,calculatePlacement:h0}=vf,Di=class extends a0{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=c0("img"),this.imageElement.onload=this.onImageLoad,this.node=new vf.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(t,e){this.containerWidth=t,this.containerHeight=e;const i={x:0,y:0,width:t,height:e},o=h0(this.imageElement.width,this.imageElement.height,i,this);return this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...o}:{visible:!1}),o}};d([rs(_r,{optional:!0})],Di.prototype,"top",2),d([rs(_r,{optional:!0})],Di.prototype,"right",2),d([rs(_r,{optional:!0})],Di.prototype,"bottom",2),d([rs(_r,{optional:!0})],Di.prototype,"left",2),d([rs(Mf,{optional:!0})],Di.prototype,"width",2),d([rs(Mf,{optional:!0})],Di.prototype,"height",2),d([rs(l0)],Di.prototype,"opacity",2),d([r0("imageElement.src"),n0(t=>t.loadedSynchronously=t.complete)],Di.prototype,"url",2);var{ActionOnSet:d0,OBJECT:p0,Validate:u0}=Kh,kf=class extends Kh.Background{constructor(){super(...arguments),this.image=new Di}onLayoutComplete(t){if(super.onLayoutComplete(t),this.image){const{width:e,height:i}=t.chart;this.image.performLayout(e,i)}}onImageLoad(){this.ctx.updateService.update(Kh.ChartUpdateType.SCENE_RENDER)}};d([u0(p0,{optional:!0}),d0({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],kf.prototype,"image",2);var g0={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new kf(t)};import"ag-charts-community";import{_ModuleSupport as Af}from"ag-charts-community";var{BOOLEAN:y0,ActionOnSet:f0,LayoutElement:m0,Logger:x0,Menu:S0,Validate:b0}=Af,Yh=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],Df=class extends Af.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.menu=new S0(this.ctx,"chart-toolbar"),this.toolbar=t.sharedToolbar.getSharedToolbar("chartToolbar"),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPressed.bind(this)),t.layoutManager.registerElement(m0.ToolbarLeft,this.onLayoutStart.bind(this)),()=>this.toolbar.destroy())}onLayoutStart(t){this.enabled&&(this.updateButton(),this.toolbar.layout(t.layoutBox))}onButtonPressed({event:t,buttonBounds:e}){this.menu.setAnchor({x:e.x+e.width+6,y:e.y}),this.menu.show({items:Yh,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),class:"ag-charts-chart-toolbar__menu",value:this.getChartType(),sourceEvent:t.sourceEvent,onPress:i=>{this.setChartType(i.value),this.hidePopover()},onHide:()=>{this.toolbar.clearActiveButton()}}),this.toolbar.toggleActiveButtonByIndex(0)}updateButton(){const t=this.getChartType(),e=Yh.find(i=>i.value===t)?.icon;e!=null&&this.toolbar.updateButtons([{icon:e,tooltip:"toolbarSeriesTypeDropdown"}])}hidePopover(){this.toolbar.clearActiveButton(),this.menu.hide()}setChartType(t){const e={chartType:t};this.ctx.chartService.publicApi?.updateDelta(e).catch(i=>x0.error(i))}getChartType(){const t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return t==null||!Yh.some(e=>e.value===t)?"candlestick":t}};d([b0(y0),f0({changeValue(t){this.toolbar?.setHidden(!t)}})],Df.prototype,"enabled",2);var v0={type:"root",optionsKey:"chartToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new Df(t)};import{_ModuleSupport as M0}from"ag-charts-community";import{_ModuleSupport as ta}from"ag-charts-community";var Pr="ag-charts-context-menu",Br="ag-charts-dark-context-menu",{BOOLEAN:If,Validate:Tf,createElement:jh,initMenuKeyNav:k0,makeAccessibleClickListener:A0,ContextMenuRegistry:Qa,Logger:Of}=ta,Xh="context-menu";function D0(t,e){const{children:i}=t??{};if(!i)return[];const o=[];for(const s of Array.from(i))s instanceof e&&o.push(s);return o}var Zh=class extends ta.BaseModuleInstance{constructor(t){if(super(),this.ctx=t,this.enabled=!0,this.darkTheme=!1,this.extraActions=[],this.extraNodeActions=[],this.extraSeriesAreaActions=[],this.extraLegendItemActions=[],this.pickedNode=void 0,this.showEvent=void 0,this.x=0,this.y=0,this.interactionManager=t.interactionManager,this.registry=t.contextMenuRegistry,this.groups={default:[],extra:[],extraSeriesArea:[],extraNode:[],extraLegendItem:[]},this.element=t.domManager.addChild("canvas-overlay",Xh),this.element.classList.add(Pr),this.element.addEventListener("contextmenu",e=>e.preventDefault()),this.destroyFns.push(()=>this.element.parentNode?.removeChild(this.element)),this.doClose(),this.destroyFns.push(t.domManager.addListener("hidden",()=>this.hide())),typeof MutationObserver<"u"){const e=new MutationObserver(()=>{this.menuElement&&this.element.contains(this.menuElement)&&this.reposition()});e.observe(this.element,{childList:!0}),this.mutationObserver=e,this.destroyFns.push(()=>e.disconnect())}this.destroyFns.push(this.registry.registerDefaultAction({id:"download",type:"all",label:"contextMenuDownload",action:()=>{const e=t.chartService.title;let i="image";e?.enabled&&e?.text!==void 0&&(i=e.text.replace(/\.+/,"")),this.ctx.chartService.publicApi?.download({fileName:i}).catch(o=>{Of.error("Unable to download chart",o)})}})),this.destroyFns.push(this.registry.addListener(e=>this.onContext(e)))}onContext(t){if(!this.enabled)return;t.preventDefault(),this.showEvent=t.sourceEvent,this.x=t.x,this.y=t.y,this.groups.default=this.registry.filterActions(t.type),this.pickedNode=void 0,this.pickedLegendItem=void 0,this.groups.extra=this.extraActions.map(({label:r,action:l})=>({type:"all",label:r,action:l})),this.groups.extraSeriesArea=[],this.groups.extraNode=[],Qa.check("series-area",t)&&(this.pickedNode=t.context.pickedNode,this.groups.extraSeriesArea=this.extraSeriesAreaActions.map(({label:r,action:l})=>({type:"series-area",label:r,action:l})),this.pickedNode&&(this.groups.extraNode=this.extraNodeActions.map(({label:r,action:l})=>({type:"node",label:r,action:l})))),this.groups.extraLegendItem=[],Qa.check("legend",t)&&(this.pickedLegendItem=t.context.legendItem,this.pickedLegendItem&&(this.groups.extraLegendItem=this.extraLegendItemActions.map(({label:r,action:l})=>({type:"legend",label:r,action:l}))));const{default:e,extra:i,extraSeriesArea:o,extraNode:s,extraLegendItem:a}=this.groups;[e,i,o,s,a].reduce((r,l)=>l.length+r,0)!==0&&this.show(t.sourceEvent)}show(t){this.interactionManager.pushState(ta.InteractionState.ContextMenu),this.element.classList.toggle(Br,this.darkTheme);const e=this.renderMenu();this.menuCloser?.close(),this.menuElement?this.element.replaceChild(e,this.menuElement):this.element.appendChild(e),this.menuElement=e,this.element.style.display="block";const i=D0(e,HTMLButtonElement);this.menuCloser=k0({menu:e,buttons:i,orientation:"vertical",sourceEvent:t,autoCloseOnBlur:!0,closeCallback:()=>this.doClose()})}hide(){this.menuCloser?.close()}doClose(){this.interactionManager.popState(ta.InteractionState.ContextMenu),this.menuElement&&(this.element.removeChild(this.menuElement),this.menuElement=void 0,this.menuCloser=void 0),this.element.style.display="none"}renderMenu(){const t=jh("div");return t.classList.add(`${Pr}__menu`),t.classList.toggle(Br,this.darkTheme),t.role="menu",this.appendMenuGroup(t,this.groups.default,!1),this.appendMenuGroup(t,this.groups.extra),this.appendMenuGroup(t,this.groups.extraSeriesArea),this.pickedNode&&this.appendMenuGroup(t,this.groups.extraNode),this.pickedLegendItem&&this.appendMenuGroup(t,this.groups.extraLegendItem),t}appendMenuGroup(t,e,i=!0){e.length!==0&&(i&&t.appendChild(this.createDividerElement()),e.forEach(o=>{const s=this.renderItem(o);s&&t.appendChild(s)}))}renderItem(t){if(t&&typeof t=="object"&&t.constructor===Object)return this.createActionElement(t)}createDividerElement(){const t=jh("div");return t.classList.add(`${Pr}__divider`),t.classList.toggle(Br,this.darkTheme),t.role="separator",t}createActionElement({id:t,label:e,type:i,action:o}){const s=!!(t&&this.registry.isDisabled(t));return this.createButtonElement(i,e,o,s)}createButtonOnClick(t,e){return Qa.checkCallback("legend",t,e)?i=>{if(this.pickedLegendItem){const{seriesId:o,itemId:s}=this.pickedLegendItem;e({type:"contextmenu",seriesId:o,itemId:s,event:i}),this.hide()}}:Qa.checkCallback("series-area",t,e)?()=>{e({type:"seriesContextMenuAction",event:this.showEvent}),this.hide()}:Qa.checkCallback("node",t,e)?()=>{const{pickedNode:i,showEvent:o}=this,s=i?.series.createNodeContextMenuActionEvent(o,i);s?e(s):Of.error("series node not found"),this.hide()}:()=>{e({type:"contextMenuEvent",event:this.showEvent}),this.hide()}}createButtonElement(t,e,i,o){const s=jh("button");return s.classList.add(`${Pr}__item`),s.classList.toggle(Br,this.darkTheme),s.ariaDisabled=o.toString(),s.textContent=this.ctx.localeManager.t(e),s.role="menuitem",s.onclick=A0(s,this.createButtonOnClick(t,i)),s.addEventListener("mouseover",()=>s.focus({preventScroll:!0})),s}reposition(){let{x:t,y:e}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:o,offsetHeight:s}=this.element;t=ta.clamp(0,t,i.width-o),e=ta.clamp(0,e,i.height-s),this.element.style.left=`${t}px`,this.element.style.top=`calc(${e}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(Xh),this.ctx.domManager.removeChild("canvas-overlay",Xh)}};d([Tf(If)],Zh.prototype,"enabled",2),d([Tf(If)],Zh.prototype,"darkTheme",2);var I0={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsKey:"contextMenu",moduleFactory:t=>new Zh(t),themeTemplate:{contextMenu:{enabled:!0,darkTheme:M0.ThemeSymbols.IS_DARK_THEME}}};import{_ModuleSupport as T0}from"ag-charts-community";import{_ModuleSupport as ea}from"ag-charts-community";import{_ModuleSupport as $h}from"ag-charts-community";var{BaseProperties:O0,BOOLEAN:Lf,FUNCTION:Nf,NUMBER:zr,STRING:Cf,Validate:Ii,createId:L0,setAttribute:N0}=$h,C0="ag-charts-crosshair-label",ia=class extends $h.ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0}};d([Ii(Lf)],ia.prototype,"enabled",2),d([Ii(zr)],ia.prototype,"xOffset",2),d([Ii(zr)],ia.prototype,"yOffset",2),d([Ii(Cf,{optional:!0})],ia.prototype,"format",2),d([Ii(Nf,{optional:!0})],ia.prototype,"renderer",2);var oa=class extends O0{constructor(t,e,i){super(),this.domManager=t,this.id=L0(this),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.renderer=void 0,this.element=t.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(C0),N0(this.element,"aria-hidden",!0),this.element.setAttribute("data-key",e),this.element.setAttribute("data-axis-id",i)}show(t){const{element:e}=this,i=t.x+this.xOffset,o=t.y+this.yOffset;e.style.top=`${Math.round(o)}px`,e.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml(t){t!==void 0&&(this.element.innerHTML=t)}getBBox(){const{element:t}=this;return new $h.BBox(t.clientLeft,t.clientTop,t.clientWidth,t.clientHeight)}toggle(t){this.element.classList.toggle("ag-charts-crosshair-label--hidden",!t)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(t,e){if(typeof t=="string")return t;e=e??{};const{text:i=e.text??"",color:o=e.color,backgroundColor:s=e.backgroundColor,opacity:a=e.opacity??1}=t;return`<div class="ag-charts-crosshair-label-content" style="${`opacity: ${a}; background-color: ${s?.toLowerCase()}; color: ${o}`}">
                    <span>${i}</span>
                </div>`}};d([Ii(Lf)],oa.prototype,"enabled",2),d([Ii(zr)],oa.prototype,"xOffset",2),d([Ii(zr)],oa.prototype,"yOffset",2),d([Ii(Cf,{optional:!0})],oa.prototype,"format",2),d([Ii(Nf,{optional:!0})],oa.prototype,"renderer",2);var{Group:R0,TranslatableGroup:E0,Line:Rf,BBox:Qh,createId:w0,POSITIVE_NUMBER:Ef,RATIO:_0,BOOLEAN:wf,COLOR_STRING:P0,LINE_DASH:B0,OBJECT:z0,InteractionState:qa,Validate:Oo,ZIndexMap:_f,formatNumber:F0,isInteger:V0,ChartAxisDirection:Pf}=ea,Xi=class extends ea.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.id=w0(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new ia,this.seriesRect=new Qh(0,0,0,0),this.hoverRect=new Qh(0,0,0,0),this.bounds=new Qh(0,0,0,0),this.crosshairGroup=new E0({name:"crosshairs",zIndex:_f.SERIES_CROSSHAIR}),this.lineGroup=this.crosshairGroup.appendChild(new R0({name:`${this.id}-crosshair-lines`,zIndex:_f.SERIES_CROSSHAIR})),this.lineGroupSelection=ea.Selection.select(this.lineGroup,Rf,!1),this.activeHighlight=void 0,this.axisCtx=t.parent,this.labels={};const e=t.regionManager.getRegion("series"),i=qa.Default|qa.Annotations|qa.AnnotationsSelected;this.hideCrosshairs(),t.domManager.addEventListener("focusin",({target:o})=>{const s=o instanceof HTMLElement&&t.domManager.contains(o,"series-area");this.crosshairGroup.visible&&!s&&(this.hideCrosshairs(),this.ctx.updateService.update(ea.ChartUpdateType.PERFORM_LAYOUT))}),this.destroyFns.push(t.scene.attachNode(this.crosshairGroup),e.addListener("hover",o=>this.onMouseMove(o),i),e.addListener("drag",o=>this.onMouseMove(o),qa.Annotations|qa.AnnotationsSelected),e.addListener("leave",()=>this.onMouseOut(),i),t.keyNavManager.addListener("nav-hori",()=>this.onKeyPress()),t.keyNavManager.addListener("nav-vert",()=>this.onKeyPress()),t.zoomManager.addListener("zoom-pan-start",()=>this.onMouseOut()),t.zoomManager.addListener("zoom-change",()=>this.onMouseOut()),t.highlightManager.addListener("highlight-change",o=>this.onHighlightChange(o)),t.layoutManager.addListener("layout:complete",o=>this.layout(o)),()=>Object.entries(this.labels).forEach(([o,s])=>s.destroy()))}layout({series:{rect:t,paddedRect:e,visible:i},axes:o}){if(!i||!o||!this.enabled)return;this.seriesRect=t,this.hoverRect=e;const{position:s="left",axisId:a}=this.axisCtx,n=o.find(h=>h.id===a);if(!n)return;this.axisLayout=n,this.bounds=t.clone().grow(n.gridPadding+n.seriesAreaPadding,s);const{crosshairGroup:r,bounds:l}=this;r.translationX=Math.round(l.x),r.translationY=Math.round(l.y);const c=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(c),this.updateLines(),this.updateLabels(c)}updateSelections(t){this.lineGroupSelection.update(t,e=>e.append(new Rf),e=>e)}updateLabels(t){const{labels:e,ctx:i}=this;for(const o of t)this.label.enabled&&(e[o]??(e[o]=new oa(i.domManager,o,this.axisCtx.axisId))),e[o]&&this.updateLabel(e[o]);this.labelFormatter=this.axisCtx.scaleValueFormatter(this.label.format)}updateLabel(t){const{enabled:e,xOffset:i,yOffset:o,format:s,renderer:a}=this.label;t.enabled=e,t.xOffset=i,t.yOffset=o,t.format=s,t.renderer=a}updateLines(){const{lineGroupSelection:t,bounds:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,axisLayout:r}=this;if(!r)return;const l=this.isVertical();t.each(c=>{c.stroke=i,c.strokeWidth=o,c.strokeOpacity=s,c.lineDash=a,c.lineDashOffset=n,c.y1=0,c.y2=l?e.height:0,c.x1=0,c.x2=l?0:e.width})}isVertical(){return this.axisCtx.direction===Pf.X}formatValue(t){const{labelFormatter:e,axisLayout:i,ctx:{callbackCache:o}}=this;if(e){const s=o.call(e,t);if(s!=null)return s}if(typeof t=="number"){const s=(i?.label.fractionDigits??0)+(V0(t)?0:1);return F0(t,s)}return String(t??"")}onMouseMove(t){if(!this.enabled||this.snap)return;const{crosshairGroup:e,hoverRect:i}=this,{canvasX:o,canvasY:s}=t;if(i.containsPoint(o,s)){const a=this.getData(t);this.updatePositions(a),e.visible=!0}else this.hideCrosshairs();this.ctx.updateService.update(ea.ChartUpdateType.SCENE_RENDER)}onMouseOut(){this.hideCrosshairs(),this.ctx.updateService.update(ea.ChartUpdateType.SCENE_RENDER)}onKeyPress(){this.enabled&&!this.snap&&this.hideCrosshairs()}onHighlightChange(t){if(!this.enabled)return;const{crosshairGroup:e,axisCtx:i}=this,{datum:o,series:s}=t.currentHighlight??{},a=o&&(s?.axes.x?.id===i.axisId||s?.axes.y?.id===i.axisId);if(this.activeHighlight=a?t.currentHighlight:void 0,!this.activeHighlight)this.hideCrosshairs();else if(this.snap){const n=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(n),e.visible=!0}}isInRange(t){return this.axisCtx.inRange(t)}updatePositions(t){const{seriesRect:e,lineGroupSelection:i}=this;i.each((o,s)=>{const a=t[s];if(!a){o.visible=!1,this.hideLabel(s);return}o.visible=!0;const{value:n,position:r}=a;let l=0,c=0;this.isVertical()?(l=r,o.x=Math.round(l)):(c=r,o.y=Math.round(c)),this.label.enabled?this.showLabel(l+e.x,c+e.y,n,s):this.hideLabel(s)})}getData(t){const{axisCtx:e}=this,i="pointer",{datum:o,xKey:s="",yKey:a=""}=this.activeHighlight??{},{regionX:n,regionY:r}=t,l=this.isVertical(),c=l?n:r;let h=o?.[l?s:a]??"";return e.continuous&&(h=e.scaleInvert(c)),{[i]:{position:c,value:h}}}getActiveHighlightData(t){const{axisCtx:e}=this,{datum:i,series:o,xKey:s="",aggregatedValue:a,cumulativeValue:n,midPoint:r}=t,l=o.getKeyProperties(e.direction),c=(e.scale.bandwidth??0)/2,h=o.axes[e.direction]?.id===e.axisId,p=l.indexOf("yKey")>-1&&h,u=l.indexOf("xKey")>-1&&h,g=a??n;if(p&&g!==void 0){const f=e.scale.convert(g)+c;return this.isInRange(f)?{yKey:{value:g,position:f}}:{}}if(u){const f=(this.isVertical()?r?.x:r?.y)??0,m=e.continuous?e.scaleInvert(f):i[s];return this.isInRange(f)?{xKey:{value:m,position:f}}:{}}const y={};return l.forEach(f=>{const m=o.properties[f],S=i[m],b=e.scale.convert(S)+c;this.isInRange(b)&&(y[f]={value:S,position:b})}),y}getLabelHtml(t,e){const i=this.axisLayout?.label?.fractionDigits??0,o={text:this.formatValue(t)};return this.label.renderer?e.toLabelHtml(this.label.renderer({value:t,fractionDigits:i}),o):e.toLabelHtml(o)}showLabel(t,e,i,o){if(!this.axisLayout)return;const{bounds:s}=this,a=this.labels[o],n=this.getLabelHtml(i,a);a.setLabelHtml(n);const{width:r,height:l}=a.getBBox(),c=this.axisCtx.position;let h=this.axisLayout.label.spacing+this.axisLayout.tickSize;this.axisCtx.direction===Pf.X?(h-=4,a.show({x:t-r/2,y:c==="bottom"?s.y+s.height+h:s.y-l-h})):(h-=8,a.show({x:c==="right"?s.x+s.width+h:s.x-r-h,y:e-l/2}))}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const t of Object.keys(this.labels))this.hideLabel(t)}hideLabel(t){this.labels[t]?.toggle(!1)}};d([Oo(wf)],Xi.prototype,"enabled",2),d([Oo(P0,{optional:!0})],Xi.prototype,"stroke",2),d([Oo(B0,{optional:!0})],Xi.prototype,"lineDash",2),d([Oo(Ef)],Xi.prototype,"lineDashOffset",2),d([Oo(Ef)],Xi.prototype,"strokeWidth",2),d([Oo(_0)],Xi.prototype,"strokeOpacity",2),d([Oo(wf)],Xi.prototype,"snap",2),d([Oo(z0)],Xi.prototype,"label",2);var G0={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","number","log","time"],moduleFactory:t=>new Xi(t),themeTemplate:{crosshair:{snap:!0,stroke:T0.ThemeSymbols.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}};import{_ModuleSupport as Bf}from"ag-charts-community";var{BOOLEAN:W0,FUNCTION:U0,ActionOnSet:Ja,Validate:zf}=Bf,sa=class extends Bf.BaseModuleInstance{constructor(t){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=t.dataService}updateCallback(t,e){this.dataService&&(t&&e!=null?this.dataService.updateCallback(e):this.dataService.clearCallback())}};d([Ja({newValue(t){this.updateCallback(t,this.getData)}}),zf(W0)],sa.prototype,"enabled",2),d([Ja({newValue(t){this.updateCallback(this.enabled,t)}}),zf(U0)],sa.prototype,"getData",2),d([Ja({newValue(t){this.dataService.requestThrottle=t}})],sa.prototype,"requestThrottle",2),d([Ja({newValue(t){this.dataService.dispatchThrottle=t}})],sa.prototype,"updateThrottle",2),d([Ja({newValue(t){this.dataService.dispatchOnlyLatest=!t}})],sa.prototype,"updateDuringInteraction",2);var H0={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","hierarchy","polar","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new sa(t),themeTemplate:{dataSource:{enabled:!1}}};import{AgErrorBarSupportedSeriesTypes as K0}from"ag-charts-community";import{AgErrorBarSupportedSeriesTypes as Ff,_ModuleSupport as qh}from"ag-charts-community";import{_ModuleSupport as tn}from"ag-charts-community";var{nearestSquaredInContainer:Y0,partialAssign:j0,mergeDefaults:Vf,BBox:Zi}=tn,X0=class{constructor(t){this.components=t,this.union=Zi.merge(t)}containsPoint(t,e){if(!this.union.containsPoint(t,e))return!1;for(const i of this.components)if(i.containsPoint(t,e))return!0;return!1}},Z0=class extends tn.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new tn.Path,this.capsPath=new tn.Path,this.bboxes=new X0([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(t){this._datum=t}calculateCapLength(t,e){const{lengthRatio:i=1,length:o}=t,{lengthRatioMultiplier:s,lengthMax:a}=e,n=o??i*s;return Math.min(n,a)}getItemStylerParams(t,e,i){const{datum:o}=this;if(o==null||t.itemStyler==null)return;const{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r}=t;return{...e,datum:o.datum,seriesId:o.datum.seriesId,xKey:o.xKey,yKey:o.yKey,xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,highlighted:i}}formatStyles(t,e,i){let{cap:o,...s}=t;const a=this.getItemStylerParams(e,t,i);if(a!=null&&e.itemStyler!=null){const n=e.itemStyler(a);s=Vf(n,s),o=Vf(n?.cap,n,o)}return{whiskerStyle:s,capsStyle:o}}applyStyling(t,e){j0(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],t,e)}update(t,e,i){if(this.datum===void 0)return;const{whiskerStyle:o,capsStyle:s}=this.formatStyles(t,e,i),{xBar:a,yBar:n,capDefaults:r}=this.datum,l=this.whiskerPath;this.applyStyling(l,o),l.path.clear(!0),n!==void 0&&(l.path.moveTo(n.lowerPoint.x,n.lowerPoint.y),l.path.lineTo(n.upperPoint.x,n.upperPoint.y)),a!==void 0&&(l.path.moveTo(a.lowerPoint.x,a.lowerPoint.y),l.path.lineTo(a.upperPoint.x,a.upperPoint.y)),l.path.closePath(),this.capLength=this.calculateCapLength(s??{},r);const c=this.capLength/2,h=this.capsPath;this.applyStyling(h,s),h.path.clear(!0),n!==void 0&&(h.path.moveTo(n.lowerPoint.x-c,n.lowerPoint.y),h.path.lineTo(n.lowerPoint.x+c,n.lowerPoint.y),h.path.moveTo(n.upperPoint.x-c,n.upperPoint.y),h.path.lineTo(n.upperPoint.x+c,n.upperPoint.y)),a!==void 0&&(h.path.moveTo(a.lowerPoint.x,a.lowerPoint.y-c),h.path.lineTo(a.lowerPoint.x,a.lowerPoint.y+c),h.path.moveTo(a.upperPoint.x,a.upperPoint.y-c),h.path.lineTo(a.upperPoint.x,a.upperPoint.y+c)),h.path.closePath()}updateBBoxes(){const{capLength:t,whiskerPath:e,capsPath:i}=this,{yBar:o,xBar:s}=this.datum??{},a=t/2,n=[];if(o!==void 0){const r=o.lowerPoint.y-o.upperPoint.y;n.push(new Zi(o.lowerPoint.x,o.upperPoint.y,e.strokeWidth,r),new Zi(o.lowerPoint.x-a,o.lowerPoint.y,t,i.strokeWidth),new Zi(o.upperPoint.x-a,o.upperPoint.y,t,i.strokeWidth))}if(s!==void 0){const r=s.upperPoint.x-s.lowerPoint.x;n.push(new Zi(s.lowerPoint.x,s.upperPoint.y,r,e.strokeWidth),new Zi(s.lowerPoint.x,s.lowerPoint.y-a,i.strokeWidth,t),new Zi(s.upperPoint.x,s.upperPoint.y-a,i.strokeWidth,t))}this.bboxes.components=n,this.bboxes.union=Zi.merge(n)}containsPoint(t,e){return this.bboxes.containsPoint(t,e)}pickNode(t,e){return this.containsPoint(t,e)?this:void 0}nearestSquared(t,e,i){const{bboxes:o}=this;if(o.union.distanceSquared(t,e)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:s}=Zi.nearestBox(t,e,o.components);return{nearest:this,distanceSquared:s}}},$0=class extends tn.Group{nearestSquared(t,e){const{nearest:i,distanceSquared:o}=Y0(t,e,{children:this.children()});if(i!==void 0&&!isNaN(o))return{datum:i.datum,distanceSquared:o}}};import{_ModuleSupport as Q0}from"ag-charts-community";var{BaseProperties:Gf,Validate:ft,BOOLEAN:Wf,COLOR_STRING:Uf,FUNCTION:q0,LINE_DASH:Hf,NUMBER:J0,OBJECT:tL,POSITIVE_NUMBER:Fr,RATIO:Jh,STRING:Lo}=Q0,$i=class extends Gf{};d([ft(Wf,{optional:!0})],$i.prototype,"visible",2),d([ft(Uf,{optional:!0})],$i.prototype,"stroke",2),d([ft(Fr,{optional:!0})],$i.prototype,"strokeWidth",2),d([ft(Jh,{optional:!0})],$i.prototype,"strokeOpacity",2),d([ft(Hf,{optional:!0})],$i.prototype,"lineDash",2),d([ft(Fr,{optional:!0})],$i.prototype,"lineDashOffset",2),d([ft(J0,{optional:!0})],$i.prototype,"length",2),d([ft(Jh,{optional:!0})],$i.prototype,"lengthRatio",2);var Zt=class extends Gf{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new $i}};d([ft(Lo,{optional:!0})],Zt.prototype,"yLowerKey",2),d([ft(Lo,{optional:!0})],Zt.prototype,"yLowerName",2),d([ft(Lo,{optional:!0})],Zt.prototype,"yUpperKey",2),d([ft(Lo,{optional:!0})],Zt.prototype,"yUpperName",2),d([ft(Lo,{optional:!0})],Zt.prototype,"xLowerKey",2),d([ft(Lo,{optional:!0})],Zt.prototype,"xLowerName",2),d([ft(Lo,{optional:!0})],Zt.prototype,"xUpperKey",2),d([ft(Lo,{optional:!0})],Zt.prototype,"xUpperName",2),d([ft(Wf,{optional:!0})],Zt.prototype,"visible",2),d([ft(Uf,{optional:!0})],Zt.prototype,"stroke",2),d([ft(Fr,{optional:!0})],Zt.prototype,"strokeWidth",2),d([ft(Jh,{optional:!0})],Zt.prototype,"strokeOpacity",2),d([ft(Hf,{optional:!0})],Zt.prototype,"lineDash",2),d([ft(Fr,{optional:!0})],Zt.prototype,"lineDashOffset",2),d([ft(q0,{optional:!0})],Zt.prototype,"itemStyler",2),d([ft(tL)],Zt.prototype,"cap",2);var{fixNumericExtent:eL,groupAccumulativeValueProperty:iL,isDefined:Se,mergeDefaults:oL,valueProperty:Vr,ChartAxisDirection:td,Logger:sL}=qh;function aL(t){for(const e of Ff)if(e===t.series.type)return t.series;throw new Error(`AG Charts - unsupported series type '${t.series.type}', error bars supported series types: ${Ff.join(", ")}`)}var nL=class Wn extends qh.BaseModuleInstance{constructor(e){super(),this.properties=new Zt;const i=aL(e),{annotationGroup:o,annotationSelections:s}=i;this.cartesianSeries=i,this.groupNode=new $0({name:`${o.id}-errorBars`}),o.appendChild(this.groupNode),this.selection=qh.Selection.select(this.groupNode,()=>this.errorBarFactory()),s.add(this.selection),i.addEventListener("seriesVisibilityChange",a=>this.onToggleSeriesItem(a)),this.destroyFns.push(i.addListener("data-processed",a=>this.onDataProcessed(a)),i.addListener("data-update",a=>this.onDataUpdate(a)),e.highlightManager.addListener("highlight-change",a=>this.onHighlightChange(a)),()=>o.removeChild(this.groupNode),()=>s.delete(this.selection))}hasErrorBars(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties;return Se(e)&&Se(i)||Se(o)&&Se(s)}isStacked(){const e=this.cartesianSeries.seriesGrouping?.stackCount;return e==null?!1:e>0}getUnstackPropertyDefinition(e){const i=[],{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n,xErrorsID:r,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=e;return a!=null&&n!=null&&i.push(Vr(a,h,{id:`${l}-lower`}),Vr(n,h,{id:`${l}-upper`})),o!=null&&s!=null&&i.push(Vr(o,c,{id:`${r}-lower`}),Vr(s,c,{id:`${r}-upper`})),i}getStackPropertyDefinition(e){const i=[],{cartesianSeries:o}=this,{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:p}=e,u=o.seriesGrouping?.groupIndex??o.id,g={invalidValue:null,missingValue:0,separateNegative:!0,...o.visible?{}:{forceValue:0}},y=(m,S,b,v)=>iL(m,"normal","current",{id:`${S}-${b}`,groupId:`errorGroup-${u}-${b}`,...g},v),f=(m,S,b,v)=>{i.push(...y(m,b,"lower",v),...y(S,b,"upper",v))};return n!=null&&r!=null&&f(n,r,c,p),s!=null&&a!=null&&f(s,a,l,h),i}getPropertyDefinitions(e){return this.isStacked()?this.getStackPropertyDefinition(e):this.getUnstackPropertyDefinition(e)}onDataProcessed(e){this.dataModel=e.dataModel,this.processedData=e.processedData}getDomain(e){const{xLowerKey:i,xUpperKey:o,xErrorsID:s,yLowerKey:a,yUpperKey:n,yErrorsID:r}=this.getMaybeFlippedKeys();if(e===td.X?Se(i)&&Se(o):Se(a)&&Se(n)){const{dataModel:c,processedData:h,cartesianSeries:p}=this;if(c!=null&&h!=null){const u={x:s,y:r}[e],g=c.getDomain(p,`${u}-lower`,"value",h),y=c.getDomain(p,`${u}-upper`,"value",h),f=[Math.min(...g,...y),Math.max(...g,...y)];return eL(f)}}return[]}onDataUpdate(e){this.dataModel=e.dataModel,this.processedData=e.processedData,Se(e.dataModel)&&Se(e.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.hasErrorBars()?this.cartesianSeries.contextNodeData?.nodeData:void 0}createNodeData(){const e=this.getNodeData(),i=this.cartesianSeries.axes[td.X]?.scale,o=this.cartesianSeries.axes[td.Y]?.scale;if(!(!i||!o||!e))for(let s=0;s<e.length;s++){const{midPoint:a,xLower:n,xUpper:r,yLower:l,yUpper:c}=this.getDatum(e,s);if(a!=null){let h,p;Se(n)&&Se(r)&&(h={lowerPoint:{x:this.convert(i,n),y:a.y},upperPoint:{x:this.convert(i,r),y:a.y}}),Se(l)&&Se(c)&&(p={lowerPoint:{x:a.x,y:this.convert(o,l)},upperPoint:{x:a.x,y:this.convert(o,c)}}),e[s].xBar=h,e[s].yBar=p}}}getMaybeFlippedKeys(){let{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties,[a,n]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([e,o]=[o,e],[i,s]=[s,i],[a,n]=[n,a]),{xLowerKey:e,xUpperKey:i,xErrorsID:a,yLowerKey:o,yUpperKey:s,yErrorsID:n}}static getDatumKey(e,i,o){if(i==null)return;const s=e.datum[i];if(s!=null){if(typeof s!="number"){sL.warnOnce(`Found [${i}] error value of type ${typeof s}. Expected number type`);return}return s+o}}getDatum(e,i){const{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n}=this.getMaybeFlippedKeys(),r=e[i],l=r.cumulativeValue==null||!this.isStacked()?0:r.cumulativeValue-r.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:Wn.getDatumKey(r,o,c),xUpper:Wn.getDatumKey(r,s,c),yLower:Wn.getDatumKey(r,a,h),yUpper:Wn.getDatumKey(r,n,h)}}convert(e,i){const o=(e.bandwidth??0)/2;return e.convert(i)+o}update(){const e=this.getNodeData();e!=null&&(this.selection.update(e),this.selection.each((i,o,s)=>this.updateNode(i,o,s)))}updateNode(e,i,o){e.datum=i,e.update(this.getDefaultStyle(),this.properties,!1),e.updateBBoxes()}pickNodeExact(e){const{x:i,y:o}=e,s=this.groupNode.pickNode(i,o);if(s!=null)return{datum:s.datum,distanceSquared:0}}pickNodeNearest(e){return this.groupNode.nearestSquared(e.x,e.y)}pickNodeMainAxisFirst(e){return this.groupNode.nearestSquared(e.x,e.y)}getTooltipParams(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s,xLowerName:a=e,xUpperName:n=i,yLowerName:r=o,yUpperName:l=s}=this.properties;return{xLowerKey:e,xLowerName:a,xUpperKey:i,xUpperName:n,yLowerKey:o,yLowerName:r,yUpperKey:s,yUpperName:l}}onToggleSeriesItem(e){this.groupNode.visible=e.visible}makeStyle(e){return{visible:e.visible,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity,cap:oL(this.properties.cap,e)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(e,i,o){const s=this.getNodeData();if(s!=null){for(let a=0;a<s.length;a++)if(e===s[a]){this.selection.at(a)?.update(i,this.properties,o);break}}}onHighlightChange(e){const{previousHighlight:i,currentHighlight:o}=e;o?.series===this.cartesianSeries&&this.restyleHighlightChange(o,this.getHighlightStyle(),!0),i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new Z0}getWhiskerProperties(){const{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}};import{_ModuleSupport as rL}from"ag-charts-community";var lL={series:{errorBar:{visible:!0,stroke:rL.ThemeSymbols.DEFAULT_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}},cL={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:K0,moduleFactory:t=>new nL(t),themeTemplate:lL};import{_ModuleSupport as Gr}from"ag-charts-community";var{ZIndexMap:hL,ActionOnSet:dL,Validate:ed,ProxyPropertyOnWrite:Kf,OBJECT:pL,RATIO:uL,COLOR_STRING:gL}=Gr,Wr=class extends Gr.Background{constructor(){super(...arguments),this.image=new Di,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new Gr.Group({name:"foreground",zIndex:hL.FOREGROUND})}onLayoutComplete(t){super.onLayoutComplete(t);const{width:e,height:i}=t.chart;let o={x:0,y:0,width:e,height:i};this.image&&(o=this.image.performLayout(e,i)),this.text&&this.updateTextNode(o)}onImageLoad(){this.ctx.updateService.update(Gr.ChartUpdateType.SCENE_RENDER)}updateTextNode(t){const{textNode:e}=this;e.fontWeight="bold",e.fontFamily="Impact, sans-serif",e.fontSize=19,e.opacity=.7,e.fill="#9b9b9b",e.textBaseline="top";const i=this.textNode.getBBox(),o=10;e.x=t.x+t.width/2-i.width/2,e.y=t.y+t.height+o}};d([ed(pL,{optional:!0}),dL({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],Wr.prototype,"image",2),d([ed(gL,{optional:!0}),Kf("rectNode","fill")],Wr.prototype,"fill",2),d([ed(uL,{optional:!0}),Kf("rectNode","fillOpacity")],Wr.prototype,"fillOpacity",2);var yL={type:"root",optionsKey:"foreground",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new Wr(t)};import{_ModuleSupport as fL}from"ag-charts-community";import{_ModuleSupport as en}from"ag-charts-community";import{_ModuleSupport as Yf}from"ag-charts-community";import{_ModuleSupport as mL}from"ag-charts-community";var{TranslatableGroup:xL,ScenePathChangeDetection:jf}=mL,id=class extends xL{constructor(){super(...arguments),this.inset=0,this.cornerRadius=0}applyClip(t,e){const{cornerRadius:i,inset:o}=this,{x:s,y:a,width:n,height:r}=e;t.beginPath(),t.roundRect(s+o,a+o,n-2*o,r-2*o,i),t.clip()}};d([jf()],id.prototype,"inset",2),d([jf()],id.prototype,"cornerRadius",2);var{Validate:od,BOOLEAN:SL,POSITIVE_NUMBER:Xf,ZIndexMap:ls,ActionOnSet:Zf,CategoryAxis:bL,TextUtils:vL,Padding:ML,Logger:$f,Group:cs,BBox:Qf,ProxyProperty:qf}=Yf,sd=class{constructor(){this.top=0,this.bottom=0}};d([od(Xf)],sd.prototype,"top",2),d([od(Xf)],sd.prototype,"bottom",2);var aa=class extends Yf.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.padding=new sd,this.root=new cs({name:"root"}),this.seriesRoot=this.root.appendChild(new id({name:"Series-root",zIndex:ls.SERIES_LAYER,renderToOffscreenCanvas:!0})),this.axisGridGroup=this.root.appendChild(new cs({name:"Axes-Grids",zIndex:ls.AXIS_GRID})),this.axisGroup=this.root.appendChild(new cs({name:"Axes-Grids",zIndex:ls.AXIS_GRID})),this.axisLabelGroup=this.root.appendChild(new cs({name:"Axes-Labels",zIndex:ls.SERIES_LABEL})),this.axisCrosslineRangeGroup=this.root.appendChild(new cs({name:"Axes-Crosslines-Range",zIndex:ls.SERIES_CROSSLINE_RANGE})),this.axisCrosslineLineGroup=this.root.appendChild(new cs({name:"Axes-Crosslines-Line",zIndex:ls.SERIES_CROSSLINE_LINE})),this.axisCrosslineLabelGroup=this.root.appendChild(new cs({name:"Axes-Crosslines-Label",zIndex:ls.SERIES_LABEL})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach(t=>t.destroy()),this.axes=[],this._destroyed=!0)}onSeriesChange(t,e){const i=e?.filter(o=>!t.includes(o))??[];this.destroySeries(i);for(const o of t){if(e?.includes(o))continue;o.attachSeries(this.seriesRoot,this.seriesRoot,void 0);const s=this;o.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return s.seriesRect}},o.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled")}}destroySeries(t){t?.forEach(e=>{e.destroy(),e.detachSeries(this.seriesRoot,this.seriesRoot,void 0),e.chart=void 0})}assignSeriesToAxes(){this.axes.forEach(t=>{t.boundSeries=this.series.filter(e=>e.axes[t.direction]===t)})}assignAxesToSeries(){const t={};this.axes.forEach(e=>{const i=e.direction;(t[i]??(t[i]=[])).push(e)}),this.series.forEach(e=>{e.directions.forEach(i=>{const o=t[i];if(!o){$f.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);return}const s=e.getKeys(i),a=this.findMatchingAxis(o,s);if(!a){$f.warnOnce(`no matching axis for direction [${i}] and keys [${s}]; check series and axes configuration.`);return}e.axes[i]=a})})}findMatchingAxis(t,e){for(const i of t){if(!i.keys.length)return i;if(e){for(const o of e)if(i.keys.includes(o))return i}}}updateData(t){this.series.forEach(e=>e.setChartData(t)),this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready",this.series.forEach(e=>e.resetAnimation("disabled"))})}async processData(t){this.series.some(e=>e.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes());for(const e of this.axes)e.processData();await Promise.all(this.series.map(e=>(e.resetDatumCallbackCache(),e.processData(t))))}computeAxisPadding(){const t=new ML;return this.enabled&&this.axes.forEach(({position:e,thickness:i,line:o,label:s})=>{if(e==null)return;let a;i?a=i:a=(o.enabled?o.width:0)+(s.enabled?vL.getLineHeight(s.fontSize??0)+s.spacing:0),t[e]=Math.ceil(a)}),t}async layout(t,e){const{padding:i}=this,o=this.seriesRect!=null,s=new Qf(0,0,t,e-(i.top+i.bottom));this.seriesRect=s,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectCanvasSpace(new Qf(0,-i.top,t,e)),this.axes.forEach(a=>{const{position:n="left"}=a;switch(n){case"top":case"bottom":a.range=[0,s.width],a.gridLength=s.height;break;case"right":case"left":{const r=a instanceof bL;a.range=r?[0,s.height]:[s.height,0],a.gridLength=s.width;break}}a.gridPadding=0,a.translation.x=0,a.translation.y=0,n==="right"?a.translation.x=t:n==="bottom"&&(a.translation.y=e),a.calculateLayout(),a.update(o)}),await Promise.all(this.series.map(a=>a.update({seriesRect:s})))}};d([od(SL)],aa.prototype,"enabled",2),d([qf(["seriesRoot","inset"])],aa.prototype,"inset",2),d([qf(["seriesRoot","cornerRadius"])],aa.prototype,"cornerRadius",2),d([Zf({changeValue(t,e=[]){const i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(const o of e)t.includes(o)||(o.detachAxis(i),o.destroy());for(const o of t)e?.includes(o)||o.attachAxis(i)}})],aa.prototype,"axes",2),d([Zf({changeValue(t,e){this.onSeriesChange(t,e)}})],aa.prototype,"series",2);import{_ModuleSupport as kL}from"ag-charts-community";var{clamp:AL,SliderWidget:Jf}=kL,DL=class{constructor(t,e){this.ctx=t,this.sliderHandlers=e,this._min=0,this._max=1,this.minRange=.001,this.dragStartX=0,this.ctx=t,this.toolbar=t.proxyInteractionService.createProxyContainer({type:"toolbar",domManagerId:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],orientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.sliders=[t.proxyInteractionService.createProxyElement({type:"slider",domIndex:1,ariaLabel:{id:"ariaLabelNavigatorMinimum"},parent:this.toolbar,cursor:"ew-resize"}),t.proxyInteractionService.createProxyElement({type:"slider",domIndex:0,ariaLabel:{id:"ariaLabelNavigatorRange"},parent:this.toolbar,cursor:"grab"}),t.proxyInteractionService.createProxyElement({type:"slider",ariaLabel:{id:"ariaLabelNavigatorMaximum"},parent:this.toolbar,cursor:"ew-resize"})];for(const[i,o]of["min","pan","max"].entries()){const s=this.sliders[i];s.step=Jf.STEP_HUNDRETH,s.keyboardStep=Jf.STEP_ONE,s.orientation="horizontal",s.setPreventsDefault(!1),s.addListener("drag-start",a=>this.onDragStart(s,a,o)),s.addListener("drag-move",a=>this.onDrag(s,a,o)),s.addListener("drag-end",()=>this.updateSliderRatios()),s.addListener("contextmenu",a=>this.onContextMenu(s,a))}this.sliders[0].addListener("change",()=>this.onMinSliderChange()),this.sliders[1].addListener("change",()=>this.onPanSliderChange()),this.sliders[2].addListener("change",()=>this.onMaxSliderChange()),this.updateSliderRatios(),this.updateVisibility(!1)}destroy(){this.toolbar.destroy()}updateVisibility(t){this.toolbar.setHidden(!t)}updateZoom(){const{_min:t,_max:e}=this;if(!(t==null||e==null))return this.ctx.zoomManager.updateZoom("navigator",{x:{min:t,max:e}})}updateBounds(t){this.toolbar.setBounds(t)}updateSliderBounds(t,e){this.sliders[t].setBounds(e)}updateMinMax(t,e){this._min=t,this._max=e,this.updateSliderRatios()}updateSliderRatios(){const{_min:t,_max:e}=this,i=this.ctx.localeManager.t("ariaValuePanRange",{min:t,max:e});this.sliders[0].setValueRatio(t),this.sliders[1].setValueRatio(t,{ariaValueText:i}),this.sliders[2].setValueRatio(e)}toCanvasOffsets(t){return{offsetX:this.dragStartX+t.originDeltaX}}onDragStart(t,e,i){const o=this.toolbar.cssLeft(),s=t.cssLeft();this.dragStartX=o+s+e.offsetX,this.sliderHandlers.onDragStart(i,this.toCanvasOffsets(e))}onDrag(t,e,i){this.sliderHandlers.onDrag(i,this.toCanvasOffsets(e))}onContextMenu(t,{sourceEvent:e,offsetX:i,offsetY:o}){const{x:s,y:a}=this.toolbar.getBounds(),{x:n,y:r}=t.getBounds(),l=i+s+n,c=o+a+r;this.ctx.contextMenuRegistry.dispatchContext("all",{sourceEvent:e,canvasX:l,canvasY:c},{})}onPanSliderChange(){const t=this.sliders[1].getValueRatio(),e=this._max-this._min;this._min=AL(0,t,1-e),this._max=this._min+e,this.updateZoom()}onMinSliderChange(){this._min=this.sliders[0].clampValueRatio(0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(){this._max=this.sliders[2].clampValueRatio(this._min+this.minRange,1),this.updateZoom()}};import{_ModuleSupport as tm}from"ag-charts-community";var{Validate:Ur,ScenePathChangeDetection:Hr,POSITIVE_NUMBER:ad,BOOLEAN:IL,BBox:TL,ExtendedPath2D:OL}=tm,No=class extends tm.Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.cornerRadius=4,this.grip=!0,this.gripPath=new OL}setCenter(t,e){this.dirtyPath=!0,(this.centerX!==t||this.centerY!==e)&&(this.centerX=t,this.centerY=e,this.markDirty())}static align(t,e,i,o,s,a,n,r,l){const c=t.align(i+s*n)+l,h=c+t.align(i+s*n,s*(r-n))-2*l,p=t.align(o+a/2);t.setCenter(c,p),e.setCenter(h,p)}computeBBox(){const{centerX:t,centerY:e,width:i,height:o}=this,s=t-i/2,a=e-o/2;return new TL(s,a,i,o)}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}updatePath(){const{centerX:t,centerY:e,path:i,gripPath:o,strokeWidth:s,cornerRadius:a,grip:n}=this,r=s/2,l=this.layerManager?.canvas?.pixelRatio??1;i.clear(),o.clear();const c=Math.floor(this.width/2*l)/l,h=Math.floor(this.height/2*l)/l;i.roundRect(t-c+r,e-h+r,2*(c-r),2*(h-r),a);const p=3;if(n)for(let u=-.5;u<=.5;u+=1)for(let g=-1;g<=1;g+=1)o.arc(t+u*p,e+g*p,1,0,2*Math.PI),o.closePath()}renderFill(t,e){const{stroke:i}=this;super.renderFill(t,e),t.fillStyle=typeof i=="string"?i:"black",t.fill(this.gripPath.getPath2D())}};No.className="RangeHandle",d([Ur(ad),Hr()],No.prototype,"width",2),d([Ur(ad),Hr()],No.prototype,"height",2),d([Ur(ad),Hr()],No.prototype,"cornerRadius",2),d([Ur(IL),Hr()],No.prototype,"grip",2);import{_ModuleSupport as LL}from"ag-charts-community";var{Path:NL,BBox:on,ExtendedPath2D:CL,clippedRoundRect:nd,POSITIVE_NUMBER:RL,Validate:EL,ScenePathChangeDetection:wL}=LL,rd=class extends NL{constructor(){super(...arguments),this.cornerRadius=4,this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1,this.visiblePath=new CL}layout(t,e,i,o,s,a){s=isNaN(s)?this.min:s,a=isNaN(a)?this.max:a,(t!==this.x||e!==this.y||i!==this.width||this.height!==o||s!==this.min||a!==this.max)&&(this.x=t,this.y=e,this.width=i,this.height=o,this.min=s,this.max=a,this.dirtyPath=!0,this.markDirty())}computeBBox(){const{x:t,y:e,width:i,height:o}=this;return new on(t,e,i,o)}computeVisibleRangeBBox(){const{x:t,y:e,width:i,height:o,min:s,max:a}=this,n=t+i*s,r=t+i*a;return new on(n,e,r-n,o)}updatePath(){const{path:t,visiblePath:e,x:i,y:o,width:s,height:a,min:n,max:r,strokeWidth:l,cornerRadius:c}=this,h=l/2;t.clear(),e.clear();const p=this.align(i)+h,u=this.align(o)+h,g=this.align(i,s)-2*h,y=this.align(o,a)-2*h,f=this.align(i+s*n)+h,m=f+this.align(i+s*n,s*(r-n))-2*h,S={topLeft:c,topRight:c,bottomRight:c,bottomLeft:c};nd(t,p,u,g,y,S,new on(p,u,f-p,y)),nd(t,p,u,g,y,S,new on(m,u,g+p-m,y)),nd(e,p,u,g,y,S,new on(f,u,m-f,y))}renderStroke(t,e){super.renderStroke(t,e),super.renderStroke(t,this.visiblePath.getPath2D())}};rd.className="RangeMask",d([EL(RL),wL()],rd.prototype,"cornerRadius",2);import{_ModuleSupport as Kr}from"ag-charts-community";var _L=class extends Kr.Group{constructor(t){super({name:"rangeSelectorGroup",zIndex:Kr.ZIndexMap.NAVIGATOR}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.background=this.appendChild(new Kr.TranslatableGroup({name:"navigator-background",zIndex:1})),this.append(t)}layout(t,e,i,o,s,a){this.x=t,this.y=e,this.width=i,this.height=o,this.lOffset=s,this.rOffset=a,this.background.translationX=t,this.background.translationY=e,this.markDirty()}updateBackground(t,e){t!=null&&this.background.removeChild(t),e!=null&&this.background.appendChild(e),this.markDirty()}computeBBox(){const{x:t,y:e,width:i,height:o,lOffset:s,rOffset:a}=this;return new Kr.BBox(t-s,e,i+(s+a),o)}},{clamp:ld,BaseModuleInstance:PL,ObserveChanges:cd,Validate:Yr,BOOLEAN:BL,POSITIVE_NUMBER:hd}=en,na=class extends PL{constructor(t){super(),this.ctx=t,this.enabled=!1,this.mask=new rd,this.minHandle=new No,this.maxHandle=new No,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:()=>this.mask.computeVisibleRangeBBox(),toCanvasBBox:()=>this.mask.computeVisibleRangeBBox(),fromCanvasPoint:(e,i)=>({x:e,y:i})},this.height=30,this.cornerRadius=0,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new _L([this.mask,this.minHandle,this.maxHandle]),this.destroyFns.push(t.scene.attachNode(this.rangeSelector),this.ctx.localeManager.addListener("locale-changed",()=>this.updateZoom()),this.ctx.layoutManager.registerElement(en.LayoutElement.Navigator,e=>this.onLayoutStart(e)),this.ctx.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)),t.zoomManager.addListener("zoom-change",e=>this.onZoomChange(e))),this.domProxy=new DL(t,this),this.updateGroupVisibility(),this.miniChart=new aa(t)}updateBackground(t,e){this.rangeSelector?.updateBackground(t,e)}updateGroupVisibility(){const{enabled:t}=this;this.rangeSelector==null||t===this.rangeSelector.visible||(this.rangeSelector.visible=t,this.domProxy.updateVisibility(t),t?this.updateZoom():this.ctx.zoomManager.updateZoom("navigator"))}onLayoutStart(t){if(this.enabled){const{layoutBox:e}=t,i=this.height+this.spacing;e.shrink(i,"bottom"),this.y=e.y+e.height+this.spacing}else this.y=0;if(this.enabled&&this.miniChart){const{top:e,bottom:i}=this.miniChart.computeAxisPadding();t.layoutBox.shrink(e+i,"bottom"),this.y-=i,this.miniChart.inset=this.mask.strokeWidth/2,this.miniChart.cornerRadius=this.mask.cornerRadius}}async onLayoutComplete(t){const{x:e,width:i}=t.series.rect,{y:o,height:s}=this;if(this.domProxy.updateVisibility(this.enabled),this.enabled){const{_min:a,_max:n}=this.domProxy;this.layoutNodes(e,o,i,s,a,n),this.domProxy.updateBounds({x:e,y:o,width:i,height:s})}this.x=e,this.width=i,await this.miniChart?.layout(i,s)}canDrag(){const t=en.InteractionState.Default|en.InteractionState.Animation|en.InteractionState.ZoomDrag;return this.enabled&&this.ctx.interactionManager.getState()&t}onDragStart(t,{offsetX:e}){this.canDrag()&&(t==="pan"&&(this.panStart=(e-this.x)/this.width-this.domProxy._min),this.ctx.zoomManager.fireZoomPanStartEvent("navigator"))}onDrag(t,{offsetX:e}){if(!this.canDrag())return;const{panStart:i,x:o,width:s}=this,{minRange:a}=this.domProxy;let{_min:n,_max:r}=this.domProxy;const l=(e-o)/s;if(t==="min")n=ld(0,l,r-a);else if(t==="max")r=ld(n+a,l,1);else if(t==="pan"&&i!=null){const c=r-n;n=ld(0,l-i,1-c),r=n+c}this.domProxy._min=n,this.domProxy._max=r,this.updateZoom()}onZoomChange(t){const{x:e}=t;if(!e)return;const{x:i,y:o,width:s,height:a}=this,{min:n,max:r}=e;this.domProxy.updateMinMax(n,r),this.layoutNodes(i,o,s,a,n,r)}layoutNodes(t,e,i,o,s,a){const{rangeSelector:n,mask:r,minHandle:l,maxHandle:c}=this;r.layout(t,e,i,o,s,a),n.layout(t,e,i,o,l.width/2,c.width/2),No.align(l,c,t,e,i,o,s,a,r.strokeWidth/2),s+(a-s)/2<.5?(l.zIndex=3,c.zIndex=4):(l.zIndex=4,c.zIndex=3),[l,this.maskVisibleRange,c].forEach((h,p)=>{const u=h.getBBox(),g={x:u.x-t,y:u.y-e,height:u.height,width:u.width};this.domProxy.updateSliderBounds(p,g)})}updateZoom(){this.enabled&&this.domProxy.updateZoom()}updateData(t){return this.miniChart?.updateData(t)}async processData(t){if(this.miniChart)return this.miniChart?.processData(t)}};d([cd((t,e,i)=>{t.updateBackground(i?.root,e?.root)})],na.prototype,"miniChart",2),d([Yr(BL),cd((t,e)=>{t.ctx.zoomManager.setNavigatorEnabled(!!e),t.updateGroupVisibility()})],na.prototype,"enabled",2),d([Yr(hd)],na.prototype,"height",2),d([Yr(hd),cd((t,e)=>{t.mask.cornerRadius=e})],na.prototype,"cornerRadius",2),d([Yr(hd)],na.prototype,"spacing",2);var{DEFAULT_FONT_FAMILY:zL,DEFAULT_LABEL_COLOUR:FL,DEFAULT_INVERTED_BACKGROUND_COLOUR:VL,DEFAULT_BACKGROUND_COLOUR:em,DEFAULT_NAVIGATOR_STROKE:dd}=fL.ThemeSymbols,GL={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new na(t),removable:!1,themeTemplate:{navigator:{enabled:!1,height:18,cornerRadius:4,mask:{fill:VL,fillOpacity:.1,stroke:dd,strokeWidth:1},minHandle:{fill:em,stroke:dd,strokeWidth:1,width:12,height:24,cornerRadius:4},maxHandle:{fill:em,stroke:dd,strokeWidth:1,width:12,height:24,cornerRadius:4},miniChart:{enabled:!1,label:{color:FL,fontSize:10,fontFamily:zL,spacing:5},padding:{top:0,bottom:0}}}}};import{_ModuleSupport as im}from"ag-charts-community";import{_ModuleSupport as WL}from"ag-charts-community";var{AND:UL,ARRAY:om,FUNCTION:HL,NUMBER:KL,OR:YL,ToolbarButtonProperties:jL,Validate:XL}=WL,sm=class extends jL{};d([XL(YL(KL,UL(om,om.restrict({length:2})),HL))],sm.prototype,"value",2);var{BOOLEAN:ZL,OBJECT:$L,ChartAxisDirection:pd,LayoutElement:QL,PropertiesArray:qL,Toolbar:JL,Validate:am}=im,ud=class extends im.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.buttons=new qL(sm),this.verticalSpacing=10,this.toolbar=new JL(this.ctx.localeManager),this.toolbar.addClass("ag-charts-range-buttons"),t.domManager.addChild("canvas-overlay","range-buttons",this.toolbar.getElement()),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),t.layoutManager.registerElement(QL.ToolbarBottom,this.onLayoutStart.bind(this)),t.zoomManager.addListener("zoom-change",this.onZoomChanged.bind(this)),this.teardown.bind(this))}teardown(){this.ctx.domManager.removeChild("canvas-overlay","range-buttons"),this.toolbar.destroy()}onLayoutStart(t){const{buttons:e,ctx:i,enabled:o,toolbar:s,verticalSpacing:a}=this,{layoutBox:n}=t;if(!o||!i.zoomManager.isZoomEnabled()){s.setHidden(!0);return}s.setHidden(!1),s.updateButtons(e);const r=s.getBounds().height;s.setBounds({x:n.x,y:n.y+n.height-r,width:n.width,height:r}),n.shrink({bottom:r+a})}onZoomChanged(){this.toolbar.clearActiveButton()}onButtonPress({button:{index:t}}){const{zoomManager:e}=this.ctx,i=this.buttons.at(t);if(!i)return;const{value:o}=i;typeof o=="number"?e.extendToEnd("zoom-buttons",pd.X,o):Array.isArray(o)?e.updateWith("zoom-buttons",pd.X,()=>o):typeof o=="function"&&e.updateWith("zoom-buttons",pd.X,o),this.toolbar.toggleActiveButtonByIndex(t)}};d([am(ZL)],ud.prototype,"enabled",2),d([am($L)],ud.prototype,"buttons",2);var nm=1e3*60*60*24,gd=nm*30,t2=nm*365,e2={type:"root",optionsKey:"ranges",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new ud(t),themeTemplate:{ranges:{enabled:!1,buttons:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:gd},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:3*gd},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:6*gd},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:(t,e)=>[new Date(`${new Date(e).getFullYear()}-01-01`).getTime(),e]},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:t2},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:(t,e)=>[t,e]}]}}};import"ag-charts-community";import{_ModuleSupport as rm}from"ag-charts-community";var lm=class Un extends rm.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.activeSections=new Set,this.sectionButtons={annotations:[],chartToolbar:[]}}getSharedToolbar(e){return this.sharedToolbar||this.createSharedToolbar(),this.toolbarWithSection(e)}createSharedToolbar(){this.sharedToolbar=new rm.Toolbar(this.ctx.localeManager,"vertical"),this.sharedToolbar.addClass("ag-charts-shared-toolbar"),this.ctx.domManager.addChild("canvas-overlay","shared-toolbar",this.sharedToolbar.getElement()),this.destroyFns.push(()=>{this.sharedToolbar?.destroy(),this.sharedToolbar=void 0,this.ctx.domManager.removeChild("canvas-overlay","shared-toolbar")})}toolbarWithSection(e){const i=this.sharedToolbar,o={layout:s=>{if(this.firstLayoutSection!=null&&this.firstLayoutSection!==e&&this.activeSections.has(this.firstLayoutSection))return;this.firstLayoutSection=e;const a=i.getBounds().width;i.setBounds({x:s.x,y:s.y,width:a}),s.shrink({left:a+i.horizontalSpacing})},addToolbarListener:(s,a)=>i.addToolbarListener(s,n=>{const r=this.getSectionIndex(e,n.button.index);if(r<0)return;const l={...n,button:this.sectionButtons[e][r]};a(l)}),updateButtons:s=>{this.sectionButtons[e]=s;const a=Un.SECTION_ORDER.flatMap(n=>this.sectionButtons[n]);i.updateButtons(a)},updateButtonByIndex:(s,a)=>{i.updateButtonByIndex(this.getIndex(e,s),a)},toggleActiveButtonByIndex:s=>{i.toggleActiveButtonByIndex(this.getIndex(e,s))},toggleButtonEnabledByIndex:(s,a)=>{i.toggleButtonEnabledByIndex(this.getIndex(e,s),a)},setHidden:s=>{s?this.activeSections.delete(e):this.activeSections.add(e);let a=0;for(const n of Un.SECTION_ORDER){if(n!==e){a+=this.sectionButtons[n].length;continue}for(const r of this.sectionButtons[e].keys())i.setButtonHiddenByIndex(a+r,s)}},destroy:()=>{o.setHidden(!0),this.activeSections.size===0&&this.destroy()},clearActiveButton:i.clearActiveButton.bind(i),addListener:i.addListener.bind(i),removeListener:i.removeListener.bind(i)};return o.setHidden(!1),o}getIndex(e,i){let o=0;for(const s of Un.SECTION_ORDER){if(s===e)return o+i;o+=this.sectionButtons[s].length}return-1}getSectionIndex(e,i){let o=0;for(const s of Un.SECTION_ORDER){if(s===e)return i>=o+this.sectionButtons[e].length?-1:i-o;o+=this.sectionButtons[s].length}return-1}};lm.SECTION_ORDER=["chartToolbar","annotations"];var i2=lm,o2={type:"context",contextKey:"sharedToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new i2(t)};import{_ModuleSupport as ra}from"ag-charts-community";import{_ModuleSupport as yd}from"ag-charts-community";var{CachedTextMeasurerPool:sn,ZIndexMap:s2,LayoutElement:a2,Validate:ue,BaseProperties:n2,OBJECT:la,BOOLEAN:r2,STRING:ca,COLOR_STRING:l2,RATIO:c2,valueProperty:h2,TextUtils:d2,Group:p2,Label:an,Rect:u2,Text:Ht}=yd,cm={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,hlc:184,"high-low":800},g2={up:"positive",down:"negative"},y2={hlc:"altNeutral"},fd=class extends n2{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};d([ue(l2)],fd.prototype,"fill",2),d([ue(c2)],fd.prototype,"fillOpacity",2);var be=class extends yd.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new an,this.positive=new an,this.negative=new an,this.neutral=new an,this.altNeutral=new an,this.background=new fd,this.layoutStyle="block",this.id="status-bar",this.data=void 0,this.layer=new p2({name:"StatusBar",zIndex:s2.STATUS_BAR}),this.labelGroup=this.layer.appendChild(new yd.TranslatableGroup),this.backgroundNode=this.labelGroup.appendChild(new u2),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new Ht),value:this.labelGroup.appendChild(new Ht),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=t.highlightManager,this.labelGroup.visible=!1,this.destroyFns.push(t.scene.attachNode(this.layer),t.layoutManager.registerElement(a2.Overlay,e=>this.startPerformLayout(e)),t.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)),t.highlightManager.addListener("highlight-change",()=>this.updateHighlight()))}async processData(t){if(!this.enabled||this.data==null)return;const e=[];for(const s of this.labels){const{id:a,key:n}=s,r=this[n];r==null?s.domain=void 0:e.push(h2(r,"number",{id:a}))}if(e.length===0)return;const{processedData:i,dataModel:o}=await t.request(this.id,this.data,{props:e});for(const s of this.labels){const{id:a,key:n}=s;this[n]!=null&&(s.domain=o.getDomain(this,a,"value",i))}}startPerformLayout(t){if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled)return;const{layoutBox:e}=t,i=4,o=12,s=0,a=8;this.labelGroup.translationY=e.y+s;const n=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),r=d2.getLineHeight(n),l=cm[this.getChartType()]??0;let c=0,h,p="alphabetic";if(this.layoutStyle==="block")e.shrink(s+r+a,"top"),h=n+(r-n)/2;else{const{title:u}=this.ctx.chartService;if(p="top",h=s+u.padding,u.enabled){const g=u.node.getBBox();c=g.x+g.width+o}else c=u.padding}for(const{label:u,configuration:g,title:y,value:f,domain:m,formatter:S}of this.labels){if(m==null||!(l&g)){y.visible=!1,f.visible=!1;continue}const b=Math.max(sn.measureText(S.format(m[0]),{font:this.positive.getFont(),textBaseline:p,textAlign:"left"}).width,sn.measureText(S.format(m[1]),{font:this.positive.getFont(),textBaseline:p,textAlign:"left"}).width,sn.measureText(S.format(m[0]),{font:this.negative.getFont(),textBaseline:p,textAlign:"left"}).width,sn.measureText(S.format(m[1]),{font:this.negative.getFont(),textBaseline:p,textAlign:"left"}).width);y.visible=!0,f.visible=!0;const v=sn.measureText(u,{font:this.title.getFont(),textBaseline:p,textAlign:"left"});y.setFont(this.title),y.fill=this.title.color,y.text=u,y.textBaseline=p,y.y=h,y.x=c,c+=v.width+i,f.textBaseline=p,f.y=h,f.x=c,c+=b+o}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=c-o,this.backgroundNode.height=r+s+a,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(t){this.labelGroup.translationX=t.series.rect.x,this.updateHighlight()}updateHighlight(){if(!this.enabled)return;const t=this.highlightManager.getActiveHighlight(),e=t?.datum??this.data?.at(-1);if(e==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const i=t?.itemId;let o=i!=null?g2[i]:void 0;o==null&&this.openKey!=null&&this.closeKey!=null&&(e[this.openKey]<e[this.closeKey]?o="positive":o="negative");for(const{domain:s,value:a,key:n,formatter:r,style:l}of this.labels){if(s==null)continue;let c=l??o??"neutral";c==="neutral"&&(c=y2[this.getChartType()]??c);const h=this[n],p=h!=null?e?.[h]:void 0;a.setFont(this[c]),a.fill=this[c].color,a.text=typeof p=="number"?r.format(p):""}}getChartType(){let t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return(t==null||cm[t]==null)&&(t="candlestick"),t}};d([ue(r2)],be.prototype,"enabled",2),d([ue(ca,{optional:!0})],be.prototype,"openKey",2),d([ue(ca,{optional:!0})],be.prototype,"highKey",2),d([ue(ca,{optional:!0})],be.prototype,"lowKey",2),d([ue(ca,{optional:!0})],be.prototype,"closeKey",2),d([ue(ca,{optional:!0})],be.prototype,"volumeKey",2),d([ue(la)],be.prototype,"title",2),d([ue(la)],be.prototype,"positive",2),d([ue(la)],be.prototype,"negative",2),d([ue(la)],be.prototype,"neutral",2),d([ue(la)],be.prototype,"altNeutral",2),d([ue(la)],be.prototype,"background",2),d([ue(ca)],be.prototype,"layoutStyle",2);var f2={type:"root",identifier:"status-bar",optionsKey:"statusBar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new be(t),themeTemplate:{statusBar:{enabled:!1,layoutStyle:ra.ThemeSymbols.DEFAULT_CAPTION_LAYOUT_STYLE,title:{color:ra.ThemeSymbols.DEFAULT_LABEL_COLOUR},positive:{color:ra.ThemeSymbols.PALETTE_UP_STROKE},negative:{color:ra.ThemeSymbols.PALETTE_DOWN_STROKE},neutral:{color:ra.ThemeSymbols.PALETTE_NEUTRAL_STROKE},background:{fill:ra.ThemeSymbols.DEFAULT_BACKGROUND_COLOUR,fillOpacity:.5},altNeutral:{color:"gray"}}}};import{_ModuleSupport as m2}from"ag-charts-community";var{BOOLEAN:md,STRING:x2,UNION:S2,BaseProperties:b2,CartesianAxis:hm,ChartUpdateType:dm,isDate:v2,isDefined:M2,isFiniteNumber:jr,unique:k2,ObserveChanges:nn,TooltipManager:A2,Validate:rn,Logger:D2}=m2,hs=class extends b2{constructor(t){super(),this.moduleContext=t,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0}updateSiblings(t){const{syncManager:e}=this.moduleContext;for(const i of e.getGroupSiblings(t??this.groupId))this.updateChart(i)}updateChart(t,e=dm.UPDATE_DATA){t.ctx.updateService.update(e,{skipSync:!0})}enabledZoomSync(){const{syncManager:t,zoomManager:e}=this.moduleContext;this.disableZoomSync=e.addListener("zoom-change",()=>{for(const i of t.getGroupSiblings(this.groupId))i.modulesManager.getModule("sync")?.zoom&&i.ctx.zoomManager.updateZoom("sync",this.mergeZoom(i))})}enabledNodeInteractionSync(){const{highlightManager:t,syncManager:e}=this.moduleContext;this.disableNodeInteractionSync=t.addListener("highlight-change",i=>{for(const o of e.getGroupSiblings(this.groupId))if(o.modulesManager.getModule("sync")?.nodeInteraction){if(!i.currentHighlight?.datum){o.ctx.highlightManager.updateHighlight(o.id),o.ctx.tooltipManager.removeTooltip(o.id);continue}for(const s of o.axes){const a=this.axes==="xy"?"x":this.axes;if(!hm.is(s)||s.direction!==a)continue;const n=o.series.map(r=>{const l=r.getKeys(s.direction);if(s.keys.length&&!s.keys.some(y=>l.includes(y)))return;const{nodeData:c}=r.contextNodeData;if(!c?.length)return;const h=c[0][`${s.direction}Key`];let p=i.currentHighlight.datum[h];const u=v2(p);u&&(p=p.getTime());const g=c.find(y=>{const f=y.datum[h];return u?f.getTime()===p:f===p});return g?{series:r,nodeDatum:g}:null}).filter(M2);if(n.length<2&&n[0]?.nodeDatum!==o.ctx.highlightManager.getActiveHighlight()){const{series:r,nodeDatum:l}=n[0]??{};if(o.ctx.highlightManager.updateHighlight(o.id,l),l){const c=l.midPoint?.x??l.point?.x??0,h=l.midPoint?.y??l.point?.y??0,p=A2.makeTooltipMeta({type:"hover",canvasX:c,canvasY:h},l);delete p.lastPointerEvent,o.ctx.tooltipManager.updateTooltip(o.id,p,r.getTooltipContent(l))}else o.ctx.tooltipManager.removeTooltip(o.id);this.updateChart(o,dm.SERIES_UPDATE)}}}})}getSyncedDomain(t){if(!hm.is(t)||this.axes!=="xy"&&this.axes!==t.direction)return;const{syncManager:e}=this.moduleContext,i=e.getGroup(this.groupId),[{axes:o}]=i,{direction:s,min:a,max:n,nice:r,reverse:l}=t;for(const c of o)if(s===c.direction&&(r!==c.nice||l!==c.reverse||a!==c.min&&(jr(a)||jr(c.min))||n!==c.max&&(jr(n)||jr(c.max)))){D2.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}return k2(i.flatMap(c=>c.series).filter(c=>{if(c.visible){const h=c.getKeys(t.direction);return t.keys.length?t.keys.some(p=>h.includes(p)):!0}}).flatMap(c=>c.getDomain(t.direction)))}mergeZoom(t){const{zoomManager:e}=this.moduleContext;if(this.axes==="xy")return e.getZoom();const i=t.ctx.zoomManager.getZoom()??{};return i[this.axes]=e.getZoom()?.[this.axes],i}onEnabledChange(){const{syncManager:t}=this.moduleContext;this.enabled?t.subscribe(this.groupId):t.unsubscribe(this.groupId),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(t,e){if(!this.enabled||t===e)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(e),i.subscribe(t),this.updateSiblings(e),this.updateSiblings(t)}onAxesChange(){if(!this.enabled)return;const{syncManager:t}=this.moduleContext;this.updateChart(t.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){const{syncManager:t}=this.moduleContext;t.unsubscribe(this.groupId),this.updateSiblings(),this.disableZoomSync?.()}};hs.className="Sync",d([rn(md),nn(t=>t.onEnabledChange())],hs.prototype,"enabled",2),d([rn(x2,{optional:!0}),nn((t,e,i)=>t.onGroupIdChange(e,i))],hs.prototype,"groupId",2),d([rn(S2(["x","y","xy"],"an axis")),nn(t=>t.onAxesChange())],hs.prototype,"axes",2),d([rn(md),nn(t=>t.onNodeInteractionChange())],hs.prototype,"nodeInteraction",2),d([rn(md),nn(t=>t.onZoomChange())],hs.prototype,"zoom",2);var I2={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new hs(t),themeTemplate:{sync:{enabled:!1}}};import{_ModuleSupport as Qi}from"ag-charts-community";import{_ModuleSupport as pm}from"ag-charts-community";var{COLOR_STRING:T2,RATIO:O2,Validate:um}=pm,Xr=class extends pm.Rect{constructor(){super(...arguments),this.fill="rgb(33, 150, 243)",this.fillOpacity=.2}};Xr.className="ZoomRect",d([um(T2)],Xr.prototype,"fill",2),d([um(O2)],Xr.prototype,"fillOpacity",2);import{_ModuleSupport as xd}from"ag-charts-community";import{_ModuleSupport as L2}from"ag-charts-community";var{clamp:N2,isNumberEqual:gm,round:ym}=L2,ct={min:0,max:1},Sd="end",bd="middle",Zr=(t,e=ct.min,i=ct.max)=>N2(e,t,i);function vd(){return{x:{...ct},y:{...ct}}}function Et(t){return t.x.max-t.x.min}function ve(t){return t.y.max-t.y.min}function fm(t,e,i=1e-10){return gm(t.min,e.min,i)&&gm(t.max,e.max,i)}function Md(t,e,i){return fm(t.x,e.x,i)&&fm(t.y,e.y,i)}function kd(t,e,i){const o=ym(Et(t),10)<=e,s=ym(ve(t),10)<=i;return o||s}function $t(t){return{x:{min:t?.x?.min??ct.min,max:t?.x?.max??ct.max},y:{min:t?.y?.min??ct.min,max:t?.y?.max??ct.max}}}function qi(t,e,i){if(!t)return{x:0,y:0};const o=Zr(e-t.x,0,t.x+t.width),s=Zr(i-t.y,0,t.y+t.height),a=1/t.width*o,n=1-1/t.height*s;return{x:Zr(a),y:Zr(n)}}function ds(t,e,i){return{x:{min:t.x.min+e,max:t.x.max+e},y:{min:t.y.min+i,max:t.y.max+i}}}function mm(t,e,i){return{x:{min:t.x.min,max:t.x.min+Et(t)*e},y:{min:t.y.min,max:t.y.min+ve(t)*i}}}function xm(t,e,i){const o=Et(t),s=ve(t),a=t.x.min+o/2,n=t.y.min+s/2;return{x:{min:a-o*e/2,max:a+o*e/2},y:{min:n-s*i/2,max:n+s*i/2}}}function oi(t,e,i,o){const{min:s,max:a}=e,n=s+(a-s)/2,r=t.max-t.min;switch(i){case"start":return{min:s,max:e.min+r};case"end":return{min:e.max-r,max:a};case"middle":return{min:n-r/2,max:n+r/2};case"pointer":return Ad(t,e,o??n);default:return{min:s,max:a}}}function Ad(t,e,i){const o=t.max-t.min,s=e.max-e.min,a=i*(1-(s-o)),n=i-a,r=t.min+n,l=t.max+n;return{min:r,max:l}}function C2(t,e,i){return{x:{min:t.x.min*e,max:t.x.max*e},y:{min:t.y.min*i,max:t.y.max*i}}}function Ke(t){const e=vd();return e.x=$r(t.x),e.y=$r(t.y),e}function $r(t){const e=t.max-t.min;let i=t.max>ct.max?ct.max-e:t.min,o=t.min<ct.min?e:t.max;return i=Math.max(ct.min,i),o=Math.min(ct.max,o),{min:i,max:o}}function Sm({min:t,max:e},i,o){if(e===i.max)t=e-o;else if(t===i.min)e=t+o;else{const s=t+(e-t)/2;t=s-o/2,e=s+o/2}return{min:t,max:e}}var R2=class{update(t,e,i,o,s,a){return this.oldZoom??(this.oldZoom=$t(e===xd.ChartAxisDirection.X?{...s,x:a}:{...s,y:a})),this.updateCoords(t.regionX,t.regionY),this.updateZoom(e,i,o)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(t,e){this.coords?(this.coords.x2=t,this.coords.y2=e):this.coords={x1:t,y1:e,x2:t,y2:e}}updateZoom(t,e,i){const{coords:o,oldZoom:s}=this;let a=$t(s);if(!o||!s)return t===xd.ChartAxisDirection.X?a.x:a.y;const n=qi(i,o.x1,o.y1),r=qi(i,o.x2,o.y2);if(t===xd.ChartAxisDirection.X){const c=(r.x-n.x)*Et(s);return a.x.max+=c,a.x=oi(a.x,s.x,e,n.x),a=Ke(a),a.x}const l=(r.y-n.y)*ve(s);return a.y.max-=l,a.y=oi(a.y,s.y,e,n.y),a=Ke(a),a.y}},Dd="zoom-action",Id="pan-action",E2=class{constructor(t,e,i,o,s){this.contextMenuRegistry=t,this.zoomManager=e,this.getModuleProperties=i,this.getRect=o,this.updateZoom=s}registerActions(t,e){if(!t)return;const{contextMenuRegistry:i}=this,o=i.registerDefaultAction({id:Dd,type:"series-area",label:"contextMenuZoomToCursor",action:this.onZoomToHere.bind(this)}),s=i.registerDefaultAction({id:Id,type:"series-area",label:"contextMenuPanToCursor",action:this.onPanToHere.bind(this)});return this.toggleActions(e),()=>{o(),s()}}toggleActions(t){const{contextMenuRegistry:e}=this,{minRatioX:i,minRatioY:o}=this.getModuleProperties();kd(t,i,o)?e.disableAction(Dd):e.enableAction(Dd),Md(t,vd())?e.disableAction(Id):e.enableAction(Id)}computeOrigin(t){const e=this.getRect(),{enabled:i}=this.getModuleProperties();if(!i||!e||!t?.target||!(t instanceof MouseEvent))return;const o={x:0,y:0,width:e.width,height:e.height};return qi(o,t.offsetX,t.offsetY)}onZoomToHere({event:t}){const e=this.computeOrigin(t);if(!e)return;const{isScalingX:i,isScalingY:o,minRatioX:s,minRatioY:a}=this.getModuleProperties(),n=$t(this.zoomManager.getZoom()),r=e.x*Et(n),l=e.y*ve(n),c=ct.max-ct.min,h=c/2;let p={x:{min:e.x-h,max:e.x+h},y:{min:e.y-h,max:e.y+h}};p=xm(p,i?s:c,o?a:c),p=ds(p,n.x.min-e.x+r,n.y.min-e.y+l),this.updateZoom(Ke(p))}onPanToHere({event:t}){const e=this.computeOrigin(t);if(!e)return;const i=$t(this.zoomManager.getZoom()),o=Et(i),s=ve(i),a=e.x*o,n=e.y*s,r=(ct.max-ct.min)/2;let l={x:{min:e.x-r,max:e.x+r},y:{min:e.y-r,max:e.y+r}};l=xm(l,o,s),l=ds(l,i.x.min-e.x+a,i.y.min-e.y+n),this.updateZoom(Ke(l))}};import{_ModuleSupport as Td}from"ag-charts-community";var{BBoxValues:w2}=Td,_2=class{constructor(t){this.axesHandlers=t,this.axes=[]}initAxis(t,e,i,o){const{X:s,Y:a}=Td.ChartAxisDirection,n={[s]:"ew-resize",[a]:"ns-resize"}[o],r="afterend",l=t.proxyInteractionService.createProxyElement({type:"region",domManagerId:e,where:r});return l.setCursor(n),l.addListener("drag-start",()=>i.onDragStart(e,o)),l.addListener("drag-move",c=>i.onDrag(c)),l.addListener("drag-end",i.onDragEnd),l.addListener("dblclick",()=>i.onDoubleClick(e,o)),{axisId:e,div:l}}destroy(){this.axes.forEach(t=>t.div.destroy())}update(t){const{X:e,Y:i}=Td.ChartAxisDirection,o=[...t.axisManager.getAxisContext(e),...t.axisManager.getAxisContext(i)],{removed:s,added:a}=this.diffAxisIds(o);s.length>0&&(this.axes=this.axes.filter(n=>s.includes(n.axisId)?(n.div.destroy(),!1):!0));for(const n of a){const{axisId:r,direction:l}=n;this.axes.push(this.initAxis(t,r,this.axesHandlers,l))}for(const n of this.axes){const l=o.filter(c=>c.axisId===n.axisId)[0].getCanvasBounds();n.div.setHidden(w2.isEmpty(l)),l!==void 0&&n.div.setBounds(l)}}diffAxisIds(t){const e=this.axes.map(a=>a.axisId),i=t.map(a=>a.axisId),o=e.filter(a=>!i.includes(a)),s=t.filter(a=>!e.includes(a.axisId));return{removed:o,added:s}}};import{_ModuleSupport as P2}from"ag-charts-community";var bm=16,B2={off:1,short:.01,long:.002},z2=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){const{deceleration:t}=this;return Math.max(typeof t=="number"?t:B2[t]??1,1e-4)}addListener(t,e){return this.onUpdate=e,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(t){this.updateCoords(t.regionX,t.regionY);const{x1:e=0,y1:i=0,x2:o=0,y2:s=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:e-o,deltaY:i-s})}start(){this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:t}=this;let e=0,i=0,o=0;if(t.length>0){const s=this.zoomCoordsHistoryIndex%bm;let a=s-1;a<0&&(a=t.length-1);let n=s;n>=t.length&&(n=0);const r=t[a],l=t[n];e=r.x-l.x,i=r.y-l.y,o=r.t-l.t}if(this.coords=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,o>0&&this.decelerationValue<1){const s=e/o,a=i/o,n=Math.hypot(s,a),r=Math.atan2(a,s),l=performance.now();this.inertiaHandle=P2.getWindow().requestAnimationFrame(c=>{this.animateInertia(c,c,l,n,r)})}}recordCurrentZoomCoords(){const{coords:t,coordsHistory:e,zoomCoordsHistoryIndex:i}=this;if(!t)return;const{x2:o,y2:s}=t,a=Date.now();e[i%bm]={x:o,y:s,t:a},this.zoomCoordsHistoryIndex+=1}animateInertia(t,e,i,o,s){const a=1-this.decelerationValue,n=-o/Math.log(a),r=o*(a**(e-i)-1)/Math.log(a),l=o*(a**(t-i)-1)/Math.log(a);this.onUpdate?.({type:"update",deltaX:-Math.cos(s)*(l-r),deltaY:-Math.sin(s)*(l-r)}),!(l>=n-1)&&(this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,t,i,o,s)}))}updateCoords(t,e){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:t,y2:e}:this.coords={x1:t,y1:e,x2:t,y2:e}}translateZooms(t,e,i,o){const s=qi(t,t.x+Math.abs(i),t.y+t.height-Math.abs(o)),a=Math.sign(i)*s.x,n=-Math.sign(o)*s.y,r={};for(const[l,{direction:c,zoom:h}]of Object.entries(e)){if(h&&h.min===ct.min&&h.max===ct.max)continue;let p=$t({[c]:h});p=Ke(ds(p,a*Et(p),n*ve(p))),r[l]={direction:c,zoom:p[c]}}return r}};import{_ModuleSupport as F2}from"ag-charts-community";var V2=200,G2=class{update(t,e,i,o){const s=t.deltaX*e*V2;return this.translateZooms(i,o,s)}translateZooms(t,e,i){const o={},s=qi(t,t.x+Math.abs(i),0),a=i<0?-s.x:s.x;for(const[n,{direction:r,zoom:l}]of Object.entries(e)){if(r!==F2.ChartAxisDirection.X)continue;let c=$t({x:l});c=Ke(ds(c,a*Et(c),0)),o[n]={direction:r,zoom:c.x}}return o}};import{_ModuleSupport as vm}from"ag-charts-community";var W2=class{updateAxes(t,e,i,o){const s=t.sourceEvent,a={},{anchorPointX:n,anchorPointY:r,isScalingX:l,isScalingY:c,scrollingStep:h}=e,p=qi(i,s.offsetX??s.clientX,s.offsetY??s.clientY);for(const[u,{direction:g,zoom:y}]of Object.entries(o)){if(y==null)continue;let f={...y};const m=h*t.deltaY*(y.max-y.min);if(g===vm.ChartAxisDirection.X&&l)f.max+=m,f=oi(f,y,n,p.x);else if(g===vm.ChartAxisDirection.Y&&c)f.max+=m,f=oi(f,y,r,p.y);else continue;a[u]={direction:g,zoom:$r(f)}}return a}update(t,e,i,o){const{anchorPointX:s,anchorPointY:a,isScalingX:n,isScalingY:r,scrollingStep:l}=e,c=qi(i,t.canvasX,t.canvasY),h=t.deltaY;let p=$t(o);return p.x.max+=n?l*h*Et(o):0,p.y.max+=r?l*h*ve(o):0,n&&(p.x=oi(p.x,o.x,s,c.x)),r&&(p.y=oi(p.y,o.y,a,c.y)),p=Ke(p),p}updateDelta(t,e,i){const{anchorPointX:o,anchorPointY:s,isScalingX:a,isScalingY:n,scrollingStep:r}=e;let l=$t(i);return l.x.max+=a?r*-t*Et(i):0,l.y.max+=n?r*-t*ve(i):0,a&&(l.x=oi(l.x,i.x,o)),n&&(l.y=oi(l.y,i.y,s)),l=Ke(l),l}},U2=class{constructor(t){this.rect=t,this.rect.visible=!1}update(t,e,i,o){this.rect.visible=!0,this.updateCoords(t.canvasX,t.canvasY,e,i,o),this.updateRect(i)}stop(t,e,i){let o=$t();if(!t||!e)return o;this.coords&&(o=this.createZoomFromCoords(e,i));const s=e.width/t.width,a=e.height/t.height;return o=Ke(C2(o,s,a)),this.reset(),o}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible&&this.rect.width>0&&this.rect.height>0}updateCoords(t,e,i,o,s){if(!this.coords){this.coords={x1:t,y1:e,x2:t,y2:e};return}const{coords:a}=this;if(a.x2=t,a.y2=e,!o)return;const{isScalingX:n,isScalingY:r,keepAspectRatio:l,minRatioX:c,minRatioY:h}=i,p=$t(s),u=this.getNormalisedDimensions(),g=p.x.max-p.x.min,y=p.y.max-p.y.min,f=c/g,m=h/y;if(n&&u.width/o.width<f&&(a.x2<a.x1?a.x2=a.x1-o.width*f:a.x2=a.x1+o.width*f),l&&n&&r){const S=o.width/o.height;a.y2<a.y1?a.y2=Math.min(a.y1-u.width/S,a.y1-o.height*m):a.y2=Math.max(a.y1+u.width/S,a.y1+o.height*m)}else r&&u.height/o.height<m&&(a.y2<a.y1?a.y2=a.y1-o.height*m:a.y2=a.y1+o.height*m);n||(a.x1=o.x,a.x2=o.x+o.width),r||(a.y1=o.y,a.y2=o.y+o.height)}updateRect(t){if(!t)return;const{rect:e}=this,i=this.getNormalisedDimensions(),{width:o,height:s}=i;let{x:a,y:n}=i;a=Math.max(a,t.x),a-=Math.max(0,a+o-(t.x+t.width)),n=Math.max(n,t.y),n-=Math.max(0,n+s-(t.y+t.height)),e.x=a,e.y=n,e.width=o,e.height=s}createZoomFromCoords(t,e){const i=$t(e),o=this.getNormalisedDimensions(),s=qi(t,o.x,o.y+o.height),a=o.width/t.width,n=o.height/t.height;let r=mm(i,a,n);const l=s.x*Et(i),c=s.y*ve(i);return r=ds(r,l,c),r=Ke(r),r}getNormalisedDimensions(){const{x1:t=0,y1:e=0,x2:i=0,y2:o=0}=this.coords??{},s=t<=i?t:i,a=e<=o?e:o,n=t<=i?i-t:t-i,r=e<=o?o-e:e-o;return{x:s,y:a,width:n,height:r}}};import{_ModuleSupport as H2}from"ag-charts-community";var{ARRAY:K2,BOOLEAN:Y2,STRING:j2,UNION:X2,ActionOnSet:Z2,BaseProperties:$2,ChartAxisDirection:Q2,InteractionState:Mm,NativeWidget:q2,PropertiesArray:J2,Toolbar:tN,ToolbarButtonProperties:eN,Validate:Qr,createElement:iN}=H2,Od=class extends eN{};d([Qr(X2(["reset","zoom-in","zoom-out","pan-left","pan-right","pan-start","pan-end"]))],Od.prototype,"value",2),d([Qr(j2)],Od.prototype,"section",2);var Ld=class extends $2{constructor(t,e,i,o,s,a){super(),this.ctx=t,this.getModuleProperties=e,this.getResetZoom=i,this.updateZoom=o,this.updateAxisZoom=s,this.resetZoom=a,this.enabled=!1,this.buttons=new J2(Od),this.verticalSpacing=10,this.detectionRange=38,this.destroyFns=[],this.container=new q2(iN("div")),this.container.addClass("ag-charts-zoom-buttons"),t.domManager.addChild("canvas-overlay","zoom-buttons",this.container.getElement()),this.toolbar=new tN(t.localeManager),this.container.addChild(this.toolbar),this.toggleVisibility(!1),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("button-focused",this.onButtonFocus.bind(this)),t.interactionManager.addListener("hover",this.onHover.bind(this),Mm.All),t.interactionManager.addListener("leave",this.onLeave.bind(this),Mm.All),t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),this.teardown.bind(this))}destroy(){for(const t of this.destroyFns)t()}teardown(){this.ctx.domManager.removeChild("canvas-overlay","zoom-buttons"),this.container.destroy()}onLayoutComplete(t){const{buttons:e,container:i}=this,{rect:o}=t.series;this.toolbar.updateButtons(e),this.toggleButtons();const s=i.getBounds().height;i.setBounds({y:o.y+o.height-s})}onHover(t){if(!this.enabled||this.toolbar.isHidden())return;const{container:e,detectionRange:i,ctx:{scene:o}}=this,{offsetY:s,sourceEvent:{target:a}}=t,n=e.getElement(),r=n.offsetTop-i,l=s>r&&s<o.canvas.element.offsetHeight||a===n;this.toggleVisibility(l)}onLeave(){this.toggleVisibility(!1)}toggleVisibility(t,e=!1){const{container:i,toolbar:o,verticalSpacing:s}=this;o.toggleClass("ag-charts-zoom-buttons__toolbar--hidden",!t);const a=o.getElement();a.style.transitionDuration=e?"0s":"",a.style.transform=t?"translateY(0)":`translateY(${i.getBounds().height+s}px)`}toggleButtons(){const t=$t(this.ctx.zoomManager.getZoom()),{minRatioX:e,minRatioY:i}=this.getModuleProperties();for(const[o,s]of this.buttons.entries()){let a=!0;switch(s?.value){case"pan-start":a=t.x.min>ct.min;break;case"pan-end":a=t.x.max<ct.max;break;case"pan-left":a=t.x.min>ct.min;break;case"pan-right":a=t.x.max<ct.max;break;case"zoom-out":a=!Md(t,vd());break;case"zoom-in":a=!kd(t,e,i);break;case"reset":a=!Md(t,this.getResetZoom());break}this.toolbar.toggleButtonEnabledByIndex(o,a)}}onButtonPress({button:t}){if(!this.enabled||this.toolbar.isHidden())return;const e=this.getModuleProperties();if(e.independentAxes&&t.value!=="reset"){const i=this.ctx.zoomManager.getAxisZooms();for(const[o,{direction:s,zoom:a}]of Object.entries(i))a!=null&&this.onButtonPressAxis(t,e,o,s,a)}else this.onButtonPressUnified(t,e)}onButtonFocus(t){this.toggleVisibility(!0,!0)}onButtonPressAxis(t,e,i,o,s){const{anchorPointX:a,anchorPointY:n,isScalingX:r,isScalingY:l,scrollingStep:c}=e;let h={...s};const p=s.max-s.min;switch(t.value){case"pan-start":h.max=p,h.min=0;break;case"pan-end":h.min=h.max-p,h.max=ct.max;break;case"pan-left":h.min-=p*c,h.max-=p*c;break;case"pan-right":h.min+=p*c,h.max+=p*c;break;case"zoom-in":case"zoom-out":{const u=o===Q2.X,g=u&&r||!u&&l;let y=t.value==="zoom-in"?1-c:1+c;g||(y=1);const S=u?a==="pointer"?Sd:a:n==="pointer"?bd:n;h.max=h.min+(h.max-h.min)*y,h=oi(h,s,S);break}}this.updateAxisZoom(i,o,$r(h))}onButtonPressUnified(t,e){const{anchorPointX:i,anchorPointY:o,isScalingX:s,isScalingY:a,scrollingStep:n}=e,r=$t(this.ctx.zoomManager.getZoom());let l=$t(r);switch(t.value){case"reset":this.resetZoom();return;case"pan-start":l.x.max=Et(l),l.x.min=0;break;case"pan-end":l.x.min=ct.max-Et(l),l.x.max=ct.max;break;case"pan-left":l=ds(l,-Et(l)*n,0);break;case"pan-right":l=ds(l,Et(l)*n,0);break;case"zoom-in":case"zoom-out":{const c=t.value==="zoom-in"?1-n:1+n,h=i==="pointer"?Sd:i,p=o==="pointer"?bd:o;l=mm(l,s?c:1,a?c:1),l.x=oi(l.x,r.x,h),l.y=oi(l.y,r.y,p);break}}this.updateZoom(Ke(l))}};d([Qr(Y2),Z2({changeValue(t){this.toolbar?.setHidden(!t)}})],Ld.prototype,"enabled",2),d([Qr(K2)],Ld.prototype,"buttons",2);var{BOOLEAN:Ji,NUMBER:km,RATIO:Nd,UNION:qr,OBJECT:Am,OR:oN,ActionOnSet:Jr,ChartAxisDirection:Cd,ChartUpdateType:sN,Validate:wt,ProxyProperty:aN,round:nN}=Qi,Dm=t=>nN(t,10),Im=qr(["pointer","start","middle","end"],"an anchor cord"),Tm="zoom-cursor",Rd="zoom-tooltip",Ed=class extends Qi.BaseProperties{constructor(t){super(),this.onChange=t,this.enabled=!1,this.padding=0}};d([wt(Ji),Jr({changeValue(t){this.onChange({enabled:t,padding:this.padding})}})],Ed.prototype,"enabled",2),d([wt(Nd),Jr({changeValue(t){this.onChange({enabled:this.enabled,padding:t})}})],Ed.prototype,"padding",2);var Vt=class extends Qi.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.enableAxisDragging=!0,this.buttons=new Ld(this.ctx,this.getModuleProperties.bind(this),this.getResetZoom.bind(this),this.updateZoom.bind(this),this.updateAxisZoom.bind(this),this.resetZoom.bind(this)),this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.panKey="alt",this.axes="x",this.scrollingStep=(ct.max-ct.min)/10,this.keepAspectRatio=!1,this.minVisibleItemsX=2,this.minVisibleItemsY=2,this.anchorPointX=Sd,this.anchorPointY=bd,this.autoScaling=new Ed(u=>{this.ctx.zoomManager.setAutoScaleYAxis(u.enabled,u.padding)}),this.axisDragger=new R2,this.panner=new z2,this.scroller=new W2,this.scrollPanner=new G2,this.deceleration="short",this.dragState=0,this.minRatioX=0,this.minRatioY=0,this.destroyContextMenuActions=void 0,this.isFirstWheelEvent=!0,this.debouncedWheelReset=Qi.debounce(()=>{this.isFirstWheelEvent=!0},100),this._didAutoZoomOnMount=!1;const e=new Xr;this.selector=new U2(e),this.contextMenu=new E2(t.contextMenuRegistry,t.zoomManager,this.getModuleProperties.bind(this),()=>this.paddedRect,this.updateZoom.bind(this));const{Default:i,ZoomDrag:o,Animation:s,Annotations:a,AnnotationsSelected:n}=Qi.InteractionState,r=i|s|o,l=i|s,c=r|a|n,h=t.regionManager.getRegion("series");this.domProxy=new _2({onDragStart:(u,g)=>this.onAxisDragStart(u,g),onDrag:u=>this.onDrag({regionX:u.offsetX,regionY:u.offsetY,canvasX:NaN,canvasY:NaN}),onDragEnd:()=>this.onDragEnd(),onDoubleClick:(u,g)=>{this.hoveredAxis={id:u,direction:g},this.onDoubleClick(),this.hoveredAxis=void 0}});const p="drag-start";this.destroyFns.push(t.scene.attachNode(e),t.keyNavManager.addListener("nav-zoom",u=>this.onNavZoom(u)),h.addListener("dblclick",u=>this.onDoubleClick(u),l),h.addListener("drag",u=>this.onDrag(u),r),h.addListener(p,u=>this.onDragStart(u),r),h.addListener("drag-end",()=>this.onDragEnd(),r),h.addListener("wheel",u=>this.onWheel(u),c),t.gestureDetector.addListener("pinch-move",u=>this.onPinchMove(u)),t.layoutManager.addListener("layout:complete",u=>this.onLayoutComplete(u)),t.updateService.addListener("update-complete",u=>this.onUpdateComplete(u)),t.zoomManager.addListener("zoom-change",u=>this.onZoomChange(u)),t.zoomManager.addListener("zoom-pan-start",u=>this.onZoomPanStart(u)),this.panner.addListener("update",u=>this.onPanUpdate(u)),()=>this.teardown())}teardown(){this.ctx.zoomManager.setZoomModuleEnabled(!1),this.buttons.destroy(),this.destroyContextMenuActions?.()}onEnabledChange(t){this.ctx.zoomManager.setZoomModuleEnabled(t);const e=this.getZoom();this.contextMenu&&(this.destroyContextMenuActions?.(),this.destroyContextMenuActions=this.contextMenu.registerActions(t,e))}onDoubleClick(t){const{enabled:e,enableDoubleClickToReset:i,hoveredAxis:o,ctx:{zoomManager:s}}=this;!e||!i||(o?s.resetAxisZoom("zoom",o.id):t?.preventZoomDblClick||this.resetZoom())}onDragStart(t){const{enabled:e,enableAxisDragging:i,enablePanning:o,enableSelecting:s,hoveredAxis:a,ctx:{cursorManager:n,zoomManager:r}}=this;if(!e)return;this.panner.stopInteractions();let l=0;if(i&&a)l=1;else if(t!=null){const c=this.isPanningKeyPressed(t.sourceEvent);o&&(!s||c)?(n.updateCursor(Tm,"grabbing"),l=2,this.panner.start()):s&&!this.isMinZoom(this.getZoom())&&!c&&(l=3)}(this.dragState=l)!==0&&r.fireZoomPanStartEvent("zoom")}onDrag(t){const{anchorPointX:e,anchorPointY:i,axisDragger:o,dragState:s,enabled:a,paddedRect:n,panner:r,selector:l,seriesRect:c,hoveredAxis:h,ctx:{interactionManager:p,tooltipManager:u,updateService:g,zoomManager:y}}=this;if(!a||!n||!c)return;p.pushState(Qi.InteractionState.ZoomDrag);const f=this.getZoom();switch(s){case 1:{if(!h)break;const{id:m,direction:S}=h,b=S===Qi.ChartAxisDirection.X?e:i,v=y.getAxisZoom(m),x=o.update(t,S,b,c,f,v);y.setAxisManuallyAdjusted("zoom",m),this.updateAxisZoom(m,S,x);break}case 2:r.update(t);break;case 3:l.update(t,this.getModuleProperties(),n,f);break;case 0:return}u.updateTooltip(Rd),g.update(sN.PERFORM_LAYOUT,{skipAnimations:!0})}onDragEnd(){const{axisDragger:t,dragState:e,enabled:i,panner:o,selector:s,ctx:{cursorManager:a,interactionManager:n,tooltipManager:r}}=this;if(n.popState(Qi.InteractionState.ZoomDrag),!(!i||e===0)){switch(e){case 1:this.hoveredAxis=void 0,t.stop();break;case 2:o.stop();break;case 3:{if(!s.didUpdate())break;const l=this.getZoom();if(this.isMinZoom(l))break;const c=s.stop(this.seriesRect,this.paddedRect,l);this.updateZoom(c);break}}this.dragState=0,a.updateCursor(Tm),r.removeTooltip(Rd)}}onNavZoom(t){const{enabled:e,enableScrolling:i,scroller:o}=this;!e||!i||(t.preventDefault(),this.updateZoom(o.updateDelta(t.delta,this.getModuleProperties(),this.getZoom())))}onWheel(t){const{enabled:e,enablePanning:i,enableScrolling:o,paddedRect:s}=this;if(!e||!o||!s)return;const a=t.sourceEvent,{deltaX:n,deltaY:r}=a,l=n!=null&&r!=null&&Math.abs(n)>Math.abs(r);i&&l?this.onWheelPanning(t):this.onWheelScrolling(t)}onWheelPanning(t){const{scrollingStep:e,scrollPanner:i,seriesRect:o,ctx:{zoomManager:s}}=this;if(!o)return;t.preventDefault();const a=i.update(t,e,o,s.getAxisZooms());for(const[n,{direction:r,zoom:l}]of Object.entries(a))this.updateAxisZoom(n,r,l)}onWheelScrolling(t){const{enableAxisDragging:e,enableIndependentAxes:i,hoveredAxis:o,scroller:s,seriesRect:a,ctx:{zoomManager:n}}=this;if(!a)return;const r=this.getZoom(),l=this.isMaxZoom(r)&&t.deltaY>0||this.isMinZoom(r)&&t.deltaY<0;(!this.isFirstWheelEvent||!l)&&t.preventDefault(),this.isFirstWheelEvent=!1,this.debouncedWheelReset();const c=e&&o!=null;let h=this.isScalingX(),p=this.isScalingY();c&&(h=o.direction===Qi.ChartAxisDirection.X,p=!h);const u=this.getModuleProperties({isScalingX:h,isScalingY:p});if(i===!0){const g=s.updateAxes(t,u,a,n.getAxisZooms());for(const[y,{direction:f,zoom:m}]of Object.entries(g))c&&o.id!==y||this.updateAxisZoom(y,f,m)}else{const g=s.update(t,u,a,this.getZoom());this.updateUnifiedZoom(g)}}onAxisDragStart(t,e){this.hoveredAxis={id:t,direction:e},this.onDragStart(void 0)}onPinchMove(t){const{enabled:e,enableScrolling:i,paddedRect:o,seriesRect:s}=this;if(!e||!i||!o||!s)return;const a=this.getZoom(),n=$t(a),r=t.deltaDistance*-.01,l=qi(s,t.origin.x,t.origin.y);this.isScalingX()&&(n.x.max+=r*Et(a),n.x=Ad(n.x,a.x,l.x)),this.isScalingY()&&(n.y.max+=r*(a.y.max-a.y.min),n.y=Ad(n.y,a.y,l.y)),this.updateZoom(Ke(n)),t.preventDefault()}onLayoutComplete(t){this.domProxy.update(this.ctx);const{enabled:e}=this;if(!e)return;const{series:{rect:i,paddedRect:o,shouldFlipXY:s}}=t;this.seriesRect=i,this.paddedRect=o,this.shouldFlipXY=s,this._didAutoZoomOnMount=!0}onUpdateComplete(t){const{minRect:e,minVisibleRect:i}=t,{enabled:o,minVisibleItemsX:s,minVisibleItemsY:a,paddedRect:n,shouldFlipXY:r}=this;if(!o||!n||!e||!i)return;const l=this.getZoom(),c=r?a:s,h=r?s:a,p=i.width*c/n.width,u=i.height*h/n.height,g=Dm(p*Et(l)),y=Dm(u*ve(l));this.isScalingX()&&(this.minRatioX=Math.min(1,g)),this.isScalingY()&&(this.minRatioY=Math.min(1,y)),this.minRatioX||(this.minRatioX=this.minRatioY||0),this.minRatioY||(this.minRatioY=this.minRatioX||0)}onZoomChange(t){t.callerId!=="zoom"&&this.panner.stopInteractions();const e=this.getZoom();this.contextMenu.toggleActions(e)}onZoomPanStart(t){t.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(t){const{panner:e,seriesRect:i,ctx:{tooltipManager:o,zoomManager:s}}=this;if(!i)return;const a=e.translateZooms(i,s.getAxisZooms(),t.deltaX,t.deltaY);for(const[n,{direction:r,zoom:l}]of Object.entries(a))this.updateAxisZoom(n,r,l);o.updateTooltip(Rd)}isPanningKeyPressed(t){switch(this.panKey){case"alt":return t.altKey;case"ctrl":return t.ctrlKey;case"shift":return t.shiftKey;case"meta":return t.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}isMinZoom(t){return kd(t,this.minRatioX,this.minRatioY)}isMaxZoom(t){const e=ct.max-ct.min;return Et(t)===e&&ve(t)===e}updateZoom(t){this.enableIndependentAxes?this.updatePrimaryAxisZooms(t):this.updateUnifiedZoom(t)}resetZoom(){this.ctx.zoomManager.resetZoom("zoom")}updatePrimaryAxisZoom(t,e){this.ctx.zoomManager.updatePrimaryAxisZoom("zoom",e,t[e])}updatePrimaryAxisZooms(t){this.updatePrimaryAxisZoom(t,Cd.X),this.updatePrimaryAxisZoom(t,Cd.Y)}updateUnifiedZoom(t){const{minRatioX:e,minRatioY:i,ctx:{zoomManager:o}}=this,s=this.getZoom(),a=Et(t);a<=Et(s)&&a<e&&(t.x=Sm(t.x,s.x,e));const r=ve(t);r<=ve(s)&&r<i&&(t.y=Sm(t.y,s.y,i)),o.updateZoom("zoom",t)}updateAxisZoom(t,e,i){const{enableIndependentAxes:o,minRatioX:s,minRatioY:a,ctx:{zoomManager:n}}=this;if(!i)return;const r=this.getZoom();if(o!==!0){r[e]=i,this.updateUnifiedZoom(r);return}const l=i.max-i.min,c=r[e].max-r[e].min,h=e===Cd.X?s:a;l<=c&&l<h||n.updateAxisZoom("zoom",t,i)}getZoom(){return $t(this.ctx.zoomManager.getZoom())}getResetZoom(){return $t(this.ctx.zoomManager.getRestoredZoom())}getModuleProperties(t){return{anchorPointX:t?.anchorPointX??this.getAnchorPointX(),anchorPointY:t?.anchorPointY??this.getAnchorPointY(),enabled:t?.enabled??this.enabled,independentAxes:t?.independentAxes??this.enableIndependentAxes===!0,isScalingX:t?.isScalingX??this.isScalingX(),isScalingY:t?.isScalingY??this.isScalingY(),keepAspectRatio:t?.keepAspectRatio??this.keepAspectRatio,minRatioX:t?.minRatioX??this.minRatioX,minRatioY:t?.minRatioY??this.minRatioY,scrollingStep:t?.scrollingStep??this.scrollingStep}}};d([Jr({newValue(t){this.onEnabledChange(t)}}),wt(Ji)],Vt.prototype,"enabled",2),d([wt(Ji)],Vt.prototype,"enableAxisDragging",2),d([wt(Am)],Vt.prototype,"buttons",2),d([wt(Ji)],Vt.prototype,"enableDoubleClickToReset",2),d([Jr({changeValue(t){this.ctx.zoomManager.setIndependentAxes(!!t)}}),wt(Ji,{optional:!0})],Vt.prototype,"enableIndependentAxes",2),d([wt(Ji)],Vt.prototype,"enablePanning",2),d([wt(Ji)],Vt.prototype,"enableScrolling",2),d([wt(Ji)],Vt.prototype,"enableSelecting",2),d([wt(qr(["alt","ctrl","meta","shift"],"a pan key"))],Vt.prototype,"panKey",2),d([wt(qr(["x","y","xy"],"an axis"))],Vt.prototype,"axes",2),d([wt(Nd)],Vt.prototype,"scrollingStep",2),d([wt(Ji)],Vt.prototype,"keepAspectRatio",2),d([wt(km.restrict({min:1}))],Vt.prototype,"minVisibleItemsX",2),d([wt(km.restrict({min:1}))],Vt.prototype,"minVisibleItemsY",2),d([wt(Im)],Vt.prototype,"anchorPointX",2),d([wt(Im)],Vt.prototype,"anchorPointY",2),d([wt(Am)],Vt.prototype,"autoScaling",2),d([aN("panner.deceleration"),wt(oN(Nd,qr(["off","short","long"],"a deceleration")))],Vt.prototype,"deceleration",2);var rN={enabled:!0,buttons:[{icon:"zoom-out",tooltip:"toolbarZoomZoomOut",value:"zoom-out",section:"scale"},{icon:"zoom-in",tooltip:"toolbarZoomZoomIn",value:"zoom-in",section:"scale"},{icon:"pan-left",tooltip:"toolbarZoomPanLeft",value:"pan-left",section:"pan"},{icon:"pan-right",tooltip:"toolbarZoomPanRight",value:"pan-right",section:"pan"},{icon:"reset",tooltip:"toolbarZoomReset",value:"reset",section:"reset"}]},lN={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian","topology"],moduleFactory:t=>new Vt(t),themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:rN,enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,deceleration:"short",minVisibleItemsX:2,minVisibleItemsY:2,panKey:"alt",scrollingStep:.1,autoScaling:{enabled:!1,padding:.25}}}};import{_ModuleSupport as cN}from"ag-charts-community";import{_ModuleSupport as hN}from"ag-charts-community";var{BOOLEAN:Om,OBJECT:dN,POSITION:pN,POSITIVE_NUMBER:wd,BaseProperties:uN,AxisTicks:gN,ZIndexMap:yN,ProxyProperty:_d,Validate:ps,LayoutElement:fN,createId:mN,Group:xN,Rect:SN,Triangle:bN,TranslatableGroup:vN,LinearGradient:MN}=hN,Pd=class extends uN{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};d([ps(wd)],Pd.prototype,"thickness",2),d([ps(wd)],Pd.prototype,"preferredLength",2);var tl=class{constructor(t){this.axisTicks=t}};d([_d("axisTicks.label")],tl.prototype,"label",2),d([_d("axisTicks.interval")],tl.prototype,"interval",2),d([_d("axisTicks.padding")],tl.prototype,"padding",2);var us=class{constructor(t){this.ctx=t,this.id=mN(this),this.legendGroup=new vN({name:"legend",zIndex:yN.LEGEND}),this.gradientRect=new SN,this.arrow=new bN,this.ticksGroup=new xN({name:"legend-axis-group"}),this.destroyFns=[],this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new Pd,this.spacing=20,this.data=[],this.highlightManager=t.highlightManager,this.axisTicks=new gN,this.axisTicks.attachAxis(this.ticksGroup),this.scale=new tl(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.destroyFns.push(t.highlightManager.addListener("highlight-change",()=>this.onChartHoverChange()),t.layoutManager.registerElement(fN.Legend,e=>this.onStartLayout(e)),()=>this.legendGroup.remove())}isVertical(){return this.position==="right"||this.position==="left"}destroy(){this.destroyFns.forEach(t=>t())}attachLegend(t){t.appendChild(this.legendGroup)}onStartLayout(t){const[e]=this.data;if(!this.enabled||!e?.enabled){this.legendGroup.visible=!1;return}const{colorRange:i}=this.normalizeColorArrays(e);this.updateGradientRect(t.layoutBox,i);const o=this.updateAxis(e),{left:s,top:a}=this.getMeasurements(t.layoutBox,o);this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=s,this.legendGroup.translationY=a}normalizeColorArrays(t){let e=t.colorDomain.slice();const i=t.colorRange.slice();if(e.length===i.length)return{colorDomain:e,colorRange:i};e.length>i.length&&i.splice(e.length);const[o,s]=e,a=i.length;return e=i.map((n,r)=>r===0?o:r===a-1?s:o+(s-o)*r/(a-1)),{colorDomain:e,colorRange:i}}updateGradientRect(t,e){const{gradientRect:i}=this,{preferredLength:o,thickness:s}=this.gradient;let a;this.isVertical()?(a=0,i.width=s,i.height=Math.min(t.height,o)):(a=90,i.width=Math.min(t.width,o),i.height=s);const n=new MN("oklch",e.map((r,l)=>({offset:l/(e.length-1),color:r})),a);i.fill=n}updateAxis(t){const{axisTicks:e}=this,i=this.isVertical(),o=this.reverseOrder!==i;return e.position=this.position,e.translationX=i?this.gradient.thickness:0,e.translationY=i?0:this.gradient.thickness,e.scale.domain=o?t.colorDomain.slice().reverse():t.colorDomain,e.scale.range=i?[0,this.gradientRect.height]:[0,this.gradientRect.width],e.calculateLayout()}updateArrow(){const t=this.highlightManager.getActiveHighlight(),{arrow:e}=this;if(t?.colorValue==null){e.visible=!1;return}const{scale:i,label:o}=this.axisTicks,s=o.fontSize??0,a=i.convert(t.colorValue);let{x:n,y:r}=this.gradientRect,l=Math.PI;this.isVertical()?(n-=s/2,r+=a,l/=2):(n+=a,r-=s/2),e.visible=!0,e.fill=o.color,e.rotation=l,e.size=s,e.translationX=n,e.translationY=r}getMeasurements(t,e){let{x:i,y:o}=t,{width:s,height:a}=this.gradientRect;switch(this.isVertical()?s+=e.width+5:a+=e.height+5,this.position){case"left":o+=t.height/2-a/2,t.shrink(s+this.spacing,"left");break;case"right":i+=t.width-s,o+=t.height/2-a/2,t.shrink(s+this.spacing,"right");break;case"top":i+=t.width/2-s/2,t.shrink(a+this.spacing,"top");break;case"bottom":i+=t.width/2-s/2,o+=t.height-a,t.shrink(a+this.spacing,"bottom")}return{top:o,left:i}}onChartHoverChange(){this.enabled&&this.updateArrow()}};us.className="GradientLegend",d([ps(Om)],us.prototype,"enabled",2),d([ps(pN)],us.prototype,"position",2),d([ps(Om)],us.prototype,"reverseOrder",2),d([ps(dN)],us.prototype,"gradient",2),d([ps(wd)],us.prototype,"spacing",2);var{ThemeSymbols:{DEFAULT_FONT_FAMILY:kN,DEFAULT_LABEL_COLOUR:AN},ThemeConstants:{FONT_SIZE:DN}}=cN,IN={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],identifier:"gradient",moduleFactory:t=>new us(t),themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:AN,fontSize:DN.SMALL,fontFamily:kN},interval:{minSpacing:1}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1},removable:"standalone-only"};import{_ModuleSupport as TN}from"ag-charts-community";var{createElement:ON}=TN;function LN(t,e){const i=t.addChild("canvas-overlay","watermark"),o=ON("span");o.innerText=e,i.addEventListener("animationend",()=>{t.removeChild("canvas-overlay","watermark"),t.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(o)}import{_ModuleSupport as NN}from"ag-charts-community";import{_ModuleSupport as Lm}from"ag-charts-community";import{_ModuleSupport as CN}from"ag-charts-community";var{findMinMax:RN,findMinValue:EN,findMaxValue:wN}=CN,ne=0,Me=1,ke=2,Ae=3,Ye=4;function ln(t,e=1){let i=Math.ceil(Math.log2(t.length/e))-1;return i=Math.min(Math.max(i,0),16),2**i|0}function cn(t){return RN(t.map(e=>Number(e)))}function el(t,e,i){return(t.valueOf()-e)/(i-e)}function il(t,e){return Math.min(Math.floor(t*e),e-1)*Ye|0}function hn(t,e,i,o,s,a){const n=new Int32Array(a*Ye).fill(-1),r=new Float64Array(a*Ye).fill(NaN);for(let l=0;l<t.length;l+=1){const c=t[l],h=e[l],p=i[l];if(c==null||h==null||p==null)continue;const u=el(c,o,s),g=h.valueOf(),y=p.valueOf(),f=il(u,a),m=n[f+ne]===-1;(m||u<r[f+ne])&&(n[f+ne]=l,r[f+ne]=u),(m||u>r[f+Me])&&(n[f+Me]=l,r[f+Me]=u),(m||y<r[f+ke])&&(n[f+ke]=l,r[f+ke]=y),(m||g>r[f+Ae])&&(n[f+Ae]=l,r[f+Ae]=g)}return{indexData:n,valueData:r}}function dn(t,e,i,{inPlace:o=!1}={}){const s=i/2|0,a=o?t:new Int32Array(s*Ye),n=o?e:new Float64Array(s*Ye);for(let r=0;r<s;r+=1){const l=r*Ye|0,c=l*2|0,h=c+Ye|0,p=t[h+ne]===-1,u=p||e[c+ne]<e[h+ne]?c:h;a[l+ne]=t[u+ne],n[l+ne]=e[u+ne];const g=p||e[c+Me]>e[h+Me]?c:h;a[l+Me]=t[g+Me],n[l+Me]=e[g+Me];const y=p||e[c+ke]<e[h+ke]?c:h;a[l+ke]=t[y+ke],n[l+ke]=e[y+ke];const f=p||e[c+Ae]>e[h+Ae]?c:h;a[l+Ae]=t[f+Ae],n[l+Ae]=e[f+Ae]}return{maxRange:s,indexData:a,valueData:n}}function _N(t,e,i,o){let s=EN(0,t-1,n=>{const r=o(n);return!Number.isFinite(r)||r>e?n:void 0});s=Math.max((s??0)-1,0);let a=wN(0,t-1,n=>{const r=o(n);return!Number.isFinite(r)||r<i?n:void 0});return a=Math.min((a??t)+2,t),[s,a]}import"ag-charts-community";var Nm={xMin:ne,xMax:Me,yMin:ke,yMax:Ae,span:Ye},PN=1e3,BN=5;function zN(t,e,i){if(t.length<PN)return;const[o,s]=cn(i);let a=ln(t,BN),{indexData:n,valueData:r}=hn(t,e,e,o,s,a);const l=[{maxRange:a,indexData:n,indexes:Nm}];for(;a>64;)({indexData:n,valueData:r,maxRange:a}=dn(n,r,a)),l.push({maxRange:a,indexData:n,indexes:Nm});return l.reverse(),l}var{ChartAxisDirection:FN,ContinuousScale:VN,OrdinalTimeScale:GN}=Lm,WN=class extends Lm.BarSeries{visibleRange(t,e,i,o){return _N(t,e,i,o)}aggregateData(t,e){if(e.rawData.length===0||e.type!=="ungrouped")return;const i=this.axes[FN.X];if(i==null||!(VN.is(i.scale)||GN.is(i.scale)))return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yValue-raw",e),{index:a}=t.resolveProcessedDataDefById(this,"xValue"),n=e.domain.keys[a];return zN(o,s,n)}},{BarSeriesModule:UN}=NN,HN={...UN,type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"bar",moduleFactory:t=>new WN(t)};import{_ModuleSupport as KN}from"ag-charts-community";import{_ModuleSupport as Bd}from"ag-charts-community";function YN(t){return{from:t?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function jN(t){return(e,i)=>t?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}import{_ModuleSupport as Cm}from"ag-charts-community";var{ScalableGroup:XN,Rect:ha,Line:pn,BBox:ZN,Selection:Rm,Logger:$N}=Cm,QN=class extends XN{constructor(){super(),this.append([new ha({tag:0}),new ha({tag:0}),new ha({tag:2}),new ha({tag:1}),new pn({tag:3}),new pn({tag:3}),new pn({tag:4}),new pn({tag:4})])}updateDatumStyles(t,e,i,o){const{bandwidth:s,scaledValues:{xValue:a,medianValue:n}}=t;let{minValue:r,q1Value:l,q3Value:c,maxValue:h}=t.scaledValues;(i&&!o||!i&&o)&&([h,c,l,r]=[r,l,c,h]);const p=(N,w,z,V)=>i?{y:N,x:w,width:V,height:z}:{x:N,y:w,width:z,height:V},u=(N,w,z)=>i?{y1:N,y2:w,x:z}:{x1:N,x2:w,y:z},g=(N,w,z)=>i?{x1:w,x2:z,y:N}:{x:N,y1:w,y2:z},y=(N,w,z,V)=>({x:N,y:w,width:z,height:V}=p(N,w,z,V),new ZN(N,w,z,V)),{fill:f,fillOpacity:m,stroke:S,strokeWidth:b,strokeOpacity:v,lineDash:x,lineDashOffset:M,cornerRadius:k,cap:A,whisker:I}=e,O=Rm.select(this,ha),T=O.selectByTag(0),[L]=O.selectByTag(2),[C]=O.selectByTag(1),D=O.selectByTag(3),R=O.selectByTag(4);I.strokeWidth>s&&(I.strokeWidth=s);const _=p(l,a,c-l,s);L.setProperties(_),T[0].setProperties(_),T[0].setProperties({cornerRadius:k,clipBBox:y(l,a,Math.round(n-l+b/2),s)}),T[1].setProperties(_),T[1].setProperties({cornerRadius:k,clipBBox:y(Math.round(n-b/2),a,Math.floor(c-n+b/2),s)});const F=Math.max(Math.round(n-b/2),l+b),E=Math.min(Math.round(n+b/2),c-b);C.setProperties(_),C.setProperties({visible:F<E,cornerRadius:k,clipBBox:y(F,a+b,E-F,Math.max(0,s-b*2))});const B=Math.floor(a+s*(1-A.lengthRatio)/2),P=Math.ceil(a+s*(1+A.lengthRatio)/2);R[0].setProperties(g(r,B,P)),R[1].setProperties(g(h,B,P)),D[0].setProperties(u(Math.round(r+I.strokeWidth/2),l,Math.floor(a+s/2))),D[1].setProperties(u(c,Math.round(h-I.strokeWidth/2),Math.floor(a+s/2)));for(const N of T)N.setProperties({fill:f,fillOpacity:m,strokeWidth:b*2,strokeOpacity:0});C.setProperties({fill:S,fillOpacity:v,strokeWidth:0});for(const N of[...D,...R])N.setProperties(I);L.setProperties({stroke:S,strokeWidth:b,strokeOpacity:v,lineDash:x,lineDashOffset:M,cornerRadius:k,fillOpacity:0})}distanceSquared(t,e){const i=Rm.selectByClass(this,ha,pn);return Cm.nearestSquared(t,e,i).distanceSquared}get midPoint(){const t=this.datum;return t.midPoint===void 0?($N.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):t.midPoint}};import{_ModuleSupport as qN}from"ag-charts-community";var{BaseProperties:Em,AbstractBarSeriesProperties:JN,SeriesTooltip:tC,Validate:lt,COLOR_STRING:ol,FUNCTION:eC,LINE_DASH:wm,OBJECT:zd,POSITIVE_NUMBER:un,RATIO:sl,STRING:Re,mergeDefaults:iC}=qN,_m=class extends Em{constructor(){super(...arguments),this.lengthRatio=.5}};d([lt(sl)],_m.prototype,"lengthRatio",2);var da=class extends Em{};d([lt(ol,{optional:!0})],da.prototype,"stroke",2),d([lt(un)],da.prototype,"strokeWidth",2),d([lt(sl)],da.prototype,"strokeOpacity",2),d([lt(wm,{optional:!0})],da.prototype,"lineDash",2),d([lt(un)],da.prototype,"lineDashOffset",2);var ut=class extends JN{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new _m,this.whisker=new da,this.tooltip=new tC,this.backgroundFill="white"}toJson(){const{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}=this,a=super.toJson();return a.whisker=iC(a.whisker,{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}),a}};d([lt(Re)],ut.prototype,"xKey",2),d([lt(Re)],ut.prototype,"minKey",2),d([lt(Re)],ut.prototype,"q1Key",2),d([lt(Re)],ut.prototype,"medianKey",2),d([lt(Re)],ut.prototype,"q3Key",2),d([lt(Re)],ut.prototype,"maxKey",2),d([lt(Re,{optional:!0})],ut.prototype,"xName",2),d([lt(Re,{optional:!0})],ut.prototype,"yName",2),d([lt(Re,{optional:!0})],ut.prototype,"minName",2),d([lt(Re,{optional:!0})],ut.prototype,"q1Name",2),d([lt(Re,{optional:!0})],ut.prototype,"medianName",2),d([lt(Re,{optional:!0})],ut.prototype,"q3Name",2),d([lt(Re,{optional:!0})],ut.prototype,"maxName",2),d([lt(ol,{optional:!0})],ut.prototype,"fill",2),d([lt(sl)],ut.prototype,"fillOpacity",2),d([lt(ol)],ut.prototype,"stroke",2),d([lt(un)],ut.prototype,"strokeWidth",2),d([lt(sl)],ut.prototype,"strokeOpacity",2),d([lt(wm)],ut.prototype,"lineDash",2),d([lt(un)],ut.prototype,"lineDashOffset",2),d([lt(un)],ut.prototype,"cornerRadius",2),d([lt(eC,{optional:!0})],ut.prototype,"itemStyler",2),d([lt(zd)],ut.prototype,"cap",2),d([lt(zd)],ut.prototype,"whisker",2),d([lt(zd)],ut.prototype,"tooltip",2),d([lt(ol)],ut.prototype,"backgroundFill",2);var{extractDecoratedProperties:Pm,fixNumericExtent:oC,keyProperty:sC,mergeDefaults:Fd,SeriesNodePickMode:Bm,SMALLEST_KEY_INTERVAL:aC,valueProperty:gn,diff:nC,animationValidation:rC,computeBarFocusBounds:lC,createDatumId:zm,Color:Vd,ContinuousScale:cC,motion:Fm}=Bd,hC=class extends Bd.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},Gd=class extends Bd.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[Bm.NEAREST_NODE,Bm.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},pathsPerSeries:[],hasHighlightedLabels:!0}),this.properties=new ut,this.NodeEvent=hC}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:p,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),g=[];r&&this.processedData&&g.push(nC(this.id,this.processedData)),r&&g.push(rC());const{processedData:y}=await this.requestDataModel(t,this.data,{props:[sC(e,p,{id:"xValue"}),gn(i,u,{id:"minValue"}),gn(o,u,{id:"q1Value"}),gn(s,u,{id:"medianValue"}),gn(a,u,{id:"q3Value"}),gn(n,u,{id:"maxValue"}),...h?[aC]:[],...g]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];if(t===this.getBarDirection()){const n=i.getDomain(this,"minValue","value",e),r=i.getDomain(this,"maxValue","value",e);return oC([Math.min(...n),Math.max(...r)])}const{index:o,def:s}=i.resolveProcessedDataDefById(this,"xValue"),a=e.domain.keys[o];return s.type==="key"&&s.valueType==="category"?a:this.padBandExtent(a)}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{visible:t,dataModel:e,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(e&&i!=null&&i.rawData.length!==0&&o&&s))return;const{xKey:a,fill:n,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:p,lineDashOffset:u,cap:g,whisker:y}=this.properties,f=[],m=e.resolveKeysById(this,"xValue",i),S=e.resolveColumnById(this,"minValue",i),b=e.resolveColumnById(this,"q1Value",i),v=e.resolveColumnById(this,"medianValue",i),x=e.resolveColumnById(this,"q3Value",i),M=e.resolveColumnById(this,"maxValue",i),{barWidth:k,groupIndex:A}=this.updateGroupScale(o),I=cC.is(o.scale)?k*-.5:0,{groupScale:O}=this,T=this.isVertical(),L={itemId:a,nodeData:f,labelData:[],scales:this.calculateScaling(),visible:this.visible};return t&&i.rawData.forEach((C,D)=>{const R=m[D];if(R==null)return;const _=S[D],F=b[D],E=v[D],B=x[D],P=M[D];if([_,F,E,B,P].some(K=>typeof K!="number")||_>F||F>E||E>B||B>P)return;const N={xValue:Math.round(o.scale.convert(R)),minValue:Math.round(s.scale.convert(_)),q1Value:Math.round(s.scale.convert(F)),medianValue:Math.round(s.scale.convert(E)),q3Value:Math.round(s.scale.convert(B)),maxValue:Math.round(s.scale.convert(P))};N.xValue+=Math.round(O.convert(String(A)))+I;const w=Math.round(k),z=Math.abs(N.q3Value-N.q1Value),V=N.xValue+w/2,G=Math.min(N.q3Value,N.q1Value)+z/2,W={x:T?V:G,y:T?G:V};let H;T?H={x:W.x-w/2,y:N.minValue,width:w,height:N.maxValue-N.minValue}:H={x:N.minValue,y:W.y-w/2,width:N.maxValue-N.minValue,height:w},f.push({series:this,itemId:R,datum:C,datumIndex:D,xKey:a,bandwidth:w,scaledValues:N,cap:g,whisker:y,fill:n,fillOpacity:r,stroke:l,strokeWidth:c,strokeOpacity:h,lineDash:p,lineDashOffset:u,midPoint:W,focusRect:H})}),L}legendItemSymbol(){const{fill:t,fillOpacity:e,stroke:i,strokeWidth:o,strokeOpacity:s}=this.properties;return{marker:{fill:t,fillOpacity:e,stroke:i,strokeOpacity:s,strokeWidth:o}}}getLegendData(t){const{id:e,ctx:{legendManager:i},visible:o}=this,{xKey:s,yName:a,showInLegend:n,legendItemName:r}=this.properties;return!s||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:o&&i.getItemEnabled({seriesId:e,itemId:e}),label:{text:r??a??e},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!n}]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:p,q3Key:u,q3Name:g,minKey:y,minName:f,maxKey:m,maxName:S,legendItemName:b,tooltip:v}=s,x=this.getCategoryAxis(),M=this.getValueAxis();if(!i||!o||o.rawData.length===0||!x||!M)return;const{datumIndex:k}=t,A=o.rawData[k],I=i.resolveKeysById(this,"xValue",o)[k],O=i.resolveColumnById(this,"minValue",o)[k],T=i.resolveColumnById(this,"q1Value",o)[k],L=i.resolveColumnById(this,"medianValue",o)[k],C=i.resolveColumnById(this,"q3Value",o)[k],D=i.resolveColumnById(this,"maxValue",o)[k];if(I==null)return;const R=this.getItemBaseStyle(!1);return Object.assign(R,this.getItemStyleOverrides(String(k),A,R,!1)),v.formatTooltip({heading:x.formatDatum(I),title:b??r,symbol:this.legendItemSymbol(),data:[{label:f,fallbackLabel:y,value:M.formatDatum(O)},{label:p,fallbackLabel:h,value:M.formatDatum(T)},{label:c,fallbackLabel:l,value:M.formatDatum(L)},{label:g,fallbackLabel:u,value:M.formatDatum(C)},{label:S,fallbackLabel:m,value:M.formatDatum(D)}]},{seriesId:e,datum:A,title:r,xKey:a,xName:n,yName:r,medianKey:l,medianName:c,q1Key:h,q1Name:p,q3Key:u,q3Name:g,minKey:y,minName:f,maxKey:m,maxName:S,...R})}animateEmptyUpdateReady({datumSelection:t}){const e=this.isVertical(),{from:i,to:o}=YN(e);Fm.resetMotion([t],jN(e)),Fm.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[t],i,o,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}getItemBaseStyle(t){const{properties:e}=this,{cornerRadius:i,cap:o,whisker:s}=e,a=t?e.highlightStyle.item:void 0;return{fill:a?.fill??e.fill,fillOpacity:a?.fillOpacity??e.fillOpacity,stroke:a?.stroke??e.stroke,strokeWidth:a?.strokeWidth??e.strokeWidth,strokeOpacity:a?.strokeOpacity??e.strokeOpacity,lineDash:a?.lineDash??e.lineDash??[],lineDashOffset:a?.lineDashOffset??e.lineDashOffset,cornerRadius:i,cap:o,whisker:s}}getItemStyleOverrides(t,e,i,o){const{id:s,properties:a}=this,{xKey:n,minKey:r,q1Key:l,medianKey:c,q3Key:h,maxKey:p,itemStyler:u}=a;if(u!=null)return this.cachedDatumCallback(zm(t,o?"highlight":"node"),()=>u({seriesId:s,datum:e,xKey:n,minKey:r,q1Key:l,medianKey:c,q3Key:h,maxKey:p,highlighted:o,...i}))}updateDatumNodes({datumSelection:t,isHighlight:e}){const i=this.isVertical(),o=this.getValueAxis()?.isReversed();t.each((s,a)=>{let n=this.getFormattedStyles(a,e?"highlight":"node");e&&(n=Fd(this.properties.highlightStyle.item,n));const{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}=n;n.whisker=Fd(n.whisker,{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}),s.updateDatumStyles(a,n,i,o)})}updateLabelNodes(){}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}nodeFactory(){return new QN}getFormattedStyles(t,e){const{id:i,properties:o}=this,{xKey:s,minKey:a,q1Key:n,medianKey:r,q3Key:l,maxKey:c,itemStyler:h,backgroundFill:p,cornerRadius:u}=o,{datum:g,stroke:y,strokeWidth:f,strokeOpacity:m,lineDash:S,lineDashOffset:b,cap:v,whisker:x}=t;let M,k;if(!0)M=t.fill,k=o.fillOpacity;else{try{M=Vd.mix(Vd.fromString(p),Vd.fromString(t.fill),o.fillOpacity).toString()}catch{M=t.fill}k=void 0}const I={fill:M,fillOpacity:k,stroke:y,strokeWidth:f,strokeOpacity:m,lineDash:S,lineDashOffset:b,cornerRadius:u,cap:Pm(v),whisker:Pm(x)};if(h){const O=this.cachedDatumCallback(zm(g.index,e),()=>h({datum:g,seriesId:i,highlighted:e==="highlight",...I,xKey:s,minKey:a,q1Key:n,medianKey:r,q3Key:l,maxKey:c}));if(O)return Fd(O,I)}return I}computeFocusBounds({datumIndex:t}){return lC(this.contextNodeData?.nodeData[t].focusRect)}};Gd.className="BoxPlotSeries",Gd.type="box-plot";import{_ModuleSupport as dC}from"ag-charts-community";var{CARTESIAN_AXIS_TYPE:Vm}=dC.ThemeConstants,pC={series:{direction:"vertical",strokeWidth:2},axes:{[Vm.NUMBER]:{crosshair:{snap:!1}},[Vm.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},{Color:Wd,swapAxisCondition:uC,ThemeSymbols:{DEFAULT_BACKGROUND_COLOUR:gC},ThemeConstants:{CARTESIAN_AXIS_TYPE:Gm,CARTESIAN_POSITION:Wm}}=KN,yC={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",moduleFactory:t=>new Gd(t),tooltipDefaults:{range:"exact"},defaultAxes:uC([{type:Gm.NUMBER,position:Wm.LEFT},{type:Gm.CATEGORY,position:Wm.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:pC,groupable:!0,paletteFactory:({takeColors:t,themeTemplateParameters:e})=>{const i=e.get(gC),o=(Array.isArray(i)?i[0]:i)??"white",{fills:[s],strokes:[a]}=t(1);let n;try{n=Wd.mix(Wd.fromString(o),Wd.fromString(s),.3).toString()}catch{n=s}return{fill:n,stroke:a,backgroundFill:o}}};import{_ModuleSupport as fC}from"ag-charts-community";import{_ModuleSupport as Ud}from"ag-charts-community";import{_ModuleSupport as Hd}from"ag-charts-community";var mC=1e3,Um=ne,xC=Ae,SC=ke,Hm=Me;function bC(t,e,i,o){if(t.length<mC)return;const[s,a]=cn(o);let n=ln(t),{indexData:r,valueData:l}=hn(t,e,i,s,a,n);const c=[{maxRange:n,indexData:r}];for(;n>64;)({indexData:r,valueData:l,maxRange:n}=dn(r,l,n)),c.push({maxRange:n,indexData:r});return c.reverse(),c}var{fixNumericExtent:vC,keyProperty:MC,createDatumId:Km,SeriesNodePickMode:Ym,ChartAxisDirection:jm,SMALLEST_KEY_INTERVAL:kC,valueProperty:al,diff:AC,animationValidation:DC,computeBarFocusBounds:IC,visibleRangeIndices:Kd,Logger:Xm,ContinuousScale:TC,OrdinalTimeScale:OC}=Hd,LC=class extends Hd.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}},Zm=class extends Hd.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[Ym.AXIS_ALIGNED,Ym.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},pathsPerSeries:[]}),this.NodeEvent=LC,this.dataAggregationFilters=void 0}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a}=this.properties,n=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:h,yScaleType:p}=this.getScaleInformation({xScale:r,yScale:l}),u=[];n&&(this.processedData&&u.push(AC(this.id,this.processedData)),u.push(DC())),i&&u.push(al(i,p,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{dataModel:g,processedData:y}=await this.requestDataModel(t,this.data,{props:[MC(e,h,{id:"xValue"}),al(o,p,{id:"closeValue"}),al(s,p,{id:"highValue"}),al(a,p,{id:"lowValue"}),...c?[kC]:[],...u]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.dataAggregationFilters=this.aggregateData(g,y),this.animationState.transition("updateData")}aggregateData(t,e){if(e.rawData.length===0)return;const i=this.axes[jm.X];if(i==null||!(TC.is(i.scale)||OC.is(i.scale)))return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"highValue",e),a=t.resolveColumnById(this,"lowValue",e),{index:n}=t.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[n];return bC(o,s,a,r)}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];const{openKey:o}=this.properties;if(t===this.getBarDirection()){const r=i.getDomain(this,"lowValue","value",e),l=i.getDomain(this,"highValue","value",e),c=o?i.getDomain(this,"openValue","value",e):[],h=i.getDomain(this,"closeValue","value",e);return vC([Math.min(...r,...l,...c,...h),Math.max(...l,...r,...c,...h)])}const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=e.domain.keys[s];return a.type==="key"&&a.valueType==="category"?n:this.padBandExtent(n)}getSeriesRange(t,e){const{dataModel:i,processedData:o}=this;if(!i||!o)return[NaN,NaN];const a=this.axes[jm.X].scale,n=i.resolveKeysById(this,"xValue",o),r=a.bandwidth??0,[l,c]=Kd(n.length,e,h=>{const p=a.convert(n[h]);return[p,p+r]});return i.getDomainBetweenRange(this,["highValue","lowValue"],[l,c],o)}createNodeData(){const{visible:t,dataModel:e,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!(e&&i!=null&&i.rawData.length!==0&&o&&s))return;const a=[],{xKey:n,highKey:r,lowKey:l}=this.properties,{rawData:c}=i,h=e.resolveKeysById(this,"xValue",i),p=e.resolveColumnById(this,"openValue",i),u=e.resolveColumnById(this,"closeValue",i),g=e.resolveColumnById(this,"highValue",i),y=e.resolveColumnById(this,"lowValue",i),{groupScale:f}=this,{barWidth:m,groupIndex:S}=this.updateGroupScale(o),b=f.convert(String(S)),v=m>=1?m:f.rawBandwidth,x={itemId:n,nodeData:a,labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!t)return x;const M=(D,R,_,F,E,B,P,N)=>{const w=c[D],z=o.scale.convert(R)+b+P/2,V=s.scale.convert(_),G=s.scale.convert(F),W=s.scale.convert(E),H=s.scale.convert(B),K=F>_,Q=K?"up":"down",st=Math.min(W,H),tt=Math.max(W,H)-st,$={x:z,y:st+tt/2};a.push({series:this,itemId:Q,datum:w,datumIndex:D,xKey:n,xValue:R,openValue:_,closeValue:F,highValue:E,lowValue:B,midPoint:$,aggregatedValue:F,isRising:K,centerX:z,width:P,y:st,height:tt,yOpen:V,yClose:G,crisp:N})},{dataAggregationFilters:k}=this,A=o.scale,[I,O]=A.range,T=O-I,L=D=>A.convert(h[D])+b,C=k?.find(D=>D.maxRange>T);if(C==null){let[D,R]=Kd(c.length,o.range,_=>{const F=L(_);return[F,F+v]});i.rawData.length<1e3&&(D=0,R=i.rawData.length);for(let _=D;_<R;_+=1){const F=h[_];if(F==null)continue;const E=p[_],B=u[_],P=g[_],N=y[_],w=N!=null&&N<=E&&N<=B,z=P!=null&&P>=E&&P>=B;if(!w){Xm.warnOnce(`invalid low value for key [${l}] in data element, low value cannot be higher than datum open or close values`);continue}if(!z){Xm.warnOnce(`invalid high value for key [${r}] in data element, high value cannot be lower than datum open or close values.`);continue}M(_,F,E,B,P,N,v,!0)}}else{const{maxRange:D,indexData:R}=C,[_,F]=Kd(D,o.range,E=>{const B=E*Ye,P=R[B+Um],N=R[B+Hm];if(P!==-1)return[L(P),L(N)+v]});for(let E=_;E<F;E+=1){const B=E*Ye,P=R[B+Um],N=R[B+Hm],w=R[B+xC],z=R[B+SC];if(P===-1)continue;const V=(P+N)/2|0,G=h[V];if(G==null)continue;const W=p[P],H=u[N],K=g[w],Q=y[z],st=Math.abs(L(N)-L(P))+v;M(V,G,W,H,K,Q,st,!1)}}return x}isVertical(){return!0}isLabelEnabled(){return!1}updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}updateLabelNodes(t){}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}getItemBaseStyle(t,e){const{properties:i}=this,o=i.item[t],s=e?i.highlightStyle.item:void 0;return{fill:s?.fill??o.fill,fillOpacity:s?.fillOpacity??o.fillOpacity,stroke:s?.stroke??o.stroke,strokeWidth:s?.strokeWidth??o.strokeWidth,strokeOpacity:s?.strokeOpacity??o.strokeOpacity,lineDash:s?.lineDash??o.lineDash,lineDashOffset:s?.lineDashOffset??o.lineDashOffset}}getItemStyleOverrides(t,e,i,o,s){const{id:a,properties:n}=this,{itemStyler:r}=n;if(r==null)return;const{xKey:l,openKey:c,closeKey:h,highKey:p,lowKey:u}=n;return this.cachedDatumCallback(Km(t,s?"highlight":"node"),()=>r({seriesId:a,datum:e,itemId:i,xKey:l,openKey:c,closeKey:h,highKey:p,lowKey:u,highlighted:s,...o}))}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:h,highName:p,lowKey:u,lowName:g,closeKey:y,closeName:f,legendItemName:m,tooltip:S}=s,b=this.getCategoryAxis(),v=this.getValueAxis();if(!i||!o||o.rawData.length===0||!b||!v)return;const{datumIndex:x}=t,M=o.rawData[x],k=i.resolveKeysById(this,"xValue",o)[x],A=i.resolveColumnById(this,"openValue",o)[x],I=i.resolveColumnById(this,"highValue",o)[x],O=i.resolveColumnById(this,"lowValue",o)[x],T=i.resolveColumnById(this,"closeValue",o)[x];if(k==null)return;const L=T>=A?"up":"down",C=this.properties.item[L],D=this.getItemBaseStyle(L,!1);return Object.assign(D,this.getItemStyleOverrides(String(x),M,L,D,!1)),S.formatTooltip({heading:b.formatDatum(k),title:m,symbol:{marker:{fill:C.fill??C.stroke,fillOpacity:C.fillOpacity??C.strokeOpacity??1,stroke:C.stroke,strokeWidth:C.strokeWidth??1,strokeOpacity:C.strokeOpacity??1}},data:[{label:c,fallbackLabel:l,value:v.formatDatum(A)},{label:p,fallbackLabel:h,value:v.formatDatum(I)},{label:g,fallbackLabel:u,value:v.formatDatum(O)},{label:f,fallbackLabel:y,value:v.formatDatum(T)}]},{seriesId:e,datum:M,title:r,itemId:L,xKey:a,xName:n,yName:r,openKey:l,openName:c,highKey:h,highName:p,lowKey:u,lowName:g,closeKey:y,closeName:f,...D})}getDatumId(t){return Km(t.xValue)}computeFocusBounds(t){const e=this.getNodeData()?.at(t.datumIndex);if(e==null)return;const{centerX:i,y:o,width:s,height:a}=e,n={x:i-s/2,y:o,width:s,height:a};return IC(n)}};import{_ModuleSupport as NC}from"ag-charts-community";import{_ModuleSupport as CC}from"ag-charts-community";var{Path:RC,ScenePathChangeDetection:Co,BBox:EC}=CC,Ti=class extends RC{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1,this.strokeAlignment=0}computeBBox(){const{centerX:t,y:e,width:i,height:o}=this;return new EC(t-i/2,e,i,o)}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}get midPoint(){return{x:this.centerX,y:this.y+this.height/2}}alignedCoordinates(){const{y:t,width:e,height:i,crisp:o,strokeAlignment:s}=this;let{centerX:a,yOpen:n,yClose:r}=this,l=a-e/2,c=a+e/2,h=t,p=t+i;if(o&&e>1){a=this.align(a),n=this.align(n),r=this.align(r);const g=this.align(e/2);l=a-g,c=a+g,h=this.align(t),p=h+this.align(h,i)}const u=(h+p)/2;return a+=s,l+=s,c+=s,h-=s,p+=s,n+=n<u?s:-s,r+=r<u?s:-s,{centerX:a,x0:l,x1:c,y0:h,y1:p,yOpen:n,yClose:r}}executeStroke(t,e){const{width:i,strokeWidth:o}=this;i<o&&(t.lineWidth=i),super.executeStroke(t,e)}};d([Co()],Ti.prototype,"centerX",2),d([Co()],Ti.prototype,"y",2),d([Co()],Ti.prototype,"width",2),d([Co()],Ti.prototype,"height",2),d([Co()],Ti.prototype,"yOpen",2),d([Co()],Ti.prototype,"yClose",2),d([Co()],Ti.prototype,"crisp",2),d([Co()],Ti.prototype,"strokeAlignment",2);var wC=class extends Ti{updatePath(){const{path:t}=this,{centerX:e,x0:i,x1:o,y0:s,y1:a,yOpen:n,yClose:r}=this.alignedCoordinates();t.clear(),t.moveTo(e,s),t.lineTo(e,a),Math.abs(o-i)>1&&(t.moveTo(i,n),t.lineTo(e,n),t.moveTo(e,r),t.lineTo(o,r))}},{ScenePathChangeDetection:yn,ExtendedPath2D:_C}=NC,pa=class extends Ti{constructor(){super(...arguments),this.wickPath=new _C,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0}updatePath(){const{path:t,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a,wickStroke:n,wickStrokeWidth:r,wickStrokeOpacity:l,wickLineDash:c,wickLineDashOffset:h,strokeAlignment:p}=this,{centerX:u,x0:g,x1:y,y0:f,y1:m,yOpen:S,yClose:b}=this.alignedCoordinates();this.path.clear(),this.wickPath.clear();const x=n!=null&&n!==e||r!=null&&r!==i||l!=null&&l!==o||c!=null&&c!==s||h!=null&&h!==a?this.wickPath:t;if(Math.abs(y-g)<=3){x.moveTo(u,f),x.lineTo(u,m);return}const M=Math.min(S,b),k=Math.max(S,b);x.moveTo(u,f),x.lineTo(u,M+i/2),x.moveTo(u,m),x.lineTo(u,k-i/2);const A=p+i/2,I=k-M-2*A;if(I>0)t.rect(g+A,M+A,y-g-2*A,I);else{const O=(M+k)/2;t.moveTo(g,O),t.lineTo(y,O)}}drawPath(t){super.drawPath(t);const{wickPath:e}=this;if(e.isEmpty())return;const{stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,wickStroke:r=i,wickStrokeWidth:l=o,wickStrokeOpacity:c=s,wickLineDash:h=a,wickLineDashOffset:p=n}=this;l!==0&&(t.globalAlpha*=c,typeof r=="string"&&(t.strokeStyle=r),t.lineWidth=l,h!=null&&t.setLineDash(h),t.lineDashOffset=p,t.stroke(e.getPath2D()))}};d([yn()],pa.prototype,"wickStroke",2),d([yn()],pa.prototype,"wickStrokeWidth",2),d([yn()],pa.prototype,"wickStrokeOpacity",2),d([yn()],pa.prototype,"wickLineDash",2),d([yn()],pa.prototype,"wickLineDashOffset",2);import{_ModuleSupport as PC}from"ag-charts-community";import{_ModuleSupport as BC}from"ag-charts-community";var{BaseProperties:$m,Validate:It,AbstractBarSeriesProperties:zC,SeriesTooltip:FC,STRING:si,COLOR_STRING:VC,FUNCTION:GC,LINE_DASH:WC,OBJECT:nl,POSITIVE_NUMBER:Qm,RATIO:UC}=BC,gs=class extends $m{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([It(VC)],gs.prototype,"stroke",2),d([It(Qm)],gs.prototype,"strokeWidth",2),d([It(UC)],gs.prototype,"strokeOpacity",2),d([It(WC)],gs.prototype,"lineDash",2),d([It(Qm)],gs.prototype,"lineDashOffset",2);var Yd=class extends $m{constructor(){super(...arguments),this.up=new gs,this.down=new gs}};d([It(nl)],Yd.prototype,"up",2),d([It(nl)],Yd.prototype,"down",2);var Ee=class extends zC{};d([It(si)],Ee.prototype,"xKey",2),d([It(si)],Ee.prototype,"openKey",2),d([It(si)],Ee.prototype,"closeKey",2),d([It(si)],Ee.prototype,"highKey",2),d([It(si)],Ee.prototype,"lowKey",2),d([It(si,{optional:!0})],Ee.prototype,"xName",2),d([It(si,{optional:!0})],Ee.prototype,"yName",2),d([It(si,{optional:!0})],Ee.prototype,"openName",2),d([It(si,{optional:!0})],Ee.prototype,"closeName",2),d([It(si,{optional:!0})],Ee.prototype,"highName",2),d([It(si,{optional:!0})],Ee.prototype,"lowName",2);var rl=class extends Ee{constructor(){super(...arguments),this.tooltip=new FC,this.item=new Yd}};d([It(nl)],rl.prototype,"tooltip",2),d([It(nl)],rl.prototype,"item",2),d([It(GC,{optional:!0})],rl.prototype,"itemStyler",2);var{BaseProperties:jd,SeriesTooltip:HC,Validate:Gt,COLOR_STRING:Xd,FUNCTION:KC,LINE_DASH:qm,OBJECT:fn,POSITIVE_NUMBER:mn,RATIO:Zd}=PC,ua=class extends jd{};d([Gt(Xd,{optional:!0})],ua.prototype,"stroke",2),d([Gt(mn)],ua.prototype,"strokeWidth",2),d([Gt(Zd)],ua.prototype,"strokeOpacity",2),d([Gt(qm,{optional:!0})],ua.prototype,"lineDash",2),d([Gt(mn)],ua.prototype,"lineDashOffset",2);var ai=class extends jd{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new ua}};d([Gt(Xd,{optional:!0})],ai.prototype,"fill",2),d([Gt(Zd)],ai.prototype,"fillOpacity",2),d([Gt(Xd)],ai.prototype,"stroke",2),d([Gt(mn)],ai.prototype,"strokeWidth",2),d([Gt(Zd)],ai.prototype,"strokeOpacity",2),d([Gt(qm)],ai.prototype,"lineDash",2),d([Gt(mn)],ai.prototype,"lineDashOffset",2),d([Gt(mn)],ai.prototype,"cornerRadius",2),d([Gt(fn)],ai.prototype,"wick",2);var $d=class extends jd{constructor(){super(...arguments),this.up=new ai,this.down=new ai}};d([Gt(fn)],$d.prototype,"up",2),d([Gt(fn)],$d.prototype,"down",2);var ll=class extends Ee{constructor(){super(...arguments),this.item=new $d,this.tooltip=new HC}};d([Gt(fn)],ll.prototype,"item",2),d([Gt(fn)],ll.prototype,"tooltip",2),d([Gt(KC,{optional:!0})],ll.prototype,"itemStyler",2);var{createDatumId:YC}=Ud,Qd=class extends Zm{constructor(){super(...arguments),this.properties=new ll}nodeFactory(){return new pa}updateDatumNodes({datumSelection:t,isHighlight:e}){const{id:i,properties:o}=this,{xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,item:c,itemStyler:h}=o,{up:p,down:u}=c,{fill:g,fillOpacity:y,stroke:f,strokeWidth:m,strokeOpacity:S,lineDash:b,lineDashOffset:v}=p,{stroke:x,strokeWidth:M,strokeOpacity:k,lineDash:A,lineDashOffset:I}=p.wick,{fill:O,fillOpacity:T,stroke:L,strokeWidth:C,strokeOpacity:D,lineDash:R,lineDashOffset:_}=u,{stroke:F,strokeWidth:E,strokeOpacity:B,lineDash:P,lineDashOffset:N}=u.wick,w=e?o.highlightStyle.item:void 0;t.each((z,V)=>{const{isRising:G,centerX:W,width:H,y:K,height:Q,yOpen:st,yClose:tt,crisp:$}=V;let j;if(h!=null){const{fill:J,fillOpacity:X,stroke:gt,strokeWidth:rt,strokeOpacity:pt,lineDash:xt,lineDashOffset:ze}=G?p:u;j=this.cachedDatumCallback(YC(this.getDatumId(V),e?"highlight":"node"),()=>h({seriesId:i,itemId:V.itemId,xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,datum:V.datum,fill:J,fillOpacity:X,strokeOpacity:pt,stroke:gt,strokeWidth:rt,lineDash:xt,lineDashOffset:ze,highlighted:e}))}z.centerX=W,z.width=H,z.y=K,z.height=Q,z.yOpen=st,z.yClose=tt,z.crisp=$,z.fill=w?.fill??j?.fill??(G?g:O),z.fillOpacity=w?.fillOpacity??j?.fillOpacity??(G?y:T),z.stroke=w?.stroke??j?.stroke??(G?f:L),z.strokeWidth=w?.strokeWidth??j?.strokeWidth??(G?m:C),z.strokeOpacity=w?.strokeOpacity??j?.strokeOpacity??(G?S:D),z.lineDash=w?.lineDash??j?.lineDash??(G?b:R),z.lineDashOffset=w?.lineDashOffset??j?.lineDashOffset??(G?v:_);const q=j?.wick;z.wickStroke=w?.stroke??q?.stroke??(G?x:F),z.wickStrokeWidth=w?.strokeWidth??q?.strokeWidth??(G?M:E),z.wickStrokeOpacity=w?.strokeOpacity??q?.strokeOpacity??(G?k:B),z.wickLineDash=w?.lineDash??q?.lineDash??(G?A:P),z.wickLineDashOffset=w?.lineDashOffset??q?.lineDashOffset??(G?I:N),z.strokeAlignment=(j?.strokeWidth??(G?m:C))/2})}legendItemSymbol(){const{up:t,down:e}=this.properties.item,i=new Ud.LinearGradient("rgb",[{color:t.fill,offset:0},{color:t.fill,offset:.5},{color:e.fill,offset:.5}],90),o=new Ud.LinearGradient("rgb",[{color:t.stroke,offset:0},{color:t.stroke,offset:.5},{color:e.stroke,offset:.5}],90);return{marker:{fill:i,fillOpacity:t.fillOpacity,stroke:o,strokeWidth:t.strokeWidth??1,strokeOpacity:t.strokeOpacity??1}}}getLegendData(t){const{id:e,data:i,visible:o,ctx:{legendManager:s}}=this,{xKey:a,yName:n,showInLegend:r,legendItemName:l}=this.properties;return!i?.length||!a||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:o&&s.getItemEnabled({seriesId:e,itemId:e}),label:{text:l??n??e},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!r}]}};Qd.className="CandleStickSeries",Qd.type="candlestick";import{_ModuleSupport as jC}from"ag-charts-community";var{CARTESIAN_AXIS_TYPE:Jm}=jC.ThemeConstants,XC={series:{highlightStyle:{item:{strokeWidth:3}}},animation:{enabled:!1},axes:{[Jm.NUMBER]:{crosshair:{snap:!1}},[Jm.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},{CARTESIAN_AXIS_TYPE:tx,CARTESIAN_POSITION:ex}=fC.ThemeConstants,ZC={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",moduleFactory:t=>new Qd(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:tx.NUMBER,position:ex.LEFT},{type:tx.ORDINAL_TIME,position:ex.BOTTOM}],themeTemplate:XC,groupable:!1,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{fills:s,strokes:a}=t(e);return{item:{up:{fill:"transparent",stroke:a[0]},down:{fill:s[0],stroke:a[0]}}}}return{item:{up:o.up,down:o.down}}}};import{_ModuleSupport as $C}from"ag-charts-community";import{_ModuleSupport as QC}from"ag-charts-community";import{_ModuleSupport as qC}from"ag-charts-community";import{_ModuleSupport as JC}from"ag-charts-community";var{Logger:tR}=JC;function ix(t,e,i){i||(e=eR(e));const o=new Map;for(const a of t)o.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let s=0;return o.forEach((a,n)=>{s=Math.max(s,qd(o,e,a,n,-1,[])+qd(o,e,a,n,1,[])+1)}),{links:e,nodeGraph:o,maxPathLength:s}}function ox(t,e,i,o){const s=o.indexOf(e);if(s!==-1){for(let n=s;n<o.length;n+=1)i.add(o[n]);return}o.push(e);const{toNode:a}=e;for(const n of t)n.fromNode===a&&ox(t,n,i,o);o.pop()}function eR(t){const e=new Set;for(const i of t)ox(t,i,e,[]);return e.size!==0&&tR.warnOnce("Some links formed circular references. These will be removed from the output."),e.size===0?t:t.filter(i=>!e.has(i))}function qd(t,e,i,o,s,a){if(a.includes(o))return 1/0;let n=s===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(n===-1){n=0;const r=s===-1?i.linksBefore:i.linksAfter;for(const l of e){const{fromNode:c,toNode:h}=l,p=s===-1?h.id:c.id,u=s===-1?c.id:h.id,g=o===p?t.get(u):void 0;g!=null&&(r.push({node:g,link:l}),a?.push(o),n=Math.max(n,qd(t,e,g,u,s,a)+1),a?.pop())}s===-1?i.maxPathLengthBefore=n:i.maxPathLengthAfter=n}return n}var{DataModelSeries:iR,DataController:oR,Validate:sR,ARRAY:aR,keyProperty:nR,valueProperty:cl,Selection:ys,Group:ga,TransformableText:rR}=qC,Jd=class extends iR{constructor(){super(...arguments),this._chartNodes=void 0,this.nodeCount=0,this.linkCount=0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new ga({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new ga({name:"nodeGroup"})),this.focusLinkGroup=this.highlightNode.appendChild(new ga({name:"linkGroup"})),this.focusNodeGroup=this.highlightNode.appendChild(new ga({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightNode.appendChild(new ga({name:"linkGroup"})),this.highlightNodeGroup=this.highlightNode.appendChild(new ga({name:"nodeGroup"})),this.labelSelection=ys.select(this.labelGroup,rR),this.linkSelection=ys.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=ys.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=ys.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=ys.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=ys.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=ys.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes??this._chartNodes}setChartNodes(t){this._chartNodes=t,this.nodes===t&&(this.nodeDataRefresh=!0)}getNodeData(){return this.contextNodeData?.nodeData}async processData(t){const{data:e,nodes:i}=this;if(e==null||!this.properties.isValid())return;const{fromKey:o,toKey:s,sizeKey:a,idKey:n,labelKey:r}=this.properties,l=new oR("standalone",t.suppressFieldDotNotation),c=i!=null?l.request(this.id,i,{props:[nR(n,void 0,{id:"idValue",includeProperty:!1}),...r!=null?[cl(r,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,h=this.requestDataModel(t,e,{props:[cl(o,void 0,{id:"fromValue",includeProperty:!1}),cl(s,void 0,{id:"toValue",includeProperty:!1}),...a!=null?[cl(a,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});i!=null&&l.execute();const[p,u]=await Promise.all([c,h]);this.nodesDataModel=p?.dataModel,this.nodesProcessedData=p?.processedData;const g=new Map;if(p==null){const y=u.dataModel.resolveColumnById(this,"fromValue",u.processedData),f=u.dataModel.resolveColumnById(this,"toValue",u.processedData),m=S=>{const b=g.size;return{series:this,itemId:void 0,datum:{},datumIndex:b,type:1,index:b,id:S,size:0,label:S}};u.processedData.rawData.forEach((S,b)=>{const v=y[b],x=f[b];v==null||x==null||(g.has(v)||g.set(v,m(v)),g.has(x)||g.set(x,m(x)))})}else{const y=p.dataModel.resolveColumnById(this,"idValue",p.processedData),f=r!=null?p.dataModel.resolveColumnById(this,"labelValue",p.processedData):void 0;p.processedData.rawData.forEach((m,S)=>{const b=y[S],v=f?.[S];g.set(b,{series:this,itemId:void 0,datum:m,datumIndex:S,type:1,index:S,id:b,size:0,label:v})})}this.processedNodes=g}getNodeGraph(t,e,{includeCircularReferences:i}){const{dataModel:o,processedData:s}=this;if(o==null||s==null||s.rawData.length===0){const{links:y,nodeGraph:f,maxPathLength:m}=ix(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:f,links:y,maxPathLength:m}}const{sizeKey:a}=this.properties,n=o.resolveColumnById(this,"fromValue",s),r=o.resolveColumnById(this,"toValue",s),l=a!=null?o.resolveColumnById(this,"sizeValue",s):void 0,c=new Map;this.processedNodes.forEach(y=>{const f=t(y);c.set(y.id,f)});const h=[];s.rawData.forEach((y,f)=>{const m=n[f],S=r[f],b=l!=null?l[f]:1,v=c.get(m),x=c.get(S);if(b<=0||v==null||x==null)return;const M=e({series:this,itemId:void 0,datum:y,datumIndex:f,type:0,index:f,fromNode:v,toNode:x,size:b});h.push(M)});const{links:p,nodeGraph:u,maxPathLength:g}=ix(c.values(),h,i);return this.nodeCount=u.size,this.linkCount=p.length,{nodeGraph:u,links:p,maxPathLength:g}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(t){const{seriesRect:e}=t,i={seriesRectWidth:e?.width??0,seriesRectHeight:e?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),this.updateSelections();const o=this.contextNodeData?.nodeData??[],s=this.contextNodeData?.labelData??[];let a=this.ctx.highlightManager?.getActiveHighlight();if(a?.series===this&&a.type==null){const{itemId:h}=a;a=h!=null?o.find(p=>p.type===1&&p.id===h):void 0}else a?.series!==this&&(a=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=a!=null?this.properties.highlightStyle.series.dimOpacity??1:1,this.labelSelection=this.updateLabelSelection({labelData:s,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:o.filter(h=>h.type===0),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:o.filter(h=>h.type===1),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let n,r,l,c;a?.type===1?(n=o.filter(h=>h.type===0&&(h.toNode===a||h.fromNode===a)),r=n.map(h=>h.fromNode===a?h.toNode:h.fromNode),r.push(a),l=[],c=[a]):a?.type===0?(n=[a],r=[a.fromNode,a.toNode],l=[a],c=[]):(n=[],r=[],l=[],c=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:n,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:r,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:l,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:c,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(t){}getSeriesDomain(t){return[]}getSeriesRange(t,e){return[NaN,NaN]}legendItemSymbol(t,e,i={}){const{fills:o,strokes:s}=this.properties,{fill:a=o[e%o.length],fillOpacity:n=1,stroke:r=s[e%s.length],strokeWidth:l=0,strokeOpacity:c=1}=i;return{marker:{fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c}}}getLegendData(t){if(t!=="category")return[];const{showInLegend:e}=this.properties;return Array.from(this.processedNodes.values(),({id:i,label:o},s)=>({legendType:"category",id:this.id,itemId:i,seriesId:this.id,enabled:!0,label:{text:o??i},symbol:this.legendItemSymbol(1,s),hideInLegend:!e,isFixed:!0}))}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.linkSelection.each((s,a)=>{const n=s.containsPoint(t,e)?0:1/0;n<i&&(i=n,o=a)}),this.nodeSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}getDatumAriaText(t,e){if(t.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:t.index+1,count:this.linkCount,from:t.fromNode.id,to:t.toNode.id,size:t.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(t.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:t.index+1,count:this.nodeCount,description:e})}};d([sR(aR,{optional:!0,property:"nodes"})],Jd.prototype,"_chartNodes",2);import{_ModuleSupport as lR}from"ag-charts-community";var{BBox:cR,Path:hR,ScenePathChangeDetection:Ro}=lR;function hl({radius:t,startAngle:e,endAngle:i,tension:o}){const s=t*Math.cos(e),a=t*Math.sin(e),n=t*Math.cos(i),r=t*Math.sin(i),l=s*o,c=a*o,h=n*o,p=r*o;return{x:[s,l,h,n],y:[a,c,p,r]}}var to=class extends hR{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}computeBBox(){const{centerX:t,centerY:e,radius:i,startAngle1:o,endAngle1:s,startAngle2:a,endAngle2:n,tension:r}=this,l=hl({radius:i,startAngle:o,endAngle:n,tension:r}),c=hl({radius:i,startAngle:a,endAngle:s,tension:r}),h=Math.min(...l.x,...c.x),p=Math.max(...l.x,...c.x)-h,u=Math.min(...l.y,...c.y),g=Math.max(...l.y,...c.y)-u;return new cR(t+h,e+u,p,g)}tensionedCurveTo(t,e,i,o,s,a,n,r){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-t)*h+t,(o-e)*h+e,(s-n)*h+n,(a-r)*h+r,n,r)}updatePath(){const{path:t,centerX:e,centerY:i,radius:o}=this;let{startAngle1:s,endAngle1:a,startAngle2:n,endAngle2:r}=this;s>n&&([s,n]=[n,s],[a,r]=[r,a]),t.clear();const l=e+o*Math.cos(s),c=i+o*Math.sin(s);t.moveTo(l,c),this.tensionedCurveTo(l,c,e,i,e,i,e+o*Math.cos(r),i+o*Math.sin(r)),t.arc(e,i,o,r,n,!0),this.tensionedCurveTo(e+o*Math.cos(n),i+o*Math.sin(n),e,i,e,i,e+o*Math.cos(a),i+o*Math.sin(a)),t.arc(e,i,o,a,s,!0),t.closePath()}};d([Ro()],to.prototype,"centerX",2),d([Ro()],to.prototype,"centerY",2),d([Ro()],to.prototype,"radius",2),d([Ro()],to.prototype,"startAngle1",2),d([Ro()],to.prototype,"endAngle1",2),d([Ro()],to.prototype,"startAngle2",2),d([Ro()],to.prototype,"endAngle2",2),d([Ro()],to.prototype,"tension",2);import{_ModuleSupport as dR}from"ag-charts-community";var{BaseProperties:sx,SeriesTooltip:pR,SeriesProperties:uR,ARRAY:gR,COLOR_STRING:dl,COLOR_STRING_ARRAY:ax,FUNCTION:nx,LINE_DASH:rx,OBJECT:pl,POSITIVE_NUMBER:Eo,RATIO:xn,STRING:wo,Validate:it,Label:yR}=dR,tp=class extends yR{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};d([it(Eo)],tp.prototype,"spacing",2),d([it(Eo)],tp.prototype,"maxWidth",2);var Oi=class extends sx{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}};d([it(dl,{optional:!0})],Oi.prototype,"fill",2),d([it(xn)],Oi.prototype,"fillOpacity",2),d([it(dl,{optional:!0})],Oi.prototype,"stroke",2),d([it(xn)],Oi.prototype,"strokeOpacity",2),d([it(Eo)],Oi.prototype,"strokeWidth",2),d([it(rx)],Oi.prototype,"lineDash",2),d([it(Eo)],Oi.prototype,"lineDashOffset",2),d([it(xn)],Oi.prototype,"tension",2),d([it(nx,{optional:!0})],Oi.prototype,"itemStyler",2);var ni=class extends sx{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([it(Eo)],ni.prototype,"spacing",2),d([it(Eo)],ni.prototype,"width",2),d([it(dl,{optional:!0})],ni.prototype,"fill",2),d([it(xn)],ni.prototype,"fillOpacity",2),d([it(dl,{optional:!0})],ni.prototype,"stroke",2),d([it(xn)],ni.prototype,"strokeOpacity",2),d([it(Eo)],ni.prototype,"strokeWidth",2),d([it(rx)],ni.prototype,"lineDash",2),d([it(Eo)],ni.prototype,"lineDashOffset",2),d([it(nx,{optional:!0})],ni.prototype,"itemStyler",2);var re=class extends uR{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fills=[],this.strokes=[],this.label=new tp,this.link=new Oi,this.node=new ni,this.tooltip=new pR}};d([it(wo)],re.prototype,"fromKey",2),d([it(wo)],re.prototype,"toKey",2),d([it(wo)],re.prototype,"idKey",2),d([it(wo,{optional:!0})],re.prototype,"idName",2),d([it(wo,{optional:!0})],re.prototype,"labelKey",2),d([it(wo,{optional:!0})],re.prototype,"labelName",2),d([it(wo,{optional:!0})],re.prototype,"sizeKey",2),d([it(wo,{optional:!0})],re.prototype,"sizeName",2),d([it(gR,{optional:!0})],re.prototype,"nodes",2),d([it(ax)],re.prototype,"fills",2),d([it(ax)],re.prototype,"strokes",2),d([it(pl)],re.prototype,"label",2),d([it(pl)],re.prototype,"link",2),d([it(pl)],re.prototype,"node",2),d([it(pl)],re.prototype,"tooltip",2);var{SeriesNodePickMode:lx,CachedTextMeasurerPool:fR,TextWrapper:mR,TextUtils:xR,createDatumId:ul,angleBetween:gl,normalizeAngle360:SR,isBetweenAngles:cx,Logger:bR,Sector:vR,evaluateBezier:yl}=QC,fl=t=>t.startAngle+gl(t.startAngle,t.endAngle)/2,ep=class extends Jd{constructor(t){super({moduleCtx:t,pickModes:[lx.NEAREST_NODE,lx.EXACT_SHAPE_MATCH]}),this.properties=new re}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new to}nodeFactory(){return new vR}createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n,maxWidth:r,fontSize:l},node:{width:c,spacing:h}}=this.properties,p=e/2,u=i/2;let g=[];const{nodeGraph:y,links:f}=this.getNodeGraph(D=>({...D,centerX:p,centerY:u,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}),D=>({...D,centerX:p,centerY:u,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0});let m=0;y.forEach(({datum:D,linksBefore:R,linksAfter:_},F)=>{const E=R.reduce((B,{link:P})=>B+P.size,0)+_.reduce((B,{link:P})=>B+P.size,0);if(E===0)y.delete(F);else{D.size=E,m+=D.size;const B=this.getLabelText(this.properties.label,{datum:D.datum,value:D.label,fromKey:o,toKey:s,sizeKey:a,size:D.size});D.label=String(B)}});let S=0;if(this.isLabelEnabled()){const D=this.properties.label.getFont();let R=0;y.forEach(({datum:_})=>{const{id:F,label:E}=_;if(E==null)return;const B=mR.wrapText(E,{maxWidth:r,font:this.properties.label,textWrap:"never"}),{width:P}=fR.measureText(B,{font:D,textAlign:"left",textBaseline:"middle"});R=Math.max(P,R),g.push({id:F,text:B,centerX:p,centerY:u,angle:NaN,radius:NaN})}),S=R+n}const b=y.size;let v=Math.min(e,i)/2-c-S,x=h/v;if(S!==0&&(b*x>=1.5*Math.PI||v<=0)&&(g=[],v=Math.min(e,i)/2-c,x=h/v),b*x>=2*Math.PI||v<=0){bR.warnOnce("There was insufficient space to display the Chord Series.");return}const M=v,k=v+c,A=Math.max((2*Math.PI-b*x)/m,0);let I=0;y.forEach(({datum:D})=>{D.innerRadius=M,D.outerRadius=k,D.startAngle=I,D.endAngle=I+D.size*A,I=D.endAngle+x;const R=(D.innerRadius+D.outerRadius)/2,_=fl(D);D.midPoint={x:D.centerX+R*Math.cos(_),y:D.centerY+R*Math.sin(_)}});const O=[];y.forEach(({datum:D,linksBefore:R,linksAfter:_})=>{const F=fl(D),E=[...R.map(P=>({link:P.link,distance:gl(fl(P.node.datum),F),after:!1})),..._.map(P=>({link:P.link,distance:gl(fl(P.node.datum),F),after:!0}))];let B=D.startAngle;E.toSorted((P,N)=>P.distance-N.distance).forEach(({link:P,after:N})=>{const w=P.size*A;N?(P.startAngle1=B,P.endAngle1=B+w):(P.startAngle2=B,P.endAngle2=B+w),B+=P.size*A}),O.push(D)});const{tension:T}=this.properties.link;f.forEach(D=>{D.radius=v;const R=hl({radius:v,startAngle:D.startAngle1,endAngle:D.endAngle2,tension:T}),_=hl({radius:v,startAngle:D.startAngle2,endAngle:D.endAngle1,tension:T}),F=yl(...R.x,.5),E=yl(...R.y,.5),B=yl(..._.x,.5),P=yl(..._.y,.5);D.midPoint={x:D.centerX+(F+B)/2,y:D.centerY+(E+P)/2},O.push(D)}),g.forEach(D=>{const R=y.get(D.id)?.datum;R!=null&&(D.radius=k+n,D.angle=SR(R.startAngle+gl(R.startAngle,R.endAngle)/2))}),g.sort((D,R)=>D.angle-R.angle);let L=1/0,C=-1/0;return g=g.filter(D=>{const R=xR.getLineHeight(l),_=Math.atan2(R/2,D.radius),F=D.angle-_,E=D.angle+_;return cx(L,F,E)||cx(C,F,E)?!1:(L=Math.min(F,L),C=Math.max(E,C),!0)}),{itemId:t,nodeData:O,labelData:g}}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{text:l,centerX:c,centerY:h,radius:p,angle:u})=>{r.visible=!0,r.translationX=c+p*Math.cos(u),r.translationY=h+p*Math.sin(u),r.text=l,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textBaseline="middle",Math.cos(u)>=0?(r.textAlign="left",r.rotation=u):(r.textAlign="right",r.rotation=u-Math.PI)})}updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>ul([e.type,e.id]))}getBaseNodeStyle(t){const{properties:e}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=e.node,l=this.getStrokeWidth(e.node.strokeWidth),c=t?e.highlightStyle.item:void 0;return{fill:c?.fill??i,fillOpacity:c?.fillOpacity??o,stroke:c?.stroke??s,strokeOpacity:c?.strokeOpacity??a,strokeWidth:c?.strokeWidth??l,lineDash:c?.lineDash??n,lineDashOffset:c?.lineDashOffset??r}}getNodeStyleOverrides(t,e,i,o,s,a,n){const{id:r,properties:l}=this,{fills:c,strokes:h}=l,{itemStyler:p}=l.node,u=a.fill??c[i%c.length],g=a.stroke??h[i%h.length],y={};if(n||(y.fill=u,y.stroke=g),p!=null){const f=this.cachedDatumCallback(ul(t,n?"highlight":"node"),()=>{const{fillOpacity:m=1,strokeOpacity:S=1,strokeWidth:b=0,lineDash:v=[],lineDashOffset:x=0}=a;return p({seriesId:r,datum:e,highlighted:n,label:s,size:o,fill:u,fillOpacity:m,stroke:g,strokeOpacity:S,strokeWidth:b,lineDash:v,lineDashOffset:x})});Object.assign(y,f)}return y}updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getBaseNodeStyle(i);e.each((s,a)=>{const{datumIndex:n,size:r,label:l}=a,c=this.getNodeStyleOverrides(String(n),a,n,r,l,o,i);s.centerX=a.centerX,s.centerY=a.centerY,s.innerRadius=a.innerRadius,s.outerRadius=a.outerRadius,s.startAngle=a.startAngle,s.endAngle=a.endAngle,s.fill=c.fill??o?.fill,s.fillOpacity=c.fillOpacity??o?.fillOpacity,s.stroke=c.stroke??o?.stroke,s.strokeOpacity=c.strokeOpacity??o?.strokeOpacity,s.strokeWidth=c.strokeWidth??o?.strokeWidth,s.lineDash=c.lineDash??o?.lineDash,s.lineDashOffset=c.lineDashOffset??o?.lineDashOffset,s.inset=s.strokeWidth/2})}updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>ul([e.type,e.index,e.fromNode.id,e.toNode.id]))}getBaseLinkStyle(t){const{properties:e}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,tension:l}=e.link,c=this.getStrokeWidth(e.link.strokeWidth),h=t?e.highlightStyle.item:void 0;return{fill:h?.fill??i,fillOpacity:h?.fillOpacity??o,stroke:h?.stroke??s,strokeOpacity:h?.strokeOpacity??a,strokeWidth:h?.strokeWidth??c,lineDash:h?.lineDash??n,lineDashOffset:h?.lineDashOffset??r,tension:l}}getLinkStyleOverrides(t,e,i,o,s){const{id:a,properties:n}=this,{fills:r,strokes:l}=n,{itemStyler:c}=n.link,h=o.fill??r[i%r.length],p=o.stroke??l[i%l.length],u={};if(s||(u.fill=h,u.stroke=p),c!=null){const g=this.cachedDatumCallback(ul(t,s?"highlight":"node"),()=>{const{fillOpacity:y=1,strokeOpacity:f=1,strokeWidth:m=0,lineDash:S=[],lineDashOffset:b=0,tension:v}=o;return c({seriesId:a,datum:e,highlighted:s,tension:v,fill:h,fillOpacity:y,stroke:p,strokeOpacity:f,strokeWidth:m,lineDash:S,lineDashOffset:b})});Object.assign(u,g)}return u}updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getBaseLinkStyle(i);e.each((s,a)=>{const{datumIndex:n}=a,r=a.fromNode.datumIndex,l=this.getLinkStyleOverrides(String(n),a,r,o,i);s.centerX=a.centerX,s.centerY=a.centerY,s.radius=a.radius,s.startAngle1=a.startAngle1,s.endAngle1=a.endAngle1,s.startAngle2=a.startAngle2,s.endAngle2=a.endAngle2,s.fill=l?.fill??o.fill,s.fillOpacity=l?.fillOpacity??o.fillOpacity,s.stroke=l?.stroke??o.stroke,s.strokeOpacity=l?.strokeOpacity??o.strokeOpacity,s.strokeWidth=l?.strokeWidth??o.strokeWidth,s.lineDash=l?.lineDash??o.lineDash,s.lineDashOffset=l?.lineDashOffset??o.lineDashOffset,s.tension=l?.tension??o.tension})}getTooltipContent(t){const{id:e,processedData:i,nodesProcessedData:o,properties:s}=this,{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,{datumIndex:h}=t,p=t.type===0?t.fromNode.index:t.index,u=t.type===0?`${t.fromNode.label} - ${t.toNode.label}`:t.label,g=t.type===0?i?.rawData[t.datumIndex]:o?.rawData[t.datumIndex],y=t.size;let f;if(t.type===0){const m=t.fromNode.datumIndex,S=this.getBaseLinkStyle(!1);Object.assign(S,this.getLinkStyleOverrides(String(h),g,m,S,!1)),f=S}else{const m=t.label,S=this.getBaseNodeStyle(!1);Object.assign(S,this.getNodeStyleOverrides(String(h),g,h,y,m,S,!1)),f=S}return c.formatTooltip({title:u,symbol:this.legendItemSymbol(t.type,p,f),data:r!=null?[{label:l,fallbackLabel:r,value:String(y)}]:[]},{seriesId:e,datum:g,title:u,fromKey:a,toKey:n,sizeKey:r,sizeName:l,size:y,...f})}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t];if(e?.type===1){for(const i of this.nodeSelection)if(i.datum===e)return i.node;return}else if(e?.type===0){for(const i of this.linkSelection)if(i.datum===e)return i.node;return}}};ep.className="ChordSeries",ep.type="chord";var{DEFAULT_FONT_FAMILY:MR,DEFAULT_LABEL_COLOUR:kR}=$C.ThemeSymbols,AR={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"chord",tooltipDefaults:{range:"exact"},moduleFactory:t=>new ep(t),themeTemplate:{series:{highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:MR,color:kR,spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0,tension:.4}},legend:{enabled:!1,toggleSeries:!1}},paletteFactory({takeColors:t,colorsCount:e}){const{fills:i,strokes:o}=t(e);return{fills:i,strokes:o}}};import{_ModuleSupport as DR}from"ag-charts-community";import{_ModuleSupport as IR}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_INSIDE_SERIES_LABEL_COLOUR:TR,DEFAULT_FONT_FAMILY:OR},ThemeConstants:{CARTESIAN_AXIS_TYPE:ya,CARTESIAN_POSITION:fa}}=IR;function hx(t){const{placement:e,...i}=t?.stageLabel??{};return t?.direction!=="horizontal"?[{type:ya.CATEGORY,position:e==="after"?fa.RIGHT:fa.LEFT,label:i},{type:ya.NUMBER,position:fa.BOTTOM}]:[{type:ya.NUMBER,position:fa.LEFT},{type:ya.CATEGORY,position:e==="before"?fa.TOP:fa.BOTTOM,label:i}]}var LR={series:{direction:"vertical",strokeWidth:0,spacingRatio:.25,label:{enabled:!0,fontSize:12,fontFamily:OR,color:TR},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:0}},axes:{[ya.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(t){return Math.abs(t.value).toFixed(t.fractionDigits??0)}}},[ya.CATEGORY]:{line:{enabled:!1}}}};import{_ModuleSupport as NR}from"ag-charts-community";import{_ModuleSupport as ip}from"ag-charts-community";import{_ModuleSupport as CR}from"ag-charts-community";var{lineDistanceSquared:ml,BBox:RR,Path:ER,ScenePathChangeDetection:_o}=CR,dx=1e-6;function px([t,e],[i,o]){return Math.abs(t-i)<=dx&&Math.abs(e-o)<=dx}var Li=class extends ER{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:t,y0:e,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this;return{x:(t+i+s+n)/4,y:(e+o+a+r)/4}}distanceSquared(t,e){if(this.containsPoint(t,e))return 0;const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c}=this;return Math.min(ml(t,e,i,o,s,a,1/0),ml(t,e,s,a,n,r,1/0),ml(t,e,n,r,l,c,1/0),ml(t,e,l,c,i,o,1/0))}computeBBox(){const{x0:t,y0:e,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this,l=Math.min(t,i,s,n),c=Math.max(t,i,s,n)-l,h=Math.min(e,o,a,r),p=Math.max(e,o,a,r)-h;return new RR(l,h,c,p)}updatePath(){const{path:t,x0:e,y0:i,x1:o,y1:s,x2:a,y2:n,x3:r,y3:l}=this,c=[[e,i],[o,s],[a,n],[r,l]];t.clear();let h,p;c.forEach(u=>{if(h!=null&&px(h,u)||p!=null&&px(p,u))return;const[g,y]=u;h==null?t.moveTo(g,y):t.lineTo(g,y),h??(h=u),p=u}),t.closePath()}};d([_o()],Li.prototype,"x0",2),d([_o()],Li.prototype,"y0",2),d([_o()],Li.prototype,"x1",2),d([_o()],Li.prototype,"y1",2),d([_o()],Li.prototype,"x2",2),d([_o()],Li.prototype,"y2",2),d([_o()],Li.prototype,"x3",2),d([_o()],Li.prototype,"y3",2);import{_ModuleSupport as wR}from"ag-charts-community";var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:_R}=wR;function ux(t,e,i,o){const{x0:s,y0:a,x1:n,y1:r,x2:l,y2:c,x3:h,y3:p,opacity:u}=t;return i?{x0:(s+h)/2,y0:(a+p)/2,x1:(n+l)/2,y1:(r+c)/2,x2:(n+l)/2,y2:(r+c)/2,x3:(s+h)/2,y3:(a+p)/2,opacity:u}:{x0:(s+n)/2,y0:(a+r)/2,x1:(s+n)/2,y1:(a+r)/2,x2:(l+h)/2,y2:(c+p)/2,x3:(l+h)/2,y3:(c+p)/2,opacity:u}}function PR(t,e){const i=a=>a==null;return{fromFn:(a,n,r)=>{r==="updated"&&i(n)?r="removed":r==="updated"&&i(a.previousDatum)&&(r="added");let l;r==="added"&&a.previousDatum==null&&e==="fade"?l={...Sn(a,n),opacity:0}:r==="unknown"||r==="added"?l=ux(n,a.previousDatum,t,e):l={x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};const c=_R[r];return{...l,phase:c}},toFn:(a,n,r)=>{let l;return r==="removed"&&a.datum==null&&e==="fade"?l={...Sn(a,n),opacity:0}:r==="removed"||i(n)?l=ux(n,a.previousDatum,t,e):l=Sn(a,n),l}}}function Sn(t,e){const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}=e;return{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}}var{SeriesNodePickMode:gx,SeriesZIndexMap:yx,valueProperty:BR,keyProperty:zR,ChartAxisDirection:FR,updateLabelNode:VR,SMALLEST_KEY_INTERVAL:GR,LARGEST_KEY_INTERVAL:WR,diff:UR,fixNumericExtent:HR,seriesLabelFadeInAnimation:fx,resetMotion:KR,resetLabelFn:YR,animationValidation:jR,computeBarFocusBounds:XR,createDatumId:ZR,ContinuousScale:$R,Group:QR,Selection:qR,PointerEvents:mx,motion:JR}=ip,tE=class extends ip.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.stageKey,this.yKey=o.properties.valueKey}},xx=class extends ip.AbstractBarSeries{constructor({moduleCtx:t,animationResetFns:e}){super({moduleCtx:t,pickModes:[gx.AXIS_ALIGNED,gx.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["stageKey"],y:["valueKey"]},directionNames:{x:[],y:[]},datumSelectionGarbageCollection:!1,animationResetFns:{datum:e.datum,label:YR}}),this.NodeEvent=tE,this.connectorNodeGroup=this.contentGroup.appendChild(new QR({name:`${this.id}-series-connectorNodes`,zIndex:yx.BACKGROUND})),this.connectorSelection=qR.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=mx.None}get pickModeAxis(){return"main-category"}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.connectorNodeGroup.zIndex=[yx.BACKGROUND,t],!0):!1}isVertical(){return!super.isVertical()}connectionFactory(){return new Li}async processData(t){if(!this.properties.isValid())return;const{stageKey:e,valueKey:i}=this.properties,{visible:o,id:s}=this,a=(y,f,m)=>o&&this.ctx.legendManager.getItemEnabled({seriesId:s,itemId:m}),n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:n,yScale:r}),p=[];this.ctx.animationManager.isSkipped()||(this.processedData&&p.push(UR(this.id,this.processedData)),p.push(jR()));const u=this.visible?{}:{forceValue:0},{processedData:g}=await this.requestDataModel(t,this.data,{props:[zR(e,c,{id:"xValue"}),BR(i,h,{id:"yValue",...u,validation:a,invalidValue:0}),...l?[GR,WR]:[],...p],groupByKeys:!1});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.largestDataInterval=g.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i,id:o,ctx:{legendManager:s}}=this;if(!e||!i)return[];const{keys:[a],values:n}=e.domain;if(t===this.getCategoryDirection()){const r=i.resolveProcessedDataDefById(this,"xValue");return r?.def.type==="key"&&r?.def.valueType==="category"?this.hasData?a.filter((l,c)=>s.getItemEnabled({seriesId:o,itemId:c})):[]:this.padBandExtent(a)}else{const r=i.resolveProcessedDataIndexById(this,"yValue"),l=n[r][1],c=[-l,l];return HR(c)}}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{hasData:t,data:e,dataModel:i,groupScale:o,processedData:s,id:a,ctx:{legendManager:n}}=this,r=this.getCategoryAxis(),l=this.getValueAxis();if(!(t&&e&&r&&l&&i&&s?.type==="ungrouped"&&s.rawData.length!==0))return;const c=r.scale,h=l.scale,p=this.getBarDirection()===FR.X,{stageKey:u,valueKey:g}=this.properties,{strokeWidth:y}=this.barStyle(),f=`${g}`,m={itemId:f,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),visible:this.visible},S=this.visible;if(!S)return m;const b=i.resolveKeysById(this,"xValue",s),v=i.resolveColumnById(this,"yValue",s),{barWidth:x,groupIndex:M}=this.updateGroupScale(r),k=$R.is(c)?x*-.5:0;let A;return s.rawData.forEach((I,O)=>{const T=S&&n.getItemEnabled({seriesId:a,itemId:O}),L=b[O];if(L==null)return;const C=Math.round(c.convert(L))+o.convert(String(M))+k,D=v[O],R=Math.round(h.convert(-D)),_=Math.round(h.convert(D)),F=Math.max(y,Math.abs(_-R)),E={x:p?Math.min(_,R):C,y:p?C:Math.min(_,R),width:p?F:x,height:p?x:F},B={x:E.x+E.width/2,y:E.y+E.height/2},P=this.createLabelData({rect:E,barAlongX:p,yDatum:D,datum:I,visible:T}),N={index:O,series:this,itemId:f,datum:I,datumIndex:O,xValue:L,yValue:D,xKey:u,yKey:g,x:E.x,y:E.y,width:E.width,height:E.height,midPoint:B,strokeWidth:y,opacity:1,label:P,visible:T};if(m.nodeData.push(N),P!=null&&m.labelData.push(P),A!=null){const w=A.rect,z=A.nodeDatum,V=A.datumIndex;p?m.connectorData.push({datum:z,datumIndex:V,x0:w.x,y0:w.y+w.height,x1:w.x+w.width,y1:w.y+w.height,x2:E.x+E.width,y2:E.y,x3:E.x,y3:E.y,opacity:1}):m.connectorData.push({datum:z,datumIndex:V,x0:w.x+w.width,y0:w.y,x1:E.x,y1:E.y,x2:E.x,y2:E.y+E.height,x3:w.x+w.width,y3:w.y+w.height,opacity:1})}T&&(A={itemId:f,rect:E,nodeDatum:N,datumIndex:O})}),m}updateNodes(t,e,i){super.updateNodes(t,e,i);const{connectorSelection:o}=this,s=this.contextNodeData?.connectorData??[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:o,connectorData:s}),this.updateConnectorNodes({connectorSelection:o})}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}updateConnectorSelection(t){const{connectorData:e,connectorSelection:i}=t;return i.update(this.connectorEnabled()?e:[],void 0,o=>this.getDatumId(o.datum))}updateConnectorNodes(t){const{fills:e,strokes:i}=this.properties,{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,strokeWidth:r,lineDash:l,lineDashOffset:c}=this.connectorStyle();t.connectorSelection.each((h,p)=>{const{datumIndex:u}=p;h.setProperties(Sn(h,p)),h.fill=o??e[u%e.length],h.fillOpacity=s,h.stroke=a??i[u%i.length],h.strokeOpacity=n,h.strokeWidth=r,h.lineDash=l,h.lineDashOffset=c})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=mx.None})}updateLabelNodes(t){t.labelSelection.each((e,i)=>{VR(e,this.properties.label,i)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{fills:a,strokes:n,stageKey:r,valueKey:l,tooltip:c,itemStyler:h}=s,p=this.getCategoryAxis(),u=this.getValueAxis();if(!i||!o||o.rawData.length===0||!p||!u)return;const{datumIndex:g}=t,y=o.rawData[g],f=i.resolveKeysById(this,"xValue",o)[g],m=i.resolveColumnById(this,"yValue",o)[g];if(f==null)return;const S={fill:a[g%a.length],stroke:n[g%n.length],...this.barStyle()};if(h!=null){const b=this.cachedDatumCallback(ZR(String(g),"node"),()=>h({seriesId:e,datum:y,stageKey:r,valueKey:l,highlighted:!1,...S}));Object.assign(S,b)}return c.formatTooltip({symbol:this.legendItemSymbol(g),data:[{label:p.formatDatum(f),value:u.formatDatum(m)}]},{seriesId:e,datum:y,title:r,stageKey:r,valueKey:l,...S})}resetAllAnimation(t){super.resetAllAnimation(t),KR([this.connectorSelection],Sn)}animateEmptyUpdateReady({labelSelection:t}){const{connectorSelection:e}=this,i=this.isVertical(),s=PR(i,"normal");JR.fromToMotion(this.id,"connectors",this.ctx.animationManager,[e],s),fx(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(t){const{labelSelection:e}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id),fx(this,"labels",this.ctx.animationManager,e)}getDatumId(t){return`${t.xValue}`}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:t}){return XR(this.contextNodeData?.nodeData[t])}legendItemSymbol(t){const{strokeWidth:e,fillOpacity:i,strokeOpacity:o}=this.barStyle(),{fills:s,strokes:a}=this.properties,n=s[t%s.length]??"black",r=a[t%a.length]??"black";return{marker:{fill:n,fillOpacity:i,stroke:r,strokeWidth:e,strokeOpacity:o}}}getLegendData(t){const{id:e,processedData:i,dataModel:o,ctx:{legendManager:s},visible:a}=this;if(!o||!i||t!=="category"||!this.properties.isValid())return[];const{showInLegend:n}=this.properties,r=o.resolveKeysById(this,"xValue",i);return i.rawData.map((l,c)=>{const h=r[c];if(h!=null)return{legendType:"category",id:e,itemId:c,seriesId:e,enabled:a&&s.getItemEnabled({seriesId:e,itemId:c}),label:{text:h},symbol:this.legendItemSymbol(c),skipAnimations:!0,hideInLegend:!n}}).filter(l=>l!=null)}};import{_ModuleSupport as eE}from"ag-charts-community";var{Label:iE,AbstractBarSeriesProperties:oE,SeriesTooltip:sE,AxisLabel:aE,Validate:ge,UNION:Sx,COLOR_STRING_ARRAY:bx,LINE_DASH:nE,OBJECT:op,POSITIVE_NUMBER:sp,RATIO:vx,STRING:Mx}=eE,ap=class extends iE{constructor(){super(...arguments),this.spacing=0}};d([ge(Sx(["before","middle","after"],"a placement"))],ap.prototype,"placement",2),d([ge(sp)],ap.prototype,"spacing",2);var kx=class extends aE{};d([ge(Sx(["before","after"],"a placement"))],kx.prototype,"placement",2);var we=class extends oE{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new ap,this.stageLabel=new kx,this.tooltip=new sE}};d([ge(Mx)],we.prototype,"stageKey",2),d([ge(Mx)],we.prototype,"valueKey",2),d([ge(bx)],we.prototype,"fills",2),d([ge(vx)],we.prototype,"fillOpacity",2),d([ge(bx)],we.prototype,"strokes",2),d([ge(sp)],we.prototype,"strokeWidth",2),d([ge(vx)],we.prototype,"strokeOpacity",2),d([ge(nE)],we.prototype,"lineDash",2),d([ge(sp)],we.prototype,"lineDashOffset",2),d([ge(op)],we.prototype,"label",2),d([ge(op)],we.prototype,"stageLabel",2),d([ge(op)],we.prototype,"tooltip",2);function Ax(t,{x:e,y:i,width:o,height:s,opacity:a}){return{x1:e,y1:i,x2:e+o,y2:i+s,opacity:a}}var{formatValue:rE,Line:lE}=NR,np=class extends xx{constructor(t){super({moduleCtx:t,animationResetFns:{datum:Ax}}),this.properties=new we}get hasData(){const{id:t,ctx:{legendManager:e}}=this,i=this.data?.reduce((o,s,a)=>o+(e.getItemEnabled({seriesId:t,itemId:a})?1:0),0);return i!=null&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}barStyle(){return{fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[],lineDashOffset:0}}connectorStyle(){const{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}=this.properties;return{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}}nodeFactory(){return new lE}createLabelData({rect:t,barAlongX:e,yDatum:i,datum:o,visible:s}){const{stageKey:a,valueKey:n,label:r}=this.properties,{spacing:l,placement:c}=r;let h,p,u,g;if(e)switch(h=t.x+t.width/2,u="center",c){case"before":p=t.y-l,g="bottom";break;case"after":p=t.y+t.height+l,g="top";break;default:p=t.y+t.height/2,g="middle"}else switch(p=t.y+t.height/2,g="middle",c){case"before":h=t.x-l,u="right";break;case"after":h=t.x+t.width+l,u="left";break;default:h=t.x+t.width/2,u="center"}return{x:h,y:p,textAlign:u,textBaseline:g,text:this.getLabelText(r,{itemId:n,value:i,datum:o,stageKey:a,valueKey:n},y=>rE(y,0)),itemId:n,datum:o,series:this,visible:s}}updateDatumNodes(t){const e=t.isHighlight?this.properties.highlightStyle.item:void 0;t.datumSelection.each((i,o)=>{i.setProperties(Ax(i,o)),i.stroke=e?.stroke,i.strokeWidth=e?.strokeWidth??0,i.strokeOpacity=e?.strokeOpacity??1,i.lineDash=e?.lineDash,i.lineDashOffset=e?.lineDashOffset??0})}};np.className="ConeFunnelSeries",np.type="cone-funnel";import{_ModuleSupport as cE}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_LABEL_COLOUR:hE,DEFAULT_FONT_FAMILY:dE},ThemeConstants:{CARTESIAN_AXIS_TYPE:Dx}}=cE,pE={series:{direction:"vertical",strokeWidth:0,label:{enabled:!0,fontSize:12,fontFamily:dE,color:hE,placement:"before",spacing:4}},seriesArea:{padding:{top:20,bottom:20}},axes:{[Dx.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(t){return Math.abs(t.value).toFixed(t.fractionDigits??0)}}},[Dx.CATEGORY]:{line:{enabled:!1}}}},uE={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"cone-funnel",moduleFactory:t=>new np(t),solo:!0,tooltipDefaults:{range:"nearest"},defaultAxes:hx,themeTemplate:pE,paletteFactory:({userPalette:t,themeTemplateParameters:e,takeColors:i,colorsCount:o})=>{const{fills:s}=i(o),a=e.get(DR.ThemeSymbols.DEFAULT_FUNNEL_SERIES_COLOR_RANGE),n=t==="inbuilt"?a:[s[0],s[1]];return{fills:n,strokes:n.slice(0)}}};import{_ModuleSupport as gE}from"ag-charts-community";import{_ModuleSupport as yE}from"ag-charts-community";var{Label:fE,DropShadow:mE,AbstractBarSeriesProperties:xE,BaseProperties:SE,SeriesTooltip:bE,AxisLabel:vE,Validate:yt,UNION:ME,BOOLEAN:kE,COLOR_STRING_ARRAY:Ix,COLOR_STRING:Tx,FUNCTION:AE,LINE_DASH:Ox,OBJECT:bn,POSITIVE_NUMBER:xl,RATIO:vn,STRING:Lx}=yE,DE=class extends fE{},Nx=class extends vE{};d([yt(ME(["before","after"],"a placement"))],Nx.prototype,"placement",2);var eo=class extends SE{constructor(){super(...arguments),this.enabled=!0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([yt(kE)],eo.prototype,"enabled",2),d([yt(Tx,{optional:!0})],eo.prototype,"fill",2),d([yt(vn)],eo.prototype,"fillOpacity",2),d([yt(Tx,{optional:!0})],eo.prototype,"stroke",2),d([yt(xl)],eo.prototype,"strokeWidth",2),d([yt(vn)],eo.prototype,"strokeOpacity",2),d([yt(Ox)],eo.prototype,"lineDash",2),d([yt(xl)],eo.prototype,"lineDashOffset",2);var Qt=class extends xE{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new eo,this.shadow=new mE().set({enabled:!1}),this.label=new DE,this.stageLabel=new Nx,this.tooltip=new bE}};d([yt(Lx)],Qt.prototype,"stageKey",2),d([yt(Lx)],Qt.prototype,"valueKey",2),d([yt(Ix)],Qt.prototype,"fills",2),d([yt(vn)],Qt.prototype,"fillOpacity",2),d([yt(Ix)],Qt.prototype,"strokes",2),d([yt(xl)],Qt.prototype,"strokeWidth",2),d([yt(vn)],Qt.prototype,"strokeOpacity",2),d([yt(Ox)],Qt.prototype,"lineDash",2),d([yt(xl)],Qt.prototype,"lineDashOffset",2),d([yt(vn)],Qt.prototype,"spacingRatio",2),d([yt(AE,{optional:!0})],Qt.prototype,"itemStyler",2),d([yt(bn)],Qt.prototype,"dropOff",2),d([yt(bn)],Qt.prototype,"shadow",2),d([yt(bn)],Qt.prototype,"label",2),d([yt(bn)],Qt.prototype,"stageLabel",2),d([yt(bn)],Qt.prototype,"tooltip",2);var{ChartAxisDirection:Cx,getRectConfig:IE,updateRect:TE,checkCrisp:OE,resetBarSelectionsFn:LE,prepareBarAnimationFunctions:Rx,midpointStartingBarPosition:Ex,formatValue:NE,Rect:CE,motion:wx}=gE,rp=class extends xx{constructor(t){super({moduleCtx:t,animationResetFns:{datum:LE}}),this.properties=new Qt}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}barStyle(){const{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}=this.properties;return{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}}connectorStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=this.properties.dropOff;return{fill:t,fillOpacity:e,stroke:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}}nodeFactory(){return new CE}createLabelData({rect:t,yDatum:e,datum:i,visible:o}){const{valueKey:s,stageKey:a,label:n}=this.properties;return{x:t.x+t.width/2,y:t.y+t.height/2,textAlign:"center",textBaseline:"middle",text:this.getLabelText(n,{itemId:a,value:e,datum:i,valueKey:s,stageKey:a},r=>NE(r,0)),itemId:a,datum:i,series:this,visible:o}}updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o}=this,{stageKey:s,valueKey:a,highlightStyle:{item:n},fills:r,strokes:l,fillOpacity:c,strokeOpacity:h,strokeWidth:p,lineDash:u,lineDashOffset:g,itemStyler:y,shadow:f}=this.properties,m=this.axes[Cx.X],S=OE(m?.scale,m?.visibleRange,this.smallestDataInterval,this.largestDataInterval),b=this.getCategoryDirection()===Cx.X;e.each((v,x)=>{const{datumIndex:M}=x,k=r[M%r.length]??"black",A=l[M%l.length]??"black",I={fill:k,stroke:A,fillOpacity:c,strokeOpacity:h,lineDash:u,lineDashOffset:g,fillShadow:f,strokeWidth:this.getStrokeWidth(p)},O=b?x.width>0:x.height>0,T=IE(this,String(x.datumIndex),{datum:x,isHighlighted:i,style:I,highlightStyle:n,itemStyler:y,seriesId:o,stageKey:s,valueKey:a});T.crisp=S,T.visible=O,TE(v,T)})}animateEmptyUpdateReady(t){super.animateEmptyUpdateReady(t);const{datumSelection:e}=t,i=this.isVertical(),s=Rx(Ex(i,"normal"));wx.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t);const{datumSelection:e}=t,{processedData:i}=this,o=i?.reduced?.diff?.[this.id],s=Rx(Ex(this.isVertical(),"fade"));wx.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s,(a,n)=>n.xValue,o)}};rp.className="FunnelSeries",rp.type="funnel";var RE={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"funnel",moduleFactory:t=>new rp(t),solo:!0,tooltipDefaults:{range:"exact"},defaultAxes:hx,themeTemplate:LR,paletteFactory:({takeColors:t})=>{const{fills:e,strokes:i}=t(1);return{fills:e,strokes:i}}};import{_ModuleSupport as EE}from"ag-charts-community";import{_ModuleSupport as lp}from"ag-charts-community";import{_ModuleSupport as wE}from"ag-charts-community";var{CachedTextMeasurerPool:_x,TextUtils:Px,TextWrapper:Sl,findMaxValue:Bx,Logger:_E}=wE;function PE(t,e){const{fontSize:i,minimumFontSize:o=i}=t,{fontSize:s,minimumFontSize:a=s}=e,n=i-o,r=s-a;let l=t.fontSize,c=e.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>o||c>a;){const p=n>0?(l-o)/n:-1,u=r>0?(c-a)/r:-1;p>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function ma(t,e){return t.lineHeight!=null&&t.fontSize!=null?t.lineHeight*e/t.fontSize:Px.getLineHeight(e)}function zx(t,e,i,o,{padding:s},a){const{spacing:n=0}=e,r=2*s,l=2*s+n,c=(e.minimumFontSize??e.fontSize)+(o.minimumFontSize??o.fontSize);if(c>a(c+l,!1).height-l)return;const h=PE(e,o),p={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight},u={fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let g,y;return Bx(0,h.length-1,f=>{const{labelFontSize:m,secondaryLabelFontSize:S}=h[f],b=f===0,v=ma(e,m),x=ma(o,S),M=a(v+x+l,b),k=M.width-r,A=M.height-l;if(v+x>A||((g==null||g.fontSize!==m)&&(p.fontSize=m,g=Vx(e,t,k,A,p,e.wrapping,b?e.overflowStrategy:"hide")),g==null||g.width>k||g.height>A)||((y==null||y.fontSize!==S)&&(u.fontSize=S,y=Vx(o,i,k,A,u,o.wrapping,b?o.overflowStrategy:"hide")),y==null))return;const I=g.height+y.height;if(!(y.width>k||I>A))return{width:Math.max(g.width,y.width),height:I+n,meta:M.meta,label:g,secondaryLabel:y}})}function Mn(t,e,{padding:i},o){const s=2*i,a=Math.min(e.minimumFontSize??e.fontSize,e.fontSize),n={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight};return Bx(a,e.fontSize,r=>{const l=ma(e,r),c=r===a,h=o(l+s,c),p=h.width-s,u=h.height-s;if(l>u)return;n.fontSize=r;const g=Sl.wrapLines(t,{maxWidth:p,maxHeight:u,font:n,textWrap:e.wrapping,overflow:(c?e.overflowStrategy:void 0)??"hide"});if(!g.length)return;const y=BE(g,{lineHeight:l,font:n,maxWidth:p,maxHeight:u});if(y)return[{fontSize:r,lineHeight:l,...y},h.meta]})}function Fx(t){return t?.minimumFontSize!=null&&t?.fontSize&&t?.minimumFontSize>t?.fontSize}function cp(t,e,i,o,s,a){const n=e.enabled?t:void 0,r=o.enabled?i:void 0;(Fx(e)||Fx(o))&&_E.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;n!=null&&r!=null&&(l=zx(n,e,r,o,s,a));let c;if(l==null&&n!=null&&(c=Mn(n,e,s,a)),c!=null){const[p,u]=c;l={width:p.width,height:p.height,meta:u,label:p,secondaryLabel:void 0}}let h;if(l==null&&n==null&&r!=null&&(h=Mn(r,o,s,a)),h!=null){const[p,u]=h;l={width:p.width,height:p.height,meta:u,label:void 0,secondaryLabel:p}}return l}function Vx(t,e,i,o,s,a,n){const r=Sl.wrapLines(e,{maxWidth:i,maxHeight:o,font:s,textWrap:a,overflow:n});if(!r.length)return;const l=ma(t,s.fontSize),{width:c}=_x.measureLines(r,{font:s});return{width:c,lineHeight:l,text:r.join(`
`),height:r.length*l,fontSize:s.fontSize}}function BE(t,{font:e,lineHeight:i=Px.defaultLineHeight,maxWidth:o,maxHeight:s=1/0}){let a=i*t.length;for(;a>s;){if(t.length===1)return;t.pop(),t[t.length-1]=Sl.appendEllipsis(t.at(-1)),a=i*t.length}const n=_x.measureLines(t,{font:e});let r,l;if(n.width>o){const c=[];l=0;for(const h of n.lineMetrics){if(h.width>o){if(!c.length)return;break}c.push(h.text),l=Math.max(l,h.width)}r=Sl.appendEllipsis(c.join(`
`))}else r=t.join(`
`),l=n.width;return{text:r,width:l,height:a}}import{_ModuleSupport as zE}from"ag-charts-community";import{_ModuleSupport as Gx}from"ag-charts-community";var{Validate:kn,NUMBER:FE,POSITIVE_NUMBER:Wx,TEXT_WRAP:VE,OVERFLOW_STRATEGY:GE}=Gx,xa=class extends Gx.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};d([kn(VE)],xa.prototype,"wrapping",2),d([kn(GE)],xa.prototype,"overflowStrategy",2),d([kn(Wx,{optional:!0})],xa.prototype,"lineHeight",2),d([kn(Wx,{optional:!0})],xa.prototype,"minimumFontSize",2);var Ni=class extends xa{constructor(){super(...arguments),this.spacing=0}};d([kn(FE)],Ni.prototype,"spacing",2);var An=class extends xa{},{CartesianSeriesProperties:WE,SeriesTooltip:UE,Validate:qt,AND:HE,ARRAY:KE,COLOR_STRING:YE,COLOR_STRING_ARRAY:jE,FUNCTION:XE,OBJECT:Ux,POSITIVE_NUMBER:Hx,RATIO:ZE,STRING:fs,TEXT_ALIGN:$E,VERTICAL_ALIGN:QE}=zE,Kt=class extends WE{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new Ni,this.tooltip=new UE}};d([qt(fs,{optional:!0})],Kt.prototype,"title",2),d([qt(fs)],Kt.prototype,"xKey",2),d([qt(fs)],Kt.prototype,"yKey",2),d([qt(fs,{optional:!0})],Kt.prototype,"colorKey",2),d([qt(fs,{optional:!0})],Kt.prototype,"xName",2),d([qt(fs,{optional:!0})],Kt.prototype,"yName",2),d([qt(fs,{optional:!0})],Kt.prototype,"colorName",2),d([qt(HE(jE,KE.restrict({minLength:1})))],Kt.prototype,"colorRange",2),d([qt(YE,{optional:!0})],Kt.prototype,"stroke",2),d([qt(ZE)],Kt.prototype,"strokeOpacity",2),d([qt(Hx,{optional:!0})],Kt.prototype,"strokeWidth",2),d([qt($E)],Kt.prototype,"textAlign",2),d([qt(QE)],Kt.prototype,"verticalAlign",2),d([qt(Hx)],Kt.prototype,"itemPadding",2),d([qt(XE,{optional:!0})],Kt.prototype,"itemStyler",2),d([qt(Ux)],Kt.prototype,"label",2),d([qt(Ux)],Kt.prototype,"tooltip",2);var{SeriesNodePickMode:Kx,computeBarFocusBounds:qE,getMissCount:JE,valueProperty:hp,ChartAxisDirection:Ci,DEFAULT_CARTESIAN_DIRECTION_KEYS:tw,DEFAULT_CARTESIAN_DIRECTION_NAMES:ew,createDatumId:iw,Logger:ow,ColorScale:sw,Rect:aw,PointerEvents:nw}=lp,rw=class extends lp.CartesianSeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.colorKey=o.properties.colorKey}},lw={left:-.5,center:0,right:-.5},cw={top:-.5,middle:0,bottom:-.5},dp=class extends lp.CartesianSeries{constructor(t){super({moduleCtx:t,directionKeys:tw,directionNames:ew,pickModes:[Kx.NEAREST_NODE,Kx.EXACT_SHAPE_MATCH],pathsPerSeries:[],hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new Kt,this.NodeEvent=rw,this.colorScale=new sw}async processData(t){const e=this.axes[Ci.X],i=this.axes[Ci.Y];if(!e||!i||!this.properties.isValid()||!this.data?.length)return;const{xKey:o,yKey:s,colorRange:a,colorKey:n}=this.properties,r=this.axes[Ci.X]?.scale,l=this.axes[Ci.Y]?.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:l}),p=this.colorScale.type,{dataModel:u,processedData:g}=await this.requestDataModel(t,this.data,{props:[hp(o,c,{id:"xValue"}),hp(s,h,{id:"yValue"}),...n?[hp(n,p,{id:"colorValue"})]:[]]});if(this.isColorScaleValid()){const y=u.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=g.domain.values[y],this.colorScale.range=a,this.colorScale.update()}}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.rawData.length,a=JE(this,i.defs.values[o].missing);return!(s===0||s===a)}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;return!e||!i?[]:t===Ci.X?e.getDomain(this,"xValue","value",i):e.getDomain(this,"yValue","value",i)}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{data:t,visible:e,axes:i,dataModel:o,processedData:s}=this,a=i[Ci.X],n=i[Ci.Y];if(!(t&&o&&s?.rawData.length&&e&&a&&n))return;if(a.type!=="category"||n.type!=="category"){ow.warnOnce(`Heatmap series expected axes to have "category" type, but received "${a.type}" and "${n.type}" instead.`);return}const{xKey:r,xName:l,yKey:c,yName:h,colorKey:p,colorName:u,textAlign:g,verticalAlign:y,itemPadding:f,label:m}=this.properties,S=o.resolveColumnById(this,"xValue",s),b=o.resolveColumnById(this,"yValue",s),v=p?o.resolveColumnById(this,"colorValue",s):void 0,x=a.scale,M=n.scale,k=(x.bandwidth??0)/2,A=(M.bandwidth??0)/2,I=[],O=[],T=x.bandwidth??10,L=M.bandwidth??10,C=(T-2*f)*lw[g],D=(L-2*f)*cw[y],R=()=>({width:T,height:L,meta:null});return s.rawData.forEach((_,F)=>{const E=S[F],B=b[F],P=x.convert(E)+k,N=M.convert(B)+A,w=v?.[F],z=w==null?void 0:this.getLabelText(m,{value:w,datum:_,colorKey:p,colorName:u,xKey:r,yKey:c,xName:l,yName:h}),V=cp(z,this.properties.label,void 0,this.properties.label,{padding:f},R),G={x:P,y:N,size:0};if(I.push({series:this,itemId:c,datumIndex:F,yKey:c,xKey:r,xValue:E,yValue:B,colorValue:w,datum:_,point:G,width:T,height:L,midPoint:{x:P,y:N},missing:w==null}),V?.label!=null){const{text:W,fontSize:H,lineHeight:K,height:Q}=V.label,{fontStyle:st,fontFamily:tt,fontWeight:$,color:j}=this.properties.label,q=G.x+C*(T-2*f),J=G.y+D*(L-2*f)-(V.height-Q)*.5;O.push({series:this,itemId:c,datum:_,text:W,fontSize:H,lineHeight:K,fontStyle:st,fontFamily:tt,fontWeight:$,color:j,textAlign:g,verticalAlign:y,x:q,y:J})}}),{itemId:this.properties.yKey??this.id,nodeData:I,labelData:O,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new aw}update(t){return this.ctx.animationManager.skipCurrentBatch(),super.update(t)}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{fill:i?.fill,fillOpacity:i?.fillOpacity??1,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity}}getItemStyleOverrides(t,e,i,o,s){const{id:a,properties:n}=this,{xKey:r,yKey:l,colorRange:c,itemStyler:h}=n,p=this.isColorScaleValid()&&i!=null?this.colorScale.convert(i):c[0];let u=o.fill==null?{fill:p}:void 0;if(h!=null){u??(u={});const g=this.cachedDatumCallback(iw(t,s?"highlight":"node"),()=>h({seriesId:a,datum:e,xKey:r,yKey:l,highlighted:s,fill:p,...o}));Object.assign(u,g)}return u}updateDatumNodes(t){const{isHighlight:e}=t,i=this.axes[Ci.X],[o,s]=i?.visibleRange??[],n=!(o!==0||s!==1),r=this.getItemBaseStyle(e);t.datumSelection.each((l,c)=>{const{datumIndex:h,colorValue:p,datum:u,point:g,width:y,height:f}=c,m=this.getItemStyleOverrides(String(h),u,p,r,e);l.crisp=n,l.x=Math.floor(g.x-y/2),l.y=Math.floor(g.y-f/2),l.width=Math.ceil(y),l.height=Math.ceil(f),l.fill=m?.fill??r.fill,l.fillOpacity=m?.fillOpacity??r.fillOpacity,l.stroke=m?.stroke??r.stroke,l.strokeWidth=m?.strokeWidth??r.strokeWidth,l.strokeOpacity=m?.strokeOpacity??r.strokeOpacity})}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t,{enabled:o}=this.properties.label,s=o?e:[];return i.update(s)}updateLabelNodes(t){t.labelSelection.each((e,i)=>{e.text=i.text,e.fontSize=i.fontSize,e.lineHeight=i.lineHeight,e.fontStyle=i.fontStyle,e.fontFamily=i.fontFamily,e.fontWeight=i.fontWeight,e.fill=i.color,e.textAlign=i.textAlign,e.textBaseline=i.verticalAlign,e.x=i.x,e.y=i.y,e.pointerEvents=nw.None})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a,colorScale:n}=this,{xKey:r,xName:l,yKey:c,yName:h,colorKey:p,colorName:u,colorRange:g,title:y,legendItemName:f,tooltip:m}=a,S=s[Ci.X],b=s[Ci.Y];if(!i||!o||o.rawData.length===0||!S||!b)return;const{datumIndex:v}=t,x=o.rawData[v],M=i.resolveColumnById(this,"xValue",o)[v],k=i.resolveColumnById(this,"yValue",o)[v],A=p!=null&&this.isColorScaleValid()?i.resolveColumnById(this,"colorValue",o)[v]:void 0;if(M==null)return;const I=[];let O;A==null?O=g[0]:(O=n.convert(A),I.push({label:u,fallbackLabel:p,value:String(A)})),I.push({label:l,fallbackLabel:r,value:S.formatDatum(M)},{label:h,fallbackLabel:c,value:b.formatDatum(k)});const T=O!=null?{marker:{shape:"square",fill:O,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1}}:void 0,L=this.getItemBaseStyle(!1);return Object.assign(L,this.getItemStyleOverrides(String(v),x,A,L,!1)),m.formatTooltip({title:y??f,symbol:T,data:I},{seriesId:e,datum:x,title:y,xKey:r,xName:l,yKey:c,yName:h,colorKey:p,colorName:u,...L})}getLegendData(t){return t!=="gradient"||!this.properties.isValid()||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t];if(e===void 0)return;const{width:i,height:o,midPoint:s}=e,a={x:s.x-i/2,y:s.y-o/2,width:i,height:o};return qE(a)}};dp.className="HeatmapSeries",dp.type="heatmap";import{_ModuleSupport as hw}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:dw,DEFAULT_LABEL_COLOUR:pw},ThemeConstants:{FONT_SIZE:uw}}=hw,gw={series:{label:{enabled:!1,color:pw,fontSize:uw.SMALL,fontFamily:dw,wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},{ThemeSymbols:{DEFAULT_DIVERGING_SERIES_COLOR_RANGE:yw,DEFAULT_BACKGROUND_COLOUR:fw},ThemeConstants:{CARTESIAN_AXIS_TYPE:Yx,CARTESIAN_POSITION:jx}}=EE,mw={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",moduleFactory:t=>new dp(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Yx.CATEGORY,position:jx.LEFT},{type:Yx.CATEGORY,position:jx.BOTTOM}],themeTemplate:gw,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,themeTemplateParameters:o})=>{const s=o.get(yw),a=o.get(fw),n=(Array.isArray(a)?a[0]:a)??"white",{fills:r,strokes:l}=t(e);return{stroke:i==="inbuilt"?n:l[0],colorRange:i==="inbuilt"?s:[r[0],r[1]]}}};import{_ModuleSupport as xw}from"ag-charts-community";import{_ModuleSupport as Xx}from"ag-charts-community";import"ag-charts-community";var Sw=1e3,Zx=10;function $x(t,e,i,o,s,a){const n=t[a];if(n==null)return!1;const r=el(n,e,i),l=il(r,s);return a===o[l+ne]||a===o[l+Me]||a===o[l+ke]||a===o[l+Ae]}function bw(t,e,i){if(t.length<Sw)return;const[o,s]=cn(i);let a=ln(t,Zx);const{indexData:n,valueData:r}=hn(t,e,e,o,s,a);let l=[];for(let h=0;h<t.length;h+=1)$x(t,o,s,n,a,h)&&l.push(h);const c=[{maxRange:a,indices:l}];for(;l.length>Zx&&a>64;)({maxRange:a}=dn(n,r,a,{inPlace:!0})),l=l.filter($x.bind(null,t,o,s,n,a)),c.push({maxRange:a,indices:l});return c.reverse(),c}var{ChartAxisDirection:vw,ContinuousScale:Mw,OrdinalTimeScale:kw}=Xx,Aw=class extends Xx.LineSeries{aggregateData(t,e){if(e.rawData.length===0)return;const i=this.axes[vw.X];if(i==null||!(Mw.is(i.scale)||kw.is(i.scale)))return;const o=t.resolveColumnById(this,"xValue",e),s=t.resolveColumnById(this,"yValueRaw",e),a=t.getDomain(this,"xValue","value",e);return bw(o,s,a)}},{LineSeriesModule:Dw}=xw,Iw={...Dw,type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"line",moduleFactory:t=>new Aw(t)};import{_ModuleSupport as Tw}from"ag-charts-community";import{_ModuleSupport as Ow}from"ag-charts-community";var{ColorScale:Lw}=Ow;function Qx(t){if(t==null)return[];const e=new Lw;e.domain=[0,1],e.range=t;const i=5;return Array.from({length:5},(o,s)=>e.convert(s/(i-1)))}import{_ModuleSupport as Dn}from"ag-charts-community";var qx={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function Jx(t,e){if(t==null)return"";if(e==null)return String(t);const[i,o]=e.scale.domain,s=i!==0?Math.ceil(Math.log10(Math.abs(i))):0,a=o!==0?Math.ceil(Math.log10(Math.abs(o))):0,n=Math.max(2-Math.max(s,a),0);return t.toFixed(n)}function In(t,e,i){if(e.text!=null)return e.text;const o=i??e.value,s=e?.formatter?.({seriesId:t.id,datum:void 0,value:o});if(s!=null)return String(s)}import{Marker as Nw}from"ag-charts-community";var pp=class extends Nw{updatePath(){const{x:t,y:e,path:i,size:o}=this;i.clear(),i.moveTo(t,e-o/2),i.lineTo(t,e+o/2)}};pp.className="LineMarker";import{_ModuleSupport as Cw}from"ag-charts-community";var{BaseProperties:Rw,Validate:tS,COLOR_STRING:Ew,NUMBER:ww,Logger:_w,ColorScale:Pw}=Cw,Sa=class extends Rw{constructor(){super(...arguments),this.color="black"}};d([tS(ww,{optional:!0})],Sa.prototype,"stop",2),d([tS(Ew,{optional:!0})],Sa.prototype,"color",2);function Bw(t){let e;for(const{stop:i}of t)if(i!=null){if(e!=null&&i<e)return!1;e=i}return!0}function eS(t){return t.flatMap((e,i)=>{const{offset:o}=e,s=t.at(i+1)?.color;return s!=null?[e,{offset:o,color:s}]:[e]})}function zw(t,e){const i=e==="discrete"?1:0,o=t.map((s,a,{length:n})=>({offset:(a+i)/(n-1+i),color:s}));return e==="discrete"?eS(o):o}function iS(t,e,i,o){if(t.length===0)return zw(e,o);if(!Bw(t))return _w.warnOnce("[fills] must have the stops defined in ascending order"),[];const s=Math.min(...i),a=Math.max(...i),n=o==="discrete",r=new Float64Array(t.length);let l=0,c=-1;for(let g=0;g<t.length;g+=1){const y=t[g];if(g>=c){c=t.length-1;for(let S=g+1;S<t.length;S+=1)if(t[S].stop!=null){c=S;break}}let{stop:f}=y;if(f==null){const S=t[l].stop,b=t[c].stop,v=S??s,x=b??a,M=n&&S==null?1:0;f=v+(x-v)*(g-l+M)/(c-l+M)}else l=g;const m=(f-s)/(a-s);r[g]=m}let h=t.find(g=>g.color!=null)?.color,p;const u=t.map(({color:g},y)=>{const f=r[y];return g!=null?h=g:h!=null?g=h:(p==null&&(p=new Pw,p.domain=[0,1],p.range=e),g=p.convert(f)),{offset:f,color:g}});return o==="discrete"?eS(u):u}import{_ModuleSupport as Fw}from"ag-charts-community";import{_ModuleSupport as Vw}from"ag-charts-community";var{MARKER_SHAPE:Gw,UNION:up,OR:Ww}=Vw,bl=up(["continuous","discrete"],"a fill mode"),oS=Ww(Gw,up(["line"],"a marker shape")),sS=up(["container","item"],"a corner mode");import{_ModuleSupport as Uw}from"ag-charts-community";var{BaseProperties:aS,Validate:ba,OBJECT:Hw,BOOLEAN:Kw,NUMBER:gp,NUMBER_ARRAY:Yw,Logger:jw}=Uw,vl=class extends aS{getSegments(t,e){const{values:i,step:o,count:s}=this,a=Math.min(...t.domain),n=Math.max(...t.domain);let r;if(i!=null){const l=i.filter(c=>c>a&&c<n).sort((c,h)=>c-h);r=[a,...l,n]}else if(o!=null){const l=[];for(let c=a;c<n;c+=o)l.push(c);l.push(n),r=l}else if(s!=null){const l=s+1;r=Array.from({length:l+1},(c,h)=>h/l*(n-a)+a)}else{const l=t.ticks?.().filter(c=>c>a&&c<n);r=l!=null?[a,...l,n]:void 0}return r!=null&&r.length>e&&(jw.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),r=void 0),r??(r=[a,n]),r}};d([ba(Yw,{optional:!0})],vl.prototype,"values",2),d([ba(gp,{optional:!0})],vl.prototype,"step",2),d([ba(gp,{optional:!0})],vl.prototype,"count",2);var Tn=class extends aS{constructor(){super(...arguments),this.enabled=!1,this.interval=new vl,this.spacing=0}};d([ba(Kw)],Tn.prototype,"enabled",2),d([ba(Hw)],Tn.prototype,"interval",2),d([ba(gp)],Tn.prototype,"spacing",2);var{BaseProperties:yp,SeriesTooltip:Xw,SeriesProperties:Zw,PropertiesArray:fp,Validate:Y,BOOLEAN:nS,COLOR_STRING:ms,COLOR_STRING_ARRAY:$w,FUNCTION:Qw,LINE_DASH:mp,NUMBER:va,OBJECT_ARRAY:xp,OBJECT:xs,POSITIVE_NUMBER:Ri,RATIO:Ss,STRING:rS,UNION:Sp,Label:qw}=Fw,Jw=Sp(["before","after","middle"],"a placement"),t1=Sp(["inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end"],"an placement"),e1=Sp(["horizontal","vertical"],"an orientation"),lS=class extends qw{};d([Y(va,{optional:!0})],lS.prototype,"spacing",2);var Jt=class extends yp{constructor(){super(...arguments),this.value=0,this.label=new lS}};d([Y(rS,{optional:!0})],Jt.prototype,"text",2),d([Y(va)],Jt.prototype,"value",2),d([Y(oS,{optional:!0})],Jt.prototype,"shape",2),d([Y(Jw,{optional:!0})],Jt.prototype,"placement",2),d([Y(va,{optional:!0})],Jt.prototype,"spacing",2),d([Y(Ri,{optional:!0})],Jt.prototype,"size",2),d([Y(va,{optional:!0})],Jt.prototype,"rotation",2),d([Y(ms,{optional:!0})],Jt.prototype,"fill",2),d([Y(Ss,{optional:!0})],Jt.prototype,"fillOpacity",2),d([Y(ms,{optional:!0})],Jt.prototype,"stroke",2),d([Y(Ri,{optional:!0})],Jt.prototype,"strokeWidth",2),d([Y(Ss,{optional:!0})],Jt.prototype,"strokeOpacity",2),d([Y(mp,{optional:!0})],Jt.prototype,"lineDash",2),d([Y(Ri,{optional:!0})],Jt.prototype,"lineDashOffset",2),d([Y(xs)],Jt.prototype,"label",2);var _e=class extends yp{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new fp(Sa),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([Y(nS)],_e.prototype,"enabled",2),d([Y(Ri,{optional:!0})],_e.prototype,"thickness",2),d([Y(Ss)],_e.prototype,"thicknessRatio",2),d([Y(xp)],_e.prototype,"fills",2),d([Y(bl)],_e.prototype,"fillMode",2),d([Y(ms,{optional:!0})],_e.prototype,"fill",2),d([Y(Ss)],_e.prototype,"fillOpacity",2),d([Y(ms)],_e.prototype,"stroke",2),d([Y(Ri)],_e.prototype,"strokeWidth",2),d([Y(Ss)],_e.prototype,"strokeOpacity",2),d([Y(mp)],_e.prototype,"lineDash",2),d([Y(Ri)],_e.prototype,"lineDashOffset",2);var ri=class extends yp{constructor(){super(...arguments),this.fills=new fp(Sa),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black"}};d([Y(xp)],ri.prototype,"fills",2),d([Y(bl)],ri.prototype,"fillMode",2),d([Y(ms,{optional:!0})],ri.prototype,"fill",2),d([Y(Ss)],ri.prototype,"fillOpacity",2),d([Y(ms)],ri.prototype,"stroke",2),d([Y(Ri)],ri.prototype,"strokeWidth",2),d([Y(Ss)],ri.prototype,"strokeOpacity",2),d([Y(mp)],ri.prototype,"lineDash",2),d([Y(Ri)],ri.prototype,"lineDashOffset",2),d([Y(ms)],ri.prototype,"defaultFill",2);var Ml=class extends Ni{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};d([Y(rS,{optional:!0})],Ml.prototype,"text",2),d([Y(t1)],Ml.prototype,"placement",2),d([Y(nS)],Ml.prototype,"avoidCollisions",2);var le=class extends Zw{constructor(){super(...arguments),this.value=0,this.segmentation=new Tn,this.defaultColorRange=[],this.targets=new fp(Jt),this.defaultTarget=new Jt,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new ri,this.bar=new _e,this.label=new Ml,this.tooltip=new Xw}};d([Y(va)],le.prototype,"value",2),d([Y(xs)],le.prototype,"segmentation",2),d([Y($w)],le.prototype,"defaultColorRange",2),d([Y(xp)],le.prototype,"targets",2),d([Y(xs)],le.prototype,"defaultTarget",2),d([Y(e1)],le.prototype,"direction",2),d([Y(Ri)],le.prototype,"thickness",2),d([Y(Ri)],le.prototype,"cornerRadius",2),d([Y(sS)],le.prototype,"cornerMode",2),d([Y(va)],le.prototype,"margin",2),d([Y(xs)],le.prototype,"scale",2),d([Y(xs)],le.prototype,"bar",2),d([Y(Qw,{optional:!0})],le.prototype,"itemStyler",2),d([Y(xs)],le.prototype,"label",2),d([Y(xs)],le.prototype,"tooltip",2);import{_ModuleSupport as i1}from"ag-charts-community";var{CachedTextMeasurerPool:o1,BBox:s1}=i1;function bp(t){const{x0:e,y0:i,x1:o,y1:s,horizontalInset:a,verticalInset:n}=t,r=Math.min(e,o)+a,l=Math.min(i,s)+n,c=Math.max(Math.abs(o-e)-2*a,0),h=Math.max(Math.abs(s-i)-2*n,0);return{x:r,y:l,width:c,height:h}}function a1(t,e){if(e==null)return!0;const i=bp(t),o=1e-6,s=i.x+o,a=i.y+o,n=i.x+i.width-o,r=i.y+i.height-o,l=e.x,c=e.x+e.width,h=e.y,p=e.y+e.height;return Math.max(s,l)<=Math.min(n,c)&&Math.max(a,h)<=Math.min(r,p)}function vp(t){const{clipX0:e,clipX1:i,clipY0:o,clipY1:s}=t;return e!=null&&i!=null||o!=null&&s!=null}function n1(t){if(!vp(t))return;const{x0:e,y0:i,x1:o,y1:s}=t,{x:a,y:n,width:r,height:l}=bp(t);let{clipX0:c,clipX1:h,clipY0:p,clipY1:u}=t;(c==null||h==null)&&(c=e,h=o),(p==null||u==null)&&(p=i,u=s);const g=Math.min(c,h),y=Math.min(p,u),f=Math.abs(h-c),m=Math.abs(u-p);return c=Math.max(a,g),p=Math.max(n,y),h=Math.min(a+r,g+f),u=Math.min(n+l,y+m),new s1(Math.min(c,h),Math.min(p,u),Math.abs(h-c),Math.abs(u-p))}function cS(t,e){const i=t?"initial":"update";return{node:{fromFn(s,a){const n=s.previousDatum;let{x0:r,y0:l,x1:c,y1:h,clipX0:p,clipY0:u,clipX1:g,clipY1:y}=n??a;const{horizontalInset:f,verticalInset:m}=a,S=n!=null&&vp(n),b=vp(a);return S&&b||(!S&&b?({x0:r,y0:l,x1:c,y1:h,clipX0:p,clipY0:u,clipX1:g,clipY1:y}=a,t&&(e?g=a.clipX0:y=a.clipY0)):S&&!b?({x0:r,y0:l,x1:c,y1:h}=a,p=void 0,u=void 0,g=void 0,y=void 0):t&&(e?c=r:h=l)),{x0:r,y0:l,x1:c,y1:h,clipX0:p,clipY0:u,clipX1:g,clipY1:y,horizontalInset:f,verticalInset:m,phase:i}},toFn(s,a){const{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:p,clipX1:u,clipY1:g,horizontalInset:y,verticalInset:f}=a;return{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:p,clipX1:u,clipY1:g,horizontalInset:y,verticalInset:f}},applyFn(s,a){s.setProperties(kl(s,a))}}}}function kl(t,e){const{x:i,y:o,width:s,height:a}=bp(e),n=n1(e),r=a1(e,n);return{x:i,y:o,width:s,height:a,clipBBox:n,visible:r}}var r1={Before:"right",Center:"center",After:"left"},l1={Before:"top",Center:"middle",After:"bottom"},c1={Before:-1,Center:-.5,After:0},h1={Before:0,Center:-.5,After:-1};function d1(t,e,i,o,s){const{scale:a,bar:n}=o,{padding:r,horizontal:l}=i;e.each((c,h)=>{const p=In(t,h,s?.label),u=()=>({width:a.width,height:a.height,meta:null});let g;const y=h.avoidCollisions&&h.placement!=="outside-start"&&h.placement!=="outside-end";if(p==null)return;if(y)g=Mn(p,h,{padding:r},u)?.[0];else{const D={fontSize:h.fontSize,fontStyle:h.fontStyle,fontWeight:h.fontWeight,fontFamily:h.fontFamily,lineHeight:h.lineHeight},{width:R,height:_}=o1.measureText(p,{font:D});g={text:p,fontSize:h.fontSize,lineHeight:ma(h,h.fontSize),width:R,height:_}}if(g==null){c.visible=!1;return}const f=l?a.x:a.y+a.height,m=l?a.x+a.width:a.y,S=l?n.x:n.y+n.height,b=l?n.x+n.width:n.y,v=h.spacing*(l?1:-1);let x,M,k,A;switch(h.placement){case"outside-start":x=-1/0,M=1/0,k=f-v,A="Before";break;case"outside-end":x=-1/0,M=1/0,k=m+v,A="After";break;case"inside-start":x=f,M=b,k=f+v,A="After";break;case"inside-end":x=b,M=m,k=m-v,A="Before";break;case"inside-center":x=f,M=m,k=(f+m)/2,A="Center";break;case"bar-inside":x=S,M=b,k=(S+b)/2,A="Center";break;case"bar-inside-end":x=S,M=b,k=b-v,A="Before";break;case"bar-outside-end":x=b,M=m,k=b+v,A="After";break;case"bar-end":x=-1/0,M=1/0,k=b,A="Center";break}const I=l?k:a.x+a.width/2,O=l?a.y+a.height/2:k;let T,L;l?(T=I+c1[A]*g.width,L=T+g.width):(T=O+h1[A]*g.height,L=T+g.height);const C=Math.min(T,L)>=Math.min(x,M)&&Math.max(T,L)<=Math.max(x,M);if(h.avoidCollisions&&!C){c.visible=!1;return}c.visible=!0,c.text=g.text,c.fontSize=g.fontSize,c.lineHeight=g.lineHeight,c.textAlign=l?r1[A]:"center",c.textBaseline=l?"middle":l1[A],c.x=I,c.y=O})}var{fromToMotion:Mp,resetMotion:p1,SeriesNodePickMode:hS,StateMachine:u1,createDatumId:dS,ChartAxisDirection:li,CachedTextMeasurerPool:g1,toRadians:y1,BBox:Al,Group:Ma,PointerEvents:kp,Selection:ka,Rect:f1,Text:pS,LinearGradient:m1,getMarker:x1,easing:S1}=Dn,b1={before:180,middle:0,after:0},v1={before:90,middle:0,after:-90},Ap=class extends Dn.Series{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[hS.EXACT_SHAPE_MATCH,hS.NEAREST_NODE]}),this.canHaveAxes=!0,this.properties=new le,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new Ma({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Ma({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Ma({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Ma({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Ma({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Ma({name:"itemTargetLabelGroup"})),this.scaleSelection=ka.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=ka.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=ka.select(this.itemTargetGroup,e=>this.markerFactory(e)),this.targetLabelSelection=ka.select(this.itemTargetLabelGroup,pS),this.labelSelection=ka.select(this.itemLabelGroup,pS),this.highlightTargetSelection=ka.select(this.highlightTargetGroup,e=>this.markerFactory(e)),this.nodeDatum={series:this,datum:{}},this.animationState=new u1("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.itemGroup.pointerEvents=kp.None,this.itemTargetLabelGroup.pointerEvents=kp.None,this.itemLabelGroup.pointerEvents=kp.None}get horizontal(){return this.properties.direction==="horizontal"}get thickness(){return this.properties.thickness}computeInset(t,e){const{label:i}=this.properties;let o;switch(i.placement){case"outside-start":o=1;break;case"outside-end":o=-1;break;default:return 0}const s=i.text?.split(`
`);let a;if(t===li.Y)a=ma(i,i.fontSize)*(s?.length??1);else{const n=i.getFont();a=(s??e.map(l=>In(this,this.labelDatum(i,l))??"")).reduce((l,c)=>{const{width:h}=g1.measureText(c,{font:n});return Math.max(l,h)},0)}return o*(i.spacing+a)}get hasData(){return!0}nodeFactory(){const t=new f1;return t.crisp=!0,t}markerFactory({shape:t}){const e=t!=="line"?x1(t):pp,i=new e;return i.size=1,i}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){const{axes:e,horizontal:i}=this,o=i?e[li.X]:e[li.Y];return Jx(t,o)}createLinearGradient(t,e){const{properties:i,originX:o,originY:s,horizontal:a,axes:n}=this,{thickness:r,defaultColorRange:l}=i,c=a?n[li.X]:n[li.Y],{domain:h,range:p}=c.scale,u=p[1]-p[0],g=iS(t,l,h,e);return new m1("oklch",g,a?90:0,new Al(o,s,a?u:r,a?r:u))}getTargets(){const{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(i=>{const{text:o=e.text,value:s=e.value??0,shape:a=e.shape??"triangle",rotation:n=e.rotation??0,strokeWidth:r=e.strokeWidth??0,placement:l=e.placement??"middle",spacing:c=e.spacing??0,size:h=e.size??0,fill:p=e.fill??"black",fillOpacity:u=e.fillOpacity??1,stroke:g=e.stroke??"black",strokeOpacity:y=e.strokeOpacity??1,lineDash:f=e.lineDash??[0],lineDashOffset:m=e.lineDashOffset??0}=i,{enabled:S=e.label.enabled,color:b=e.label.color??"black",fontStyle:v=e.label.fontStyle??"normal",fontWeight:x=e.label.fontWeight??"normal",fontSize:M=e.label.fontSize,fontFamily:k=e.label.fontFamily,spacing:A=e.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:l,spacing:c,size:h,rotation:n,fill:p,fillOpacity:u,stroke:g,strokeWidth:r,strokeOpacity:y,lineDash:f,lineDashOffset:m,label:{enabled:S,color:b,fontStyle:v,fontWeight:x,fontSize:M,fontFamily:k,spacing:A}}})}getTargetPoint(t){const e=this.axes[li.X],i=this.axes[li.Y];if(e==null||i==null)return{x:0,y:0};const{properties:o,originX:s,originY:a,horizontal:n}=this,{thickness:r}=o,{value:l,placement:c,spacing:h,size:p}=t,u=n?e:i,g=u.scale.convert(l)-u.scale.range[0];let y;switch(c){case"before":y=-(h+p/2);break;case"after":y=r+h+p/2;break;default:y=r/2;break}return{x:s+e.range[0]+(n?g:y),y:a+i.range[0]+(n?y:g)}}getTargetLabel(t){const{size:e,placement:i,label:o}=t,{spacing:s,color:a,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c}=o,h=void 0,p=e/2+s;let u,g,y=0,f=0;return this.horizontal?(u="center",i==="after"?(g="top",f=p):(g="bottom",f=-p)):(g="middle",i==="before"?(u="right",y=-p):(u="left",y=p)),{offsetX:y,offsetY:f,fill:a,textAlign:u,textBaseline:g,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c,lineHeight:h}}labelDatum(t,e){const{placement:i,avoidCollisions:o,spacing:s,text:a,color:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:p,lineHeight:u,wrapping:g,overflowStrategy:y,formatter:f=m=>this.formatLabel(m.value)}=t;return{placement:i,avoidCollisions:o,spacing:s,text:a,value:e,fill:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:p,lineHeight:u,wrapping:g,overflowStrategy:y,formatter:f}}createNodeData(){const{id:t,properties:e,originX:i,originY:o,horizontal:s}=this;if(!e.isValid())return;const{value:a,segmentation:n,thickness:r,cornerRadius:l,cornerMode:c,bar:h,scale:p,label:u}=e,g=this.getTargets(),y=this.axes[li.X],f=this.axes[li.Y];if(y==null||f==null)return;const m=s?y:f,S=y.scale,b=f.scale,v=m.scale;let{domain:x}=m.scale;m.isReversed()&&(x=x.slice().reverse());const M=[],k=[],A=[],I=[],[O,T]=v.range,L=Math.abs(T-O);let[C,D]=y.range;y.isReversed()&&([D,C]=[C,D]);let[R,_]=f.range;f.isReversed()&&([_,R]=[R,_]);const F=s?S.convert(a):D,E=s?_:b.convert(a),B=n.enabled?n.spacing/2:0,P=s?B:0,N=s?0:B,w=Math.min(h.thickness??Math.round(h.thicknessRatio*r),r),z=-(r-w)/2,V=s?0:z,G=s?z:0,W=c==="item",H=Math.ceil(L);let K=n.enabled?n.interval.getSegments(v,H):void 0;const Q=h.fill??this.createLinearGradient(h.fills,h.fillMode),st=p.fill??(h.enabled&&p.fills.length===0?p.defaultFill:void 0)??this.createLinearGradient(p.fills,p.fillMode);if(K==null&&W){const $=Math.min(...x),j=Math.max(...x),q={value:a,segmentStart:$,segmentEnd:j};if(h.enabled){const xt=Math.min(l,w/2,L/2)*(m.isReversed()?-1:1),ze=s?xt:0,ee=s?0:xt;M.push({series:this,itemId:"value",datum:q,type:0,x0:i+C-ze-V,y0:o+R-ee-G,x1:i+F+ze+V,y1:o+E+ee+G,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:Q,horizontalInset:P,verticalInset:N})}const X=Math.min(l,r/2,L/2)*(m.isReversed()?-1:1),gt=s?X:0,rt=s?0:X;I.push({series:this,itemId:"scale",datum:q,type:0,x0:i+C-gt,y0:o+R-rt,x1:i+D+gt,y1:o+_+rt,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:st,horizontalInset:P,verticalInset:N})}else{K??(K=x);const $=i+C-V,j=o+R-G,q=i+F+V,J=o+E+G;for(let X=0;X<K.length-1;X+=1){const gt=K[X+0],rt=K[X+1],pt={value:a,segmentStart:gt,segmentEnd:rt},xt=X===0,ze=X===K.length-2,ee=v.convert(gt),Te=v.convert(rt),Ho=W||xt?l:0,Pi=W||ze?l:0,ws=s?Ho:Pi,Ra=Pi,Xu=s?Pi:Ho,Zu=Ho;h.enabled&&M.push({series:this,itemId:`value-${X}`,datum:pt,type:0,x0:i+(s?ee:C),y0:o+(s?R:ee),x1:i+(s?Te:D),y1:o+(s?_:Te),clipX0:$,clipY0:j,clipX1:q,clipY1:J,topLeftCornerRadius:ws,topRightCornerRadius:Ra,bottomRightCornerRadius:Xu,bottomLeftCornerRadius:Zu,fill:Q,horizontalInset:P,verticalInset:N}),I.push({series:this,itemId:`scale-${X}`,datum:pt,type:0,x0:i+(s?ee:C),y0:o+(s?R:ee),x1:i+(s?Te:D),y1:o+(s?_:Te),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:ws,topRightCornerRadius:Ra,bottomRightCornerRadius:Xu,bottomLeftCornerRadius:Zu,fill:st,horizontalInset:P,verticalInset:N})}}u.enabled&&A.push(this.labelDatum(u,a));const tt=s?b1:v1;for(let $=0;$<g.length;$+=1){const j=g[$],{value:q,text:J,shape:X,size:gt,fill:rt,fillOpacity:pt,stroke:xt,strokeWidth:ze,strokeOpacity:ee,lineDash:Te,lineDashOffset:Ho}=j,Pi=this.getTargetPoint(j),ws=y1(j.rotation+tt[j.placement]);k.push({series:this,itemId:`target-${$}`,midPoint:Pi,datum:{value:q},type:1,value:q,text:J,x:Pi.x,y:Pi.y,shape:X,size:gt,rotation:ws,fill:rt,fillOpacity:pt,stroke:xt,strokeOpacity:ee,strokeWidth:ze,lineDash:Te,lineDashOffset:Ho,label:this.getTargetLabel(j)})}return{itemId:t,nodeData:M,targetData:k,labelData:A,scaleData:I}}updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(t!=null&&t.series===this&&t.type===1)return t}update({seriesRect:t}){const{datumSelection:e,labelSelection:i,targetSelection:o,targetLabelSelection:s,scaleSelection:a,highlightTargetSelection:n}=this,r=this.checkResize(t);this.updateSelections(r),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const l=this.contextNodeData?.nodeData??[],c=this.contextNodeData?.labelData??[],h=this.contextNodeData?.targetData??[],p=this.contextNodeData?.scaleData??[],u=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:p,scaleSelection:a}),this.updateScaleNodes({scaleSelection:a}),this.targetSelection=this.updateTargetSelection({targetData:h,targetSelection:o}),this.updateTargetNodes({targetSelection:o,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:h,targetLabelSelection:s}),this.updateTargetLabelNodes({targetLabelSelection:s}),this.datumSelection=this.updateDatumSelection({nodeData:l,datumSelection:e}),this.updateDatumNodes({datumSelection:e}),this.labelSelection=this.updateLabelSelection({labelData:c,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:u!=null?[u]:[],targetSelection:n}),this.updateTargetNodes({targetSelection:n,isHighlight:!0}),r&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>dS(t.nodeData.length,e.itemId))}updateDatumNodes(t){const{datumSelection:e}=t,{ctx:i,properties:o}=this,{bar:s}=o,{fillOpacity:a,stroke:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}=s,h=this.getStrokeWidth(s.strokeWidth),p=i.animationManager.isSkipped();e.each((u,g)=>{const{topLeftCornerRadius:y,topRightCornerRadius:f,bottomRightCornerRadius:m,bottomLeftCornerRadius:S,fill:b}=g;u.fill=b,u.fillOpacity=a,u.stroke=n,u.strokeOpacity=r,u.strokeWidth=h,u.lineDash=l,u.lineDashOffset=c,u.topLeftCornerRadius=y,u.topRightCornerRadius=f,u.bottomRightCornerRadius=m,u.bottomLeftCornerRadius=S,(p||u.previousDatum==null)&&u.setProperties(kl(u,g))})}updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>dS(t.scaleData.length,e.itemId))}updateScaleNodes(t){const{scaleSelection:e}=t,{scale:i}=this.properties,{fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=i;e.each((c,h)=>{const{topLeftCornerRadius:p,topRightCornerRadius:u,bottomRightCornerRadius:g,bottomLeftCornerRadius:y,fill:f}=h;c.fill=f,c.fillOpacity=o,c.stroke=s,c.strokeOpacity=a,c.strokeWidth=n,c.lineDash=r,c.lineDashOffset=l,c.topLeftCornerRadius=p,c.topRightCornerRadius=u,c.bottomRightCornerRadius=g,c.bottomLeftCornerRadius=y,c.setProperties(kl(c,h))})}updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,e=>e.itemId)}updateTargetNodes(t){const{targetSelection:e,isHighlight:i}=t,o=i?this.properties.highlightStyle.item:void 0;e.each((s,a)=>{const{x:n,y:r,size:l,rotation:c,fill:h,fillOpacity:p,stroke:u,strokeOpacity:g,strokeWidth:y,lineDash:f,lineDashOffset:m}=a;s.size=l,s.fill=o?.fill??h,s.fillOpacity=o?.fillOpacity??p,s.stroke=o?.stroke??u,s.strokeOpacity=o?.strokeOpacity??g,s.strokeWidth=o?.strokeWidth??y,s.lineDash=o?.lineDash??f,s.lineDashOffset=o?.lineDashOffset??m,s.translationX=n,s.translationY=r,s.rotation=c})}updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData)}updateTargetLabelNodes(t){const{targetLabelSelection:e}=t;e.each((i,o)=>{const{x:s,y:a,text:n}=o,{offsetX:r,offsetY:l,fill:c,fontStyle:h,fontWeight:p,fontSize:u,fontFamily:g,textAlign:y,textBaseline:f}=o.label;i.visible=!0,i.x=s+r,i.y=a+l,i.text=n,i.fill=c,i.fontStyle=h,i.fontWeight=p,i.fontSize=u,i.fontFamily=g,i.textAlign=y,i.textBaseline=f})}updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,e=>"primary")}updateLabelNodes(t){const{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:t}of this.labelSelection)if(t.text==null)return!1;return!0}formatLabelText(t){const{labelSelection:e,horizontal:i,axes:o}=this,s=o[li.X],a=o[li.Y];if(s==null||a==null)return;const[n,r]=s.range,[l,c]=a.range,h=this.originX+Math.min(n,r),p=this.originY+Math.min(l,c),u=Math.abs(r-n),g=Math.abs(c-l),y=t?.label??this.properties.value;let f;if(i){const b=s.scale.convert(y);f=new Al(h,p,b-h,g)}else{const b=a.scale.convert(y);f=new Al(h,b,u,g-b)}const m={scale:new Al(h,p,u,g),bar:f},{margin:S}=this.properties;d1(this,e,{padding:S,horizontal:i},m,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),p1([this.datumSelection],kl),this.formatLabelText()}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}animateLabelText(t={}){const{animationManager:e}=this.ctx;let i=0,o=0;if(this.labelSelection.each((s,a)=>{s.opacity=1,i=s.previousDatum?.value??t.from??a.value,o=a.value}),!this.labelsHaveExplicitText())if(i===o)this.formatLabelText({label:o});else{const s=`${this.id}_labels`;e.animate({id:s,groupId:"label",from:{label:i},to:{label:o},phase:t.phase??"update",ease:S1.easeOut,onUpdate:a=>this.formatLabelText(a)})}}animateEmptyUpdateReady(){const{animationManager:t}=this.ctx,{node:e}=cS(!0,this.horizontal);Mp(this.id,"node",t,[this.datumSelection],e,(i,o)=>o.itemId),Mp(this.id,"label",t,[this.labelSelection],qx,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:t}=this.ctx,{node:e}=cS(!1,this.horizontal);Mp(this.id,"node",t,[this.datumSelection],e,(i,o)=>o.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}getLegendData(){return[]}pickNode(t,e){switch(e){case"event":case"context-menu":{const i=this.scaleGroup.pickNode(t.x,t.y);return i!=null?{pickMode:Dn.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:void 0}case"tooltip":case"highlight":case"highlight-tooltip":{const i=this.itemTargetGroup.pickNode(t.x,t.y);return i!=null?{pickMode:Dn.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:{pickMode:Dn.SeriesNodePickMode.NEAREST_NODE,match:this.nodeDatum,distance:0}}}}getTooltipContent(t){const{id:e,properties:i}=this,{tooltip:o}=i;if(!i.isValid())return;const s=this.highlightDatum(t),a=s?.value??i.value,n=s?.text;return o.formatTooltip({data:[{label:n??"",value:this.formatLabel(a)}]},{seriesId:e,title:void 0,datum:void 0,value:a})}pickFocus(t){const e=this.contextNodeData?.targetData;if(e==null||e.length===0)return;const i=Math.min(Math.max(t.datumIndex,0),e.length-1),o=e[i];for(const s of this.targetSelection)if(s.datum===o)return{bounds:s.node,showFocusBox:!0,clipFocusBox:!0,datum:o,datumIndex:i}}getCaptionText(){const{value:t}=this.properties,e=[];return e.push(this.formatLabel(t)),e.join(". ")}};Ap.className="LinearGaugeSeries",Ap.type="linear-gauge";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:uS,DEFAULT_HIERARCHY_FILLS:M1,DEFAULT_LABEL_COLOUR:Dp,DEFAULT_INVERTED_LABEL_COLOUR:k1,DEFAULT_GAUGE_SERIES_COLOR_RANGE:A1},ThemeConstants:{CARTESIAN_AXIS_TYPE:Ip}}=Tw,D1={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"linear-gauge",moduleFactory:t=>new Ap(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Ip.NUMBER,line:{enabled:!1}},{type:Ip.NUMBER,line:{enabled:!1}}],themeTemplate:{minWidth:200,minHeight:200,series:{thickness:50,bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:Dp,stroke:Dp,size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:"normal",fontSize:12,fontFamily:uS,color:Dp,spacing:5}},label:{enabled:!1,placement:"inside-start",fontWeight:"normal",fontSize:24,minimumFontSize:12,spacing:18,fontFamily:uS,color:k1},margin:4,tooltip:{enabled:!1}},axes:{[Ip.NUMBER]:{line:{enabled:!1},gridLine:{enabled:!1}}}},paletteFactory(t){const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fills:a}=e(i),n=s.get(A1),r=s.get(M1),l=o==="inbuilt"?n:[a[0],a[1]];return{scale:{defaultFill:r?.[1],stroke:r?.[2]},defaultColorRange:Qx(l)}}};import{_ModuleSupport as I1}from"ag-charts-community";var On={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer"},legend:{enabled:!1},gradientLegend:{enabled:!1},tooltip:{range:"exact"}};import{_ModuleSupport as T1}from"ag-charts-community";import{_ModuleSupport as O1}from"ag-charts-community";var L1=1e-9;function gS(t,e,i,o){const[s,a]=t,[n,r]=e,l=n-s,c=r-a,h=l*l+c*c;let p,u;if(Math.abs(h)<L1)p=s,u=a;else{let f=((i-s)*l+(o-a)*c)/h;f=Math.max(0,Math.min(1,f)),p=s+f*(n-s),u=a+f*(r-a)}const g=i-p,y=o-u;return g*g+y*y}function yS(t,e,i){let o=1/0,s=t[t.length-1];for(const a of t)o=Math.min(o,gS(s,a,e,i)),s=a;return Math.sqrt(o)}function Tp(t){let[e,i]=t[0],o=0;for(let s=1;s<t.length;s+=1){const[a,n]=t[s],r=Math.hypot(a-e,n-i);o+=r,e=a,i=n}return o}function Dl(t){if(t.length===0)return;const e=Tp(t)/2;let[i,o]=t[0],s=0;for(let a=1;a<t.length;a+=1){const[n,r]=t[a],l=Math.hypot(n-i,r-o),c=s+l;if(c>e){const h=(e-s)/l,p=[i+(n-i)*h,o+(r-o)*h],u=Math.atan2(r-o,n-i);return{point:p,angle:u}}s=c,i=n,o=r}}import{_ModuleSupport as N1}from"ag-charts-community";var{LonLatBBox:C1}=N1;function Ln(t,e,i,o,s){return t==null?t=new C1(e,i,o,s):(t.lon0=Math.min(t.lon0,e),t.lat0=Math.min(t.lat0,i),t.lon1=Math.max(t.lon1,o),t.lat1=Math.max(t.lat1,s)),t}function bs(t,e){return t.forEach(i=>{const[o,s]=i;e=Ln(e,o,s,o,s)}),e}function R1(t){if(t.length===0)return;let e=0,i=0,o=0,[s,a]=t[t.length-1];for(const[n,r]of t){const l=s*r-n*a;o+=l,e+=(s+n)*l,i+=(a+r)*l,s=n,a=r}return o*=3,[e/o,i/o]}function Il(t,e,i){let o=!1,s=1/0;for(const a of t){let n=a[a.length-1],[r,l]=n;for(const c of a){const[h,p]=c;p>i!=l>i&&e<(r-h)*(i-p)/(l-p)+h&&(o=!o),s=Math.min(s,gS(n,c,e,i)),n=c,r=h,l=p}}return(o?-1:1)*Math.sqrt(s)}var{Path:E1,ExtendedPath2D:w1,BBox:_1,ScenePathChangeDetection:fS}=O1,Aa=class extends E1{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new w1}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:t}=this;this.strokePath.clear(),this.path.clear(),this.bbox=t!=null?this.drawGeometry(t,void 0):void 0}drawPath(t){super.drawPath(t),this.renderStroke(t,this.strokePath.getPath2D())}containsPoint(t,e){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(t,e)?!1:this.geometryDistance(i,t,e)<=0}distanceSquared(t,e){const{projectedGeometry:i}=this;if(i==null)return 1/0;const o=this.geometryDistance(i,t,e);return o>0?o*o:0}geometryDistance(t,e,i){const{renderMode:o,strokeWidth:s}=this,a=(o&1)!==0,n=(o&2)!==0,r=Math.max(s/2,1)+1;switch(t.type){case"GeometryCollection":return t.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,e,i)),1/0);case"MultiPolygon":return a?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(Il(c,e,i),0)),1/0):1/0;case"Polygon":return a?Math.max(Il(t.coordinates,e,i),0):1/0;case"MultiLineString":return n?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(yS(c,e,i)-r,0)),1/0):1/0;case"LineString":return n?Math.max(yS(t.coordinates,e,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}drawGeometry(t,e){const{renderMode:i,path:o,strokePath:s}=this,a=(i&1)!==0,n=(i&2)!==0;switch(t.type){case"GeometryCollection":t.geometries.forEach(r=>{e=this.drawGeometry(r,e)});break;case"MultiPolygon":a&&t.coordinates.forEach(r=>{e=this.drawPolygon(o,r,e)});break;case"Polygon":a&&(e=this.drawPolygon(o,t.coordinates,e));break;case"LineString":n&&(e=this.drawLineString(s,t.coordinates,e,!1));break;case"MultiLineString":n&&t.coordinates.forEach(r=>{e=this.drawLineString(s,r,e,!1)});break;case"Point":case"MultiPoint":break}return e}drawPolygon(t,e,i){if(e.length<1)return i;i=this.drawLineString(t,e[0],i,!0);for(let o=1;o<e.length;o+=1){const s=e[o];this.drawLineString(t,s,void 0,!0)}return i}drawLineString(t,e,i,o){if(e.length<2)return i;const s=o?e.length-1:e.length;for(let a=0;a<s;a+=1){const[n,r]=e[a];if(a===0?t.moveTo(n,r):t.lineTo(n,r),i==null)i=new _1(n,r,0,0);else{const{x:l,y:c}=i,h=l+i.width,p=c+i.height;i.x=Math.min(l,n),i.y=Math.min(c,r),i.width=Math.max(h,n)-i.x,i.height=Math.max(p,r)-i.y}}return o&&t.closePath(),i}};d([fS()],Aa.prototype,"projectedGeometry",2),d([fS()],Aa.prototype,"renderMode",2);function Da(t,e){if(t.bbox!=null){const[i,o,s,a]=t.bbox;return e=Ln(e,i,o,s,a),e}switch(t.type){case"GeometryCollection":t.geometries.forEach(i=>{e=Da(i,e)});break;case"MultiPolygon":t.coordinates.forEach(i=>{i.length>0&&(e=bs(i[0],e))});break;case"Polygon":t.coordinates.length>0&&(e=bs(t.coordinates[0],e));break;case"MultiLineString":t.coordinates.forEach(i=>{e=bs(i,e)});break;case"LineString":e=bs(t.coordinates,e);break;case"MultiPoint":t.coordinates.forEach(i=>{const[o,s]=i;e=Ln(e,o,s,o,s)});break;case"Point":{const[i,o]=t.coordinates;e=Ln(e,i,o,i,o);break}}return e}function Tl(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(o=>{const s=Tl(o);if(s==null)return;const a=bs(s[0],void 0);if(a==null)return;const n=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(e==null||n>e)&&(e=n,i=s)}),i}case"MultiPolygon":{let e,i;return t.coordinates.forEach(o=>{const s=bs(o[0],void 0);if(s==null)return;const a=Math.abs(s.lat1-s.lat0)*Math.abs(s.lon1-s.lon0);(e==null||a>e)&&(e=a,i=o)}),i}case"Polygon":return t.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function Ol(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(o=>{const s=Ol(o);if(s==null)return;const a=Tp(s);a!=null&&(e==null||a>e)&&(e=a,i=s)}),i}case"MultiLineString":{let e=0,i;return t.coordinates.forEach(o=>{const s=Tp(o);s>e&&(e=s,i=o)}),i}case"LineString":return t.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function Op(t,e){if(t==null)return!1;switch(t.type){case"GeometryCollection":return t.geometries.some(i=>Op(i,e));case"MultiPolygon":case"Polygon":return(e&1)!==0;case"MultiLineString":case"LineString":return(e&2)!==0;case"MultiPoint":case"Point":return(e&4)!==0}}function Po(t,e){switch(t.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(i=>Po(i,e))};case"Polygon":return{type:"Polygon",coordinates:Lp(t.coordinates,e)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:P1(t.coordinates,e)};case"MultiLineString":return{type:"MultiLineString",coordinates:Lp(t.coordinates,e)};case"LineString":return{type:"LineString",coordinates:Np(t.coordinates,e)};case"MultiPoint":return{type:"MultiPoint",coordinates:Np(t.coordinates,e)};case"Point":return{type:"Point",coordinates:e.convert(t.coordinates)}}}function P1(t,e){return t.map(i=>Lp(i,e))}function Lp(t,e){return t.map(i=>Np(i,e))}function Np(t,e){return t.map(i=>e.convert(i))}import{_ModuleSupport as mS}from"ag-charts-community";var N3=class extends mS.SeriesProperties{},Nn=class extends mS.DataModelSeries{addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}};import{_ModuleSupport as xS}from"ag-charts-community";function SS(t){return Array.isArray(t)&&t.length>=2&&t.every(xS.isFiniteNumber)}function Ll(t){return Array.isArray(t)&&t.length>=2&&t.every(SS)}var bS=.001;function B1(t){return Math.abs(t[0][0]-t[t.length-1][0])<bS&&Math.abs(t[0][1]-t[t.length-1][1])<bS}function vS(t){return Array.isArray(t)&&t.every(Ll)&&t.every(B1)}function MS(t){if(t===null)return!0;if(typeof t!="object"||t.type==null)return!1;const{type:e,coordinates:i}=t;switch(e){case"GeometryCollection":return Array.isArray(t.geometries)&&t.geometries.every(MS);case"MultiPolygon":return Array.isArray(i)&&i.every(vS);case"Polygon":return vS(i);case"MultiLineString":return Array.isArray(i)&&i.every(Ll);case"LineString":return Ll(i);case"MultiPoint":return Ll(i);case"Point":return SS(i)}}function z1(t){return t!==null&&typeof t=="object"&&t.type==="Feature"&&MS(t.geometry)}function F1(t){return t!==null&&typeof t=="object"&&t.type==="FeatureCollection"&&Array.isArray(t.features)&&t.features.every(z1)}var Ei=xS.predicateWithMessage(F1,"a GeoJSON object");import{_ModuleSupport as V1}from"ag-charts-community";var{COLOR_STRING:G1,LINE_DASH:W1,OBJECT:U1,POSITIVE_NUMBER:kS,RATIO:H1,Validate:vs,SeriesProperties:K1,SeriesTooltip:Y1}=V1,Bo=class extends K1{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new Y1}};d([vs(Ei,{optional:!0})],Bo.prototype,"topology",2),d([vs(G1)],Bo.prototype,"stroke",2),d([vs(H1)],Bo.prototype,"strokeOpacity",2),d([vs(kS)],Bo.prototype,"strokeWidth",2),d([vs(W1)],Bo.prototype,"lineDash",2),d([vs(kS)],Bo.prototype,"lineDashOffset",2),d([vs(U1)],Bo.prototype,"tooltip",2);var{createDatumId:j1,SeriesNodePickMode:X1,Validate:Z1,Logger:$1,Group:Q1,Selection:q1,PointerEvents:J1}=T1,Nl=class extends Nn{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[X1.EXACT_SHAPE_MATCH]}),this.properties=new Bo,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new Q1({name:"itemGroup"})),this.datumSelection=q1.select(this.itemGroup,()=>this.nodeFactory())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.contentGroup.zIndex=[0,t,0],this.highlightGroup.zIndex=[0,t,1],!0):!1}nodeFactory(){const t=new Aa;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t.pointerEvents=J1.None,t}processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:Da(o,e)},void 0),t==null&&$1.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:t,topology:e,scale:i}=this;if(e==null)return;const o=[],s=[];return e.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?Po(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,index:n,projectedGeometry:l})}),{itemId:t,nodeData:o,labelData:s}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:e,datumSelection:t}),this.updateDatumNodes({datumSelection:t})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>j1(e.index))}updateDatumNodes(t){const{properties:e}=this,{datumSelection:i}=t,{stroke:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=e,r=this.getStrokeWidth(e.strokeWidth);i.each((l,c)=>{const{projectedGeometry:h}=c;if(h==null){l.visible=!1,l.projectedGeometry=void 0;return}l.visible=!0,l.projectedGeometry=h,l.stroke=o,l.strokeWidth=r,l.strokeOpacity=s,l.lineDash=a,l.lineDashOffset=n})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(t){}computeFocusBounds(t){}};Nl.className="MapLineBackgroundSeries",Nl.type="map-line-background",d([Z1(Ei,{optional:!0,property:"topology"})],Nl.prototype,"_chartTopology",2);var{DEFAULT_HIERARCHY_STROKES:t_}=I1.ThemeSymbols,e_={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",moduleFactory:t=>new Nl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...On,series:{strokeWidth:1,lineDash:[0],lineDashOffset:0}},paletteFactory:({themeTemplateParameters:t})=>({stroke:t.get(t_)?.[1]})};import{_ModuleSupport as AS}from"ag-charts-community";import{_ModuleSupport as DS}from"ag-charts-community";function i_(){return{fromFn:(i,o,s)=>s==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,o,s)=>s==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function IS(t,e){const i=t.contextNodeData?.nodeData[e.datumIndex];if(i!==void 0){for(const o of t.datumSelection.nodes())if(o.datum===i)return o}}import{_ModuleSupport as o_}from"ag-charts-community";var{AND:s_,ARRAY:a_,COLOR_STRING:n_,COLOR_STRING_ARRAY:r_,FUNCTION:l_,LINE_DASH:c_,NUMBER_ARRAY:h_,OBJECT:TS,POSITIVE_NUMBER:Cp,RATIO:d_,STRING:ci,Validate:bt,SeriesProperties:p_,SeriesTooltip:u_,Label:g_}=o_,mt=class extends p_{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new g_,this.tooltip=new u_}};d([bt(Ei,{optional:!0})],mt.prototype,"topology",2),d([bt(ci,{optional:!0})],mt.prototype,"title",2),d([bt(ci,{optional:!0})],mt.prototype,"legendItemName",2),d([bt(ci)],mt.prototype,"idKey",2),d([bt(ci)],mt.prototype,"topologyIdKey",2),d([bt(ci,{optional:!0})],mt.prototype,"idName",2),d([bt(ci,{optional:!0})],mt.prototype,"labelKey",2),d([bt(ci,{optional:!0})],mt.prototype,"labelName",2),d([bt(ci,{optional:!0})],mt.prototype,"sizeKey",2),d([bt(ci,{optional:!0})],mt.prototype,"sizeName",2),d([bt(ci,{optional:!0})],mt.prototype,"colorKey",2),d([bt(ci,{optional:!0})],mt.prototype,"colorName",2),d([bt(h_,{optional:!0})],mt.prototype,"sizeDomain",2),d([bt(s_(r_,a_.restrict({minLength:1})),{optional:!0})],mt.prototype,"colorRange",2),d([bt(Cp,{optional:!0})],mt.prototype,"maxStrokeWidth",2),d([bt(n_)],mt.prototype,"stroke",2),d([bt(d_)],mt.prototype,"strokeOpacity",2),d([bt(Cp)],mt.prototype,"strokeWidth",2),d([bt(c_)],mt.prototype,"lineDash",2),d([bt(Cp)],mt.prototype,"lineDashOffset",2),d([bt(l_,{optional:!0})],mt.prototype,"itemStyler",2),d([bt(TS)],mt.prototype,"label",2),d([bt(TS)],mt.prototype,"tooltip",2);var{getMissCount:y_,createDatumId:OS,SeriesNodePickMode:LS,valueProperty:Cn,CachedTextMeasurerPool:f_,Validate:m_,Logger:NS,ColorScale:x_,LinearScale:S_,Selection:Rp,Text:b_}=DS,Cl=class extends Nn{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[LS.EXACT_SHAPE_MATCH,LS.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new mt,this._chartTopology=void 0,this.colorScale=new x_,this.sizeScale=new S_,this.datumSelection=Rp.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=Rp.select(this.labelGroup,b_),this.highlightDatumSelection=Rp.select(this.highlightNode,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.contentGroup.zIndex=[1,t],this.highlightGroup.zIndex=[2,t],!0):!1}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new Aa;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:h,colorRange:p}=this.properties,u=new Map;i?.features.forEach(v=>{const x=v.properties?.[a];x==null||!Op(v.geometry,2)||u.set(x,v)});const g=this.sizeScale.type,y=this.colorScale.type,f=this.scale?.type,{dataModel:m,processedData:S}=await this.requestDataModel(t,e,{props:[Cn(n,f,{id:"idValue",includeProperty:!1}),Cn(n,f,{id:"featureValue",includeProperty:!1,processor:()=>v=>u.get(v)}),...c!=null?[Cn(c,"band",{id:"labelValue"})]:[],...r!=null?[Cn(r,g,{id:"sizeValue"})]:[],...l!=null?[Cn(l,y,{id:"colorValue"})]:[]]}),b=S.rawData.length!==0?m.resolveColumnById(this,"featureValue",S):void 0;if(this.topologyBounds=b?.reduce((v,x)=>{const M=x?.geometry;return M==null?v:Da(M,v)},void 0),r!=null){const v=m.resolveProcessedDataIndexById(this,"sizeValue"),x=S.domain.values[v]??[];o.domain=h??x}if(p!=null&&this.isColorScaleValid()){const v=m.resolveProcessedDataIndexById(this,"colorValue");s.domain=S.domain.values[v],s.range=p,s.update()}i==null&&NS.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.rawData.length,a=y_(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o){if(e==null||i==null)return;const s=Ol(i);if(s==null)return;const{idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:p,labelName:u,label:g}=this.properties,y=this.getLabelText(g,{value:e,datum:t,idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:p,labelName:u});if(y==null)return;const f=f_.measureText(String(y),{font:o}),m=Dl(s);if(m==null)return;const[S,b]=m.point,{width:v,height:x}=f;return{point:{x:S,y:b,size:0},label:{width:v,height:x,text:y},marker:void 0,placement:void 0}}createNodeData(){const{id:t,dataModel:e,processedData:i,sizeScale:o,properties:s,scale:a}=this,{idKey:n,sizeKey:r,colorKey:l,labelKey:c,label:h}=s;if(e==null||i==null||i.rawData.length===0)return;const p=e.resolveColumnById(this,"idValue",i),u=e.resolveColumnById(this,"featureValue",i),g=c!=null?e.resolveColumnById(this,"labelValue",i):void 0,y=r!=null?e.resolveColumnById(this,"sizeValue",i):void 0,f=l!=null?e.resolveColumnById(this,"colorValue",i):void 0,m=s.maxStrokeWidth??s.strokeWidth;o.range=[Math.min(s.strokeWidth,m),m];const S=h.getFont(),b=new Map;i.rawData.forEach((A,I)=>{const O=p[I],T=u[I]?.geometry??void 0,L=T!=null&&a!=null?Po(T,a):void 0;O!=null&&L!=null&&b.set(O,L)});const v=[],x=[],M=[];i.rawData.forEach((A,I)=>{const O=p[I],T=f?.[I],L=y?.[I],C=g?.[I],D=b.get(O);D==null&&M.push(O);const R=this.getLabelDatum(A,C,D,S);R!=null&&x.push(R),v.push({series:this,itemId:n,datum:A,datumIndex:I,idValue:O,labelValue:C,colorValue:T,sizeValue:L,projectedGeometry:D})});const k=10;if(M.length>k){const A=M.length-k;M.length=k,M.push(`(+${A} more)`)}return M.length>0&&NS.warnOnce("some data items do not have matches in the provided topology",M),{itemId:t,nodeData:v,labelData:x}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t,highlightDatumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let i=this.ctx.highlightManager?.getActiveHighlight();i!=null&&(i.series!==this||i.datum==null)&&(i=void 0);const o=this.contextNodeData?.nodeData??[];this.datumSelection=this.updateDatumSelection({nodeData:o,datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:i!=null?[i]:[],datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!0})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>OS(e.idValue))}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset}}getItemStyleOverrides(t,e,i,o,s,a){const{id:n,properties:r,colorScale:l,sizeScale:c}=this,{colorRange:h,itemStyler:p}=r;let u;if(!a&&i!=null&&(u??(u={}),u.stroke=this.isColorScaleValid()?l.convert(i):h?.[0]??r.stroke),o!=null&&(u??(u={}),u.strokeWidth=c.convert(o,!0)),p!=null){const g=this.cachedDatumCallback(OS(t,a?"highlight":"node"),()=>p({seriesId:n,datum:e,highlighted:a,...s,...u}));u??(u={}),Object.assign(u,g)}return u}updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getItemBaseStyle(i);e.each((s,a)=>{const{datum:n,datumIndex:r,colorValue:l,sizeValue:c,projectedGeometry:h}=a;if(h==null){s.visible=!1,s.projectedGeometry=void 0;return}const p=this.getItemStyleOverrides(String(r),n,l,c,o,i);s.visible=!0,s.projectedGeometry=h,s.stroke=p?.stroke??o.stroke,s.strokeWidth=p?.strokeWidth??o.strokeWidth,s.strokeOpacity=p?.strokeOpacity??o.strokeOpacity,s.lineDash=p?.lineDash??o.lineDash,s.lineDashOffset=p?.lineDashOffset??o.lineDashOffset})}updatePlacedLabelData(t){this.labelSelection=this.labelSelection.update(t,e=>{e.pointerEvents=DS.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,width:h,height:p,text:u})=>{r.visible=!0,r.x=l+h/2,r.y=c+p/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}resetAnimation(){}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?Ol(i):void 0,s=o!=null?Dl(o)?.point:void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}legendItemSymbol(t){const{dataModel:e,processedData:i,properties:o}=this,{strokeWidth:s,strokeOpacity:a,lineDash:n}=o;let{stroke:r}=o;if(t!=null&&this.isColorScaleValid()){const c=e.resolveColumnById(this,"colorValue",i)[t];r=this.colorScale.convert(c)}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,enabled:!1},line:{stroke:r,strokeWidth:s,strokeOpacity:a,lineDash:n}}}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorName:h,colorRange:p,showInLegend:u}=this.properties;if(t==="gradient"&&c!=null&&p!=null){const g=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,colorName:h,colorRange:p,colorDomain:g}]}else return t==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!u}]:[]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{idKey:a,idName:n,colorKey:r,colorName:l,sizeKey:c,sizeName:h,labelKey:p,labelName:u,title:g,legendItemName:y,tooltip:f}=s;if(!i||!o?.rawData.length)return;const{datumIndex:m}=t,S=o.rawData[m],b=i.resolveColumnById(this,"idValue",o),v=[],x=c!=null?i.resolveColumnById(this,"sizeValue",o)[m]:void 0,M=r!=null?i.resolveColumnById(this,"colorValue",o)[m]:void 0;if(c!=null&&v.push({label:h,fallbackLabel:c,value:String(x)}),r!=null&&v.push({label:l,fallbackLabel:r,value:String(M)}),p!=null&&p!==a){const A=i.resolveColumnById(this,"labelValue",o)[m];v.push({label:u,fallbackLabel:p,value:A})}const k=this.getItemBaseStyle(!1);return Object.assign(k,this.getItemStyleOverrides(String(m),m,M,x,k,!1)),f.formatTooltip({heading:b[m],title:g??y,symbol:this.legendItemSymbol(m),data:v},{seriesId:e,datum:S,title:g,idKey:a,idName:n,colorKey:r,colorName:l,sizeKey:c,sizeName:h,labelKey:p,labelName:u,...k})}computeFocusBounds(t){const e=IS(this,t);return e?e.getBBox():void 0}};Cl.className="MapLineSeries",Cl.type="map-line",d([m_(Ei,{optional:!0,property:"topology"})],Cl.prototype,"_chartTopology",2);var{DEFAULT_DIVERGING_SERIES_COLOR_RANGE:v_,DEFAULT_FONT_FAMILY:M_,DEFAULT_LABEL_COLOUR:k_}=AS.ThemeSymbols,A_={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",moduleFactory:t=>new Cl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...On,series:{strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontSize:12,fontFamily:M_,color:k_}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a}=AS.singleSeriesPaletteFactory(t),n=s.get(v_),{fills:r}=e(i);return{colorRange:o==="inbuilt"?n:[r[0],r[1]],stroke:a}}};import{_ModuleSupport as CS}from"ag-charts-community";import{_ModuleSupport as RS}from"ag-charts-community";var D_=(t,e,i)=>{let o=t,s=o;for(const a of e)if(o==null||i(o.value,a)>0)o={value:a,next:o},s=o;else{for(s=s;s.next!=null&&i(s.next.value,a)<=0;)s=s.next;s.next={value:a,next:s.next}}return o};function ES(t,e,i){const o=bs(t[0],void 0);if(o==null)return;const s=(o.lon0+o.lon1)/2,a=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=R1(t[0]),[c,h]=l,p=-Il(t,c,h);let u;const g=(M,k)=>{const I=Math.max(k-p,0);return M-.5*I},y=(M,k,A)=>{const{distance:I,maxDistance:O}=i(t,M,k,A),T=Math.hypot(c-M,h-k),L=Math.min(Math.max(c,M-A/2),M+A/2),C=Math.min(Math.max(h,k-A/2),k+A/2),D=Math.hypot(c-L,h-C),R=g(I,T),_=g(O,D);return{distance:I,maxDistance:O,value:R,maxValue:_,x:M,y:k,stride:A}},f=(M,k,A,I)=>{const O=y(k,A,I);O.maxDistance>=0&&M.push(O)},m=Math.min(n,r)/2;let S={value:y(s,a,m),next:null};for(;S!=null;){const M=S.value,{distance:k,value:A,maxValue:I,x:O,y:T,stride:L}=M;if(S=S.next,k>0&&(u==null||A>u.value)&&(u=M),u!=null&&I-u.value<=e)continue;const C=L/2,D=[];f(D,O-C,T-C,C),f(D,O+C,T-C,C),f(D,O-C,T+C,C),f(D,O+C,T+C,C),D.sort(wS),S=D_(S,D,wS)}if(u==null)return;const{distance:b,x:v,y:x}=u;return{x:v,y:x,distance:b}}var wS=(t,e)=>e.maxValue-t.maxValue;function Ep(t,e){const i=ES(t,e,(a,n,r,l)=>{const c=-Il(a,n,r),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:o,y:s}=i;return[o,s]}function _S(t,e){let i;switch(t.type){case"GeometryCollection":return t.geometries.flatMap(o=>_S(o,e));case"MultiPoint":return t.coordinates;case"Point":return[t.coordinates];case"MultiPolygon":{const o=Tl(t);i=o!=null?Ep(o,e):void 0;break}case"Polygon":{const o=t.coordinates;i=o!=null?Ep(o,e):void 0;break}case"MultiLineString":{const o=Ol(t);i=o!=null?Dl(o)?.point:void 0;break}case"LineString":{const o=t.coordinates;i=Dl(o)?.point;break}}return i!=null?[i]:[]}import{_ModuleSupport as I_}from"ag-charts-community";var{AND:T_,ARRAY:O_,COLOR_STRING:PS,COLOR_STRING_ARRAY:L_,FUNCTION:N_,NUMBER_ARRAY:C_,OBJECT:BS,POSITIVE_NUMBER:wp,RATIO:zS,STRING:ce,MARKER_SHAPE:R_,Validate:ht,SeriesProperties:E_,SeriesTooltip:w_,Logger:__,Label:P_}=I_,FS=class extends P_{constructor(){super(...arguments),this.placement="bottom"}};d([ht(ce)],FS.prototype,"placement",2);var dt=class extends E_{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.label=new FS,this.tooltip=new w_}isValid(){const t=super.isValid(),e=this.idKey!=null,i=this.latitudeKey!=null&&this.longitudeKey!=null;return!e&&!i?(__.warnOnce("Either both [topology] and [idKey] or both [latitudeKey] and [longitudeKey] must be set to render a map marker series."),!1):t}};d([ht(Ei,{optional:!0})],dt.prototype,"topology",2),d([ht(ce,{optional:!0})],dt.prototype,"title",2),d([ht(ce,{optional:!0})],dt.prototype,"legendItemName",2),d([ht(ce,{optional:!0})],dt.prototype,"idKey",2),d([ht(ce)],dt.prototype,"topologyIdKey",2),d([ht(ce,{optional:!0})],dt.prototype,"idName",2),d([ht(ce,{optional:!0})],dt.prototype,"latitudeKey",2),d([ht(ce,{optional:!0})],dt.prototype,"latitudeName",2),d([ht(ce,{optional:!0})],dt.prototype,"longitudeKey",2),d([ht(ce,{optional:!0})],dt.prototype,"longitudeName",2),d([ht(ce,{optional:!0})],dt.prototype,"labelKey",2),d([ht(ce,{optional:!0})],dt.prototype,"labelName",2),d([ht(ce,{optional:!0})],dt.prototype,"sizeKey",2),d([ht(ce,{optional:!0})],dt.prototype,"sizeName",2),d([ht(ce,{optional:!0})],dt.prototype,"colorKey",2),d([ht(ce,{optional:!0})],dt.prototype,"colorName",2),d([ht(T_(L_,O_.restrict({minLength:1})),{optional:!0})],dt.prototype,"colorRange",2),d([ht(R_)],dt.prototype,"shape",2),d([ht(wp)],dt.prototype,"size",2),d([ht(wp,{optional:!0})],dt.prototype,"maxSize",2),d([ht(C_,{optional:!0})],dt.prototype,"sizeDomain",2),d([ht(PS)],dt.prototype,"fill",2),d([ht(zS)],dt.prototype,"fillOpacity",2),d([ht(PS)],dt.prototype,"stroke",2),d([ht(wp)],dt.prototype,"strokeWidth",2),d([ht(zS)],dt.prototype,"strokeOpacity",2),d([ht(N_,{optional:!0})],dt.prototype,"itemStyler",2),d([ht(BS)],dt.prototype,"label",2),d([ht(BS)],dt.prototype,"tooltip",2);var{CachedTextMeasurerPool:B_,Validate:z_,fromToMotion:F_,StateMachine:V_,getMissCount:G_,createDatumId:VS,SeriesNodePickMode:GS,valueProperty:Ms,computeMarkerFocusBounds:W_,Logger:U_,ColorScale:H_,LinearScale:K_,Group:Y_,Selection:_p,Text:j_,getMarker:WS}=RS,Rl=class extends Nn{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[GS.EXACT_SHAPE_MATCH,GS.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new dt,this._chartTopology=void 0,this.colorScale=new H_,this.sizeScale=new K_,this.markerGroup=this.contentGroup.appendChild(new Y_({name:"markerGroup"})),this.labelSelection=_p.select(this.labelGroup,j_,!1),this.markerSelection=_p.select(this.markerGroup,()=>this.markerFactory(),!1),this.highlightMarkerSelection=_p.select(this.highlightNode,()=>this.markerFactory()),this.animationState=new V_("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const t=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||t)}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.contentGroup.zIndex=[3,t],this.highlightGroup.zIndex=[4,t],!0):!1}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}markerFactory(){const{shape:t}=this.properties,e=WS(t);return new e}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:p,sizeDomain:u,colorRange:g}=this.properties,y=new Map;i?.features.forEach(O=>{const T=O.properties?.[a];T!=null&&y.set(T,O)});const f=this.sizeScale.type,m=this.colorScale.type,S=this.scale?.type,b=r!=null&&l!=null,{dataModel:v,processedData:x}=await this.requestDataModel(t,e,{props:[...n!=null?[Ms(n,S,{id:"idValue",includeProperty:!1}),Ms(n,S,{id:"featureValue",includeProperty:!1,processor:()=>O=>y.get(O)})]:[],...b?[Ms(r,S,{id:"latValue"}),Ms(l,S,{id:"lonValue"})]:[],...p?[Ms(p,"band",{id:"labelValue"})]:[],...c?[Ms(c,f,{id:"sizeValue"})]:[],...h?[Ms(h,m,{id:"colorValue"})]:[]]}),M=x.rawData.length!==0,k=M&&n!=null?v.resolveColumnById(this,"featureValue",x):void 0,A=M&&b?v.resolveColumnById(this,"latValue",x):void 0,I=M&&b?v.resolveColumnById(this,"lonValue",x):void 0;if(this.topologyBounds=x.rawData.reduce((O,T,L)=>{const D=k?.[L]?.geometry;if(D!=null&&(O=Da(D,O)),A!=null&&I!=null){const R=I[L],_=A[L];O=Ln(O,R,_,R,_)}return O},void 0),c!=null){const O=v.resolveProcessedDataIndexById(this,"sizeValue"),T=x.domain.values[O]??[];o.domain=u??T}if(g!=null&&this.isColorScaleValid()){const O=v.resolveProcessedDataIndexById(this,"colorValue");s.domain=x.domain.values[O],s.range=g,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.rawData.length,a=G_(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o,s,a){if(e==null)return;const{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:p,sizeKey:u,sizeName:g,colorKey:y,colorName:f,labelKey:m,labelName:S,label:b}=this.properties,{placement:v}=b,x=this.getLabelText(b,{value:e,datum:t,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:p,sizeKey:u,sizeName:g,colorKey:y,colorName:f,labelKey:m,labelName:S});if(x==null)return;const{width:M,height:k}=B_.measureText(String(x),{font:a});return{point:{x:i,y:o,size:s},label:{width:M,height:k,text:x},marker:WS(this.properties.shape),placement:v}}createNodeData(){const{id:t,dataModel:e,processedData:i,sizeScale:o,properties:s,scale:a}=this,{idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:p,label:u}=s;if(e==null||i==null||i.rawData.length===0||a==null)return;const g=r!=null&&l!=null,y=n!=null?e.resolveColumnById(this,"idValue",i):void 0,f=n!=null?e.resolveColumnById(this,"featureValue",i):void 0,m=g?e.resolveColumnById(this,"latValue",i):void 0,S=g?e.resolveColumnById(this,"lonValue",i):void 0,b=p!=null?e.resolveColumnById(this,"labelValue",i):void 0,v=c!=null?e.resolveColumnById(this,"sizeValue",i):void 0,x=h!=null?e.resolveColumnById(this,"colorValue",i):void 0,M=s.maxSize??s.size;o.range=[Math.min(s.size,M),M];const k=u.getFont();let A;y!=null&&f!=null&&(A=new Map,i.rawData.forEach((C,D)=>{const R=y[D],_=f[D]?.geometry??void 0,F=_!=null&&a!=null?Po(_,a):void 0;R!=null&&F!=null&&A.set(R,F)}));const I=[],O=[],T=[];i.rawData.forEach((C,D)=>{const R=y?.[D],_=S?.[D],F=m?.[D],E=x?.[D],B=v?.[D],P=b?.[D],N=B!=null?o.convert(B,!0):s.size,w=R!=null?A?.get(R):void 0;if(R!=null&&Po==null&&T.push(R),_!=null&&F!=null){const[z,V]=a.convert([_,F]),G=this.getLabelDatum(C,P,z,V,N,k);G&&O.push(G),I.push({series:this,itemId:r,datum:C,datumIndex:D,index:-1,idValue:R,lonValue:_,latValue:F,labelValue:P,sizeValue:B,colorValue:E,point:{x:z,y:V,size:N},midPoint:{x:z,y:V}})}else w!=null&&_S(w,1).forEach(([z,V],G)=>{const W=this.getLabelDatum(C,P,z,V,N,k);W&&O.push(W),I.push({series:this,itemId:r,datum:C,datumIndex:D,index:G,idValue:R,lonValue:_,latValue:F,labelValue:P,sizeValue:B,colorValue:E,point:{x:z,y:V,size:N},midPoint:{x:z,y:V}})})});const L=10;if(T.length>L){const C=T.length-L;T.length=L,T.push(`(+${C} more)`)}return T.length>0&&U_.warnOnce("some data items do not have matches in the provided topology",T),{itemId:t,nodeData:I,labelData:O}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}update({seriesRect:t}){const e=this.checkResize(t),i=this.checkScaleChange(),{markerSelection:o,highlightMarkerSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const n=this.contextNodeData?.nodeData??[];this.markerSelection=this.updateMarkerSelection({markerData:n,markerSelection:o}),this.updateMarkerNodes({markerSelection:o,isHighlight:!1,highlightedDatum:a}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:a!=null?[a]:[],markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!0,highlightedDatum:a}),(i||e)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(t){this.labelSelection=this.labelSelection.update(t,e=>{e.pointerEvents=RS.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,width:h,height:p,text:u})=>{r.visible=!0,r.x=l+h/2,r.y=c+p/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}updateMarkerSelection(t){const{markerData:e,markerSelection:i}=t;return i.update(e,void 0,o=>VS([o.index,o.idValue,o.lonValue,o.latValue]))}getMarkerItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{size:e.size,fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity}}getMarkerItemStyleOverrides(t,e,i,o,s,a){const{id:n,properties:r,colorScale:l,sizeScale:c}=this,{colorRange:h,itemStyler:p}=r;let u;if(!a&&i!=null&&(u??(u={}),u.fill=this.isColorScaleValid()?l.convert(i):h?.[0]??r.fill),o!=null&&(u??(u={}),u.size=c.convert(o,!0)),p!=null){const g=this.cachedDatumCallback(VS(t,a?"highlight":"node"),()=>p({seriesId:n,datum:e,highlighted:a,...s,...u}));u??(u={}),Object.assign(u,g)}return u}updateMarkerNodes(t){const{markerSelection:e,isHighlight:i,highlightedDatum:o}=t,s=this.getMarkerItemBaseStyle(i);e.each((a,n)=>{const{datumIndex:r,datum:l,point:c,colorValue:h,sizeValue:p}=n,u=this.getMarkerItemStyleOverrides(String(r),l,h,p,s,i);a.size=u?.size??s.size,a.fill=u?.fill??s.fill,a.fillOpacity=u?.fillOpacity??s.fillOpacity,a.stroke=u?.stroke??s.stroke,a.strokeWidth=u?.strokeWidth??s.strokeWidth,a.strokeOpacity=u?.strokeOpacity??s.strokeOpacity,a.translationX=c.x,a.translationY=c.y,a.zIndex=!i&&o!=null&&l===o.datum?1:0})}isProcessedDataAnimatable(){return!0}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:t}=this.ctx,e=i_();F_(this.id,"markers",t,[this.markerSelection,this.highlightMarkerSelection],e)}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum(t){const{x:e,y:i}=t;let o=1/0,s;return this.contextNodeData?.nodeData.forEach(a=>{const{x:n,y:r,size:l}=a.point,c=Math.max(Math.abs(n-e)-l,0),h=Math.max(Math.abs(r-i)-l,0),p=c*c+h*h;p<o&&(o=p,s=a)}),s!=null?{datum:s,distance:Math.sqrt(o)}:void 0}legendItemSymbol(t){const{dataModel:e,processedData:i,properties:o}=this,{shape:s,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l}=o;let{fill:c}=o;if(t!=null&&this.isColorScaleValid()){const p=e.resolveColumnById(this,"colorValue",i)[t];c=this.colorScale.convert(p)}return{marker:{shape:s,fill:c,fillOpacity:a,stroke:n,strokeWidth:r,strokeOpacity:l}}}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idName:r,idKey:l,colorKey:c,colorName:h,colorRange:p,showInLegend:u}=this.properties;if(t==="gradient"&&c!=null&&p!=null){const g=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,colorName:h,colorRange:p,colorDomain:g}]}else return t==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??r??l??o},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!u}]:[]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{idKey:a,idName:n,latitudeKey:r,latitudeName:l,longitudeKey:c,longitudeName:h,colorKey:p,colorName:u,sizeKey:g,sizeName:y,labelKey:f,labelName:m,title:S,legendItemName:b,tooltip:v}=s;if(!i||!o?.rawData.length)return;const{datumIndex:x}=t,M=o.rawData[x],k=g!=null?i.resolveColumnById(this,"sizeValue",o)[x]:void 0,A=p!=null?i.resolveColumnById(this,"colorValue",o)[x]:void 0,I=[];if(k!=null&&I.push({label:y,fallbackLabel:g,value:String(k)}),A!=null&&I.push({label:u,fallbackLabel:p,value:String(A)}),f!=null&&f!==a){const L=i.resolveColumnById(this,"labelValue",o)[x];I.push({label:m,fallbackLabel:f,value:L})}let O;if(a!=null)O=i.resolveColumnById(this,"idValue",o)[x];else if(r!=null&&c!=null){const L=i.resolveColumnById(this,"latValue",o)[x],C=i.resolveColumnById(this,"lonValue",o)[x];O=`${Math.abs(L).toFixed(4)}\xB0 ${L>=0?"N":"S"}, ${Math.abs(C).toFixed(4)}\xB0 ${C>=0?"W":"E"}`}const T=this.getMarkerItemBaseStyle(!1);return Object.assign(T,this.getMarkerItemStyleOverrides(String(x),x,A,k,T,!1)),v.formatTooltip({heading:O,title:S??b,symbol:this.legendItemSymbol(x),data:I},{seriesId:e,datum:M,title:S,idKey:a,idName:n,latitudeKey:r,latitudeName:l,longitudeKey:c,longitudeName:h,colorKey:p,colorName:u,sizeKey:g,sizeName:y,labelKey:f,labelName:m,...T})}getFormattedMarkerStyle(t){const{datumIndex:e,colorValue:i,sizeValue:o}=t,s=this.getMarkerItemBaseStyle(!1);return Object.assign(s,this.getMarkerItemStyleOverrides(String(e),e,i,o,s,!1)),{size:s.size}}computeFocusBounds(t){return W_(this,t)}};Rl.className="MapMarkerSeries",Rl.type="map-marker",d([z_(Ei,{optional:!0,property:"topology"})],Rl.prototype,"_chartTopology",2);var{DEFAULT_LABEL_COLOUR:X_,DEFAULT_DIVERGING_SERIES_COLOR_RANGE:Z_}=CS.ThemeSymbols,$_={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",moduleFactory:t=>new Rl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...On,series:{shape:"circle",maxSize:30,fillOpacity:.5,label:{color:X_}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a,stroke:n}=CS.singleSeriesPaletteFactory(t),r=s.get(Z_),{fills:l}=e(i);return{fill:a,stroke:n,colorRange:o==="inbuilt"?r:[l[0],l[1]]}}};import{_ModuleSupport as Q_}from"ag-charts-community";import{_ModuleSupport as q_}from"ag-charts-community";import{_ModuleSupport as J_}from"ag-charts-community";var{COLOR_STRING:US,LINE_DASH:tP,OBJECT:eP,POSITIVE_NUMBER:HS,RATIO:KS,Validate:io,SeriesProperties:iP,SeriesTooltip:oP}=J_,wi=class extends iP{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new oP}};d([io(Ei,{optional:!0})],wi.prototype,"topology",2),d([io(US)],wi.prototype,"fill",2),d([io(KS)],wi.prototype,"fillOpacity",2),d([io(US)],wi.prototype,"stroke",2),d([io(KS)],wi.prototype,"strokeOpacity",2),d([io(HS)],wi.prototype,"strokeWidth",2),d([io(tP)],wi.prototype,"lineDash",2),d([io(HS)],wi.prototype,"lineDashOffset",2),d([io(eP)],wi.prototype,"tooltip",2);var{createDatumId:sP,SeriesNodePickMode:aP,Validate:nP,Logger:rP,Selection:lP,Group:cP,PointerEvents:hP}=q_,El=class extends Nn{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[aP.EXACT_SHAPE_MATCH]}),this.properties=new wi,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new cP({name:"itemGroup"})),this.datumSelection=lP.select(this.itemGroup,()=>this.nodeFactory())}get topology(){return this.properties.topology??this._chartTopology}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.contentGroup.zIndex=[0,t,0],this.highlightGroup.zIndex=[0,t,1],!0):!1}nodeFactory(){const t=new Aa;return t.renderMode=1,t.lineJoin="round",t.pointerEvents=hP.None,t}processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:Da(o,e)},void 0),t==null&&rP.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){const{id:t,topology:e,scale:i}=this;if(e==null)return;const o=[],s=[];return e.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?Po(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,index:n,projectedGeometry:l})}),{itemId:t,nodeData:o,labelData:s}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:e,datumSelection:t}),this.updateDatumNodes({datumSelection:t})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>sP(e.index))}updateDatumNodes(t){const{properties:e}=this,{datumSelection:i}=t,{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}=e,c=this.getStrokeWidth(e.strokeWidth);i.each((h,p)=>{const{projectedGeometry:u}=p;if(u==null){h.visible=!1,h.projectedGeometry=void 0;return}h.visible=!0,h.projectedGeometry=u,h.fill=o,h.fillOpacity=s,h.stroke=a,h.strokeWidth=c,h.strokeOpacity=n,h.lineDash=r,h.lineDashOffset=l})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(t){}pickFocus(){}computeFocusBounds(t){}};El.className="MapShapeBackgroundSeries",El.type="map-shape-background",d([nP(Ei,{optional:!0,property:"topology"})],El.prototype,"_chartTopology",2);var{DEFAULT_BACKGROUND_COLOUR:dP,DEFAULT_HIERARCHY_FILLS:pP}=Q_.ThemeSymbols,uP={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",moduleFactory:t=>new El(t),tooltipDefaults:{range:"exact"},themeTemplate:{...On,series:{stroke:dP,strokeWidth:1}},paletteFactory:({themeTemplateParameters:t})=>({fill:t.get(pP)?.[1]})};import{_ModuleSupport as YS}from"ag-charts-community";import{_ModuleSupport as jS}from"ag-charts-community";function gP(t,{aspectRatio:e,precision:i}){const o=ES(t,i,(l,c,h,p)=>{const u=fP(l,c,h,e),g=u+2*p*e,y=u*Math.SQRT2,f=g*Math.SQRT2;return{distance:y,maxDistance:f}});if(o==null)return;const{x:s,y:a,distance:n}=o,r=n/Math.SQRT2;return{x:s,y:a,maxWidth:r}}function yP(t,e,i,o,s){const[a,n]=t,[r,l]=e,c=1/s,h=r-a,p=l-n,[u,g]=n<=l?t:e,[y,f]=a<=r?t:e,[m,S]=n<=l?e:t,[b,v]=a<=r?e:t;let x=1/0;if(h!==0){const T=p/h;for(let L=0;L<=1;L+=1){const C=L===0?c:-c,D=(T*a-n-C*i+o)/(T-C);if(D>=y&&D<=b){const R=Math.abs(i-D)*2;x=Math.min(x,R)}}}else for(let T=0;T<=1;T+=1){const C=(T===0?c:-c)*(a-i)+o;if(C>=g&&C<=S){const R=Math.abs(o-C)*2*s;x=Math.min(x,R)}}const M=s,k=Math.abs((u-i)/(g-o)),A=Math.abs((m-i)/(S-o));if(S<o&&A<M){const L=Math.abs(o-S)*2*s;x=Math.min(x,L)}else if(g>o&&k<M){const L=Math.abs(o-g)*2*s;x=Math.min(x,L)}const I=Math.abs((f-o)/(y-i)),O=Math.abs((v-o)/(b-i));if(b<i&&O<c){const T=Math.abs(i-b)*2;x=Math.min(x,T)}else if(y>i&&I<c){const T=Math.abs(i-y)*2;x=Math.min(x,T)}return x}function fP(t,e,i,o){let s=!1,a=1/0;for(const n of t){let r=n[n.length-1],[l,c]=r;for(const h of n){const[p,u]=h;u>i!=c>i&&e<(l-p)*(i-u)/(c-u)+p&&(s=!s);const g=yP(r,h,e,i,o);a=Math.min(a,g),r=h,l=p,c=u}}return(s?1:-1)*a}function wl(t,e,i){i>=e&&(t.maxX=Math.min(t.maxX,i-e)),i<=e&&(t.minX=Math.max(t.minX,i-e))}function mP(t,e,i,o,s,a){const n=s-a/2,r=s+a/2,[l,c]=e,[h,p]=i,u=h-l,g=p-c,[y,f]=l<=h?e:i,[m,S]=l<=h?i:e;if(u!==0){const b=g/u;for(let v=0;v<=1;v+=1){const M=((v===0?n:r)-c)/b+l;M>=y&&M<=m&&wl(t,o,M)}}else Math.max(n,Math.min(c,p))<=Math.min(r,Math.max(c,p))&&wl(t,o,l);return m<o&&S>=n&&S<=r?wl(t,o,m):y>o&&f>=n&&f<=r&&wl(t,o,y),t}function xP(t,e,i,o){const s={minX:-1/0,maxX:1/0};for(const r of t){let l=r[r.length-1];for(const c of r)mP(s,l,c,e,i,o),l=c}const{minX:a,maxX:n}=s;return Number.isFinite(a)&&Number.isFinite(n)?{x:e+(a+n)/2,width:n-a}:{x:e,width:0}}import{_ModuleSupport as SP}from"ag-charts-community";var{AND:bP,ARRAY:vP,COLOR_STRING:XS,COLOR_STRING_ARRAY:MP,FUNCTION:kP,LINE_DASH:AP,OBJECT:ZS,POSITIVE_NUMBER:Pp,RATIO:$S,STRING:oo,Validate:Mt,SeriesProperties:DP,SeriesTooltip:IP}=SP,vt=class extends DP{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new An,this.tooltip=new IP}};d([Mt(Ei,{optional:!0})],vt.prototype,"topology",2),d([Mt(oo,{optional:!0})],vt.prototype,"title",2),d([Mt(oo,{optional:!0})],vt.prototype,"legendItemName",2),d([Mt(oo)],vt.prototype,"idKey",2),d([Mt(oo,{optional:!0})],vt.prototype,"idName",2),d([Mt(oo)],vt.prototype,"topologyIdKey",2),d([Mt(oo,{optional:!0})],vt.prototype,"labelKey",2),d([Mt(oo,{optional:!0})],vt.prototype,"labelName",2),d([Mt(oo,{optional:!0})],vt.prototype,"colorKey",2),d([Mt(oo,{optional:!0})],vt.prototype,"colorName",2),d([Mt(bP(MP,vP.restrict({minLength:1})),{optional:!0})],vt.prototype,"colorRange",2),d([Mt(XS)],vt.prototype,"fill",2),d([Mt($S)],vt.prototype,"fillOpacity",2),d([Mt(XS)],vt.prototype,"stroke",2),d([Mt($S)],vt.prototype,"strokeOpacity",2),d([Mt(Pp)],vt.prototype,"strokeWidth",2),d([Mt(AP)],vt.prototype,"lineDash",2),d([Mt(Pp)],vt.prototype,"lineDashOffset",2),d([Mt(Pp)],vt.prototype,"padding",2),d([Mt(kP,{optional:!0})],vt.prototype,"itemStyler",2),d([Mt(ZS)],vt.prototype,"label",2),d([Mt(ZS)],vt.prototype,"tooltip",2);var{getMissCount:TP,createDatumId:QS,SeriesNodePickMode:qS,valueProperty:_l,Validate:OP,CachedTextMeasurerPool:LP,TextUtils:JS,Logger:tb,ColorScale:NP,Group:eb,Selection:Bp,Text:CP,PointerEvents:RP}=jS,ib=jS.MercatorScale.fixedScale(),Pl=class extends Nn{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[qS.EXACT_SHAPE_MATCH,qS.NEAREST_NODE]}),this.properties=new vt,this._chartTopology=void 0,this.colorScale=new NP,this.itemGroup=this.contentGroup.appendChild(new eb({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new eb({name:"itemLabelGroup"})),this.datumSelection=Bp.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Bp.select(this.itemLabelGroup,CP),this.highlightDatumSelection=Bp.select(this.highlightNode,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=RP.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.contentGroup.zIndex=[1,t],this.highlightGroup.zIndex=[2,t],!0):!1}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new Aa;return t.renderMode=1,t.lineJoin="round",t}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,colorKey:n,labelKey:r,colorRange:l}=this.properties,c=new Map;i?.features.forEach(f=>{const m=f.properties?.[s];m==null||!Op(f.geometry,1)||c.set(m,f)});const h=this.colorScale.type,p=this.scale?.type,{dataModel:u,processedData:g}=await this.requestDataModel(t,e,{props:[_l(a,p,{id:"idValue",includeProperty:!1}),_l(a,p,{id:"featureValue",includeProperty:!1,processor:()=>f=>c.get(f)}),...r?[_l(r,"band",{id:"labelValue"})]:[],...n?[_l(n,h,{id:"colorValue"})]:[]]}),y=g.rawData.length!==0?u.resolveColumnById(this,"featureValue",g):void 0;if(this.topologyBounds=y?.reduce((f,m)=>{const S=m?.geometry;return S==null?f:Da(S,f)},void 0),l!=null&&this.isColorScaleValid()){const f=u.resolveProcessedDataIndexById(this,"colorValue");o.domain=g.domain.values[f],o.range=l,o.update()}i==null&&tb.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.rawData.length,a=TP(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelLayout(t,e,i,o,s){if(e==null||o==null)return;const{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,padding:p,label:u}=this.properties,g=this.getLabelText(u,{value:e,datum:t,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h});if(g==null)return;const y=LP.measureText(String(g),{font:i}),f=g.split(`
`).length,m=(y.width+2*p)/(f*JS.getLineHeight(u.fontSize)+2*p);if(s?.geometry===o&&s?.labelText===g&&s?.aspectRatio===m)return s;const S=Po(o,ib),b=Tl(S);if(b==null)return;const v=gP(b,{aspectRatio:m,precision:.001});if(v==null)return;const{x,y:M,maxWidth:k}=v;return{geometry:o,labelText:g,aspectRatio:m,x,y:M,maxWidth:k,fixedPolygon:b}}getLabelDatum(t,e){const{scale:i}=this;if(i==null)return;const{padding:o,label:s}=this.properties,{labelText:a,aspectRatio:n,x:r,y:l,maxWidth:c,fixedPolygon:h}=t,p={width:Math.ceil(c*e),height:Math.ceil(c*e/n),meta:r},u=Mn(a,s,{padding:o},(x,M)=>{if(!M)return p;const k=xP(h,r,l,x/e);return{width:k.width*e,height:x,meta:k.x}});if(u==null)return;const[{text:g,fontSize:y,lineHeight:f,width:m},S]=u;if(g===JS.EllipsisChar)return;const b=m<p.width?r:S,v=this.scale.convert(ib.invert([b,l]));return{x:v[0],y:v[1],text:g,fontSize:y,lineHeight:f}}createNodeData(){const{id:t,dataModel:e,processedData:i,properties:o,scale:s,previousLabelLayouts:a}=this,{idKey:n,colorKey:r,labelKey:l,label:c}=o;if(e==null||i==null||i.rawData.length===0)return;const h=s!=null?(s.range[1][0]-s.range[0][0])/s.bounds.width:NaN,p=e.resolveColumnById(this,"idValue",i),u=e.resolveColumnById(this,"featureValue",i),g=l!=null?e.resolveColumnById(this,"labelValue",i):void 0,y=r!=null?e.resolveColumnById(this,"colorValue",i):void 0,f=c.getFont(),m=new Map;this.previousLabelLayouts=m;const S=[],b=[],v=[];i.rawData.forEach((M,k)=>{const A=p[k],I=y?.[k],O=g?.[k],T=u[k]?.geometry??void 0;T==null&&v.push(A);const L=this.getLabelLayout(M,O,f,T,a?.get(A));L!=null&&m.set(A,L);const C=L!=null&&s!=null?this.getLabelDatum(L,h):void 0;C!=null&&b.push(C);const D=T!=null&&s!=null?Po(T,s):void 0;S.push({series:this,itemId:n,datum:M,datumIndex:k,idValue:A,colorValue:I,labelValue:O,projectedGeometry:D})});const x=10;if(v.length>x){const M=v.length-x;v.length=x,v.push(`(+${M} more)`)}return v.length>0&&tb.warnOnce("some data items do not have matches in the provided topology",v),{itemId:t,nodeData:S,labelData:b}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){const{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();o!=null&&(o.series!==this||o.datum==null)&&(o=void 0);const s=this.contextNodeData?.nodeData??[],a=this.contextNodeData?.labelData??[];this.datumSelection=this.updateDatumSelection({nodeData:s,datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:a,labelSelection:e}),this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),this.updateDatumNodes({datumSelection:i,isHighlight:!0})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>QS(e.idValue))}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset}}getItemStyleOverrides(t,e,i,o,s){const{id:a,properties:n,colorScale:r}=this,{colorRange:l,itemStyler:c}=n;let h;if(!s&&i!=null&&(h??(h={}),h.fill=this.isColorScaleValid()?r.convert(i):l?.[0]??n.fill),c!=null){const p=this.cachedDatumCallback(QS(t,s?"highlight":"node"),()=>c({seriesId:a,datum:e,highlighted:s,...o,...h}));h??(h={}),Object.assign(h,p)}return h}updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getItemBaseStyle(i);e.each((s,a)=>{const{datum:n,datumIndex:r,colorValue:l,projectedGeometry:c}=a;if(c==null){s.visible=!1,s.projectedGeometry=void 0;return}const h=this.getItemStyleOverrides(String(r),n,l,o,i);s.visible=!0,s.projectedGeometry=c,s.fill=h?.fill??o.fill,s.fillOpacity=h?.fillOpacity??o.fillOpacity,s.stroke=h?.stroke??o.stroke,s.strokeWidth=h?.strokeWidth??o.strokeWidth,s.strokeOpacity=h?.strokeOpacity??o.strokeOpacity,s.lineDash=h?.lineDash??o.lineDash,s.lineDashOffset=h?.lineDashOffset??o.lineDashOffset})}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontFamily:a}=this.properties.label;e.each((n,{x:r,y:l,text:c,fontSize:h,lineHeight:p})=>{n.visible=!0,n.x=r,n.y=l,n.text=c,n.fill=i,n.fontStyle=o,n.fontWeight=s,n.fontSize=h,n.lineHeight=p,n.fontFamily=a,n.textAlign="center",n.textBaseline="middle"})}resetAnimation(){}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?Tl(i):void 0,s=o!=null?Ep(o,2):void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}legendItemSymbol(t){const{dataModel:e,processedData:i,properties:o}=this,{fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r}=o;let{fill:l}=o;if(t!=null&&this.isColorScaleValid()){const h=e.resolveColumnById(this,"colorValue",i)[t];l=this.colorScale.convert(h)}return{marker:{fill:l,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r}}}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{id:o,visible:s}=this,{title:a,legendItemName:n,idKey:r,idName:l,colorKey:c,colorName:h,colorRange:p,showInLegend:u}=this.properties;if(t==="gradient"&&c!=null&&p!=null){const g=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:s,seriesId:o,colorName:h,colorRange:p,colorDomain:g}]}else return t==="category"?[{legendType:"category",id:o,itemId:o,seriesId:o,enabled:s,label:{text:n??a??l??r},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!u}]:[]}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,legendItemName:p,title:u,tooltip:g}=s;if(!i||!o?.rawData.length)return;const{datumIndex:y}=t,f=o.rawData[y],m=i.resolveColumnById(this,"idValue",o)[y],S=r!=null?i.resolveColumnById(this,"colorValue",o)[y]:void 0,b=[];if(S!=null&&b.push({label:l,fallbackLabel:r,value:String(S)}),c!=null&&c!==a){const x=i.resolveColumnById(this,"labelValue",o)[y];b.push({label:h,fallbackLabel:c,value:x})}const v=this.getItemBaseStyle(!1);return Object.assign(v,this.getItemStyleOverrides(String(y),y,S,v,!1)),g.formatTooltip({heading:m,title:u??p,symbol:this.legendItemSymbol(y),data:b},{seriesId:e,datum:f,title:u,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,...v})}computeFocusBounds(t){return IS(this,t)}};Pl.className="MapShapeSeries",Pl.type="map-shape",d([OP(Ei,{optional:!0,property:"topology"})],Pl.prototype,"_chartTopology",2);var{DEFAULT_INVERTED_LABEL_COLOUR:EP,DEFAULT_DIVERGING_SERIES_COLOR_RANGE:wP,DEFAULT_BACKGROUND_COLOUR:_P}=YS.ThemeSymbols,PP={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",moduleFactory:t=>new Pl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...On,series:{fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:EP,fontWeight:"bold",overflowStrategy:"hide"}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a}=YS.singleSeriesPaletteFactory(t),n=s.get(wP),{fills:r}=e(i);return{fill:a,stroke:s.get(_P),colorRange:o==="inbuilt"?n:[r[0],r[1]]}}};import{_ModuleSupport as BP}from"ag-charts-community";import{_ModuleSupport as zP}from"ag-charts-community";import{_ModuleSupport as zp}from"ag-charts-community";var{isDefined:FP,ChartAxisDirection:so,PolarAxis:VP,diff:GP,fixNumericExtent:WP,groupAccumulativeValueProperty:ob,keyProperty:UP,normaliseGroupTo:HP,resetLabelFn:KP,seriesLabelFadeInAnimation:YP,seriesLabelFadeOutAnimation:jP,valueProperty:XP,animationValidation:ZP,createDatumId:sb,SeriesNodePickMode:ab,normalizeAngle360:nb,BandScale:$P,motion:rb}=zp,QP=class extends zp.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},lb=class extends zp.PolarSeries{constructor(t,{animationResetFns:e}){super({moduleCtx:t,useLabelLayer:!0,canHaveAxes:!0,pickModes:[ab.NEAREST_NODE,ab.EXACT_SHAPE_MATCH],animationResetFns:{...e,label:KP}}),this.NodeEvent=QP,this.groupScale=new $P,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===so.X)return e.getDomain(this,"angleValue","key",i);{const o=e.getDomain(this,"radiusValue-end","value",i),s=[o[0]>0?0:o[0],o[1]<0?0:o[1]];return WP(s)}}async processData(t){const{visible:e}=this,{angleKey:i,radiusKey:o,normalizedTo:s}=this.properties,a=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid())return;const n=this.getStackId(),r=`${n}-trailing`,l=[];FP(s)&&l.push(HP([n,r],Math.abs(s),"range")),a&&this.processedData&&l.push(GP(this.id,this.processedData)),a&&l.push(ZP());const c=e||!a?{}:{forceValue:0},h=this.axes[so.Y]?.scale.type,p=this.axes[so.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[UP(i,p,{id:"angleValue"}),XP(o,h,{id:"radiusValue-raw",invalidValue:null,...c}),...ob(o,"normal","current",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:n,separateNegative:!0,...c},h),...ob(o,"trailing","current",{id:"radiusValue-start",invalidValue:null,groupId:r,separateNegative:!0,...c},h),...l]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t!==o.r||e!==o.cx||i!==o.cy?(this.circleCache={r:t,cx:e,cy:i},!0):!1}isRadiusAxisReversed(){return this.axes[so.Y]?.isReversed()}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}getAxisInnerRadius(){const t=this.axes[so.Y];return t instanceof VP?this.radius*t.innerRadiusRatio:0}createNodeData(){const{processedData:t,dataModel:e,groupScale:i}=this;if(!e||!t||t.type!=="ungrouped"||t.rawData.length===0||!this.properties.isValid())return;const o=this.axes[so.X],s=this.axes[so.Y],a=o?.scale,n=s?.scale;if(!a||!n)return;const r=e.resolveKeysById(this,"angleValue",t),l=e.resolveColumnById(this,"radiusValue-start",t),c=e.resolveColumnById(this,"radiusValue-end",t),h=e.resolveColumnById(this,"radiusValue-raw",t),p=e.resolveProcessedDataIndexById(this,"radiusValue-range");let u=0,g=0;o instanceof Ko&&(u=o.groupPaddingInner,g=o.paddingInner);const f=(a.bandwidth??0)*(1-g),{index:m,visibleGroupCount:S}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:S}).map((F,E)=>String(E)),i.range=[-f/2,f/2],i.paddingInner=S>1?u:0;const b=this.isRadiusAxisReversed(),v=b?this.radius:this.getAxisInnerRadius(),x=b?this.getAxisInnerRadius():this.radius,M=x+v,{angleKey:k,radiusKey:A,angleName:I,radiusName:O,label:T}=this.properties,L=(F,E,B,P)=>{const N=this.getLabelText(T,{value:E,datum:F,angleKey:k,radiusKey:A,angleName:I,radiusName:O});if(N)return{x:B,y:P,text:N,textAlign:"center",textBaseline:"middle"}},C=[],D={itemId:A,nodeData:C,labelData:C};if(!this.visible)return D;const{rawData:R,aggregation:_}=t;return R.forEach((F,E)=>{const B=r[E];if(B==null)return;const P=h[E],N=P>=0&&!Object.is(P,-0),w=l[E],z=c[E],G=_[E][p][N?1:0]??0,W=N===b;if(w===void 0||z===void 0)return;let H,K;if(R.length===1)H=-.5*Math.PI,K=1.5*Math.PI;else{const pt=a.convert(B);H=nb(pt+i.convert(String(m))),K=nb(H+i.bandwidth)}const Q=H+i.bandwidth/2,st=M-n.convert(w),tt=M-n.convert(z),$=(st+tt)/2,j=M-n.convert(0),q=M-n.convert(G),J=Math.cos(Q)*$,X=Math.sin(Q)*$,gt=this.properties.label.enabled?L(F,P,J,X):void 0,rt=this.getColumnWidth(H,K);C.push({series:this,datum:F,datumIndex:E,point:{x:J,y:X,size:0},midPoint:{x:J,y:X},label:gt,angleValue:B,radiusValue:P,negative:W,innerRadius:st,outerRadius:tt,stackInnerRadius:j,stackOuterRadius:q,startAngle:H,endAngle:K,axisInnerRadius:v,axisOuterRadius:x,columnWidth:rt,index:E})}),{itemId:A,nodeData:C,labelData:C}}getColumnWidth(t,e){return NaN}update({seriesRect:t}){const e=this.checkResize(t);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset,cornerRadius:e.cornerRadius}}getItemStyleOverrides(t,e,i,o){const{id:s,properties:a}=this,{angleKey:n,radiusKey:r,itemStyler:l}=a;if(l!=null)return this.cachedDatumCallback(sb(t,o?"highlight":"node"),()=>l({seriesId:s,datum:e,highlighted:o,angleKey:n,radiusKey:r,...i}))}updateSectorSelection(t,e){let i=[];if(e){const s=this.ctx.highlightManager?.getActiveHighlight();s?.datum&&s.series===this&&i.push(s)}else i=this.nodeData;const o=this.getItemBaseStyle(e);t.update(i,void 0,s=>this.getDatumId(s)).each((s,a)=>{const{datum:n,datumIndex:r}=a,l=this.getItemStyleOverrides(String(r),n,o,e);this.updateItemPath(s,a,e,{...l,...o}),s.fill=l?.fill??o.fill,s.fillOpacity=l?.fillOpacity??o.fillOpacity,s.stroke=l?.stroke??o.stroke,s.strokeWidth=l?.strokeWidth??o.strokeWidth,s.strokeOpacity=l?.strokeOpacity??o.strokeOpacity,s.lineDash=l?.lineDash??o.lineDash,s.lineDashOffset=l?.lineDashOffset??o.lineDashOffset,s.cornerRadius=l?.cornerRadius??o.cornerRadius,s.lineJoin="round"})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getColumnTransitionFunctions();rb.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),YP(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getColumnTransitionFunctions();rb.fromToMotion(this.id,"datums",e,[t],i),jP(this,"labels",e,this.labelSelection)}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:h}=a,p=s[so.X],u=s[so.Y];if(!i||!o||o.rawData.length===0||!p||!u)return;const{datumIndex:g}=t,y=o.rawData[g],f=i.resolveKeysById(this,"angleValue",o)[g],m=i.resolveColumnById(this,"radiusValue-raw",o)[g];if(f==null)return;const S=this.getItemBaseStyle(!1);return Object.assign(S,this.getItemStyleOverrides(String(g),g,S,!1)),h.formatTooltip({heading:p.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:u.formatDatum(m)}]},{seriesId:e,datum:y,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,...S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}legendItemSymbol(){const{fill:t,stroke:e,fillOpacity:i,strokeOpacity:o,strokeWidth:s}=this.properties;return{marker:{fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:i??1,strokeOpacity:o??1,strokeWidth:s}}}getLegendData(t){if(!this.properties.isValid()||t!=="category")return[];const{id:e,visible:i}=this,{radiusKey:o,radiusName:s,showInLegend:a}=this.properties;return[{legendType:"category",id:e,itemId:o,seriesId:e,enabled:i,label:{text:s??o},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(t){return sb(t.angleValue)}computeLabelsBBox(){return null}};import{_ModuleSupport as qP}from"ag-charts-community";var{SeriesProperties:JP,SeriesTooltip:tB,Validate:Yt,COLOR_STRING:cb,NUMBER:hb,FUNCTION:eB,LINE_DASH:iB,OBJECT:db,POSITIVE_NUMBER:Fp,RATIO:pb,STRING:Rn,Label:oB}=qP,_t=class extends JP{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new oB,this.tooltip=new tB}};d([Yt(Rn)],_t.prototype,"angleKey",2),d([Yt(Rn,{optional:!0})],_t.prototype,"angleName",2),d([Yt(Rn)],_t.prototype,"radiusKey",2),d([Yt(Rn,{optional:!0})],_t.prototype,"radiusName",2),d([Yt(cb)],_t.prototype,"fill",2),d([Yt(pb)],_t.prototype,"fillOpacity",2),d([Yt(cb)],_t.prototype,"stroke",2),d([Yt(Fp)],_t.prototype,"strokeWidth",2),d([Yt(pb)],_t.prototype,"strokeOpacity",2),d([Yt(iB)],_t.prototype,"lineDash",2),d([Yt(Fp)],_t.prototype,"lineDashOffset",2),d([Yt(Fp)],_t.prototype,"cornerRadius",2),d([Yt(eB,{optional:!0})],_t.prototype,"itemStyler",2),d([Yt(hb)],_t.prototype,"rotation",2),d([Yt(Rn,{optional:!0})],_t.prototype,"stackGroup",2),d([Yt(hb,{optional:!0})],_t.prototype,"normalizedTo",2),d([Yt(db)],_t.prototype,"label",2),d([Yt(db)],_t.prototype,"tooltip",2);import{_ModuleSupport as sB}from"ag-charts-community";import{_ModuleSupport as aB}from"ag-charts-community";var{motion:nB}=aB;function ub(){const t={startAngle:new Map,endAngle:new Map},e=["startAngle","endAngle"],i=(n,r,l)=>{e.forEach(c=>{const h=t[c];let p=(l==="removed"||l==="updated"?n:r)[c],u=(l==="removed"?n:r)[c];isNaN(u)&&(u=n.previousDatum?.[c]??NaN);const g=p-u;Math.abs(g)>Math.PI&&(p-=Math.sign(g)*2*Math.PI),h.set(r,{from:p,to:u})})},o=(n,r)=>({startAngle:t.startAngle.get(n)[r],endAngle:t.endAngle.get(n)[r]});return{calculate:i,from:n=>o(n,"from"),to:n=>o(n,"to")}}function gb(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.startAngle)||isNaN(t.previousDatum.endAngle))return"added";if(isNaN(e.startAngle)||isNaN(e.endAngle))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function rB(t){const e=ub();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,p,u,g;return n==="removed"?(c=s.innerRadius,h=s.innerRadius,p=s.columnWidth,u=s.axisInnerRadius,g=s.axisOuterRadius):(c=isNaN(a.innerRadius)?t:a.innerRadius,h=isNaN(a.outerRadius)?t:a.outerRadius,p=isNaN(a.columnWidth)?s.columnWidth:a.columnWidth,u=a.axisInnerRadius,g=a.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:p,axisInnerRadius:u,axisOuterRadius:g,startAngle:r,endAngle:l}},fromFn:(s,a,n)=>{n=gb(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,p,u,g;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,p=s.columnWidth,u=s.axisInnerRadius,g=s.axisOuterRadius):(c=t,h=t,p=a.columnWidth,u=a.axisInnerRadius,g=a.axisOuterRadius);const y=nB.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,columnWidth:p,axisInnerRadius:u,axisOuterRadius:g,startAngle:r,endAngle:l,phase:y}}}}function lB(t,{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}){return{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}}var{SectorBox:Bl,motion:cB}=sB;function Vp(t){const{negative:e,innerRadius:i,outerRadius:o,stackInnerRadius:s,stackOuterRadius:a}=t;return{innerRadius:e?a:s,outerRadius:e?s:a,clipInnerRadius:e?o:i,clipOuterRadius:e?i:o}}function hB(t){const e=ub();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,p;if(n==="removed")c=t,h=t,p=new Bl(r,l,c,h);else{let u,g;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:g}=Vp(a)),isNaN(c)&&(c=t),isNaN(h)&&(h=t),isNaN(u)&&(u=t),isNaN(g)&&(g=t),p=new Bl(r,l,u,g)}return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:p}},fromFn:(s,a,n)=>{n=gb(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,p;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,p=s.clipSector):(c=t,h=t),p??(p=new Bl(r,l,c,h));const u=cB.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:p,phase:u}}}}function dB(t,e){const{startAngle:i,endAngle:o}=e,{innerRadius:s,outerRadius:a,clipInnerRadius:n,clipOuterRadius:r}=Vp(e),l=new Bl(i,o,n,r);return{innerRadius:s,outerRadius:a,startAngle:i,endAngle:o,clipSector:l}}var{Sector:pB,SectorBox:uB,PolarZIndexMap:Gp}=zP,Wp=class extends lb{constructor(t){super(t,{animationResetFns:{item:dB}}),this.properties=new _t}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.contentGroup.zIndex=[0,Gp.FOREGROUND,t],this.highlightGroup.zIndex=[0,Gp.HIGHLIGHT,t],this.labelGroup.zIndex=[0,Gp.LABEL,t],!0):!1}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new pB}updateItemPath(t,e,i,o){const{negative:s}=e;if(t.centerX=0,t.centerY=0,t.startOuterCornerRadius=s?0:this.properties.cornerRadius,t.endOuterCornerRadius=s?0:this.properties.cornerRadius,t.startInnerCornerRadius=s?this.properties.cornerRadius:0,t.endInnerCornerRadius=s?this.properties.cornerRadius:0,i){const{startAngle:a,endAngle:n}=e,{innerRadius:r,outerRadius:l,clipInnerRadius:c,clipOuterRadius:h}=Vp(e);t.innerRadius=r,t.outerRadius=l,t.startAngle=a,t.endAngle=n,t.clipSector=new uB(a,n,c,h)}}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return hB(t)}};Wp.className="NightingaleSeries",Wp.type="nightingale";import{_ModuleSupport as gB}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:yB,DEFAULT_LABEL_COLOUR:fB},ThemeConstants:{POLAR_AXIS_TYPE:yb,POLAR_AXIS_SHAPE:fb}}=gB,mB={series:{strokeWidth:1,label:{enabled:!1,fontSize:12,fontFamily:yB,color:fB}},axes:{[yb.ANGLE_CATEGORY]:{shape:fb.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[yb.RADIUS_NUMBER]:{shape:fb.CIRCLE}}},{ThemeSymbols:{DEFAULT_POLAR_SERIES_STROKE:xB},ThemeConstants:{POLAR_AXIS_TYPE:mb}}=BP,SB={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",moduleFactory:t=>new Wp(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:mb.ANGLE_CATEGORY},{type:mb.RADIUS_NUMBER}],themeTemplate:mB,paletteFactory({takeColors:t,userPalette:e}){const{fills:[i],strokes:[o]}=t(1);return{fill:i,stroke:e!=="inbuilt"?o:xB}},stackable:!0,groupable:!0,stackedByDefault:!0};import{_ModuleSupport as bB}from"ag-charts-community";import{_ModuleSupport as xb}from"ag-charts-community";var{createDatumId:vB}=xb,Up=class extends Zm{constructor(){super(...arguments),this.properties=new rl}nodeFactory(){return new wC}updateDatumNodes({datumSelection:t,isHighlight:e}){const{id:i,properties:o}=this,{xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,item:c,itemStyler:h}=o,{up:p,down:u}=c,{stroke:g,strokeWidth:y,strokeOpacity:f,lineDash:m,lineDashOffset:S}=p,{stroke:b,strokeWidth:v,strokeOpacity:x,lineDash:M,lineDashOffset:k}=u,A=e?o.highlightStyle.item:void 0;t.each((I,O)=>{const{isRising:T,centerX:L,width:C,y:D,height:R,yOpen:_,yClose:F,crisp:E}=O;let B;if(h!=null){const{stroke:P,strokeWidth:N,strokeOpacity:w,lineDash:z,lineDashOffset:V}=T?p:u;B=this.cachedDatumCallback(vB(this.getDatumId(O),e?"highlight":"node"),()=>h({seriesId:i,itemId:O.itemId,xKey:s,highKey:a,lowKey:n,openKey:r,closeKey:l,datum:O.datum,strokeOpacity:w,stroke:P,strokeWidth:N,lineDash:z,lineDashOffset:V,highlighted:e}))}I.centerX=L,I.width=C,I.y=D,I.height=R,I.yOpen=_,I.yClose=F,I.crisp=E,I.stroke=A?.stroke??B?.stroke??(T?g:b),I.strokeWidth=A?.strokeWidth??B?.strokeWidth??(T?y:v),I.strokeOpacity=A?.strokeOpacity??B?.strokeOpacity??(T?f:x),I.lineDash=A?.lineDash??B?.lineDash??(T?m:M),I.lineDashOffset=A?.lineDashOffset??B?.lineDashOffset??(T?S:k),I.strokeAlignment=(B?.strokeWidth??(T?y:v))/2})}getLegendData(t){const{id:e,data:i,ctx:{legendManager:o},visible:s}=this,{xKey:a,yName:n,item:{up:r,down:l},showInLegend:c,legendItemName:h}=this.properties;if(!i?.length||!a||t!=="category")return[];const p=new xb.LinearGradient("rgb",[{color:r.stroke,offset:0},{color:r.stroke,offset:.5},{color:l.stroke,offset:.5}],90);return[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:s&&o.getItemEnabled({seriesId:e,itemId:e}),label:{text:h??n??e},symbol:{marker:{fill:p,fillOpacity:r.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1}},legendItemName:h,hideInLegend:!c}]}};Up.className="ohlc",Up.type="ohlc";var{CARTESIAN_AXIS_TYPE:zl,CARTESIAN_POSITION:Sb}=bB.ThemeConstants,MB={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",moduleFactory:t=>new Up(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:zl.NUMBER,position:Sb.LEFT},{type:zl.ORDINAL_TIME,position:Sb.BOTTOM}],themeTemplate:{animation:{enabled:!1},axes:{[zl.NUMBER]:{crosshair:{snap:!1}},[zl.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const[s]=t(e).strokes;return{item:{up:{stroke:s},down:{stroke:s}}}}return{item:{up:{stroke:o.up.stroke},down:{stroke:o.down.stroke}}}}};import"ag-charts-community";import{_ModuleSupport as bb}from"ag-charts-community";import{_ModuleSupport as kB}from"ag-charts-community";var{SeriesProperties:AB,SeriesTooltip:DB,Validate:Pt,UNION:IB,COLOR_STRING_ARRAY:vb,FUNCTION:TB,DIRECTION:OB,BOOLEAN:LB,LINE_DASH:NB,OBJECT:Fl,NUMBER:CB,POSITIVE_NUMBER:Vl,RATIO:Mb,STRING:kb,Label:Ab,DropShadow:RB}=kB,EB=class extends Ab{},Hp=class extends Ab{constructor(){super(...arguments),this.spacing=0}};d([Pt(CB)],Hp.prototype,"spacing",2),d([Pt(IB(["before","after"],"a placement"))],Hp.prototype,"placement",2);var Wt=class extends AB{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new RB().set({enabled:!1}),this.label=new EB,this.stageLabel=new Hp,this.tooltip=new DB}};d([Pt(kb)],Wt.prototype,"stageKey",2),d([Pt(kb)],Wt.prototype,"valueKey",2),d([Pt(vb)],Wt.prototype,"fills",2),d([Pt(Mb)],Wt.prototype,"fillOpacity",2),d([Pt(vb)],Wt.prototype,"strokes",2),d([Pt(Vl)],Wt.prototype,"strokeWidth",2),d([Pt(Mb)],Wt.prototype,"strokeOpacity",2),d([Pt(NB)],Wt.prototype,"lineDash",2),d([Pt(Vl)],Wt.prototype,"lineDashOffset",2),d([Pt(OB)],Wt.prototype,"direction",2),d([Pt(LB,{optional:!0})],Wt.prototype,"reverse",2),d([Pt(Vl)],Wt.prototype,"spacing",2),d([Pt(Vl,{optional:!0})],Wt.prototype,"aspectRatio",2),d([Pt(TB,{optional:!0})],Wt.prototype,"itemStyler",2),d([Pt(Fl)],Wt.prototype,"shadow",2),d([Pt(Fl)],Wt.prototype,"label",2),d([Pt(Fl)],Wt.prototype,"stageLabel",2),d([Pt(Fl)],Wt.prototype,"tooltip",2);var{valueProperty:Db,SeriesNodePickMode:Ib,CachedTextMeasurerPool:wB,TextUtils:_B,createDatumId:PB,BBox:Kp,Group:Yp,Selection:Gl,Text:Tb,PointerEvents:Ob}=bb,BB=class extends bb.DataModelSeries{constructor(t){super({moduleCtx:t,pickModes:[Ib.EXACT_SHAPE_MATCH,Ib.NEAREST_NODE]}),this.properties=new Wt,this.itemGroup=this.contentGroup.appendChild(new Yp({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Yp({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new Yp({name:"stageLabelGroup"})),this.datumSelection=Gl.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Gl.select(this.itemLabelGroup,Tb),this.stageLabelSelection=Gl.select(this.stageLabelGroup,Tb),this.highlightDatumSelection=Gl.select(this.highlightNode,()=>this.nodeFactory()),this.itemLabelGroup.pointerEvents=Ob.None,this.stageLabelGroup.pointerEvents=Ob.None}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)))}nodeFactory(){return new Li}getNodeData(){return this.contextNodeData?.nodeData}async processData(t){if(this.data==null||!this.properties.isValid())return;const{id:e,visible:i,ctx:{legendManager:o}}=this,{stageKey:s,valueKey:a}=this.properties,n="band",r="number",l=(h,p,u)=>i&&o.getItemEnabled({seriesId:e,itemId:u}),c=this.visible?{}:{forceValue:0};await this.requestDataModel(t,this.data,{props:[Db(s,n,{id:"xValue"}),Db(a,r,{id:"yValue",...c,validation:l,invalidValue:0})]})}createNodeData(){const{id:t,dataModel:e,processedData:i,properties:o,visible:s,ctx:{legendManager:a}}=this,{stageKey:n,valueKey:r,direction:l,reverse:c=l==="horizontal",spacing:h,aspectRatio:p,label:u,stageLabel:g}=o;if(e==null||i==null||i.rawData.length===0)return;const y=l==="horizontal",f=e.resolveColumnById(this,"xValue",i),m=e.resolveColumnById(this,"yValue",i),S=wB.getMeasurer({font:g.getFont()});let b,v;y?(b="center",v=g.placement==="before"?"bottom":"top"):(b=g.placement==="after"?"left":"right",v="middle");const x=g.enabled?[]:void 0;let M=0,k=0,A=0;i.rawData.forEach((P,N)=>{const w=f[N],z=m[N],V=s&&a.getItemEnabled({seriesId:t,itemId:N});if(A+=z,x==null)return;const G=this.getLabelText(this.properties.stageLabel,{datum:P,value:w,stageKey:n,valueKey:r}),{width:W}=S.measureText(G),H=G.split(`
`).length*_B.getLineHeight(u.fontSize);M=Math.max(M,W),k=Math.max(k,H),x.push({x:NaN,y:NaN,text:G,textAlign:b,textBaseline:v,visible:V})});const I=this._nodeDataDependencies?.seriesRectWidth??0,O=this._nodeDataDependencies?.seriesRectHeight??0,T=h*(i.rawData.length-1);let L;if(y){const P=k+g.spacing;L=new Kp(0,g.placement==="before"?P:0,I,O-P)}else{const P=M+g.spacing;L=new Kp(g.placement==="after"?0:P,0,I-P,O)}if(p!=null&&p!==0){const P=l==="horizontal"?1/p:p,N=Math.min(L.width,L.height*P),w=N/P;L=new Kp(L.x+(L.width-N)/2,L.y+(L.height-w)/2,N,w)}let C,D;y?D=g.placement==="before"?L.y-g.spacing:L.y+L.height+g.spacing:C=g.placement==="after"?L.x+L.width+g.spacing:L.x-g.spacing;const R=L.width-(y?T:0),_=L.height-(y?0:T);if(R<0||_<0)return;const F=[],E=[];let B=0;return i.rawData.forEach((P,N)=>{const w=f[N],z=m[N],V=s&&a.getItemEnabled({seriesId:t,itemId:N}),G=B+z,W=(B+G)/(2*A),H=(G-B)/A,K=y?R*W+h*N:R*.5,Q=y?_*.5:_*W+h*N,st=L.x+K,tt=L.y+Q;if(x!=null){const rt=x[N];rt.x=C??st,rt.y=D??tt}let $,j,q,J;if(y){const rt=R*H;$=rt,q=rt;const pt=(K+rt/2)*(_/L.width),xt=(K-rt/2)*(_/L.width);j=c?L.height-pt:pt,J=c?L.height-xt:xt}else{const rt=_*H;j=rt,J=rt;const pt=(Q-rt/2)*(R/L.height),xt=(Q+rt/2)*(R/L.height);$=c?L.width-pt:pt,q=c?L.width-xt:xt}const X=this.getLabelText(u,{datum:P,value:z,stageKey:n,valueKey:r}),gt={x:st,y:tt,text:X,textAlign:"center",textBaseline:"middle",visible:V};E.push(gt),F.push({series:this,itemId:r,datum:P,datumIndex:N,index:N,xValue:w,yValue:z,x:st,y:tt,top:$,right:j,bottom:q,left:J,label:gt,enabled:V,midPoint:{x:st,y:tt}}),B=G}),{itemId:t,nodeData:F,labelData:E,stageLabelData:x}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:t}){this.checkResize(t);const{datumSelection:e,labelSelection:i,stageLabelSelection:o,highlightDatumSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const n=this.contextNodeData?.nodeData??[],r=this.contextNodeData?.labelData??[],l=this.contextNodeData?.stageLabelData??[];this.datumSelection=this.updateDatumSelection({nodeData:n,datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:r,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:l,stageLabelSelection:o}),this.updateLabelNodes({labelSelection:o,labelProperties:this.properties.stageLabel}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:a!=null?[a]:[],datumSelection:s}),this.updateDatumNodes({datumSelection:s,isHighlight:!0})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData)}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{fill:i?.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset}}getItemStyleOverrides(t,e,i,o,s){const{id:a,properties:n}=this,{fills:r,strokes:l,stageKey:c,valueKey:h,itemStyler:p}=n,u=o.fill??r[i%r.length],g=o.stroke??l[i%l.length],y={};if(s||(y.fill=u,y.stroke=g),p!=null){const f=this.cachedDatumCallback(PB(t,s?"highlight":"node"),()=>p({seriesId:a,datum:e,stageKey:c,valueKey:h,highlighted:s,fill:u,stroke:g,...o}));Object.assign(y,f)}return y}updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{properties:o}=this,{shadow:s}=o,a=this.getItemBaseStyle(i);e.each((n,r)=>{const{datumIndex:l,datum:c,x:h,y:p,top:u,right:g,bottom:y,left:f}=r,m=this.getItemStyleOverrides(String(l),c,l,a,i);n.x0=h-u/2,n.x1=h+u/2,n.x2=h+y/2,n.x3=h-y/2,n.y0=p-f/2,n.y1=p-g/2,n.y2=p+g/2,n.y3=p+f/2,n.fill=m?.fill??a.fill,n.fillOpacity=m?.fillOpacity??a.fillOpacity,n.stroke=m?.stroke??a.stroke,n.strokeOpacity=m?.strokeOpacity??a.strokeOpacity,n.strokeWidth=m?.strokeWidth??a.strokeWidth,n.lineDash=m?.lineDash??a.lineDash,n.lineDashOffset=m?.lineDashOffset??a.lineDashOffset,n.fillShadow=s})}updateLabelSelection(t){return t.labelSelection.update(this.properties.label.enabled?t.labelData:[])}updateStageLabelSelection(t){return t.stageLabelSelection.update(t.stageLabelData)}updateLabelNodes(t){const{labelSelection:e,labelProperties:i}=t,{color:o,fontSize:s,fontStyle:a,fontWeight:n,fontFamily:r}=i;e.each((l,{visible:c,x:h,y:p,text:u,textAlign:g,textBaseline:y})=>{l.visible=c,l.x=h,l.y=p,l.text=u,l.fill=o,l.fontStyle=a,l.fontWeight=n,l.fontSize=s,l.fontFamily=r,l.textAlign=g,l.textBaseline=y})}resetAnimation(t){}computeFocusBounds(t){const e=this.getNodeData()?.[t.datumIndex];if(e!==void 0){for(const i of this.datumSelection)if(i.datum===e)return i.node}}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{stageKey:a,valueKey:n,tooltip:r}=s;if(!i||!o||o.rawData.length===0)return;const{datumIndex:l}=t,c=o.rawData[l],h=i.resolveColumnById(this,"xValue",o)[l],p=i.resolveColumnById(this,"yValue",o)[l];if(h==null)return;const u=this.getLabelText(this.properties.stageLabel,{datum:o.rawData[l],value:p,stageKey:a,valueKey:n}),g=this.getItemBaseStyle(!1);return Object.assign(g,this.getItemStyleOverrides(String(l),l,l,g,!1)),r.formatTooltip({symbol:this.legendItemSymbol(l),data:[{label:String(h),value:u}]},{seriesId:e,datum:c,title:void 0,stageKey:a,valueKey:n,...g})}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}legendItemSymbol(t){const{fills:e,strokes:i,strokeWidth:o,fillOpacity:s,strokeOpacity:a}=this.properties,n=e[t%e.length]??"black",r=i[t%i.length]??"black";return{marker:{fill:n,fillOpacity:s,stroke:r,strokeWidth:o,strokeOpacity:a}}}getLegendData(t){const{processedData:e,dataModel:i,id:o,ctx:{legendManager:s},visible:a}=this;if(!i||!e||t!=="category"||!this.properties.isValid())return[];const{showInLegend:n}=this.properties,r=[],l=i.resolveColumnById(this,"xValue",e);return e.rawData.forEach((c,h)=>{const p=l[h];r.push({legendType:"category",id:o,itemId:h,seriesId:o,enabled:a&&s.getItemEnabled({seriesId:o,itemId:h}),label:{text:p},symbol:this.legendItemSymbol(h),hideInLegend:!n})}),r}};import{_ModuleSupport as zB}from"ag-charts-community";var{DEFAULT_FONT_FAMILY:Lb,DEFAULT_LABEL_COLOUR:FB,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:VB}=zB.ThemeSymbols,GB={series:{direction:"vertical",strokeWidth:0,spacing:2,label:{enabled:!0,fontSize:12,fontFamily:Lb,color:VB},stageLabel:{enabled:!0,fontSize:12,fontFamily:Lb,color:FB,spacing:12}}},WB={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"pyramid",moduleFactory:t=>new BB(t),solo:!0,tooltipDefaults:{range:"exact"},themeTemplate:GB,paletteFactory:({takeColors:t,colorsCount:e})=>{const{fills:i,strokes:o}=t(e);return{fills:i,strokes:o}}};import{_ModuleSupport as UB}from"ag-charts-community";import{_ModuleSupport as jp}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:HB,DEFAULT_LABEL_COLOUR:KB},ThemeConstants:{POLAR_AXIS_TYPE:YB}}=jp,Nb={series:{label:{enabled:!1,fontSize:12,fontFamily:HB,color:KB},marker:{enabled:!0,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[YB.ANGLE_CATEGORY]:{label:{spacing:10}}}},jB=jp.mergeDefaults({series:{strokeWidth:2}},Nb),XB=jp.mergeDefaults({series:{fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},Nb);import{_ModuleSupport as Cb}from"ag-charts-community";import{_ModuleSupport as Ia}from"ag-charts-community";import{_ModuleSupport as ZB}from"ag-charts-community";var{Label:$B,SeriesMarker:QB,SeriesProperties:qB,SeriesTooltip:JB,Validate:De,BOOLEAN:tz,COLOR_STRING:ez,NUMBER:iz,LINE_DASH:oz,OBJECT:Xp,POSITIVE_NUMBER:Rb,RATIO:sz,STRING:Wl}=ZB,he=class extends qB{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new QB,this.label=new $B,this.tooltip=new JB,this.connectMissingData=!1}};d([De(Wl)],he.prototype,"angleKey",2),d([De(Wl)],he.prototype,"radiusKey",2),d([De(Wl,{optional:!0})],he.prototype,"angleName",2),d([De(Wl,{optional:!0})],he.prototype,"radiusName",2),d([De(ez)],he.prototype,"stroke",2),d([De(Rb)],he.prototype,"strokeWidth",2),d([De(sz)],he.prototype,"strokeOpacity",2),d([De(oz)],he.prototype,"lineDash",2),d([De(Rb)],he.prototype,"lineDashOffset",2),d([De(iz)],he.prototype,"rotation",2),d([De(Xp)],he.prototype,"marker",2),d([De(Xp)],he.prototype,"label",2),d([De(Xp)],he.prototype,"tooltip",2),d([De(tz)],he.prototype,"connectMissingData",2);var{ChartAxisDirection:hi,PolarAxis:az,SeriesNodePickMode:Eb,valueProperty:wb,fixNumericExtent:nz,seriesLabelFadeInAnimation:rz,markerFadeInAnimation:lz,resetMarkerFn:cz,animationValidation:hz,computeMarkerFocusBounds:dz,isFiniteNumber:_b,extent:pz,isNumberEqual:Pb,createDatumId:uz,BBox:gz,Group:yz,Path:fz,PointerEvents:mz,Selection:Bb,Text:xz,getMarker:Sz}=Ia,bz=class extends Ia.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Zp=class extends Ia.PolarSeries{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[Eb.NEAREST_NODE,Eb.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:cz}}),this.clipFocusBox=!1,this.properties=new he,this.NodeEvent=bz,this.lineGroup=this.contentGroup.appendChild(new yz({name:"radar-line",zIndex:Ia.SeriesZIndexMap.ANY_CONTENT})),this.lineSelection=Bb.select(this.lineGroup,fz),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){const{shape:t}=this.properties.marker,e=Sz(t);return new e}setSeriesIndex(t){return super.setSeriesIndex(t)?(this.lineGroup.zIndex=[Ia.SeriesZIndexMap.ANY_CONTENT,t,Ia.SeriesContentZIndexMap.FOREGROUND,1],!0):!1}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===hi.X)return e.getDomain(this,"angleValue","value",i);{const o=e.getDomain(this,"radiusValue","value",i),s=pz(o.length===0?o:[0].concat(o));return nz(s)}}async processData(t){if(!this.properties.isValid())return;const{angleKey:e,radiusKey:i}=this.properties,o=[];this.ctx.animationManager.isSkipped()||o.push(hz());const s=this.axes[hi.Y]?.scale.type,a=this.axes[hi.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[wb(e,a,{id:"angleValue"}),wb(i,s,{id:"radiusValue",invalidValue:void 0}),...o]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}getAxisInnerRadius(){const t=this.axes[hi.Y];return t instanceof az?this.radius*t.innerRadiusRatio:0}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}createNodeData(){const{processedData:t,dataModel:e}=this;if(!t||!e||t.rawData.length===0||!this.properties.isValid())return;const{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,label:r}=this.properties,l=this.axes[hi.X]?.scale,c=this.axes[hi.Y]?.scale;if(!l||!c)return;const h=e.resolveColumnById(this,"angleValue",t),p=e.resolveColumnById(this,"radiusValue",t),u=this.getAxisInnerRadius(),g=t.rawData.map((y,f)=>{const m=h[f],S=p[f],b=l.convert(m),v=this.radius+u-c.convert(S),x=Math.cos(b),M=Math.sin(b),k=x*v,A=M*v;let I;if(r.enabled){const O=this.getLabelText(r,{value:S,datum:y,angleKey:i,radiusKey:o,angleName:s,radiusName:a});if(O){let T="right";Pb(x,0)?T="center":x>0&&(T="left");let L="bottom";Pb(M,0)?L="middle":M>0&&(L="top"),I={x:k+x*n.size,y:A+M*n.size,text:O,textAlign:T,textBaseline:L}}}return{series:this,datum:y,datumIndex:f,index:f,point:{x:k,y:A,size:n.size},midPoint:{x:k,y:A},label:I,angleValue:m,radiusValue:S,missing:!_b(b)||!_b(v)}});return{itemId:o,nodeData:g,labelData:g}}update({seriesRect:t}){const e=this.checkResize(t),i=!this.ctx.animationManager.isSkipped(),{series:o}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&o===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const t=this.visible?[!0]:[];this.lineSelection.update(t)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=Bb.select(this.itemGroup,()=>this.nodeFactory(),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(t){return t?.fill??this.properties.marker.fill}getMarkerItemBaseStyle(t){const{properties:e}=this,{marker:i}=e,o=t?e.highlightStyle.item:void 0,s=this.getStrokeWidth(i.strokeWidth);return{size:i.size,fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??s,strokeOpacity:o?.strokeOpacity??i.strokeOpacity}}getMarkerItemStyleOverrides(t,e,i,o){const{id:s,properties:a}=this,{angleKey:n,radiusKey:r,marker:l}=a,{itemStyler:c}=l;if(c!=null)return this.cachedDatumCallback(uz(t,o?"highlight":"node"),()=>c({seriesId:s,datum:e,angleKey:n,radiusKey:r,highlighted:o,...i}))}updateMarkers(t,e){const{visible:i}=this,{marker:o}=this.properties;let s=[];if(i&&o.shape&&o.enabled)if(e){const n=this.ctx.highlightManager?.getActiveHighlight();n?.datum&&(s=[n])}else s=this.nodeData;const a=this.getMarkerItemBaseStyle(e);t.update(s).each((n,r)=>{const{datum:l,datumIndex:c,point:h}=r,p=this.getMarkerItemStyleOverrides(String(c),l,a,!1);n.fill=p?.fill??a.fill,n.stroke=p?.stroke??a.stroke,n.strokeWidth=p?.strokeWidth??a.strokeWidth,n.fillOpacity=p?.fillOpacity??a.fillOpacity,n.strokeOpacity=p?.strokeOpacity??a.strokeOpacity,n.size=p?.size??a.size;const{x:u,y:g}=h;n.x=u,n.y=g,n.visible=i&&n.size>0&&!isNaN(u)&&!isNaN(g)})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:h}=a,p=s[hi.X],u=s[hi.Y];if(!i||!o||o.rawData.length===0||!p||!u)return;const{datumIndex:g}=t,y=o.rawData[g],f=i.resolveColumnById(this,"angleValue",o)[g],m=i.resolveColumnById(this,"radiusValue",o)[g];if(f==null)return;const S=this.getMarkerItemBaseStyle(!1);return Object.assign(S,this.getMarkerItemStyleOverrides(String(g),g,S,!1)),h.formatTooltip({heading:p.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:c,fallbackLabel:l,value:u.formatDatum(m)}]},{seriesId:e,datum:y,title:r,angleKey:n,radiusKey:l,angleName:r,radiusName:c,...S})}legendItemSymbol(){const{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,marker:s}=this.properties;return{marker:{shape:s.shape,fill:this.getMarkerFill()??s.stroke??t??"rgba(0, 0, 0, 0)",stroke:s.stroke??t??"rgba(0, 0, 0, 0)",fillOpacity:s.fillOpacity??1,strokeOpacity:s.strokeOpacity??i??1,strokeWidth:s.strokeWidth??0,enabled:s.enabled||e<=0},line:{stroke:t,strokeOpacity:i,strokeWidth:e,lineDash:o}}}getLegendData(t){if(!this.properties.isValid()||t!=="category")return[];const{id:e,ctx:{legendManager:i},visible:o}=this,{radiusKey:s,radiusName:a,showInLegend:n}=this.properties;return[{legendType:"category",id:e,itemId:s,seriesId:e,enabled:o&&i.getItemEnabled({seriesId:e,itemId:s}),label:{text:a??s},symbol:this.legendItemSymbol(),hideInLegend:!n}]}pickNodeClosestDatum(t){const{nodeData:e,centerX:i,centerY:o}=this,{x:s,y:a}=t,n=this.radius;if(Math.sqrt((s-i)**2+(a-o)**2)>n+this.properties.marker.size)return;let l=1/0,c;for(const h of e){const{point:{x:p=NaN,y:u=NaN}={}}=h;if(isNaN(p)||isNaN(u))continue;const g=Math.sqrt((t.x-p-i)**2+(t.y-u-o)**2);g<l&&(l=g,c=h)}if(c){const h=Math.max(l-(c.point?.size??0),0);return{datum:c,distance:h}}}computeLabelsBBox(){const{label:t}=this.properties;this.maybeRefreshNodeData();const e=[],i=new xz;return this.nodeData.forEach(o=>{if(!t.enabled||!o.label)return;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(t),i.setAlign(o.label);const s=i.getBBox();e.push(s)}),e.length===0?null:gz.merge(e)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){const t=this.getLineNode();t&&(t.fill=void 0,t.lineJoin="round",t.lineCap="round",t.pointerEvents=mz.None,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset)}getLinePoints(){const{nodeData:t,resetInvalidToZero:e}=this,{connectMissingData:i}=this.properties;if(t.length===0)return[];const o=this.axes[hi.Y],a=this.axes[hi.X]?.isReversed(),r=o?.isReversed()&&!a?[...t].reverse():t,l=[];let c=!1,h;return r.forEach((p,u)=>{let{x:g,y}=p.point;const f=isNaN(g)||isNaN(y);f||(h??(h=p)),f&&!i&&(g=0,y=0);const m=u===0||!e&&!i&&(f||c);l.push({x:g,y,moveTo:m}),c=f}),h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(t,e,i){const{path:o}=t;o.clear(!0);const s=this.getAxisInnerRadius(),a=this.axes[hi.Y],r=a?.isReversed()?this.radius+s-a?.scale.convert(0):s;e.forEach(l=>{const{x:c,y:h,arc:p,radius:u=0,startAngle:g=0,endAngle:y=0,moveTo:f}=l,m=Math.atan2(h,c),S=r*Math.cos(m),b=r*Math.sin(m),v=i,x=S*(1-v)+c*v,M=b*(1-v)+h*v;p?o.arc(c,h,u,g,y):f?o.moveTo(x,M):o.lineTo(x,M)}),t.checkPathDirty()}animatePaths(t){const e=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,e,t)}animateEmptyUpdateReady(){const{itemSelection:t,labelSelection:e}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:o=>this.animatePaths(o),onStop:()=>this.animatePaths(1)}),lz(this,i,"added",t),rz(this,"labels",i,e)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t),this.resetPaths()}animateReadyResize(t){super.animateReadyResize(t),this.resetPaths()}resetPaths(){const t=this.getLineNode();if(t){const{path:e}=t,i=this.getLinePoints();t.fill=void 0,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,e.clear(!0);for(const{x:o,y:s,moveTo:a}of i)a?e.moveTo(o,s):e.lineTo(o,s);t.checkPathDirty()}}getFormattedMarkerStyle(t){const{angleKey:e,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:t,angleKey:e,radiusKey:i,highlighted:!0})}computeFocusBounds(t){const e=dz(this,t),{translationX:i,translationY:o}=this.contentGroup;return e?.translate(i,o),e}};Zp.className="RadarSeries";import{_ModuleSupport as vz}from"ag-charts-community";var{RATIO:Mz,COLOR_STRING:kz,Validate:zb}=vz,$p=class extends he{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};d([zb(kz)],$p.prototype,"fill",2),d([zb(Mz)],$p.prototype,"fillOpacity",2);var{Group:Az,Path:Dz,PointerEvents:Iz,Selection:Tz,ChartAxisDirection:Fb}=Cb,Qp=class extends Zp{constructor(t){super(t),this.properties=new $p,this.resetInvalidToZero=!0;const e=new Az;this.contentGroup.append(e),this.areaSelection=Tz.select(e,Dz)}updatePathSelections(){const t=this.visible?[!0]:[];this.areaSelection.update(t),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(t){return t?.fill??this.properties.marker.fill??this.properties.fill}beforePathAnimation(){super.beforePathAnimation();const t=this.getAreaNode();t.fill=this.properties.fill,t.fillOpacity=this.properties.fillOpacity,t.pointerEvents=Iz.None,t.stroke=void 0}animatePaths(t){super.animatePaths(t),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),t)}getAreaPoints(){const t=this.getLinePoints(),e=n=>{const r=this.axes[n];return r instanceof Cb.PolarAxis?r:void 0},i=e(Fb.Y),o=e(Fb.X);if(!i?.isReversed())return t;const a=o?.getAxisLinePoints()?.points??[];return t.concat(...a)}resetPaths(){super.resetPaths();const t=this.getAreaNode();if(t){const{path:e}=t,i=this.getAreaPoints();t.fill=this.properties.fill,t.fillOpacity=this.properties.fillOpacity,t.stroke=void 0,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,t.lineJoin=t.lineCap="round",e.clear(!0),i.forEach(({x:o,y:s,moveTo:a,arc:n,radius:r=0,startAngle:l=0,endAngle:c=0})=>{n?e.arc(o,s,r,l,c):a?e.moveTo(o,s):e.lineTo(o,s)}),e.closePath(),t.checkPathDirty()}}};Qp.className="RadarAreaSeries",Qp.type="radar-area";var{markerPaletteFactory:Oz,ThemeConstants:{POLAR_AXIS_TYPE:Vb}}=UB,Lz={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",moduleFactory:t=>new Qp(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Vb.ANGLE_CATEGORY},{type:Vb.RADIUS_NUMBER}],themeTemplate:XB,paletteFactory:t=>{const{marker:e}=Oz(t);return{stroke:e.stroke,fill:e.fill,marker:e}}};import{_ModuleSupport as Nz}from"ag-charts-community";var qp=class extends Zp{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};qp.className="RadarLineSeries",qp.type="radar-line";var{POLAR_AXIS_TYPE:Gb}=Nz.ThemeConstants,Cz={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",moduleFactory:t=>new qp(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Gb.ANGLE_CATEGORY},{type:Gb.RADIUS_NUMBER}],themeTemplate:jB,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{stroke:e,marker:{fill:e,stroke:i}}}};import{_ModuleSupport as Rz}from"ag-charts-community";import{_ModuleSupport as Jp}from"ag-charts-community";import{_ModuleSupport as Ez}from"ag-charts-community";var{SeriesProperties:wz,SeriesTooltip:_z,Validate:jt,COLOR_STRING:Wb,NUMBER:Ub,FUNCTION:Pz,LINE_DASH:Bz,OBJECT:Hb,POSITIVE_NUMBER:tu,RATIO:Kb,STRING:En,Label:zz}=Ez,Ut=class extends wz{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new zz,this.tooltip=new _z}};d([jt(En)],Ut.prototype,"angleKey",2),d([jt(En)],Ut.prototype,"radiusKey",2),d([jt(En,{optional:!0})],Ut.prototype,"angleName",2),d([jt(En,{optional:!0})],Ut.prototype,"radiusName",2),d([jt(Wb)],Ut.prototype,"fill",2),d([jt(Kb)],Ut.prototype,"fillOpacity",2),d([jt(Wb)],Ut.prototype,"stroke",2),d([jt(tu)],Ut.prototype,"strokeWidth",2),d([jt(Kb)],Ut.prototype,"strokeOpacity",2),d([jt(Bz)],Ut.prototype,"lineDash",2),d([jt(tu)],Ut.prototype,"lineDashOffset",2),d([jt(tu)],Ut.prototype,"cornerRadius",2),d([jt(Pz,{optional:!0})],Ut.prototype,"itemStyler",2),d([jt(Ub)],Ut.prototype,"rotation",2),d([jt(En,{optional:!0})],Ut.prototype,"stackGroup",2),d([jt(Ub,{optional:!0})],Ut.prototype,"normalizedTo",2),d([jt(Hb)],Ut.prototype,"label",2),d([jt(Hb)],Ut.prototype,"tooltip",2);import{_ModuleSupport as Fz}from"ag-charts-community";var{SectorBox:Yb,motion:Vz}=Fz;function Gz(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.innerRadius)||isNaN(t.previousDatum.outerRadius))return"added";if(isNaN(e.innerRadius)||isNaN(e.outerRadius))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function jb(t){return{toFn:(o,s,a)=>{let n,r,l,c,h;return a==="removed"?(n=t,r=t,l=s.innerRadius,c=s.outerRadius,h=new Yb(n,r,l,c)):(n=s.startAngle,r=s.endAngle,l=isNaN(s.innerRadius)?o.innerRadius:s.innerRadius,c=isNaN(s.outerRadius)?o.outerRadius:s.outerRadius,h=s.clipSector),{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(o,s,a)=>{a=Gz(o,s,a);let n,r,l,c,h;a==="removed"||a==="updated"?(n=o.startAngle,r=o.endAngle,l=o.innerRadius,c=o.outerRadius,h=o.clipSector):(n=t,r=t,l=s.innerRadius,c=s.outerRadius),h??(h=new Yb(n,r,l,c));const p=Vz.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h,phase:p}}}}function Wz(t,e){return{centerX:0,centerY:0,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clipSector:e.clipSector}}var{ChartAxisDirection:ao,PolarAxis:Uz,diff:Hz,isDefined:Kz,groupAccumulativeValueProperty:Xb,keyProperty:Yz,normaliseGroupTo:jz,valueProperty:Xz,fixNumericExtent:Zz,resetLabelFn:$z,seriesLabelFadeInAnimation:Qz,seriesLabelFadeOutAnimation:qz,animationValidation:Jz,angleBetween:tF,createDatumId:Zb,BandScale:eF,Sector:iF,SectorBox:oF,motion:$b}=Jp,sF=class extends Jp.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},eu=class extends Jp.PolarSeries{constructor(t){super({moduleCtx:t,useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:Wz,label:$z}}),this.properties=new Ut,this.NodeEvent=sF,this.groupScale=new eF,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new iF}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===ao.X){const o=e.getDomain(this,"angleValue-end","value",i),s=[o[0]>0?0:o[0],o[1]<0?0:o[1]];return Zz(s)}else return e.getDomain(this,"radiusValue","key",i)}async processData(t){const{visible:e}=this,{angleKey:i,radiusKey:o,normalizedTo:s}=this.properties,a=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid())return;const n=this.getStackId(),r=`${n}-trailing`,l=[];Kz(s)&&l.push(jz([n,r],Math.abs(s),"range")),a&&(this.processedData&&l.push(Hz(this.id,this.processedData)),l.push(Jz()));const c=e||!a?{}:{forceValue:0},h=this.axes[ao.Y]?.scale.type,p=this.axes[ao.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[Yz(o,h,{id:"radiusValue"}),Xz(i,p,{id:"angleValue-raw",invalidValue:null,...c}),...Xb(i,"normal","current",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:n,separateNegative:!0,...c},p),...Xb(i,"trailing","current",{id:"angleValue-start",invalidValue:null,groupId:r,separateNegative:!0,...c},p),...l]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}getAxisInnerRadius(){const t=this.axes[ao.Y];return t instanceof Uz?this.radius*t.innerRadiusRatio:0}createNodeData(){const{processedData:t,dataModel:e}=this;if(!e||!t||t.type!=="ungrouped"||t.rawData.length===0||!this.properties.isValid())return;const i=this.axes[ao.X],o=this.axes[ao.Y],s=i?.scale,a=o?.scale;if(!s||!a)return;const n=e.resolveKeysById(this,"radiusValue",t),r=e.resolveColumnById(this,"angleValue-start",t),l=e.resolveColumnById(this,"angleValue-end",t),c=e.resolveColumnById(this,"angleValue-raw",t),h=e.resolveProcessedDataIndexById(this,"angleValue-range");let p=0;o instanceof Yo&&(p=o.groupPaddingInner);const{groupScale:u}=this,{index:g,visibleGroupCount:y}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);u.domain=Array.from({length:y}).map((_,F)=>String(F)),u.range=[0,Math.abs(a.bandwidth??0)],u.paddingInner=y>1?p:0;const f=u.bandwidth>=1?u.bandwidth:u.rawBandwidth,m=i.isReversed(),S=o.isReversed(),b=S?this.radius:this.getAxisInnerRadius(),x=(S?this.getAxisInnerRadius():this.radius)+b,{angleKey:M,radiusKey:k,angleName:A,radiusName:I,label:O}=this.properties,T=(_,F,E,B)=>{const P=this.getLabelText(O,{value:F,datum:_,angleKey:M,radiusKey:k,angleName:A,radiusName:I});if(P)return{x:E,y:B,text:P,textAlign:"center",textBaseline:"middle"}},L=[],C={itemId:k,nodeData:L,labelData:L};if(!this.visible)return C;const{rawData:D,aggregation:R}=t;return D.forEach((_,F)=>{const E=n[F];if(E==null)return;const B=c[F],P=r[F],N=l[F],w=B>=0&&!Object.is(B,-0),V=R[F][h][w?1:0],G=w===m;let W=s.convert(P,!0),H=s.convert(N,!0),K=s.convert(0,!0),Q=s.convert(V,!0);G&&([K,Q]=[Q,K],[W,H]=[H,W]);const tt=x-a.convert(E)+u.convert(String(g)),$=tt+f,j=(tt+$)/2,q=W+tF(W,H)/2,J=Math.cos(q)*j,X=Math.sin(q)*j,gt=this.properties.label.enabled?T(_,B,J,X):void 0,rt=new oF(W,H,tt,$);L.push({series:this,datum:_,datumIndex:F,point:{x:J,y:X,size:0},midPoint:{x:J,y:X},label:gt,angleValue:B,radiusValue:E,innerRadius:tt,outerRadius:$,startAngle:K,endAngle:Q,clipSector:rt,reversed:G,index:F})}),C}update({seriesRect:t}){const e=this.checkResize(t);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle.item:void 0,o=this.getStrokeWidth(e.strokeWidth);return{fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??o,strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset,cornerRadius:e.cornerRadius}}getItemStyleOverrides(t,e,i,o){const{id:s,properties:a}=this,{angleKey:n,radiusKey:r,itemStyler:l}=a;if(l!=null)return this.cachedDatumCallback(Zb(t,o?"highlight":"node"),()=>l({seriesId:s,datum:e,highlighted:o,angleKey:n,radiusKey:r,...i}))}updateSectorSelection(t,e){let i=[];if(e){const s=this.ctx.highlightManager?.getActiveHighlight();s?.datum&&s.series===this&&i.push(s)}else i=this.nodeData;const o=this.getItemBaseStyle(e);t.update(i,void 0,s=>this.getDatumId(s)).each((s,a)=>{const{datum:n,datumIndex:r}=a,l=this.getItemStyleOverrides(String(r),n,o,e),c=l?.stroke??o.stroke,h=l?.strokeWidth??o.strokeWidth,p=l?.cornerRadius??o.cornerRadius;s.fill=l?.fill??o.fill,s.fillOpacity=l?.fillOpacity??o.fillOpacity,s.stroke=c,s.strokeWidth=h,s.strokeOpacity=l?.strokeOpacity??o.strokeOpacity,s.lineDash=l?.lineDash??o.lineDash,s.lineDashOffset=l?.lineDashOffset??o.lineDashOffset,s.lineJoin="round",s.inset=c!=null?h/2:0,s.startInnerCornerRadius=n.reversed?p:0,s.startOuterCornerRadius=n.reversed?p:0,s.endInnerCornerRadius=n.reversed?0:p,s.endOuterCornerRadius=n.reversed?0:p,e&&(s.startAngle=a.startAngle,s.endAngle=a.endAngle,s.clipSector=a.clipSector,s.innerRadius=a.innerRadius,s.outerRadius=a.outerRadius)})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getBarTransitionFunctions(){const t=this.axes[ao.X]?.scale;let e=0;if(!t)return jb(e);const i=Math.min(t.domain[0],t.domain[1]),o=Math.max(t.domain[0],t.domain[1]);return i<=0&&o>=0&&(e=t.convert(0)),jb(e)}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getBarTransitionFunctions();$b.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),Qz(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getBarTransitionFunctions();$b.fromToMotion(this.id,"datums",e,[t],i),qz(this,"labels",e,this.labelSelection)}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{angleKey:n,angleName:r,radiusKey:l,radiusName:c,tooltip:h}=a,p=s[ao.X],u=s[ao.Y];if(!i||!o||o.rawData.length===0||!p||!u)return;const{datumIndex:g}=t,y=o.rawData[g],f=i.resolveKeysById(this,"radiusValue",o)[g],m=i.resolveColumnById(this,"angleValue-raw",o)[g];if(f==null)return;const S=this.getItemBaseStyle(!1);return Object.assign(S,this.getItemStyleOverrides(String(g),g,S,!1)),h.formatTooltip({heading:u.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:n,value:p.formatDatum(m)}]},{seriesId:e,datum:y,title:r,angleKey:n,angleName:r,radiusKey:l,radiusName:c,...S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}legendItemSymbol(){const{fill:t,stroke:e,fillOpacity:i,strokeOpacity:o,strokeWidth:s}=this.properties;return{marker:{fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:i??1,strokeOpacity:o??1,strokeWidth:s}}}getLegendData(t){if(!this.properties.isValid()||t!=="category")return[];const{id:e,visible:i}=this,{angleKey:o,angleName:s,showInLegend:a}=this.properties;return[{legendType:"category",id:e,itemId:o,seriesId:e,enabled:i,label:{text:s??o},symbol:this.legendItemSymbol(),hideInLegend:!a}]}getDatumId(t){return Zb(t.radiusValue)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}};eu.className="RadialBarSeries",eu.type="radial-bar";import{_ModuleSupport as aF}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:nF,DEFAULT_INVERTED_LABEL_COLOUR:rF},ThemeConstants:{POLAR_AXIS_TYPE:lF}}=aF,cF={series:{strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:nF,color:rF}},axes:{[lF.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},{POLAR_AXIS_TYPE:Qb}=Rz.ThemeConstants,hF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",moduleFactory:t=>new eu(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Qb.ANGLE_NUMBER},{type:Qb.RADIUS_CATEGORY}],themeTemplate:cF,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},stackable:!0,groupable:!0};import{_ModuleSupport as dF}from"ag-charts-community";import{_ModuleSupport as pF}from"ag-charts-community";import{_ModuleSupport as uF}from"ag-charts-community";var{Validate:qb,RATIO:Jb}=uF,iu=class extends _t{};d([qb(Jb,{optional:!0})],iu.prototype,"columnWidthRatio",2),d([qb(Jb,{optional:!0})],iu.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:gF,PolarAxis:yF,RadialColumnShape:fF,getRadialColumnWidth:mF}=pF,ou=class extends lb{constructor(t){super(t,{animationResetFns:{item:lB}}),this.properties=new iu}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new fF}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return rB(t)}isRadiusAxisCircle(){const t=this.axes[gF.Y];return t instanceof yF?t.shape==="circle":!1}updateItemPath(t,e,i){t.isBeveled=this.isRadiusAxisCircle(),t.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.columnWidth=e.columnWidth,t.axisInnerRadius=e.axisInnerRadius,t.axisOuterRadius=e.axisOuterRadius)}getColumnWidth(t,e){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return mF(t,e,this.radius,i,o)}};ou.className="RadialColumnSeries",ou.type="radial-column";import{_ModuleSupport as xF}from"ag-charts-community";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:SF,DEFAULT_LABEL_COLOUR:bF},ThemeConstants:{POLAR_AXIS_TYPE:tv,POLAR_AXIS_SHAPE:ev}}=xF,vF={series:{columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:SF,color:bF}},axes:{[tv.ANGLE_CATEGORY]:{shape:ev.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[tv.RADIUS_NUMBER]:{shape:ev.CIRCLE,innerRadiusRatio:.5}}},{POLAR_AXIS_TYPE:iv}=dF.ThemeConstants,MF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",moduleFactory:t=>new ou(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:iv.ANGLE_CATEGORY},{type:iv.RADIUS_NUMBER}],themeTemplate:vF,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},stackable:!0,groupable:!0};import{_ModuleSupport as kF}from"ag-charts-community";import{_ModuleSupport as wn}from"ag-charts-community";import{_ModuleSupport as AF}from"ag-charts-community";var{SvgPath:DF,Rotatable:IF,Translatable:TF,Scalable:OF}=AF,su=class extends IF(OF(TF(DF))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};su.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";import{_ModuleSupport as LF}from"ag-charts-community";var{BaseProperties:Ul,SeriesTooltip:NF,SeriesProperties:CF,PropertiesArray:au,Validate:U,BOOLEAN:ov,COLOR_STRING:no,COLOR_STRING_ARRAY:RF,FUNCTION:EF,LINE_DASH:Hl,NUMBER:ks,OBJECT_ARRAY:nu,OBJECT:ro,POSITIVE_NUMBER:je,RATIO:di,STRING:ru,UNION:wF,Logger:_F,Label:PF}=LF,BF=wF(["inside","outside","middle"],"a placement"),sv=class extends PF{};d([U(ks,{optional:!0})],sv.prototype,"spacing",2);var te=class extends Ul{constructor(){super(...arguments),this.label=new sv}};d([U(ru,{optional:!0})],te.prototype,"text",2),d([U(ks,{optional:!0})],te.prototype,"value",2),d([U(oS,{optional:!0})],te.prototype,"shape",2),d([U(BF,{optional:!0})],te.prototype,"placement",2),d([U(ks,{optional:!0})],te.prototype,"spacing",2),d([U(je,{optional:!0})],te.prototype,"size",2),d([U(ks,{optional:!0})],te.prototype,"rotation",2),d([U(no,{optional:!0})],te.prototype,"fill",2),d([U(di,{optional:!0})],te.prototype,"fillOpacity",2),d([U(no,{optional:!0})],te.prototype,"stroke",2),d([U(je,{optional:!0})],te.prototype,"strokeWidth",2),d([U(di,{optional:!0})],te.prototype,"strokeOpacity",2),d([U(Hl,{optional:!0})],te.prototype,"lineDash",2),d([U(je,{optional:!0})],te.prototype,"lineDashOffset",2),d([U(ro)],te.prototype,"label",2);var pi=class extends Ul{constructor(){super(...arguments),this.enabled=!0,this.fills=new au(Sa),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([U(ov)],pi.prototype,"enabled",2),d([U(nu)],pi.prototype,"fills",2),d([U(bl)],pi.prototype,"fillMode",2),d([U(no,{optional:!0})],pi.prototype,"fill",2),d([U(di)],pi.prototype,"fillOpacity",2),d([U(no,{optional:!0})],pi.prototype,"stroke",2),d([U(je,{optional:!0})],pi.prototype,"strokeWidth",2),d([U(di)],pi.prototype,"strokeOpacity",2),d([U(Hl)],pi.prototype,"lineDash",2),d([U(je)],pi.prototype,"lineDashOffset",2);var ui=class extends Ul{constructor(){super(...arguments),this.fills=new au(Sa),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black"}};d([U(nu)],ui.prototype,"fills",2),d([U(bl)],ui.prototype,"fillMode",2),d([U(no,{optional:!0})],ui.prototype,"fill",2),d([U(di)],ui.prototype,"fillOpacity",2),d([U(no)],ui.prototype,"stroke",2),d([U(je)],ui.prototype,"strokeWidth",2),d([U(di)],ui.prototype,"strokeOpacity",2),d([U(Hl)],ui.prototype,"lineDash",2),d([U(je)],ui.prototype,"lineDashOffset",2),d([U(no)],ui.prototype,"defaultFill",2);var gi=class extends Ul{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([U(ov)],gi.prototype,"enabled",2),d([U(di,{optional:!0})],gi.prototype,"radiusRatio",2),d([U(ks)],gi.prototype,"spacing",2),d([U(no)],gi.prototype,"fill",2),d([U(di)],gi.prototype,"fillOpacity",2),d([U(no)],gi.prototype,"stroke",2),d([U(je)],gi.prototype,"strokeWidth",2),d([U(di)],gi.prototype,"strokeOpacity",2),d([U(Hl)],gi.prototype,"lineDash",2),d([U(je)],gi.prototype,"lineDashOffset",2);var av=class extends Ni{};d([U(ru,{optional:!0})],av.prototype,"text",2);var nv=class extends An{};d([U(ru,{optional:!0})],nv.prototype,"text",2);var Bt=class extends CF{constructor(){super(...arguments),this.segmentation=new Tn,this.defaultColorRange=[],this.targets=new au(te),this.defaultTarget=new te,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new ui,this.bar=new pi,this.needle=new gi,this.label=new av,this.secondaryLabel=new nv,this.tooltip=new NF}isValid(t){if(!super.isValid(t))return!1;const{outerRadius:e,innerRadius:i}=this;return e==null!=(i==null)?(_F.warnOnce("Either [innerRadius] and [outerRadius] must both be set, or neither can be set."),!1):!0}};d([U(ks)],Bt.prototype,"value",2),d([U(ro)],Bt.prototype,"segmentation",2),d([U(RF)],Bt.prototype,"defaultColorRange",2),d([U(nu)],Bt.prototype,"targets",2),d([U(ro)],Bt.prototype,"defaultTarget",2),d([U(di)],Bt.prototype,"outerRadiusRatio",2),d([U(di)],Bt.prototype,"innerRadiusRatio",2),d([U(je,{optional:!0})],Bt.prototype,"outerRadius",2),d([U(je,{optional:!0})],Bt.prototype,"innerRadius",2),d([U(je)],Bt.prototype,"cornerRadius",2),d([U(sS)],Bt.prototype,"cornerMode",2),d([U(ks)],Bt.prototype,"spacing",2),d([U(ro)],Bt.prototype,"scale",2),d([U(ro)],Bt.prototype,"bar",2),d([U(ro)],Bt.prototype,"needle",2),d([U(EF,{optional:!0})],Bt.prototype,"itemStyler",2),d([U(ro)],Bt.prototype,"label",2),d([U(ro)],Bt.prototype,"secondaryLabel",2),d([U(ro)],Bt.prototype,"tooltip",2);import{_ModuleSupport as zF}from"ag-charts-community";var{SectorBox:lu}=zF;function FF(t){const{startAngle:e,endAngle:i,clipStartAngle:o,clipEndAngle:s,innerRadius:a,outerRadius:n}=t;if(!(o==null||s==null))return new lu(Math.max(o,e),Math.min(s,i),a,n)}function rv(t,e,i){return Math.max(t,i.startAngle)<=Math.min(e,i.endAngle)}function cu(t){return t.clipStartAngle!=null&&t.clipEndAngle!=null}function hu(t,e){const{clipStartAngle:i,clipEndAngle:o,innerRadius:s,outerRadius:a}=t;return new lu(i,e?i:o,s,a)}function lv(t,e){const i=t?"initial":"update";return{node:{fromFn(a,n){const r=a.previousDatum;let{startAngle:l,endAngle:c}=r??n;const h=r!=null&&cu(r)?hu(r,t):void 0,p=cu(n)?hu(n,t):void 0;let u;return h!=null&&p!=null?u=h:h==null&&p!=null?(u=p,l=n.startAngle,c=n.endAngle):h!=null&&p==null?(u=void 0,l=n.startAngle,c=n.endAngle):t&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(a,n){const{startAngle:r,endAngle:l}=n;let c;return cu(n)&&(c=hu(n,!1)),{startAngle:r,endAngle:l,clipSector:c}},applyFn(a,n){const{startAngle:r,endAngle:l}=n;let{clipSector:c}=n;c!=null&&(c=new lu(Math.max(r,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const h=c==null||rv(r,l,c);a.startAngle=r,a.endAngle=l,a.clipSector=c,a.visible=h}},needle:{fromFn(a){let{angle:n}=a.previousDatum??a.datum;return t&&(n=e),{rotation:n,phase:i}},toFn(a,n){const{angle:r}=n;return{rotation:r}}}}}function du(t,e){const{startAngle:i,endAngle:o}=e,s=FF(e),a=s==null||rv(i,o,s);return{startAngle:i,endAngle:o,clipSector:s,visible:a}}function cv(t,e){const{angle:i}=e;return{rotation:i}}var VF={top:0,middle:.5,bottom:1};function GF(t,e,i,o,s){const{padding:a,textAlign:n,verticalAlign:r}=i;let l,c;if(e.each((x,M)=>{M.label==="primary"?l=M:M.label==="secondary"&&(c=M)}),l==null)return;const h=In(t,l,s?.label);if(h==null)return;const p=c!=null?In(t,c,s?.secondaryLabel):void 0,u={padding:a},g=n==="center"?2:1,y=r==="middle"?2:1,f=x=>({width:Math.sqrt(Math.max(o**2-(x/y)**2,0))*g,height:Math.min(x,y*o),meta:null});let m,S,b;if(c!=null&&p!=null){const x=zx(h,l,p,c,u,f);m=x?.label,S=x?.secondaryLabel,b=x?.height??0}else{const x=Mn(h,l,u,f);m=x?.[0],S=void 0,b=x?.[0].height??0}const v=b*VF[r];e.each((x,M)=>{let k;if(M.label==="primary"?k=m:M.label==="secondary"&&(k=S),k==null){x.visible=!1;return}x.visible=!0,x.text=k.text,x.fontSize=k.fontSize,x.lineHeight=k.lineHeight,x.textAlign=n,x.textBaseline="middle";const A=M.label==="primary"?k.height/2:b-k.height/2;x.y=M.centerY+A-v,x.x=M.centerX})}var{fromToMotion:_n,resetMotion:hv,SeriesNodePickMode:dv,StateMachine:WF,createDatumId:pu,ChartAxisDirection:zo,normalizeAngle360:pv,normalizeAngle360Inclusive:uv,toDegrees:UF,toRadians:HF,BBox:KF,Group:As,PointerEvents:uu,Selection:Ds,Sector:YF,Text:gv,ConicGradient:jF,getMarker:XF}=wn,ZF={inside:90,middle:0,outside:-90},$F=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],QF=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],gu=class extends wn.Series{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[dv.EXACT_SHAPE_MATCH,dv.NEAREST_NODE]}),this.canHaveAxes=!0,this.properties=new Bt,this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.scaleGroup=this.contentGroup.appendChild(new As({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new As({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new As({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new As({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new As({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new As({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new As({name:"itemTargetLabelGroup"})),this.scaleSelection=Ds.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Ds.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=Ds.select(this.itemNeedleGroup,su),this.targetSelection=Ds.select(this.itemTargetGroup,e=>this.markerFactory(e)),this.targetLabelSelection=Ds.select(this.itemTargetLabelGroup,gv),this.labelSelection=Ds.select(this.itemLabelGroup,gv),this.highlightTargetSelection=Ds.select(this.highlightTargetGroup,e=>this.markerFactory(e)),this.nodeDatum={series:this,datum:{}},this.animationState=new WF("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.itemGroup.pointerEvents=uu.None,this.itemTargetLabelGroup.pointerEvents=uu.None,this.itemLabelGroup.pointerEvents=uu.None}get maximumRadius(){return this.properties.outerRadius}get minimumRadius(){return this.properties.outerRadius}get hasData(){return this.properties.value!=null}nodeFactory(){return new YF}markerFactory({shape:t}){const e=t!=="line"?XF(t):pp,i=new e;return i.size=1,i}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){return Jx(t,this.axes[zo.X])}createConicGradient(t,e){const{centerX:i,centerY:o,radius:s}=this,{domain:a,range:n}=this.axes[zo.X].scale,[r,l]=n,{defaultColorRange:c}=this.properties,h=pv((r+l)/2+Math.PI),p=uv(l-r),u=iS(t,c,a,e).map(({color:g,offset:y})=>(y=Math.min(Math.max(y,0),1),y=(r+p*y-h)/(2*Math.PI),y=(y%1+1)%1,{offset:y,color:g}));return new jF("oklch",u,UF(h)-90,new KF(i-s,o-s,2*s,2*s))}getTargets(){const{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(i=>{const{text:o=e.text,value:s=e.value??0,shape:a=e.shape??"triangle",rotation:n=e.rotation??0,strokeWidth:r=e.strokeWidth??0,placement:l=e.placement??"middle",spacing:c=e.spacing??0,size:h=e.size??0,fill:p=e.fill??"black",fillOpacity:u=e.fillOpacity??1,stroke:g=e.stroke??"black",strokeOpacity:y=e.strokeOpacity??1,lineDash:f=e.lineDash??[0],lineDashOffset:m=e.lineDashOffset??0}=i,{enabled:S=e.label.enabled,color:b=e.label.color??"black",fontStyle:v=e.label.fontStyle??"normal",fontWeight:x=e.label.fontWeight??"normal",fontSize:M=e.label.fontSize,fontFamily:k=e.label.fontFamily,spacing:A=e.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:l,spacing:c,size:h,rotation:n,fill:p,fillOpacity:u,stroke:g,strokeWidth:r,strokeOpacity:y,lineDash:f,lineDashOffset:m,label:{enabled:S,color:b,fontStyle:v,fontWeight:x,fontSize:M,fontFamily:k,spacing:A}}})}getTargetRadius(t){const{radius:e,properties:i}=this,{innerRadiusRatio:o,outerRadiusRatio:s}=i,{placement:a,spacing:n,size:r}=t,l=e*s,c=e*o;switch(a){case"inside":return Math.max(c-n-r/2,0);case"outside":return l+n+r/2;default:return(c+l)/2}}getTargetLabel(t){const i=this.axes[zo.X].scale,{value:o,size:s,placement:a,label:n}=t,{spacing:r,color:l,fontStyle:c,fontWeight:h,fontSize:p,fontFamily:u}=n,g=void 0,y=i.convert(o),f=pv(y)/(Math.PI/2)|0,m=s/2+r;let S,b,v,x;switch(a){case"outside":({textAlign:S,textBaseline:b}=$F[f]),v=m*Math.cos(y),x=m*Math.sin(y);break;case"inside":({textAlign:S,textBaseline:b}=QF[f]),v=-m*Math.cos(y),x=-m*Math.sin(y);break;default:S="center",b="bottom",v=0,x=-m;break}return{offsetX:v,offsetY:x,fill:l,textAlign:S,textBaseline:b,fontStyle:c,fontWeight:h,fontSize:p,fontFamily:u,lineHeight:g}}createNodeData(){const{id:t,properties:e,radius:i,centerX:o,centerY:s}=this;if(!e.isValid())return;const a=this.axes[zo.X];if(a==null)return;const{value:n,innerRadiusRatio:r,outerRadiusRatio:l,segmentation:c,cornerRadius:h,cornerMode:p,needle:u,bar:g,scale:y,label:f,secondaryLabel:m}=e,{outerRadius:S=i*l,innerRadius:b=i*r}=e,v=this.getTargets(),{domain:x}=a.scale,M=[],k=[],A=[],I=[],O=[],[T,L]=a.range,C=a.scale,D=p==="item",R=C.convert(x[0]),_=C.convert(n),F=Math.ceil(uv(_-R)*i);let E=c.enabled?c.interval.getSegments(a.scale,F):void 0;const B=g.fill??this.createConicGradient(g.fills,g.fillMode),P=y.fill??(g.enabled&&y.fills.length===0?y.defaultFill:void 0)??this.createConicGradient(y.fills,y.fillMode);if(E==null&&D){const[N,w]=x,z={value:n,segmentStart:N,segmentEnd:w},G=Math.min(h,(S-b)/2)/((b+S)/2);g.enabled&&M.push({series:this,itemId:"value",datum:z,type:0,centerX:o,centerY:s,outerRadius:S,innerRadius:b,startAngle:R-G,endAngle:_+G,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:h,endCornerRadius:h,fill:B}),O.push({series:this,itemId:"scale",datum:z,type:0,centerX:o,centerY:s,outerRadius:S,innerRadius:b,startAngle:T-G,endAngle:L+G,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:h,endCornerRadius:h,fill:P})}else{E??(E=x);for(let N=0;N<E.length-1;N++){const w=E[N],z=E[N+1],V={value:n,segmentStart:w,segmentEnd:z},G=N===0,W=N===E.length-2,H=C.convert(w),K=C.convert(z);g.enabled&&M.push({series:this,itemId:`value-${N}`,datum:V,type:0,centerX:o,centerY:s,outerRadius:S,innerRadius:b,startAngle:H,endAngle:K,clipStartAngle:R,clipEndAngle:_,startCornerRadius:D||G?h:0,endCornerRadius:D||W?h:0,fill:B}),O.push({series:this,itemId:`scale-${N}`,datum:V,type:0,centerX:o,centerY:s,outerRadius:S,innerRadius:b,startAngle:H,endAngle:K,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:D||G?h:0,endCornerRadius:D||W?h:0,fill:P})}}if(!u.enabled&&f.enabled){const{text:N,color:w,fontSize:z,minimumFontSize:V,fontStyle:G,fontWeight:W,fontFamily:H,lineHeight:K,formatter:Q=st=>this.formatLabel(st.value)}=f;I.push({label:"primary",centerX:o,centerY:s,text:N,value:n,fill:w,fontSize:z,minimumFontSize:V,fontStyle:G,fontWeight:W,fontFamily:H,lineHeight:K,formatter:Q})}if(!u.enabled&&m.enabled){const{text:N,color:w,fontSize:z,minimumFontSize:V,fontStyle:G,fontWeight:W,fontFamily:H,lineHeight:K,formatter:Q}=m;I.push({label:"secondary",centerX:o,centerY:s,text:N,value:n,fill:w,fontSize:z,minimumFontSize:V,fontStyle:G,fontWeight:W,fontFamily:H,lineHeight:K,formatter:Q})}if(u.enabled){let N=u.radiusRatio!=null?i*u.radiusRatio:b;N=Math.max(N-u.spacing,0);const w=C.convert(n);A.push({centerX:o,centerY:s,radius:N,angle:w})}for(let N=0;N<v.length;N+=1){const w=v[N],{value:z,text:V,size:G,shape:W,fill:H,fillOpacity:K,stroke:Q,strokeWidth:st,strokeOpacity:tt,lineDash:$,lineDashOffset:j}=w;if(z<Math.min(...x)||z>Math.max(...x))continue;const q=this.getTargetRadius(w),J=C.convert(z),X=HF(w.rotation+ZF[w.placement]);k.push({series:this,itemId:`target-${N}`,midPoint:{x:q*Math.cos(J)+o,y:q*Math.sin(J)+s},datum:{value:z},type:1,value:z,text:V,centerX:o,centerY:s,shape:W,radius:q,angle:J,rotation:X,size:G,fill:H,fillOpacity:K,stroke:Q,strokeOpacity:tt,strokeWidth:st,lineDash:$,lineDashOffset:j,label:this.getTargetLabel(w)})}return{itemId:t,nodeData:M,needleData:A,targetData:k,labelData:I,scaleData:O}}updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(t!=null&&t.series===this&&t.type===1)return t}update({seriesRect:t}){const{datumSelection:e,labelSelection:i,needleSelection:o,targetSelection:s,targetLabelSelection:a,scaleSelection:n,highlightTargetSelection:r}=this,l=this.checkResize(t);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=this.contextNodeData?.nodeData??[],h=this.contextNodeData?.labelData??[],p=this.contextNodeData?.needleData??[],u=this.contextNodeData?.targetData??[],g=this.contextNodeData?.scaleData??[],y=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:g,scaleSelection:n}),this.updateScaleNodes({scaleSelection:n}),this.needleSelection=this.updateNeedleSelection({needleData:p,needleSelection:o}),this.updateNeedleNodes({needleSelection:o}),this.targetSelection=this.updateTargetSelection({targetData:u,targetSelection:s}),this.updateTargetNodes({targetSelection:s,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:u,targetLabelSelection:a}),this.updateTargetLabelNodes({targetLabelSelection:a}),this.datumSelection=this.updateDatumSelection({nodeData:c,datumSelection:e}),this.updateDatumNodes({datumSelection:e}),this.labelSelection=this.updateLabelSelection({labelData:h,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:y!=null?[y]:[],targetSelection:r}),this.updateTargetNodes({targetSelection:r,isHighlight:!0}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>pu(t.nodeData.length,e.itemId))}updateDatumNodes(t){const{datumSelection:e}=t,{ctx:i,properties:o}=this,{bar:s,segmentation:a}=o,n=a.spacing??0,{fillOpacity:r,stroke:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}=s,u=this.getStrokeWidth(s.strokeWidth),g=i.animationManager.isSkipped();e.each((y,f)=>{const{centerX:m,centerY:S,innerRadius:b,outerRadius:v,startCornerRadius:x,endCornerRadius:M,fill:k}=f;y.centerX=m,y.centerY=S,y.innerRadius=b,y.outerRadius=v,y.fill=k,y.fillOpacity=r,y.stroke=l,y.strokeOpacity=c,y.strokeWidth=u,y.lineDash=h,y.lineDashOffset=p,y.startOuterCornerRadius=x,y.startInnerCornerRadius=x,y.endOuterCornerRadius=M,y.endInnerCornerRadius=M,y.radialEdgeInset=(n+y.strokeWidth)/2,y.concentricEdgeInset=y.strokeWidth/2,(g||y.previousDatum==null)&&y.setProperties(du(y,f))})}updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>pu(t.scaleData.length,e.itemId))}updateScaleNodes(t){const{scaleSelection:e}=t,{scale:i,segmentation:o}=this.properties,s=o.spacing??0,{fillOpacity:a,stroke:n,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h}=i;e.each((p,u)=>{const{centerX:g,centerY:y,innerRadius:f,outerRadius:m,startCornerRadius:S,endCornerRadius:b,fill:v}=u;p.centerX=g,p.centerY=y,p.innerRadius=f,p.outerRadius=m,p.fill=v,p.fillOpacity=a,p.stroke=n,p.strokeOpacity=r,p.strokeWidth=l,p.lineDash=c,p.lineDashOffset=h,p.startOuterCornerRadius=S,p.startInnerCornerRadius=S,p.endOuterCornerRadius=b,p.endInnerCornerRadius=b,p.radialEdgeInset=(s+p.strokeWidth)/2,p.concentricEdgeInset=p.strokeWidth/2,p.setProperties(du(p,u))})}updateNeedleSelection(t){return t.needleSelection.update(t.needleData,void 0,()=>pu([]))}updateNeedleNodes(t){const{needleSelection:e}=t,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();e.each((h,p)=>{const{centerX:u,centerY:g,radius:y}=p,f=y*2;h.d=su.defaultPathData,h.fill=i,h.fillOpacity=o,h.stroke=s,h.strokeOpacity=a,h.strokeWidth=n/f,h.lineDash=r.map(m=>m/f),h.lineDashOffset=l/f,h.translationX=u,h.translationY=g,h.scalingX=f,h.scalingY=f,c&&h.setProperties(cv(h,p))})}updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,e=>e.itemId)}updateTargetNodes(t){const{targetSelection:e,isHighlight:i}=t,o=i?this.properties.highlightStyle.item:void 0;e.each((s,a)=>{const{centerX:n,centerY:r,angle:l,radius:c,size:h,rotation:p,fill:u,fillOpacity:g,stroke:y,strokeOpacity:f,strokeWidth:m,lineDash:S,lineDashOffset:b}=a;s.size=h,s.fill=o?.fill??u,s.fillOpacity=o?.fillOpacity??g,s.stroke=o?.stroke??y,s.strokeOpacity=o?.strokeOpacity??f,s.strokeWidth=o?.strokeWidth??m,s.lineDash=o?.lineDash??S,s.lineDashOffset=o?.lineDashOffset??b,s.translationX=n+c*Math.cos(l),s.translationY=r+c*Math.sin(l),s.rotation=l+p})}updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData,void 0,e=>e.itemId)}updateTargetLabelNodes(t){const{targetLabelSelection:e}=t;e.each((i,o)=>{const{centerX:s,centerY:a,radius:n,angle:r,text:l}=o,{offsetX:c,offsetY:h,fill:p,fontStyle:u,fontWeight:g,fontSize:y,fontFamily:f,textAlign:m,textBaseline:S}=o.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=s+n*Math.cos(r)+c,i.y=a+n*Math.sin(r)+h,i.text=l,i.fill=p,i.fontStyle=u,i.fontWeight=g,i.fontSize=y,i.fontFamily=f,i.textAlign=m,i.textBaseline=S})}updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,e=>e.label)}updateLabelNodes(t){const{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:t}of this.labelSelection)if(t.text==null)return!1;return!0}formatLabelText(t){if(this.axes[zo.X]==null)return;const{labelSelection:i,radius:o,textAlign:s,verticalAlign:a}=this,{spacing:n,innerRadiusRatio:r}=this.properties;GF(this,i,{padding:n,textAlign:s,verticalAlign:a},o*r,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),hv([this.datumSelection],du),hv([this.needleSelection],cv),this.formatLabelText()}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}animateLabelText(t={}){const{animationManager:e}=this.ctx;let i,o,s,a;if(this.labelSelection.each((n,r)=>{n.opacity=1,r.label==="primary"?(i=n.previousDatum?.value??t.from??r.value,o=r.value):r.label==="secondary"&&(s=n.previousDatum?.value??t.from??r.value,a=r.value)}),!this.labelsHaveExplicitText())if(o==null||a==null)this.formatLabelText();else if(i===o&&s===a)this.formatLabelText({label:o,secondaryLabel:a});else{const n=`${this.id}_labels`;e.animate({id:n,groupId:"label",from:{label:i,secondaryLabel:s},to:{label:o,secondaryLabel:a},phase:t.phase??"update",onUpdate:r=>this.formatLabelText(r)})}}animateEmptyUpdateReady(){const{animationManager:t}=this.ctx,{node:e,needle:i}=lv(!0,this.axes[zo.X]?.range[0]??0);_n(this.id,"node",t,[this.datumSelection],e,(o,s)=>s.itemId),_n(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),_n(this.id,"label",t,[this.labelSelection],qx,(o,s)=>s.label),this.animateLabelText({from:this.axes[zo.X]?.scale.domain[0]??0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:t}=this.ctx,{node:e,needle:i}=lv(!1,this.axes[zo.X]?.range[0]??0);_n(this.id,"node",t,[this.datumSelection],e,(o,s)=>s.itemId),_n(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}getLegendData(){return[]}pickNode(t,e){switch(e){case"event":case"context-menu":{const i=this.scaleGroup.pickNode(t.x,t.y);return i!=null?{pickMode:wn.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:void 0}case"tooltip":case"highlight":case"highlight-tooltip":{const i=this.itemTargetGroup.pickNode(t.x,t.y);return i!=null?{pickMode:wn.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:{pickMode:wn.SeriesNodePickMode.NEAREST_NODE,match:this.nodeDatum,distance:0}}}}getTooltipContent(t){const{id:e,properties:i}=this,{tooltip:o}=i;if(!i.isValid())return;const s=this.highlightDatum(t),a=s?.value??i.value,n=s?.text;return o.formatTooltip({data:[{label:n??"",value:this.formatLabel(a)}]},{seriesId:e,title:void 0,datum:void 0,value:a})}pickFocus(t){const e=this.contextNodeData?.targetData;if(e==null||e.length===0)return;const i=Math.min(Math.max(t.datumIndex,0),e.length-1),o=e[i];for(const s of this.targetSelection)if(s.datum===o)return{bounds:s.node,showFocusBox:!0,clipFocusBox:!0,datum:o,datumIndex:i}}getCaptionText(){const{value:t}=this.properties,e=[];return e.push(this.formatLabel(t)),this.labelSelection.each((i,o)=>{const s=In(this,o);s!=null&&e.push(s)}),e.join(". ")}};gu.className="RadialGaugeSeries",gu.type="radial-gauge";var{ThemeSymbols:{DEFAULT_FONT_FAMILY:yu,DEFAULT_HIERARCHY_FILLS:qF,DEFAULT_LABEL_COLOUR:Pn,DEFAULT_MUTED_LABEL_COLOUR:JF,DEFAULT_GAUGE_SERIES_COLOR_RANGE:tV},ThemeConstants:{POLAR_AXIS_TYPE:fu}}=kF,eV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"radial-gauge",moduleFactory:t=>new gu(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:fu.ANGLE_NUMBER,line:{enabled:!1}},{type:fu.RADIUS_NUMBER,line:{enabled:!1}}],themeTemplate:{minWidth:200,minHeight:200,series:{outerRadiusRatio:1,innerRadiusRatio:.8,bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:Pn,stroke:Pn,size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:"normal",fontSize:12,fontFamily:yu,color:Pn,spacing:5}},needle:{enabled:!1,fill:Pn,spacing:10},label:{enabled:!0,fontWeight:"normal",fontSize:56,minimumFontSize:18,fontFamily:yu,color:Pn},secondaryLabel:{enabled:!0,fontWeight:"normal",fontSize:14,minimumFontSize:12,fontFamily:yu,color:JF},tooltip:{enabled:!1}},axes:{[fu.ANGLE_NUMBER]:{startAngle:270,endAngle:450,nice:!1,line:{enabled:!1}}}},paletteFactory(t){const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fills:a}=e(i),n=s.get(tV),r=s.get(qF),l=o==="inbuilt"?n:[a[0],a[1]];return{scale:{defaultFill:r?.[1],stroke:r?.[2]},defaultColorRange:Qx(l)}}};import{_ModuleSupport as iV}from"ag-charts-community";import{_ModuleSupport as Kl}from"ag-charts-community";var oV=1e3;function yv(t,e,i,o,s,a){const n=t[a];if(n==null)return!1;const r=el(n,e,i),l=il(r,s);return a===o[l+Ae]}function fv(t,e,i,o,s,a){const n=t[a];if(n==null)return!1;const r=el(n,e,i),l=il(r,s);return a===o[l+ke]}function sV(t,e,i,o){if(t.length<oV)return;const[s,a]=cn(o);let n=ln(t);const{indexData:r,valueData:l}=hn(t,e,i,s,a,n);let c=[],h=[];for(let u=0;u<t.length;u+=1)yv(t,s,a,r,n,u)&&c.push(u),fv(t,s,a,r,n,u)&&h.push(u);const p=[{maxRange:n,topIndices:c,bottomIndices:h}];for(;n>64;)({maxRange:n}=dn(r,l,n,{inPlace:!0})),c=c.filter(yv.bind(null,t,s,a,r,n)),h=h.filter(fv.bind(null,t,s,a,r,n)),p.push({maxRange:n,topIndices:c,bottomIndices:h});return p.reverse(),p}import{_ModuleSupport as aV}from"ag-charts-community";var{CartesianSeriesProperties:nV,InterpolationProperties:rV,SeriesMarker:lV,SeriesTooltip:cV,Validate:kt,BOOLEAN:hV,COLOR_STRING:mv,LINE_DASH:dV,OBJECT:Bn,PLACEMENT:pV,POSITIVE_NUMBER:mu,RATIO:xv,STRING:Is,DropShadow:uV,Label:gV}=aV,xu=class extends gV{constructor(){super(...arguments),this.placement="outside",this.padding=6}};d([kt(pV)],xu.prototype,"placement",2),d([kt(mu)],xu.prototype,"padding",2);var Tt=class extends nV{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new rV,this.shadow=new uV().set({enabled:!1}),this.marker=new lV,this.label=new xu,this.tooltip=new cV,this.connectMissingData=!1}};d([kt(Is)],Tt.prototype,"xKey",2),d([kt(Is)],Tt.prototype,"yLowKey",2),d([kt(Is)],Tt.prototype,"yHighKey",2),d([kt(Is,{optional:!0})],Tt.prototype,"xName",2),d([kt(Is,{optional:!0})],Tt.prototype,"yName",2),d([kt(Is,{optional:!0})],Tt.prototype,"yLowName",2),d([kt(Is,{optional:!0})],Tt.prototype,"yHighName",2),d([kt(mv)],Tt.prototype,"fill",2),d([kt(xv)],Tt.prototype,"fillOpacity",2),d([kt(mv)],Tt.prototype,"stroke",2),d([kt(mu)],Tt.prototype,"strokeWidth",2),d([kt(xv)],Tt.prototype,"strokeOpacity",2),d([kt(dV)],Tt.prototype,"lineDash",2),d([kt(mu)],Tt.prototype,"lineDashOffset",2),d([kt(Bn)],Tt.prototype,"interpolation",2),d([kt(Bn)],Tt.prototype,"shadow",2),d([kt(Bn)],Tt.prototype,"marker",2),d([kt(Bn)],Tt.prototype,"label",2),d([kt(Bn)],Tt.prototype,"tooltip",2),d([kt(hV)],Tt.prototype,"connectMissingData",2);import{_ModuleSupport as yV}from"ag-charts-community";var{CollapseMode:Yl,isScaleValid:Sv,pairUpSpans:jl,prepareAreaFillAnimationFns:fV,plotInterpolatedLinePathStroke:Ta,prepareLinePathPropertyAnimation:mV,areScalingEqual:bv}=yV;function xV(t,e,i,o){const s=(l,c)=>{Ta(l,c,e.removed),Ta(l,c,i.removed)},a=(l,c)=>{Ta(l,c,e.moved),Ta(l,c,i.moved)},n=(l,c)=>{Ta(l,c,e.added),Ta(l,c,i.added)},r=mV(t,o);return{status:t,path:{addPhaseFn:n,updatePhaseFn:a,removePhaseFn:s},pathProperties:r}}function SV(t,e,i){const o=t.scales.x?.type==="category",s=e.scales.x?.type==="category";if(o!==s||!Sv(t.scales.x)||!Sv(e.scales.x))return;let a="updated";e.visible&&!t.visible?a="removed":!e.visible&&t.visible&&(a="added");const n=jl({scales:t.scales,data:t.fillData.spans},{scales:e.scales,data:e.fillData.spans},Yl.Split);if(n==null)return;const r=jl({scales:t.scales,data:t.fillData.phantomSpans},{scales:e.scales,data:e.fillData.phantomSpans},Yl.Split);if(r==null)return;const l=jl({scales:t.scales,data:t.highStrokeData.spans},{scales:e.scales,data:e.highStrokeData.spans},Yl.Split);if(l==null)return;const c=jl({scales:t.scales,data:t.lowStrokeData.spans},{scales:e.scales,data:e.lowStrokeData.spans},Yl.Split);if(c==null)return;const h="fade",p=fV(a,n,r,h),u=xV(a,l,c,h),g=(i?.changed??!0)||!bv(t.scales.x,e.scales.x)||!bv(t.scales.y,e.scales.y)||a!=="updated";return{status:a,fill:p,stroke:u,hasMotion:g}}var{valueProperty:vv,keyProperty:bV,ChartAxisDirection:Pe,mergeDefaults:vV,updateLabelNode:MV,fixNumericExtent:Mv,buildResetPathFn:kV,resetLabelFn:AV,resetMarkerFn:DV,resetMarkerPositionFn:kv,pathSwipeInAnimation:IV,resetMotion:TV,markerSwipeScaleInAnimation:OV,seriesLabelFadeInAnimation:Su,animationValidation:LV,diff:NV,updateClipPath:Av,computeMarkerFocusBounds:Dv,plotAreaPathFill:CV,plotLinePathStroke:Iv,interpolatePoints:Tv,pathFadeInAnimation:Ov,markerFadeInAnimation:Lv,fromToMotion:Nv,pathMotion:Cv,extent:RV,getMarker:EV,visibleRangeIndices:wV,createDatumId:_V,PointerEvents:bu,Group:PV,BBox:BV,ContinuousScale:zV,OrdinalTimeScale:FV}=Kl,VV=class extends Kl.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},vu=class extends Kl.CartesianSeries{constructor(t){super({moduleCtx:t,hasMarkers:!0,pathsPerSeries:["fill","stroke"],pickModes:[Kl.SeriesNodePickMode.AXIS_ALIGNED],directionKeys:{[Pe.X]:["xKey"],[Pe.Y]:["yLowKey","yHighKey"]},directionNames:{[Pe.X]:["xName"],[Pe.Y]:["yLowName","yHighName","yName"]},animationResetFns:{path:kV({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:AV,marker:(e,i)=>({...DV(e),...kv(e,i)})}}),this.properties=new Tt,this.NodeEvent=VV,this.dataAggregationFilters=void 0}async processData(t){if(!this.properties.isValid())return;const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.axes[Pe.X]?.scale,a=this.axes[Pe.Y]?.scale,{xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:s,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(NV(this.id,this.processedData)),c&&l.push(LV());const{dataModel:h,processedData:p}=await this.requestDataModel(t,this.data,{props:[bV(e,n,{id:"xValue"}),vv(i,r,{id:"yLowValue"}),vv(o,r,{id:"yHighValue"}),...l]});this.dataAggregationFilters=this.aggregateData(h,p),this.animationState.transition("updateData")}aggregateData(t,e){if(e.rawData.length===0)return;const i=this.axes[Pe.X];if(i==null||!(zV.is(i.scale)||FV.is(i.scale)))return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yHighValue",e),a=t.resolveColumnById(this,"yLowValue",e),{index:n}=t.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[n];return sV(o,s,a,r)}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];const{domain:{keys:[o],values:s}}=e;if(t===Pe.X){const a=i.resolveProcessedDataDefById(this,"xValue");return a?.def.type==="key"&&a.def.valueType==="category"?o:Mv(RV(o))}else{const a=i.resolveProcessedDataIndexById(this,"yLowValue"),n=s[a],r=i.resolveProcessedDataIndexById(this,"yHighValue"),l=s[r],c=[n[0]>l[0]?l[0]:n[0],l[1]<n[1]?n[1]:l[1]];return Mv(c)}}visibleRangeIndices(t,e){const{dataModel:i,processedData:o}=this;if(!i||!o)return[0,0];const s=this.axes[Pe.X].scale,a=i.resolveKeysById(this,"xValue",o);return wV(e?.length??a.length,t,n=>{const r=s.convert(a[e?.[n]??n]);return[r,r]})}getSeriesRange(t,e){const{dataModel:i,processedData:o}=this;if(!i||!o)return[NaN,NaN];const[s,a]=this.visibleRangeIndices(e);return i.getDomainBetweenRange(this,["yLowValue","yHighValue"],[s,a],o)}createNodeData(){const{data:t,dataModel:e,processedData:i,axes:o}=this,s=o[Pe.X],a=o[Pe.Y];if(!(t&&s&&a&&e&&i!=null&&i.rawData.length!==0))return;const n=s.scale,r=a.scale,{xKey:l,yLowKey:c,yHighKey:h,connectMissingData:p,marker:u,interpolation:g}=this.properties,{rawData:y}=i,f=(n.bandwidth??0)/2,m=e.resolveKeysById(this,"xValue",i),S=e.resolveColumnById(this,"yHighValue",i),b=e.resolveColumnById(this,"yLowValue",i),v=N=>n.convert(m[N])+f,x=[],M=[],k=[],A=(N,w,z)=>{const V=y[N],G=m[N];if(G==null)return;const W=k[k.length-1];if(Number.isFinite(w)&&Number.isFinite(z)){const H=(q,J,X)=>{M.push({index:N,series:this,itemId:q,datum:V,datumIndex:N,midPoint:{x:Q,y:X},yHighValue:w,yLowValue:z,xValue:G,xKey:l,yLowKey:c,yHighKey:h,point:{x:Q,y:X,size:$},enabled:!0});const gt=this.createLabelData({point:{x:Q,y:X},value:J,yLowValue:z,yHighValue:w,itemId:q,inverted:K,datum:V,series:this});x.push(gt)},K=z>w,Q=v(N),st=r.convert(w),tt=r.convert(z),{size:$}=u;H("high",w,st),H("low",z,tt);const j={high:{point:{x:Q,y:st},xDatum:G,yDatum:w},low:{point:{x:Q,y:tt},xDatum:G,yDatum:z}};Array.isArray(W)?W.push(j):W!=null?(W.skip+=1,k.push([j])):k.push([j])}else p||(Array.isArray(W)||W==null?k.push({skip:0}):W.skip+=1)},{dataAggregationFilters:I}=this,[O,T]=n.range,L=T-O,C=I?.find(N=>N.maxRange>L),D=C?.topIndices,R=C?.bottomIndices;let[_,F]=this.visibleRangeIndices(s.range,D);_=Math.max(_-1,0),F=Math.min(F+1,D?.length??m.length),i.rawData.length<1e3&&(_=0,F=i.rawData.length);for(let N=_;N<F;N+=1){const w=D?.[N]??N,z=R?.[N]??N;A(w,S[w],b[z])}const E=k.flatMap(N=>{if(!Array.isArray(N))return[];const w=N.map(z=>z.high);return Tv(w,g)}),B=k.flatMap(N=>{if(!Array.isArray(N))return[];const w=N.map(z=>z.low);return Tv(w,g)});return{itemId:`${c}-${h}`,labelData:x,nodeData:M,fillData:{itemId:"high",spans:E,phantomSpans:B},highStrokeData:{itemId:"high",spans:E},lowStrokeData:{itemId:"low",spans:B},scales:this.calculateScaling(),visible:this.visible}}createLabelData({point:t,value:e,itemId:i,inverted:o,datum:s,series:a}){const{xKey:n,yLowKey:r,yHighKey:l,xName:c,yName:h,yLowName:p,yHighName:u,label:g}=this.properties,{placement:y,padding:f=10}=g;let m=i;o&&(m=i==="low"?"high":"low");const S=y==="outside"&&m==="high"||y==="inside"&&m==="low"?-1:1;return{x:t.x,y:t.y+f*S,series:a,itemId:i,datum:s,text:this.getLabelText(g,{value:e,datum:s,itemId:i,xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:p,yHighName:u,yName:h}),textAlign:"center",textBaseline:S===-1?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape:t}=this.properties.marker,e=EV(t);return new e}updatePathNodes(t){const{opacity:e,visible:i,animationEnabled:o}=t,[s,a]=t.paths,n=this.getStrokeWidth(this.properties.strokeWidth);a.setProperties({fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:bu.None,stroke:this.properties.stroke,strokeWidth:n,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:e,visible:i||o}),s.setProperties({stroke:void 0,lineJoin:"round",pointerEvents:bu.None,fill:this.properties.fill,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,fillShadow:this.properties.shadow,strokeWidth:n,opacity:e,visible:i||o}),Av(this,a),Av(this,s)}updatePaths(t){this.updateAreaPaths(t.paths,t.contextData)}updateAreaPaths(t,e){for(const i of t)i.visible=e.visible;if(e.visible)this.updateFillPath(t,e),this.updateStrokePath(t,e);else for(const i of t)i.path.clear(),i.markDirty()}updateFillPath(t,e){const[i]=t;i.path.clear(),CV(i,e.fillData),i.markDirty()}updateStrokePath(t,e){const[,i]=t;i.path.clear(),Iv(i,e.highStrokeData.spans),Iv(i,e.lowStrokeData.spans),i.markDirty()}updateMarkerSelection(t){const{nodeData:e,markerSelection:i}=t;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?e:[])}getMarkerItemBaseStyle(t){const{properties:e}=this,{marker:i}=e,o=t?e.highlightStyle.item:void 0,s=this.getStrokeWidth(i.strokeWidth);return{size:i.size,fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??s,strokeOpacity:o?.strokeOpacity??i.strokeOpacity}}getMarkerItemStyleOverrides(t,e,i,o){const{id:s,properties:a}=this,{xKey:n,yHighKey:r,yLowKey:l,marker:c}=a,{itemStyler:h}=c;if(h!=null)return this.cachedDatumCallback(_V(t,o?"highlight":"node"),()=>h({seriesId:s,datum:e,xKey:n,yHighKey:r,yLowKey:l,highlighted:o,...i}))}updateMarkerNodes(t){const{markerSelection:e,isHighlight:i}=t,{xKey:o,yLowKey:s,yHighKey:a,marker:n,fill:r,stroke:l,strokeWidth:c,fillOpacity:h,strokeOpacity:p}=this.properties,u=vV(i&&this.properties.highlightStyle.item,n.getStyle(),{fill:r,fillOpacity:h,stroke:l,strokeWidth:c,strokeOpacity:p});e.each((g,y)=>{this.updateMarkerStyle(g,n,{datum:y,highlighted:i,xKey:o,yHighKey:a,yLowKey:s},u)}),i||this.properties.marker.markClean()}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e,o=>{o.pointerEvents=bu.None})}updateLabelNodes(t){t.labelSelection.each((e,i)=>{MV(e,this.properties.label,i)})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}getHighlightData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,axes:s,properties:a}=this,{xName:n,yName:r,yLowKey:l,yLowName:c,xKey:h,yHighKey:p,yHighName:u,tooltip:g}=a,y=s[Pe.X],f=s[Pe.Y];if(!i||!o||o.rawData.length===0||!y||!f)return;const{datumIndex:m}=t,S=o.rawData[m],b=i.resolveKeysById(this,"xValue",o)[m],v=i.resolveColumnById(this,"yHighValue",o)[m],x=i.resolveColumnById(this,"yLowValue",o)[m];if(b==null)return;const M=this.getMarkerItemBaseStyle(!1);Object.assign(M,this.getMarkerItemStyleOverrides(String(m),m,M,!1));const k=`${f.formatDatum(x)} - ${f.formatDatum(v)}`;return g.formatTooltip({heading:y.formatDatum(b),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:`${c??l} - ${u??u}`,value:k}]},{seriesId:e,datum:S,title:r,itemId:t.itemId,xName:n,yName:r,yLowKey:l,yLowName:c,xKey:h,yHighKey:p,yHighName:u,...M})}legendItemSymbol(){const{fill:t,stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,marker:a}=this.properties;return{marker:{shape:a.shape,fill:a.fill??t,stroke:a.stroke??e,fillOpacity:a.fillOpacity,strokeOpacity:a.strokeOpacity,strokeWidth:a.strokeWidth},line:{stroke:e,strokeOpacity:o,strokeWidth:i,lineDash:s}}}getLegendData(t){if(t!=="category")return[];const{id:e,visible:i}=this,{yLowKey:o,yHighKey:s,yName:a,yLowName:n,yHighName:r,showInLegend:l}=this.properties,c=a??`${n??o} - ${r??s}`,h=`${o}-${s}`;return[{legendType:"category",id:e,itemId:h,seriesId:e,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new PV}animateEmptyUpdateReady(t){const{markerSelection:e,labelSelection:i,contextData:o,paths:s}=t,{animationManager:a}=this.ctx;this.updateAreaPaths(s,o),IV(this,a,...s),TV([e],kv),OV(this,a,e),Su(this,"labels",a,i)}animateReadyResize(t){const{contextData:e,paths:i}=t;this.updateAreaPaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){const{animationManager:e}=this.ctx,{markerSelection:i,labelSelection:o,contextData:s,paths:a,previousContextData:n}=t,[r,l]=a;if(r==null&&l==null)return;this.resetMarkerAnimation(t),this.resetLabelAnimation(t);const c=()=>{this.resetPathAnimation(t),this.updateAreaPaths(a,s)},h=()=>{e.skipCurrentBatch(),c()};if(s==null||n==null){c(),Lv(this,e,"added",i),Ov(this,"fill_path_properties",e,"add",r),Ov(this,"stroke_path_properties",e,"add",l),Su(this,"labels",e,o);return}const p=SV(s,n,this.processedData?.reduced?.diff?.[this.id]);if(p===void 0){h();return}else if(p.status==="no-op")return;Nv(this.id,"fill_path_properties",e,[r],p.fill.pathProperties),Nv(this.id,"stroke_path_properties",e,[l],p.stroke.pathProperties),p.status==="added"?this.updateAreaPaths(a,s):p.status==="removed"?this.updateAreaPaths(a,n):(Cv(this.id,"fill_path_update",e,[r],p.fill.path),Cv(this.id,"stroke_path_update",e,[l],p.stroke.path)),p.hasMotion&&(Lv(this,e,void 0,i),Su(this,"labels",e,o)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(a,s)})}getFormattedMarkerStyle(t){const{xKey:e,yLowKey:i,yHighKey:o}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:t,xKey:e,yLowKey:i,yHighKey:o,highlighted:!0})}computeFocusBounds(t){const e=Dv(this,t),i=Dv(this,{...t,datumIndex:t.datumIndex+1});if(e&&i)return BV.merge([e,i])}computeFocusDatumIndex(t,e){const i={...t,datumIndex:t.datumIndex+t.datumIndexDelta,datumIndexDelta:t.datumIndexDelta*2};return super.computeFocusDatumIndex(i,e)}};vu.className="RangeAreaSeries",vu.type="range-area";import{_ModuleSupport as Mu}from"ag-charts-community";var GV={series:{fillOpacity:.7,nodeClickRange:"nearest",marker:{enabled:!1,size:6,strokeWidth:2},label:{enabled:!1,placement:"outside",padding:10,fontSize:12,fontFamily:Mu.ThemeSymbols.DEFAULT_FONT_FAMILY,color:Mu.ThemeSymbols.DEFAULT_LABEL_COLOUR},interpolation:{type:"linear",tension:1,position:"end"}},axes:{[Mu.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{markerPaletteFactory:WV,ThemeConstants:{CARTESIAN_AXIS_TYPE:Rv,CARTESIAN_POSITION:Ev}}=iV,UV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",moduleFactory:t=>new vu(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Rv.NUMBER,position:Ev.LEFT},{type:Rv.CATEGORY,position:Ev.BOTTOM}],themeTemplate:GV,paletteFactory:t=>{const{marker:e}=WV(t);return{fill:e.fill,stroke:e.stroke,marker:e}}};import{_ModuleSupport as wv}from"ag-charts-community";import{_ModuleSupport as ku}from"ag-charts-community";var HV=1e3,KV=5;function YV(t,e,i,o){if(t.length<HV)return;const[s,a]=cn(o);let n=ln(t,KV),{indexData:r,valueData:l}=hn(t,e,i,s,a,n);const c=[{maxRange:n,indexData:r}];for(;n>64;)({indexData:r,valueData:l,maxRange:n}=dn(r,l,n)),c.push({maxRange:n,indexData:r});return c.reverse(),c}import{_ModuleSupport as jV}from"ag-charts-community";var{AbstractBarSeriesProperties:XV,SeriesTooltip:ZV,Validate:At,COLOR_STRING:_v,FUNCTION:$V,LINE_DASH:QV,OBJECT:Au,PLACEMENT:qV,POSITIVE_NUMBER:Xl,RATIO:Pv,STRING:Ts,BOOLEAN:JV,DropShadow:tG,Label:eG}=jV,Du=class extends eG{constructor(){super(...arguments),this.placement="inside",this.padding=6}};d([At(qV)],Du.prototype,"placement",2),d([At(Xl)],Du.prototype,"padding",2);var Ot=class extends XV{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new tG().set({enabled:!1}),this.label=new Du,this.tooltip=new ZV,this.fastDataProcessing=!1}};d([At(Ts)],Ot.prototype,"xKey",2),d([At(Ts)],Ot.prototype,"yLowKey",2),d([At(Ts)],Ot.prototype,"yHighKey",2),d([At(Ts,{optional:!0})],Ot.prototype,"xName",2),d([At(Ts,{optional:!0})],Ot.prototype,"yName",2),d([At(Ts,{optional:!0})],Ot.prototype,"yLowName",2),d([At(Ts,{optional:!0})],Ot.prototype,"yHighName",2),d([At(_v)],Ot.prototype,"fill",2),d([At(Pv)],Ot.prototype,"fillOpacity",2),d([At(_v)],Ot.prototype,"stroke",2),d([At(Xl)],Ot.prototype,"strokeWidth",2),d([At(Pv)],Ot.prototype,"strokeOpacity",2),d([At(QV)],Ot.prototype,"lineDash",2),d([At(Xl)],Ot.prototype,"lineDashOffset",2),d([At(Xl)],Ot.prototype,"cornerRadius",2),d([At($V,{optional:!0})],Ot.prototype,"itemStyler",2),d([At(Au)],Ot.prototype,"shadow",2),d([At(Au)],Ot.prototype,"label",2),d([At(Au)],Ot.prototype,"tooltip",2),d([At(JV)],Ot.prototype,"fastDataProcessing",2);var{SeriesNodePickMode:Bv,valueProperty:zv,keyProperty:iG,ChartAxisDirection:Zl,getRectConfig:oG,updateRect:sG,checkCrisp:aG,updateLabelNode:nG,SMALLEST_KEY_INTERVAL:rG,LARGEST_KEY_INTERVAL:lG,diff:cG,prepareBarAnimationFunctions:Fv,midpointStartingBarPosition:Vv,resetBarSelectionsFn:hG,fixNumericExtent:dG,seriesLabelFadeInAnimation:Gv,resetLabelFn:pG,animationValidation:uG,computeBarFocusBounds:gG,visibleRangeIndices:Iu,createDatumId:yG,ContinuousScale:Wv,OrdinalTimeScale:fG,Rect:mG,PointerEvents:xG,motion:Uv}=ku,SG=class extends ku.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Tu=class extends ku.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[Bv.AXIS_ALIGNED,Bv.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},datumSelectionGarbageCollection:!1,animationResetFns:{datum:hG,label:pG}}),this.properties=new Ot,this.dataAggregationFilters=void 0,this.NodeEvent=SG}async processData(t){if(!this.properties.isValid())return;const{xKey:e,yLowKey:i,yHighKey:o,fastDataProcessing:s}=this.properties,a=!s,n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:l,xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:n,yScale:r}),p=[];this.ctx.animationManager.isSkipped()||(this.processedData&&p.push(cG(this.id,this.processedData)),p.push(uG()));const u=this.visible?{}:{forceValue:0},{dataModel:g,processedData:y}=await this.requestDataModel(t,this.data,{props:[iG(e,c,{id:"xValue"}),zv(i,h,{id:"yLowValue",invalidValue:null,...u}),zv(o,h,{id:"yHighValue",invalidValue:null,...u}),...l?[rG,lG]:[],...p],groupByKeys:a});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.largestDataInterval=y.reduced?.largestKeyInterval,this.dataAggregationFilters=this.aggregateData(g,y),this.animationState.transition("updateData")}aggregateData(t,e){if(e.type!=="grouped"||e.rawData.length===0)return;const i=this.axes[Zl.X];if(i==null||!(Wv.is(i.scale)||fG.is(i.scale)))return;const o=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yHighValue",e),a=t.resolveColumnById(this,"yLowValue",e),{index:n}=t.resolveProcessedDataDefById(this,"xValue"),r=e.domain.keys[n];return YV(o,s,a,r)}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o],values:s}=e.domain;if(t===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");return a?.def.type==="key"&&a?.def.valueType==="category"?o:this.padBandExtent(o)}else{const a=i.resolveProcessedDataIndexById(this,"yLowValue"),n=s[a],r=i.resolveProcessedDataIndexById(this,"yHighValue"),l=s[r],c=[n[0]>l[0]?l[0]:n[0],l[1]<n[1]?n[1]:l[1]];return dG(c)}}getSeriesRange(t,e){const{dataModel:i,processedData:o}=this;if(!i||!o)return[NaN,NaN];const s=this.axes[Zl.X].scale,a=i.resolveKeysById(this,"xValue",o),n=s.bandwidth??0,[r,l]=Iu(a.length,e,c=>{const h=s.convert(a[c]);return[h,h+n]});return i.getDomainBetweenRange(this,["yHighValue","yLowValue"],[r,l],o)}createNodeData(){const{data:t,dataModel:e,groupScale:i,processedData:o,visible:s}=this,a=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&a&&n&&e&&o?.rawData.length))return;const r=a.scale,l=n.scale,c=this.getBarDirection()===Zl.X,{xKey:h,yLowKey:p,yHighKey:u,fill:g,stroke:y,strokeWidth:f}=this.properties,m=`${p}-${u}`,S={itemId:m,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!s)return S;const{rawData:b}=o,v=e.resolveKeysById(this,"xValue",o),x=e.resolveColumnById(this,"yLowValue",o),M=e.resolveColumnById(this,"yHighValue",o),{barWidth:k,groupIndex:A}=this.updateGroupScale(a),I=Wv.is(r)?k*-.5:0,O=i.convert(String(A)),T=aG(a?.scale,a?.visibleRange,this.smallestDataInterval,this.largestDataInterval),L=B=>Math.round(r.convert(v[B]))+O+I,C=(B,P,N,w,z,V,G)=>{const W=b[B],H=v[B];if(H==null)return;const K=x[B],Q=M[B];if(!Number.isFinite(K?.valueOf())||!Number.isFinite(Q?.valueOf()))return;const[st,tt]=K<Q?[K,Q]:[Q,K],$=Math.round(l.convert(V)),j=Math.round(l.convert(z)),q=Math.max(f,Math.abs(j-$)),J={x:c?Math.min($,j):N,y:c?N:Math.min($,j),width:c?q:w,height:c?w:q},X={x:J.x+J.width/2,y:J.y+J.height/2},gt=this.createLabelData({rect:J,barAlongX:c,yLowValue:st,yHighValue:tt,datum:W,series:this}),rt={index:P,valueIndex:B,series:this,itemId:m,datum:W,datumIndex:B,xValue:H,yLowValue:K,yHighValue:Q,yLowKey:p,yHighKey:u,xKey:h,x:J.x,y:J.y,width:J.width,height:J.height,midPoint:X,fill:g,stroke:y,strokeWidth:f,opacity:1,crisp:G,labels:gt};S.nodeData.push(rt),S.labelData.push(...gt)},{dataAggregationFilters:D}=this,[R,_]=r.range,F=_-R,E=D?.find(B=>B.maxRange>F);if(E!=null){const{maxRange:B,indexData:P}=E,[N,w]=Iu(B,a.range,z=>{const V=z*Ye,G=P[V+ne],W=P[V+Me];if(G===-1)return;const H=(G+W)/2|0;return[L(H),L(W)+k]});for(let z=N;z<w;z+=1){const V=z*Ye,G=P[V+ne],W=P[V+Me],H=P[V+ke],K=P[V+Ae];if(G===-1)continue;const Q=(G+W)/2|0;if(v[Q]==null)continue;const tt=L(Q),$=Math.abs(L(G)-L(W))+k,j=x[H],q=M[K];C(Q,0,tt,$,j,q,!1)}}else if(o.type==="ungrouped"){let[B,P]=Iu(b.length,a.range,N=>[L(N),k]);o.rawData.length<1e3&&(B=0,P=o.rawData.length);for(let N=B;N<P;N+=1){const w=L(N),z=k,V=x[N],G=M[N];C(N,0,w,z,V,G,T)}}else o.groups.forEach(({datumIndices:B},P)=>{B.forEach(N=>{const w=L(N),z=k,V=x[N],G=M[N];C(N,P,w,z,V,G,T)})});return S}createLabelData({rect:t,barAlongX:e,yLowValue:i,yHighValue:o,datum:s,series:a}){const{xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:h,yHighName:p,yName:u,label:g}=this.properties,y={datum:s,xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:h,yHighName:p,yName:u},{placement:f,padding:m}=g,b=m*(f==="outside"?1:-1),v={x:t.x+(e?-b:t.width/2),y:t.y+(e?t.height/2:t.height+b),textAlign:e?"left":"center",textBaseline:e?"middle":"bottom",text:this.getLabelText(g,{itemId:"low",value:i,...y}),itemId:"low",datum:s,series:a},x={x:t.x+(e?t.width+b:t.width/2),y:t.y+(e?t.height/2:-b),textAlign:e?"right":"center",textBaseline:e?"middle":"top",text:this.getLabelText(g,{itemId:"high",value:o,...y}),itemId:"high",datum:s,series:a};return f==="outside"&&(v.textAlign=e?"right":"center",v.textBaseline=e?"middle":"top",x.textAlign=e?"left":"center",x.textBaseline=e?"middle":"bottom"),[v,x]}nodeFactory(){return new mG}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}getItemBaseStyle(t){const{properties:e}=this,{cornerRadius:i}=e,o=t?e.highlightStyle.item:void 0;return{fill:o?.fill??e.fill,fillOpacity:o?.fillOpacity??e.fillOpacity,stroke:o?.stroke??e.stroke,strokeWidth:o?.strokeWidth??e.strokeWidth,strokeOpacity:o?.strokeOpacity??e.strokeOpacity,lineDash:o?.lineDash??e.lineDash??[],lineDashOffset:o?.lineDashOffset??e.lineDashOffset,cornerRadius:i}}getItemStyleOverrides(t,e,i,o){const{id:s,properties:a}=this,{xKey:n,yHighKey:r,yLowKey:l,itemStyler:c}=a;if(c!=null)return this.cachedDatumCallback(yG(t,o?"highlight":"node"),()=>c({seriesId:s,datum:e,xKey:n,yHighKey:r,yLowKey:l,highlighted:o,...i}))}updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o}=this,{yLowKey:s,yHighKey:a,highlightStyle:{item:n},fillOpacity:r,strokeOpacity:l,strokeWidth:c,lineDash:h,lineDashOffset:p,itemStyler:u,shadow:g}=this.properties,y=this.getCategoryDirection()===Zl.X;e.each((f,m)=>{const S={fill:m.fill,stroke:m.stroke,fillOpacity:r,strokeOpacity:l,lineDash:h,lineDashOffset:p,fillShadow:g,strokeWidth:this.getStrokeWidth(c),cornerRadius:this.properties.cornerRadius},b=y?m.width>0:m.height>0,v=oG(this,this.getDatumId(m),{datum:m,isHighlighted:i,style:S,highlightStyle:n,itemStyler:u,seriesId:o,yLowKey:s,yHighKey:a});v.crisp=m.crisp,v.visible=b,sG(f,v)})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=xG.None})}updateLabelNodes(t){t.labelSelection.each((e,i)=>{nG(e,this.properties.label,i)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:p,tooltip:u}=s,g=this.getCategoryAxis(),y=this.getValueAxis();if(!i||!o||o.rawData.length===0||!g||!y)return;const{datumIndex:f}=t,m=o.rawData[f],S=i.resolveKeysById(this,"xValue",o)[f],b=i.resolveColumnById(this,"yHighValue",o)[f],v=i.resolveColumnById(this,"yLowValue",o)[f];if(S==null)return;const x=this.getItemBaseStyle(!1);Object.assign(x,this.getItemStyleOverrides(String(f),m,x,!1));const M=`${y.formatDatum(v)} - ${y.formatDatum(b)}`;return u.formatTooltip({heading:g.formatDatum(S),symbol:this.legendItemSymbol(),data:[{label:r,fallbackLabel:`${h??l} - ${p??c}`,value:M}]},{seriesId:e,datum:m,title:r,xKey:a,xName:n,yName:r,yLowKey:l,yHighKey:c,yLowName:h,yHighName:p,...x})}legendItemSymbol(){const{fill:t,stroke:e,strokeWidth:i,fillOpacity:o,strokeOpacity:s}=this.properties;return{marker:{fill:t,stroke:e,fillOpacity:o,strokeOpacity:s,strokeWidth:i}}}getLegendData(t){if(t!=="category")return[];const{id:e,visible:i}=this,{yName:o,yLowName:s,yHighName:a,yLowKey:n,yHighKey:r,showInLegend:l}=this.properties,c=o??`${s??n} - ${a??r}`,h=`${n}-${r}`;return[{legendType:"category",id:e,itemId:h,seriesId:e,enabled:i,label:{text:`${c}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){const i=Fv(Vv(this.isVertical(),"normal"));Uv.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],i),Gv(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(t){const{datumSelection:e,labelSelection:i}=t,{processedData:o}=this,s=o?.reduced?.diff?.[this.id];this.ctx.animationManager.stopByAnimationGroupId(this.id);const a=Fv(Vv(this.isVertical(),"fade"));Uv.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],a,(n,r)=>this.getDatumId(r),s),Gv(this,"labels",this.ctx.animationManager,i)}getDatumId(t){return`${t.xValue}-${t.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t}){return gG(this.contextNodeData?.nodeData[t])}};Tu.className="RangeBarSeries",Tu.type="range-bar";import{_ModuleSupport as Ou}from"ag-charts-community";var bG={series:{direction:"vertical",strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:Ou.ThemeSymbols.DEFAULT_FONT_FAMILY,color:Ou.ThemeSymbols.DEFAULT_INSIDE_SERIES_LABEL_COLOUR,placement:"inside"}},axes:{[Ou.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{CARTESIAN_AXIS_TYPE:Hv,CARTESIAN_POSITION:Kv}=wv.ThemeConstants,vG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",moduleFactory:t=>new Tu(t),tooltipDefaults:{range:"exact"},defaultAxes:wv.swapAxisCondition([{type:Hv.NUMBER,position:Kv.LEFT},{type:Hv.CATEGORY,position:Kv.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:bG,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},groupable:!0};import{_ModuleSupport as MG}from"ag-charts-community";import{_ModuleSupport as kG}from"ag-charts-community";function Yv(t){t.nodes.sort((e,i)=>Math.round((e.datum.y-i.datum.y)*100)/100||-(e.datum.size-i.datum.size))}function AG({nodes:t,size:e},{seriesRectHeight:i,nodeSpacing:o,sizeScale:s}){const a=i*e*s;let r=(i-(a+o*(t.length-1)))/2;t.forEach(({datum:l})=>{const c=i*l.size*s;l.y=r,l.height=c,r+=c+o})}function DG(t,e){const{nodes:i}=t,{seriesRectHeight:o,nodeSpacing:s}=e;Yv(t);let a=0,n=0;for(const{datum:c}of i){const h=Math.max(n-c.y,0);c.y+=h,a+=h,n=c.y+c.height+s}if(n-s<o)return a>0;let l=o;for(let c=i.length-1;c>=0;c-=1){const{datum:h}=i[c],p=h.y+h.height,u=Math.min(l-p,0);h.y+=u,a+=u,l=h.y-s}return!0}function Lu(t,e,i,o,s,a,n,r){const l=(i-t)/(o-e),c=(n-s)/(r-a),h=((a-e)*(l*c)+t*c-s*l)/(c-l);return t<i?h>t&&h<Math.min(i,n):h<t&&h>Math.max(i,n)}function jv(t,e){let i=!1;const o=t.nodes.filter(a=>e(a).length===1);let s=!0;for(let a=0;s&&a<o.length;a+=1){s=!1;for(let n=0;n<o.length-1;n+=1){const{datum:r}=o[n],l=e(o[n])[0].node.datum,{datum:c}=o[n+1],h=e(o[n+1])[0].node.datum;if(!(Lu(r.x,r.y,l.x,l.y,c.x,c.y,h.x,h.y)||Lu(r.x,r.y+r.height/2,l.x,l.y+l.height/2,c.x,c.y+c.height/2,h.x,h.y+h.height/2)||Lu(r.x,r.y+r.height,l.x,l.y+l.height,c.x,c.y+c.height,h.x,h.y+h.height)))continue;const u=o[n];o[n]=o[n+1],o[n+1]=u;const g=r.y;r.y=c.y+c.height-r.height,c.y=g,i=!0,s=!0}}return i}function IG(t){let e=!1;return Yv(t),e=jv(t,i=>i.linksBefore)||e,e=jv(t,i=>i.linksAfter)||e,e}function TG(t){if(t.length===0)return;let e=0,i=0;for(const{node:{datum:o}}of t)e+=o.y*o.size,i+=o.size;return e/i}function Xv(t,e,i,o){return t.nodes.forEach(({datum:s,linksBefore:a,linksAfter:n})=>{const r=o===1?a:n,l=o===1?n:a,c=TG(r);if(c!=null){const h=l.length!==0?i:1;s.y=s.y+(c-s.y)*h}}),DG(t,e)}function Zv(t,e,i){let o=!1;for(const s of t)o=Xv(s,e,i,1)||o;return o}function OG(t,e,i){let o=!1;for(let s=t.length-1;s>=0;s-=1)o=Xv(t[s],e,i,-1)||o;return o}function $v(t){let e=!1;for(let i=t.length-1;i>=0;i-=1)e=IG(t[i])||e;return e}function LG(t,e){t.forEach(o=>{AG(o,e)});let i=!1;for(let o=0;o<6;o+=1){const s=Zv(t,e,1);i=OG(t,e,.5);const a=$v(t);if(!s&&!i&&!a)break}i&&(Zv(t,e,1),$v(t))}import{_ModuleSupport as NG}from"ag-charts-community";var{BBox:CG,Path:RG,ScenePathChangeDetection:Oa,splitBezier:EG}=NG;function $l(t,e,i,o,s,a,n,r,l,c){let h,p;if(s!==i&&l!==n){const k=-(o-e)/(s-i),A=-(r-a)/(l-n);h=(n-i+k*e-A*a)/(k-A),p=k*(h-e)+i}else if(s===i&&l!==n)h=e,p=-(r-a)/(l-n)*(h-r)+l;else if(s!==i&&l===n)h=r,p=-(o-e)/(s-i)*(h-e)+i;else throw new Error("Offsetting flat bezier curve");const u=Math.hypot(i-p,e-h),g=(u+c)/u,y=Math.hypot(l-p,r-h),f=(y+c)/y,m=h+(o-h)*g,S=p+(s-p)*g,b=h+(a-h)*f,v=p+(n-p)*f,x=h+(r-h)*f,M=p+(l-p)*f;t.cubicCurveTo(m,S,b,v,x,M)}var Os=class extends RG{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){const t=Math.min(this.x1,this.x2),e=Math.max(this.x1,this.x2)-t,i=Math.min(this.y1,this.y2),o=Math.max(this.y1,this.y2)-i+this.height;return new CG(t,i,e,o)}updatePath(){const{path:t,inset:e}=this;t.clear();const i=this.x1+e,o=this.x2-e,s=this.y1+e,a=this.y2+e,n=this.height-2*e;if(n<0||i>o)return;const r=i,l=s+n/2,c=(i+o)/2,h=s+n/2,p=(i+o)/2,u=a+n/2,g=o,y=a+n/2;if(t.moveTo(r,l-n/2),Math.abs(this.y2-this.y1)<1||this.x2-this.x1<this.height*Math.SQRT2)t.cubicCurveTo(c,h-n/2,p,u-n/2,g,y-n/2),t.lineTo(g,y+n/2),t.cubicCurveTo(p,u+n/2,c,h+n/2,r,l+n/2);else{const[f,m]=EG(r,l,c,h,p,u,g,y,.5),S=(a>s?1:-1)*n/2;$l(t,f[0].x,f[0].y,f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y,S),$l(t,m[0].x,m[0].y,m[1].x,m[1].y,m[2].x,m[2].y,m[3].x,m[3].y,-S),t.lineTo(g,y+n/2),$l(t,m[3].x,m[3].y,m[2].x,m[2].y,m[1].x,m[1].y,m[0].x,m[0].y,S),$l(t,f[3].x,f[3].y,f[2].x,f[2].y,f[1].x,f[1].y,f[0].x,f[0].y,-S)}t.closePath()}};d([Oa()],Os.prototype,"x1",2),d([Oa()],Os.prototype,"x2",2),d([Oa()],Os.prototype,"y1",2),d([Oa()],Os.prototype,"y2",2),d([Oa()],Os.prototype,"height",2),d([Oa()],Os.prototype,"inset",2);import{_ModuleSupport as wG}from"ag-charts-community";var{BaseProperties:Qv,SeriesTooltip:_G,SeriesProperties:PG,ARRAY:BG,COLOR_STRING:Ql,COLOR_STRING_ARRAY:qv,FUNCTION:Jv,LINE_DASH:tM,OBJECT:ql,POSITIVE_NUMBER:Ls,RATIO:Jl,STRING:Fo,UNION:zG,Validate:at,Label:FG}=wG,VG=zG(["left","right","center","justify"],"a justification value"),eM=class extends FG{constructor(){super(...arguments),this.spacing=1}};d([at(Ls)],eM.prototype,"spacing",2);var lo=class extends Qv{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([at(Ql,{optional:!0})],lo.prototype,"fill",2),d([at(Jl)],lo.prototype,"fillOpacity",2),d([at(Ql,{optional:!0})],lo.prototype,"stroke",2),d([at(Jl)],lo.prototype,"strokeOpacity",2),d([at(Ls)],lo.prototype,"strokeWidth",2),d([at(tM)],lo.prototype,"lineDash",2),d([at(Ls)],lo.prototype,"lineDashOffset",2),d([at(Jv,{optional:!0})],lo.prototype,"itemStyler",2);var Xe=class extends Qv{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([at(Ls)],Xe.prototype,"spacing",2),d([at(Ls)],Xe.prototype,"width",2),d([at(VG)],Xe.prototype,"alignment",2),d([at(Ql,{optional:!0})],Xe.prototype,"fill",2),d([at(Jl)],Xe.prototype,"fillOpacity",2),d([at(Ql,{optional:!0})],Xe.prototype,"stroke",2),d([at(Jl)],Xe.prototype,"strokeOpacity",2),d([at(Ls)],Xe.prototype,"strokeWidth",2),d([at(tM)],Xe.prototype,"lineDash",2),d([at(Ls)],Xe.prototype,"lineDashOffset",2),d([at(Jv,{optional:!0})],Xe.prototype,"itemStyler",2);var de=class extends PG{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fills=[],this.strokes=[],this.label=new eM,this.link=new lo,this.node=new Xe,this.tooltip=new _G}};d([at(BG,{optional:!0})],de.prototype,"nodes",2),d([at(Fo)],de.prototype,"fromKey",2),d([at(Fo)],de.prototype,"toKey",2),d([at(Fo)],de.prototype,"idKey",2),d([at(Fo,{optional:!0})],de.prototype,"idName",2),d([at(Fo,{optional:!0})],de.prototype,"labelKey",2),d([at(Fo,{optional:!0})],de.prototype,"labelName",2),d([at(Fo,{optional:!0})],de.prototype,"sizeKey",2),d([at(Fo,{optional:!0})],de.prototype,"sizeName",2),d([at(qv)],de.prototype,"fills",2),d([at(qv)],de.prototype,"strokes",2),d([at(ql)],de.prototype,"label",2),d([at(ql)],de.prototype,"link",2),d([at(ql)],de.prototype,"node",2),d([at(ql)],de.prototype,"tooltip",2);var{SeriesNodePickMode:iM,CachedTextMeasurerPool:GG,TextWrapper:oM,TextUtils:sM,createDatumId:tc,Logger:WG,Rect:UG,BBox:HG}=kG,Nu=class extends Jd{constructor(t){super({moduleCtx:t,pickModes:[iM.NEAREST_NODE,iM.EXACT_SHAPE_MATCH]}),this.properties=new de}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Os}nodeFactory(){return new UG}createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n},node:{spacing:r,width:l,alignment:c}}=this.properties,{nodeGraph:h,links:p,maxPathLength:u}=this.getNodeGraph(A=>({...A,x:NaN,y:NaN,width:l,height:NaN}),A=>({...A,x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),g=h,y=this.isLabelEnabled()?(e-l)*(1-u/(u+1)):0,f=(e-l-2*y)/(u-1),m=[];for(let A=0;A<u;A+=1){const I=y+A*f;m.push({index:A,size:0,nodes:[],x:I})}g.forEach(A=>{const{datum:I,linksBefore:O,linksAfter:T,maxPathLengthBefore:L,maxPathLengthAfter:C}=A,D=Math.max(O.reduce((F,{link:E})=>F+E.size,0),T.reduce((F,{link:E})=>F+E.size,0));if(O.length===0&&T.length===0||D===0){A.columnIndex=-1;return}let R;switch(c){case"left":R=m[L];break;case"right":R=m[u-1-C];break;case"center":{if(O.length!==0)R=m[L];else if(T.length!==0){const F=T.reduce((E,B)=>Math.min(E,B.node.maxPathLengthBefore),u)-1;R=m[F]}else R=m[0];break}case"justify":{R=T.length===0?m[u-1]:m[L];break}}I.x=R.x,I.size=D;const _=this.getLabelText(this.properties.label,{datum:I.datum,value:I.label,fromKey:o,toKey:s,sizeKey:a,size:D});I.label=String(_),R.nodes.push(A),R.size+=D,A.columnIndex=R.index}),g.forEach(A=>{let I=1/0,O=0;A.linksAfter.forEach(T=>{const L=T.node,{columnIndex:C}=L;C<I?(I=C,O=L.datum.size):C===I&&(O=Math.max(O,L.datum.size))}),A.closestColumnIndex=I,A.maxSizeOfClosestNodesAfter=O});const S=m.reduce((A,{size:I,nodes:O})=>{const T=(1-(O.length-1)*(r/i))/I;return Math.min(A,T)},1/0);for(let A=m.length-1;A>=0;A-=1)m[A].nodes.sort((O,T)=>O.closestColumnIndex-T.closestColumnIndex||O.maxSizeOfClosestNodesAfter-T.maxSizeOfClosestNodesAfter||O.datum.size-T.datum.size);LG(m,{seriesRectHeight:i,nodeSpacing:r,sizeScale:S});let b=!1;if(g.forEach(({datum:A,linksBefore:I,linksAfter:O})=>{b||(b=A.height<0);const T=A.y+A.height,L=R=>R.sort((_,F)=>{const E=_.node.datum,B=F.node.datum,P=E.y+E.height,N=B.y+B.height,w=Math.atan2(E.y-A.y,Math.abs(E.x-A.x))-Math.atan2(B.y-A.y,Math.abs(B.x-A.x)),z=Math.atan2(P-T,Math.abs(E.x-A.x))-Math.atan2(N-T,Math.abs(B.x-A.x));return w+z});let C=A.y;L(I).forEach(({link:R})=>{R.y2=C,C+=R.size*i*S});let D=A.y;L(O).forEach(({link:R})=>{R.y1=D,D+=R.size*i*S})}),b){WG.warnOnce("There was insufficient space to display the Sankey Series. Reduce the node spacing, or provide a larger container.");return}const v=[],x=[],{fontSize:M}=this.properties.label,k=this.properties.label.getFont();return m.forEach((A,I)=>{const O=I===0,T=I===m.length-1;let L=-1/0;A.nodes.sort((C,D)=>C.datum.y-D.datum.y),A.nodes.forEach(({datum:C})=>{if(C.midPoint={x:C.x+C.width/2,y:C.y+C.height/2},v.push(C),C.label==null)return;const D=O?C.x-n:C.x+C.width+n,R=C.y+C.height/2;let _;if(!O&&!T){const P=R-sM.getLineHeight(M),N=R+sM.getLineHeight(M);let w=e;g.forEach(({datum:V})=>{V.x>C.x&&Math.max(V.y,P)<=Math.min(V.y+V.height,N)&&(w=Math.min(w,V.x-n))});const z=w-C.x-2*n;_=oM.wrapText(C.label,{maxWidth:z,maxHeight:C.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(_==null||_===""){const P=O||T?n:n*2;_=oM.wrapText(C.label,{maxWidth:f-P,maxHeight:C.height,font:this.properties.label,textWrap:"never"})}if(_==="")return;const{height:F}=GG.measureText(_,{font:k,textAlign:"left",textBaseline:"middle"}),E=R-F/2,B=R+F/2;E>=L&&(x.push({x:D,y:R,leading:O,text:_}),L=B)})}),p.forEach(A=>{const{fromNode:I,toNode:O,size:T}=A;A.height=i*T*S,A.x1=I.x+l,A.x2=O.x,A.midPoint={x:(A.x1+A.x2)/2,y:(A.y1+A.y2)/2+A.height/2},v.push(A)}),{itemId:t,nodeData:v,labelData:x}}updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,leading:h,text:p})=>{r.visible=!0,r.x=l,r.y=c,r.text=p,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign=h?"right":"left",r.textBaseline="middle"})}updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>tc([e.type,e.id]))}getBaseNodeStyle(t){const{properties:e}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=e.node,l=this.getStrokeWidth(e.node.strokeWidth),c=t?e.highlightStyle.item:void 0;return{fill:c?.fill??i,fillOpacity:c?.fillOpacity??o,stroke:c?.stroke??s,strokeOpacity:c?.strokeOpacity??a,strokeWidth:c?.strokeWidth??l,lineDash:c?.lineDash??n,lineDashOffset:c?.lineDashOffset??r}}getNodeStyleOverrides(t,e,i,o,s,a,n){const{id:r,properties:l}=this,{fills:c,strokes:h}=l,{itemStyler:p}=l.node,u=a.fill??c[i%c.length],g=a.stroke??h[i%h.length],y={};if(n||(y.fill=u,y.stroke=g),p!=null){const f=this.cachedDatumCallback(tc(t,n?"highlight":"node"),()=>{const{fillOpacity:m=1,strokeOpacity:S=1,strokeWidth:b=0,lineDash:v=[],lineDashOffset:x=0}=a;return p({seriesId:r,datum:e,highlighted:n,label:s,size:o,fill:u,fillOpacity:m,stroke:g,strokeOpacity:S,strokeWidth:b,lineDash:v,lineDashOffset:x})});Object.assign(y,f)}return y}updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getBaseNodeStyle(i);e.each((s,a)=>{const{datumIndex:n,size:r,label:l}=a,c=this.getNodeStyleOverrides(String(n),a,n,r,l,o,i);s.x=a.x,s.y=a.y,s.width=Math.max(a.width,0),s.height=Math.max(a.height,0),s.fill=c?.fill??o.fill,s.fillOpacity=c?.fillOpacity??o.fillOpacity,s.stroke=c?.stroke??o.stroke,s.strokeOpacity=c?.strokeOpacity??o.strokeOpacity,s.strokeWidth=c?.strokeWidth??o.strokeWidth,s.lineDash=c?.lineDash??o.lineDash,s.lineDashOffset=c?.lineDashOffset??o.lineDashOffset})}updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>tc([e.type,e.index,e.fromNode.id,e.toNode.id]))}getBaseLinkStyle(t){const{properties:e}=this,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=e.link,l=this.getStrokeWidth(e.link.strokeWidth),c=t?e.highlightStyle.item:void 0;return{fill:c?.fill??i,fillOpacity:c?.fillOpacity??o,stroke:c?.stroke??s,strokeOpacity:c?.strokeOpacity??a,strokeWidth:c?.strokeWidth??l,lineDash:c?.lineDash??n,lineDashOffset:c?.lineDashOffset??r}}getLinkStyleOverrides(t,e,i,o,s){const{id:a,properties:n}=this,{fills:r,strokes:l}=n,{itemStyler:c}=n.link,h=o.fill??r[i%r.length],p=o.stroke??l[i%l.length],u={};if(s||(u.fill=h,u.stroke=p),c!=null){const g=this.cachedDatumCallback(tc(t,s?"highlight":"node"),()=>{const{fillOpacity:y=1,strokeOpacity:f=1,strokeWidth:m=0,lineDash:S=[],lineDashOffset:b=0}=o;return c({seriesId:a,datum:e,highlighted:s,fill:h,fillOpacity:y,stroke:p,strokeOpacity:f,strokeWidth:m,lineDash:S,lineDashOffset:b})});Object.assign(u,g)}return u}updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,o=this.getBaseLinkStyle(i);e.each((s,a)=>{const{datumIndex:n}=a,r=a.fromNode.datumIndex,l=this.getLinkStyleOverrides(String(n),a,r,o,i);s.x1=a.x1,s.y1=a.y1,s.x2=a.x2,s.y2=a.y2,s.height=a.height,s.fill=l?.fill??o?.fill,s.fillOpacity=l?.fillOpacity??o?.fillOpacity,s.stroke=l?.stroke??o?.stroke,s.strokeOpacity=l?.strokeOpacity??o?.strokeOpacity,s.strokeWidth=Math.min(l?.strokeWidth??o?.strokeWidth,a.height/2),s.lineDash=l?.lineDash??o?.lineDash,s.lineDashOffset=l?.lineDashOffset??o?.lineDashOffset,s.inset=s.strokeWidth/2})}getTooltipContent(t){const{id:e,processedData:i,nodesProcessedData:o,properties:s}=this,{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,{datumIndex:h}=t,p=t.type===0?t.fromNode.index:t.index,u=t.type===0?`${t.fromNode.label} - ${t.toNode.label}`:t.label,g=t.type===0?i?.rawData[t.datumIndex]:o?.rawData[t.datumIndex],y=t.size;let f;if(t.type===0){const m=t.fromNode.datumIndex,S=this.getBaseLinkStyle(!1);Object.assign(S,this.getLinkStyleOverrides(String(h),g,m,S,!1)),f=S}else{const m=t.label,S=this.getBaseNodeStyle(!1);Object.assign(S,this.getNodeStyleOverrides(String(h),g,h,y,m,S,!1)),f=S}return c.formatTooltip({title:u,symbol:this.legendItemSymbol(t.type,p,f),data:r!=null?[{label:l,fallbackLabel:r,value:String(y)}]:[]},{seriesId:e,datum:g,title:u,fromKey:a,toKey:n,sizeKey:r,sizeName:l,size:y,...f})}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t];if(e?.type===1){const{x:i,y:o,width:s,height:a}=e;return new HG(i,o,s,a)}else if(e?.type===0){for(const i of this.linkSelection)if(i.datum===e)return i.node;return}}};Nu.className="SankeySeries",Nu.type="sankey";var{DEFAULT_FONT_FAMILY:KG,DEFAULT_LABEL_COLOUR:YG}=MG.ThemeSymbols,jG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"sankey",moduleFactory:t=>new Nu(t),tooltipDefaults:{range:"exact"},themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:KG,color:YG,fontSize:12,spacing:10},node:{spacing:20,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0}},legend:{enabled:!1,toggleSeries:!1}},paletteFactory({takeColors:t,colorsCount:e}){return t(e)}};import{_ModuleSupport as XG}from"ag-charts-community";import{_ModuleSupport as aM}from"ag-charts-community";import{_ModuleSupport as ZG}from"ag-charts-community";var{HierarchySeriesProperties:$G,HighlightStyle:QG,SeriesTooltip:qG,Validate:Lt,COLOR_STRING:JG,FUNCTION:tW,NUMBER:nM,OBJECT:La,POSITIVE_NUMBER:Cu,RATIO:ec,STRING:ic}=ZG,Vo=class extends QG{constructor(){super(...arguments),this.label=new Ni,this.secondaryLabel=new Ni}};d([Lt(ic,{optional:!0})],Vo.prototype,"fill",2),d([Lt(ec,{optional:!0})],Vo.prototype,"fillOpacity",2),d([Lt(JG,{optional:!0})],Vo.prototype,"stroke",2),d([Lt(Cu,{optional:!0})],Vo.prototype,"strokeWidth",2),d([Lt(ec,{optional:!0})],Vo.prototype,"strokeOpacity",2),d([Lt(La)],Vo.prototype,"label",2),d([Lt(La)],Vo.prototype,"secondaryLabel",2);var ye=class extends $G{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new Vo,this.label=new Ni,this.secondaryLabel=new An,this.tooltip=new qG}};d([Lt(ic,{optional:!0})],ye.prototype,"sizeName",2),d([Lt(ic,{optional:!0})],ye.prototype,"labelKey",2),d([Lt(ic,{optional:!0})],ye.prototype,"secondaryLabelKey",2),d([Lt(ec)],ye.prototype,"fillOpacity",2),d([Lt(Cu)],ye.prototype,"strokeWidth",2),d([Lt(ec)],ye.prototype,"strokeOpacity",2),d([Lt(Cu)],ye.prototype,"cornerRadius",2),d([Lt(nM,{optional:!0})],ye.prototype,"sectorSpacing",2),d([Lt(nM,{optional:!0})],ye.prototype,"padding",2),d([Lt(tW,{optional:!0})],ye.prototype,"itemStyler",2),d([Lt(La)],ye.prototype,"highlightStyle",2),d([Lt(La)],ye.prototype,"label",2),d([Lt(La)],ye.prototype,"secondaryLabel",2),d([Lt(La)],ye.prototype,"tooltip",2);var{fromToMotion:eW,normalizeAngle360:iW,createDatumId:oW,Sector:zn,ScalableGroup:rM,Selection:Ru,TransformableText:Fn}=aM,lM=(t,e=0,i=2*Math.PI/t.sumSize,o=Array.from(t,()=>{}))=>{let s=e;for(const a of t.children){const n=s,r=s+a.sumSize*i;o[a.index]={start:n,end:r},lM(a,n,i,o),s=r}return o},Eu=class extends aM.HierarchySeries{constructor(){super(...arguments),this.properties=new ye,this.groupSelection=Ru.select(this.contentGroup,rM),this.highlightSelection=Ru.select(this.highlightGroup,rM),this.angleData=[]}processData(){const{childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n}=this.properties;super.processData(),this.angleData=lM(this.rootNode),this.labelData=Array.from(this.rootNode,({datum:r,depth:l})=>{let c;if(r!=null&&l!=null&&o!=null){const p=r[o];c=this.getLabelText(this.properties.label,{depth:l,datum:r,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:p})}c===""&&(c=void 0);let h;if(r!=null&&l!=null&&s!=null){const p=r[s];h=this.getLabelText(this.properties.secondaryLabel,{depth:l,datum:r,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:p})}return h===""&&(h=void 0),c!=null||h!=null?{label:c,secondaryLabel:h}:void 0})}updateSelections(){if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const i=Array.from(this.rootNode),o=s=>{s.append([new zn,new Fn({tag:0}),new Fn({tag:1})])};this.groupSelection.update(i,o,s=>this.getDatumId(s)),this.highlightSelection.update(i,o,s=>this.getDatumId(s))}getItemBaseStyle(t){const{properties:e}=this,i=t?e.highlightStyle:void 0;return{fill:i?.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??e.strokeWidth,strokeOpacity:i?.strokeOpacity??e.strokeOpacity}}getItemStyleOverrides(t,e,i,o,s,a,n){const{id:r,properties:l,colorScale:c}=this,{fills:h,strokes:p,itemStyler:u}=l,g=a.fill??h[i%h.length],y=a.stroke??p[i%p.length],f={};if(n||(f.fill=s!=null?c.convert(s):g,f.stroke=y),u!=null){const m=this.cachedDatumCallback(oW(t,n?"highlight":"node"),()=>u({seriesId:r,datum:e,depth:o,highlighted:n,fill:g,stroke:y,...a}));Object.assign(f,m)}return f}updateNodes(){const{chart:t,data:e,maxDepth:i,labelData:o}=this;if(t==null||e==null||o==null)return;const{width:s,height:a}=t.seriesRect,{sectorSpacing:n=0,padding:r=0,cornerRadius:l}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=a/2,this.highlightGroup.translationX=s/2,this.highlightGroup.translationY=a/2;const c=n*.5,p=Math.min(s,a)/2/(i+1),u=-Math.PI/2,g=this.ctx.highlightManager?.getActiveHighlight();new Fn().setFont(this.properties.label),this.rootNode.walk(x=>{const M=this.angleData[x.index];if(x.depth!=null&&M!=null){const k=M.end-M.start,A=(x.depth+.5)*p;x.midPoint.x=Math.cos(k)*A,x.midPoint.y=Math.sin(k)*A}});const f=(x,M,k,A)=>{const{datum:I,index:O,rootIndex:T,depth:L,colorValue:C}=x,D=this.angleData[O];if(L==null||D==null){M.visible=!1;return}M.visible=!0;const R=this.getItemStyleOverrides(String(O),I,T,L,C,k,A),_=R.strokeWidth??k.strokeWidth;M.fill=R.fill??k.fill,M.fillOpacity=R.fillOpacity??k.fillOpacity,M.stroke=R.stroke??k.stroke,M.strokeWidth=_,M.strokeOpacity=R.strokeOpacity??k.strokeOpacity,M.centerX=0,M.centerY=0,M.innerRadius=L*p,M.outerRadius=(L+1)*p,M.startAngle=D.start+u,M.endAngle=D.end+u,M.inset=c+_*.5,M.cornerRadius=l},m=this.getItemBaseStyle(!1);this.groupSelection.selectByClass(zn).forEach(x=>{f(x.datum,x,m,!1)});const S=this.getItemBaseStyle(!0);this.highlightSelection.selectByClass(zn).forEach(x=>{const M=x.datum,k=g===M;x.visible=k,x.visible&&f(x.datum,x,S,!0)});const b=Array.from(this.rootNode,(x,M)=>{const{depth:k}=x,A=o[M],I=this.angleData[M];if(k==null||I==null)return;const O=k*p+c,T=(k+1)*p-c,L=O>c?c/O:c,C=T>c?c/T:c,D=I.start+L,_=I.end+L-D,F=I.start+C,B=I.end+C-F,P=$=>{if(k===0&&x.parent?.sumSize===x.sumSize)return{width:2*Math.sqrt(T**2-($*.5)**2),height:$,meta:0};const q=$,J=2*Math.sqrt(T**2-(O+q)**2),X=_<Math.PI?2*O*Math.tan(_*.5):1/0,gt=Math.min(J,X),rt=Math.PI/4;let pt,xt;return k===0?(pt=$,xt=Math.sqrt(T**2-(pt/2)**2)-$/(2*Math.tan(B*.5))):iW(_)<rt?(pt=2*O*Math.tan(_*.5),xt=Math.sqrt(T**2-(pt/2)**2)-O):(xt=0,pt=0),gt>=xt?{width:gt,height:q,meta:1}:{width:xt,height:pt,meta:2}},N=cp(A?.label,this.properties.label,A?.secondaryLabel,this.properties.secondaryLabel,{padding:r},P);if(N==null)return;const{width:w,height:z,meta:V,label:G,secondaryLabel:W}=N,H=u+(I.start+I.end)/2,K=Math.sin(H)>=0,Q=Math.cos(H)>=0,st=(K?3:12)&(Q?6:9);let tt;switch(V){case 0:tt=0;break;case 1:{const j=T-(p-z)*.58,q=Math.sqrt((T-r)**2-(w/2)**2);tt=Math.min(j,q);break}case 2:if(k===0){const $=z/(2*Math.tan(_*.5))+w*.5,j=Math.sqrt(T**2-(z*.5)**2)-w*.5;tt=($+j)*.5}else tt=(O+T)*.5;break}return{width:w,height:z,labelPlacement:V,circleQuarter:st,radius:tt,theta:H,label:G,secondaryLabel:W}}),v=(x,M,k,A)=>{const{index:I,depth:O}=x,T=b?.[I],L=k===0?this.properties.label:this.properties.secondaryLabel,C=k===0?T?.label:T?.secondaryLabel;if(O==null||T==null||C==null){M.visible=!1;return}const{height:D,labelPlacement:R,circleQuarter:_,radius:F,theta:E}=T;let B;switch(A&&(B=(k===0?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color),M.text=C.text,M.fontSize=C.fontSize,M.lineHeight=C.lineHeight,M.fontStyle=L.fontStyle,M.fontFamily=L.fontFamily,M.fontWeight=L.fontWeight,M.fill=B??L.color,R){case 0:M.textAlign="center",M.textBaseline="top",M.translationX=0,M.translationY=(k===0?0:D-C.height)-D*.5,M.rotation=0;break;case 1:{const P=(_&3)!==0,N=k===0==!P?F:F-(D-C.height);M.textAlign="center",M.textBaseline=P?"bottom":"top",M.translationX=Math.cos(E)*N,M.translationY=Math.sin(E)*N,M.rotation=P?E-Math.PI*.5:E+Math.PI*.5;break}case 2:{const P=(_&6)!==0,N=k===0==!P?(D-C.height)*.5:(C.height-D)*.5;M.textAlign="center",M.textBaseline="middle",M.translationX=Math.cos(E)*F+Math.cos(E+Math.PI/2)*N,M.translationY=Math.sin(E)*F+Math.sin(E+Math.PI/2)*N,M.rotation=P?E:E+Math.PI;break}}M.visible=!0};this.groupSelection.selectByClass(Fn).forEach(x=>{v(x.datum,x,x.tag,!1)}),this.highlightSelection.selectByClass(Fn).forEach(x=>{const M=x.datum,k=g===M;x.visible=k,x.visible&&v(x.datum,x,x.tag,k)})}getTooltipContent(t){const{id:e,properties:i}=this,{labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,tooltip:h}=i,{datum:p,index:u,rootIndex:g,depth:y}=t;if(p==null||y==null)return;const f=[],m=n!=null?p[n]:void 0;m!=null&&f.push({label:r,fallbackLabel:n,value:m});const S=l!=null?p[l]:void 0;S!=null&&f.push({label:c,fallbackLabel:l,value:S});const b=this.getItemBaseStyle(!1);Object.assign(b,this.getItemStyleOverrides(String(u),p,g,y,S,b,!1));const v=b.fill;return h.formatTooltip({title:o!=null?p[o]:void 0,symbol:{marker:{shape:"square",fill:v,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1}},data:f},{seriesId:e,datum:p,title:void 0,depth:y,labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,...b})}createNodeData(){}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.groupSelection.selectByClass(zn))}animateEmptyUpdateReady({datumSelections:t}){eW(this.id,"nodes",this.ctx.animationManager,t,{toFn(){return{scalingX:1,scalingY:1}},fromFn(e,i,o){return o==="unknown"&&i!=null&&e.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}})}getAnimationData(){return{datumSelections:[this.groupSelection]}}computeFocusBounds(t){let e;for(const{node:i,datum:o}of this.groupSelection)o===t&&(e=Ru.selectByClass(i,zn)[0]);return e}};Eu.className="SunburstSeries",Eu.type="sunburst";var{DEFAULT_INSIDE_SERIES_LABEL_COLOUR:oc,DEFAULT_DIVERGING_SERIES_COLOR_RANGE:sW}=XG.ThemeSymbols,aW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",moduleFactory:t=>new Eu(t),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{label:{fontSize:14,minimumFontSize:9,color:oc,overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontSize:8,minimumFontSize:7,color:oc,overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:oc},secondaryLabel:{color:oc},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}},paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:o,strokes:s}=t(e),a=i.get(sW);return{fills:o,strokes:s,colorRange:a}}};import{_ModuleSupport as nW}from"ag-charts-community";import{_ModuleSupport as wu}from"ag-charts-community";import{_ModuleSupport as rW}from"ag-charts-community";var{BaseProperties:sc,HierarchySeriesProperties:lW,HighlightStyle:cW,SeriesTooltip:hW,Validate:Z,BOOLEAN:dW,COLOR_STRING:ac,FUNCTION:pW,NUMBER:uW,OBJECT:Ze,POSITIVE_NUMBER:_i,RATIO:Go,STRING:Ns,STRING_ARRAY:cM,TEXT_ALIGN:hM,VERTICAL_ALIGN:gW,Label:yW}=rW,dM=class extends yW{constructor(){super(...arguments),this.spacing=0}};d([Z(uW)],dM.prototype,"spacing",2);var $e=class extends sc{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new dM}};d([Z(Ns,{optional:!0})],$e.prototype,"fill",2),d([Z(Go)],$e.prototype,"fillOpacity",2),d([Z(ac,{optional:!0})],$e.prototype,"stroke",2),d([Z(_i)],$e.prototype,"strokeWidth",2),d([Z(Go)],$e.prototype,"strokeOpacity",2),d([Z(_i)],$e.prototype,"cornerRadius",2),d([Z(hM)],$e.prototype,"textAlign",2),d([Z(_i)],$e.prototype,"gap",2),d([Z(_i)],$e.prototype,"padding",2),d([Z(dW)],$e.prototype,"interactive",2),d([Z(Ze)],$e.prototype,"label",2);var Be=class extends sc{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new Ni,this.secondaryLabel=new An}};d([Z(Ns,{optional:!0})],Be.prototype,"fill",2),d([Z(Go)],Be.prototype,"fillOpacity",2),d([Z(ac,{optional:!0})],Be.prototype,"stroke",2),d([Z(_i,{optional:!0})],Be.prototype,"strokeWidth",2),d([Z(Go)],Be.prototype,"strokeOpacity",2),d([Z(_i)],Be.prototype,"cornerRadius",2),d([Z(hM)],Be.prototype,"textAlign",2),d([Z(gW)],Be.prototype,"verticalAlign",2),d([Z(_i)],Be.prototype,"gap",2),d([Z(_i)],Be.prototype,"padding",2),d([Z(Ze)],Be.prototype,"label",2),d([Z(Ze)],Be.prototype,"secondaryLabel",2);var Cs=class extends sc{constructor(){super(...arguments),this.label=new Ni}};d([Z(Ns,{optional:!0})],Cs.prototype,"fill",2),d([Z(Go,{optional:!0})],Cs.prototype,"fillOpacity",2),d([Z(ac,{optional:!0})],Cs.prototype,"stroke",2),d([Z(_i,{optional:!0})],Cs.prototype,"strokeWidth",2),d([Z(Go,{optional:!0})],Cs.prototype,"strokeOpacity",2),d([Z(Ze)],Cs.prototype,"label",2);var Wo=class extends sc{constructor(){super(...arguments),this.label=new Ni,this.secondaryLabel=new An}};d([Z(Ns,{optional:!0})],Wo.prototype,"fill",2),d([Z(Go,{optional:!0})],Wo.prototype,"fillOpacity",2),d([Z(ac,{optional:!0})],Wo.prototype,"stroke",2),d([Z(_i,{optional:!0})],Wo.prototype,"strokeWidth",2),d([Z(Go,{optional:!0})],Wo.prototype,"strokeOpacity",2),d([Z(Ze)],Wo.prototype,"label",2),d([Z(Ze)],Wo.prototype,"secondaryLabel",2);var _u=class extends cW{constructor(){super(...arguments),this.group=new Cs,this.tile=new Wo}};d([Z(Ze)],_u.prototype,"group",2),d([Z(Ze)],_u.prototype,"tile",2);var yi=class extends lW{constructor(){super(...arguments),this.highlightStyle=new _u,this.tooltip=new hW,this.group=new $e,this.tile=new Be,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};d([Z(Ns,{optional:!0})],yi.prototype,"sizeName",2),d([Z(Ns,{optional:!0})],yi.prototype,"labelKey",2),d([Z(Ns,{optional:!0})],yi.prototype,"secondaryLabelKey",2),d([Z(pW,{optional:!0})],yi.prototype,"itemStyler",2),d([Z(Ze)],yi.prototype,"highlightStyle",2),d([Z(Ze)],yi.prototype,"tooltip",2),d([Z(Ze)],yi.prototype,"group",2),d([Z(Ze)],yi.prototype,"tile",2),d([Z(cM)],yi.prototype,"undocumentedGroupFills",2),d([Z(cM)],yi.prototype,"undocumentedGroupStrokes",2);var{TextUtils:fW,TextWrapper:mW,clamp:xW,isNumberEqual:SW,createDatumId:pM,Rect:uM,Group:gM,BBox:nc,Selection:Pu,Text:rc}=wu,yM=new rc;function bW(t,e){const{fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a}=e;yM.setProperties({text:t,fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a,textAlign:"left",textBaseline:"top"});const{width:n,height:r}=yM.getBBox();return{width:n,height:r}}function Uo(t){return t.children.length>0?t.sumSize-t.sizeValue:t.sizeValue}var fM={left:0,center:.5,right:1},vW={top:0,middle:.5,bottom:1},HK=class extends wu.Group{distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}},Bu=class extends wu.HierarchySeries{constructor(){super(...arguments),this.properties=new yi,this.rectGroup=this.contentGroup.appendChild(new gM),this.rectSelection=Pu.select(this.rectGroup,uM),this.labelSelection=Pu.select(this.labelGroup,gM),this.highlightSelection=Pu.select(this.rectGroup,uM)}groupTitleHeight(t,e){const i=this.labelData?.[t.index]?.label,{label:o}=this.properties.group,s=3;if(i!=null){if(o.fontSize>e.width/s||o.fontSize>e.height/s)return;{const{height:a}=bW(i,o);return Math.max(a,o.fontSize)}}}getNodePadding(t,e){if(t.index===0)return{top:0,right:0,bottom:0,left:0};if(t.children.length===0){const{padding:n}=this.properties.tile;return{top:n,right:n,bottom:n,left:n}}const{label:{spacing:i},padding:o}=this.properties.group,s=this.groupTitleHeight(t,e),a=s!=null?s+i:0;return{top:o+a,right:o,bottom:o,left:o}}processData(){super.processData();const{childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,tile:r,group:l}=this.properties;if(!this.data?.length){this.labelData=void 0;return}this.labelData=Array.from(this.rootNode,({datum:c,depth:h,children:p})=>{const u=p.length===0,g=u?r.label:l.label;let y;if(c!=null&&h!=null&&o!=null){const m=c[o];y=this.getLabelText(g,{depth:h,datum:c,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:m})}y===""&&(y=void 0);let f;if(u&&c!=null&&h!=null&&s!=null){const m=c[s];f=this.getLabelText(r.secondaryLabel,{depth:h,datum:c,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:m})}return f===""&&(f=void 0),y!=null||f!=null?{label:y,secondaryLabel:f}:void 0})}sortChildren({children:t}){const e=Array.from(t,(o,s)=>s).filter(o=>Uo(t[o])>0).sort((o,s)=>Uo(t[s])-Uo(t[o]));return{sortedChildrenIndices:e,childAt:o=>{const s=e[o];return t[s]}}}squarify(t,e,i,o){const{index:s,datum:a,children:n}=t;if(e.width<=0||e.height<=0){i[s]=void 0,o[s]=void 0;return}const r=a!=null?this.getNodePadding(t,e):{top:0,right:0,bottom:0,left:0};i[s]=s===0?void 0:e,o[s]=s===0?void 0:r;const{sortedChildrenIndices:l,childAt:c}=this.sortChildren(t),h=l.every(I=>n[I].children.length===0),p=1,u=e.width-r.left-r.right,g=e.height-r.top-r.bottom;if(u<=0||g<=0)return;const y=l.length;let f=0,m=0,S=1/0,b=l.reduce((I,O)=>I+Uo(n[O]),0);const v=new nc(e.x+r.left,e.y+r.top,u,g),x=v.clone();let M=0;for(;M<y;){const I=Uo(c(M)),O=Uo(c(m)),T=x.width<x.height;f+=I;const L=T?x.height:x.width,C=T?x.width:x.height,D=C*O/f;let R=L*f/b;const _=Math.max(D,R)/Math.min(D,R),F=Math.abs(p-_);if(F<S){S=F,M++;continue}f-=I,R=L*f/b;let E=T?x.x:x.y;for(let B=m;B<M;B++){const P=c(B),N=Uo(P),w=T?E:x.x,z=T?x.y:E,V=C*N/f,G=T?V:R,W=T?R:V,H=new nc(w,z,G,W);this.applyGap(v,H,h),this.squarify(P,H,i,o),b-=N,E+=V}T?(x.y+=R,x.height-=R):(x.x+=R,x.width-=R),m=M,f=0,S=1/0}const k=x.width<x.height;let A=k?x.x:x.y;for(let I=m;I<y;I++){const O=c(I),T=k?A:x.x,L=k?x.y:A,C=Uo(O)/b,D=x.width*(k?C:1),R=x.height*(k?1:C),_=new nc(T,L,D,R);this.applyGap(v,_,h),this.squarify(O,_,i,o),A+=k?D:R}}applyGap(t,e,i){const o=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,s=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=s(t),n=s(e);["top","right","bottom","left"].forEach(l=>{SW(a[l],n[l])||e.shrink(o,l)})}createNodeData(){}getGroupBaseStyle(t){const{properties:e}=this,{group:i}=e,o=t?e.highlightStyle.group:void 0;return{fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??i.strokeWidth,strokeOpacity:o?.strokeOpacity??i.strokeOpacity}}getGroupStyleOverrides(t,e,i,o,s){const{id:a,properties:n}=this,{undocumentedGroupFills:r,undocumentedGroupStrokes:l,itemStyler:c}=n,h=o.fill??r[Math.min(i??0,r.length)],p=o.stroke??l[Math.min(i??0,l.length)],u={};if(s||(u.fill=h,u.stroke=p),c!=null){const g=this.cachedDatumCallback(pM(t,s?"highlight":"node"),()=>c({seriesId:a,datum:e,depth:i,highlighted:s,fill:h,stroke:p,...o}));Object.assign(u,g)}return u}getTileBaseStyle(t){const{properties:e}=this,{tile:i}=e,o=t?e.highlightStyle.tile:void 0;return{fill:o?.fill??i.fill,fillOpacity:o?.fillOpacity??i.fillOpacity,stroke:o?.stroke??i.stroke,strokeWidth:o?.strokeWidth??i.strokeWidth,strokeOpacity:o?.strokeOpacity??i.strokeOpacity}}getTileStyleOverrides(t,e,i,o,s,a,n){const{id:r,properties:l,colorScale:c}=this,{fills:h,strokes:p,itemStyler:u}=l,g=a.fill??h[o%h.length],y=a.stroke??p[o%p.length],f={};if(n||(f.fill=s!=null?c.convert(s):g,f.stroke=y),u!=null){const m=this.cachedDatumCallback(pM(t,n?"highlight":"node"),()=>u({seriesId:r,datum:e,depth:i,highlighted:n,fill:g,stroke:y,...a}));Object.assign(f,m)}return f}updateSelections(){let t=this.ctx.highlightManager?.getActiveHighlight();if(t!=null&&!this.properties.group.interactive&&t.children.length!==0&&(t=void 0),this.highlightSelection.update(t!=null?[t]:[],void 0,s=>this.getDatumId(s)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:e}=this.chart??{};if(!e)return;const i=Array.from(this.rootNode),o=s=>{s.append([new rc({tag:0}),new rc({tag:1})])};this.rectSelection.update(i,void 0,s=>this.getDatumId(s)),this.labelSelection.update(i,o,s=>this.getDatumId(s))}updateNodes(){const{rootNode:t,data:e}=this,{highlightStyle:i,tile:o,group:s}=this.properties,{seriesRect:a}=this.chart??{};if(!a||!e)return;const{width:n,height:r}=a,l=Array.from(this.rootNode,()=>{}),c=Array.from(this.rootNode,()=>{});this.squarify(t,new nc(0,0,n,r),l,c),this.updateNodeMidPoint(l);const h=(S,b,v,x,M)=>{const k=l[S.index];if(k==null){b.visible=!1;return}const{datum:A,depth:I=-1,index:O,rootIndex:T,colorValue:L}=S,C=S.children.length===0,D=C?x:v,R=C?this.getTileStyleOverrides(String(O),A,I,T,L,D,M):this.getGroupStyleOverrides(String(O),A,I,D,M);b.crisp=!0,b.fill=R?.fill??D.fill,b.fillOpacity=R?.fillOpacity??D.fillOpacity,b.stroke=R?.stroke??D.stroke,b.strokeWidth=R?.strokeWidth??D.strokeWidth,b.strokeOpacity=R?.strokeOpacity??D.strokeOpacity,b.cornerRadius=C?o.cornerRadius:s.cornerRadius,b.zIndex=[0,I,M?1:0];const _=S.parent?.children.every(B=>B.children.length===0),F=S.parent!=null?l[S.parent.index]:void 0,E=S.parent!=null?c[S.parent.index]:void 0;_===!0&&F!=null&&E!=null?(b.clipBBox=k,b.x=F.x+E.left,b.y=F.y+E.top,b.width=F.width-(E.left+E.right),b.height=F.height-(E.top+E.bottom)):(b.clipBBox=void 0,b.x=k.x,b.y=k.y,b.width=k.width,b.height=k.height),b.visible=!0},p=this.getGroupBaseStyle(!1),u=this.getTileBaseStyle(!1);this.rectSelection.each((S,b)=>h(b,S,p,u,!1));const g=this.getGroupBaseStyle(!0),y=this.getTileBaseStyle(!0);this.highlightSelection.each((S,b)=>{h(b,S,g,y,!0)});const f=Array.from(this.rootNode,S=>{const{index:b,children:v}=S,x=l[b],M=this.labelData?.[b];if(!(x==null||M==null))if(v.length===0){const k={width:x.width,height:x.height,meta:null},A=cp(M.label,this.properties.tile.label,M.secondaryLabel,this.properties.tile.secondaryLabel,{padding:o.padding},()=>k);if(A==null)return;const{height:I,label:O,secondaryLabel:T}=A,{textAlign:L,verticalAlign:C,padding:D}=o,R=fM[L]??.5,_=x.x+D+(x.width-2*D)*R,F=vW[C]??.5,E=x.y+D+I*.5+(x.height-2*D-I)*F;return{label:O!=null?{text:O.text,fontSize:O.fontSize,lineHeight:O.lineHeight,style:this.properties.tile.label,x:_,y:E-(I-O.height)*.5}:void 0,secondaryLabel:T!=null?{text:T.text,fontSize:T.fontSize,lineHeight:T.fontSize,style:this.properties.tile.secondaryLabel,x:_,y:E+(I-T.height)*.5}:void 0,verticalAlign:"middle",textAlign:L}}else{if(M?.label==null)return;{const{padding:k,textAlign:A}=s,I=this.groupTitleHeight(S,x);if(I==null)return;const O=x.width-2*k,T=mW.wrapText(M.label,{maxWidth:x.width-2*k,font:s.label,textWrap:"never"}),L=fM[A]??.5;return{label:{text:T,fontSize:s.label.fontSize,lineHeight:fW.getLineHeight(s.label.fontSize),style:this.properties.group.label,x:x.x+k+O*L,y:x.y+k+I*.5},secondaryLabel:void 0,verticalAlign:"middle",textAlign:A}}}}),m=(S,b,v,x)=>{const M=S.children.length===0,k=f[S.index],A=v===0?k?.label:k?.secondaryLabel;if(k==null||A==null){b.visible=!1;return}let I;if(x){const{tile:O,group:T}=i;I=O.secondaryLabel.color,M?v===0&&(I=O.label.color):I=T.label.color}b.text=A.text,b.fontSize=A.fontSize,b.lineHeight=A.lineHeight,b.fontStyle=A.style.fontStyle,b.fontFamily=A.style.fontFamily,b.fontWeight=A.style.fontWeight,b.fill=I??A.style.color,b.textAlign=k.textAlign,b.textBaseline=k.verticalAlign,b.x=A.x,b.y=A.y,b.visible=!0,b.zIndex=1};this.labelSelection.selectByClass(rc).forEach(S=>{m(S.datum,S,S.tag,!1)})}updateNodeMidPoint(t){this.rootNode.walk(e=>{const i=t[e.index];i!=null&&(e.midPoint.x=i.x+i.width/2,e.midPoint.y=i.y)})}pickNodeClosestDatum(t){const e=this.pickNodeExactShape(t);return e!==void 0?e:this.pickNodeNearestDistantObject(t,this.rectSelection.nodes())}getTooltipContent(t){const{id:e,properties:i}=this,{labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,tooltip:h}=i,{datum:p,index:u,rootIndex:g,depth:y,children:f}=t;if(p==null||y==null)return;const m=f.length===0,S=[],b=n!=null?p[n]:void 0;b!=null&&S.push({label:r,fallbackLabel:n,value:b});const v=l!=null?p[l]:void 0;v!=null&&S.push({label:c,fallbackLabel:l,value:v});let x;m?(x=this.getTileBaseStyle(!1),Object.assign(x,this.getTileStyleOverrides(String(u),p,y,g,v,x,!1))):(x=this.getGroupBaseStyle(!1),Object.assign(x,this.getGroupStyleOverrides(String(u),p,y,x,!1)));const M=x.fill,k=m?{marker:{shape:"square",fill:M,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1}}:void 0;return h.formatTooltip({title:o!=null?p[o]:void 0,symbol:k,data:S},{seriesId:e,datum:p,title:void 0,depth:y,labelKey:o,secondaryLabelKey:s,childrenKey:a,sizeKey:n,sizeName:r,colorKey:l,colorName:c,...x})}pickFocus(t){const{focusPath:e}=this;(e.length<2||this.focusSorted==null)&&(e.length=1,this.focusSorted=this.sortChildren(e[0].nodeDatum),e.push({nodeDatum:this.focusSorted.childAt(0),childIndex:0}));const{datumIndexDelta:i,otherIndexDelta:o}=t,s=e[e.length-1];if(o===1){if(s.nodeDatum.children.length>0){this.focusSorted=this.sortChildren(s.nodeDatum);const n={nodeDatum:this.focusSorted.childAt(0),childIndex:0};return e.push(n),this.computeFocusOutputs(n)}}else if(i!==0){const n=s.childIndex+i,r=(s.nodeDatum.parent?.children.length??1)-1;return s.childIndex=xW(0,n,r),s.nodeDatum=this.focusSorted.childAt(s.childIndex),this.computeFocusOutputs(s)}const a=super.pickFocus(t);return o<0&&(this.focusSorted=this.sortChildren(e[e.length-1].nodeDatum.parent)),a}getAnimationData(){return{datumSelections:[]}}computeFocusBounds(t){return this.rectSelection.at(t.index)?.getBBox()}};Bu.className="TreemapSeries",Bu.type="treemap";var{DEFAULT_DIVERGING_SERIES_COLOR_RANGE:MW,DEFAULT_FONT_FAMILY:zu,DEFAULT_HIERARCHY_FILLS:kW,DEFAULT_HIERARCHY_STROKES:AW,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:lc,DEFAULT_LABEL_COLOUR:mM}=nW.ThemeSymbols,DW={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",moduleFactory:t=>new Bu(t),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{group:{label:{enabled:!0,color:mM,fontStyle:void 0,fontWeight:"normal",fontSize:12,fontFamily:zu,spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:lc,fontStyle:void 0,fontWeight:"normal",fontSize:18,minimumFontSize:10,fontFamily:zu,wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:lc,fontStyle:void 0,fontWeight:void 0,fontSize:12,minimumFontSize:10,fontFamily:zu,wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:mM},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:lc},secondaryLabel:{color:lc},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}},paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:o,strokes:s}=t(e),a=i.get(MW),n=i.get(kW),r=i.get(AW);return{fills:o,strokes:s,colorRange:a,undocumentedGroupFills:n,undocumentedGroupStrokes:r}}};import{_ModuleSupport as xM}from"ag-charts-community";import{_ModuleSupport as Rs}from"ag-charts-community";import{_ModuleSupport as IW}from"ag-charts-community";var{AbstractBarSeriesProperties:TW,BaseProperties:Vn,PropertiesArray:OW,SeriesTooltip:LW,Validate:ot,BOOLEAN:NW,COLOR_STRING:Fu,FUNCTION:SM,LINE_DASH:bM,NUMBER:CW,OBJECT:co,OBJECT_ARRAY:RW,POSITIVE_NUMBER:Na,RATIO:Vu,STRING:Ca,UNION:vM,DropShadow:EW,Label:wW}=IW,cc=class extends Vn{};d([ot(vM(["subtotal","total"],"a total type"))],cc.prototype,"totalType",2),d([ot(CW)],cc.prototype,"index",2),d([ot(Ca)],cc.prototype,"axisLabel",2);var MM=class extends Vn{};d([ot(SM,{optional:!0})],MM.prototype,"renderer",2);var Gu=class extends wW{constructor(){super(...arguments),this.placement="outside-end",this.padding=6}};d([ot(vM(["inside-center","inside-start","inside-end","outside-start","outside-end"],"a placement"))],Gu.prototype,"placement",2),d([ot(Na)],Gu.prototype,"padding",2);var pe=class extends Vn{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new EW().set({enabled:!1}),this.label=new Gu,this.tooltip=new MM}};d([ot(Ca,{optional:!0})],pe.prototype,"name",2),d([ot(Fu)],pe.prototype,"fill",2),d([ot(Fu)],pe.prototype,"stroke",2),d([ot(Vu)],pe.prototype,"fillOpacity",2),d([ot(Vu)],pe.prototype,"strokeOpacity",2),d([ot(bM)],pe.prototype,"lineDash",2),d([ot(Na)],pe.prototype,"lineDashOffset",2),d([ot(Na)],pe.prototype,"strokeWidth",2),d([ot(Na)],pe.prototype,"cornerRadius",2),d([ot(SM,{optional:!0})],pe.prototype,"itemStyler",2),d([ot(co)],pe.prototype,"shadow",2),d([ot(co)],pe.prototype,"label",2),d([ot(co)],pe.prototype,"tooltip",2);var Es=class extends Vn{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};d([ot(NW)],Es.prototype,"enabled",2),d([ot(Fu)],Es.prototype,"stroke",2),d([ot(Vu)],Es.prototype,"strokeOpacity",2),d([ot(bM)],Es.prototype,"lineDash",2),d([ot(Na)],Es.prototype,"lineDashOffset",2),d([ot(Na)],Es.prototype,"strokeWidth",2);var hc=class extends Vn{constructor(){super(...arguments),this.positive=new pe,this.negative=new pe,this.total=new pe}};d([ot(co)],hc.prototype,"positive",2),d([ot(co)],hc.prototype,"negative",2),d([ot(co)],hc.prototype,"total",2);var ho=class extends TW{constructor(){super(...arguments),this.item=new hc,this.totals=new OW(cc),this.line=new Es,this.tooltip=new LW}};d([ot(Ca)],ho.prototype,"xKey",2),d([ot(Ca)],ho.prototype,"yKey",2),d([ot(Ca,{optional:!0})],ho.prototype,"xName",2),d([ot(Ca,{optional:!0})],ho.prototype,"yName",2),d([ot(co)],ho.prototype,"item",2),d([ot(RW)],ho.prototype,"totals",2),d([ot(co)],ho.prototype,"line",2),d([ot(co)],ho.prototype,"tooltip",2);var{adjustLabelPlacement:_W,SeriesNodePickMode:kM,fixNumericExtent:PW,valueProperty:AM,keyProperty:BW,accumulativeValueProperty:dc,trailingAccumulatedValueProperty:zW,ChartAxisDirection:Wu,getRectConfig:FW,createDatumId:DM,updateRect:VW,checkCrisp:GW,updateLabelNode:WW,prepareBarAnimationFunctions:UW,collapsedStartingBarPosition:HW,resetBarSelectionsFn:KW,seriesLabelFadeInAnimation:YW,resetLabelFn:jW,animationValidation:XW,DEFAULT_CARTESIAN_DIRECTION_KEYS:ZW,DEFAULT_CARTESIAN_DIRECTION_NAMES:$W,computeBarFocusBounds:QW,isContinuous:IM,Rect:qW,motion:JW}=Rs,Uu=class extends Rs.AbstractBarSeries{constructor(t){super({moduleCtx:t,directionKeys:ZW,directionNames:$W,pickModes:[kM.NEAREST_NODE,kM.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:KW,label:jW}}),this.properties=new ho,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(t){const{xKey:e,yKey:i,totals:o}=this.properties,{data:s=[]}=this;if(!this.properties.isValid()||!this.visible)return;const a=b=>IM(b)&&Number(b)>=0,n=b=>IM(b)&&Number(b)>=0,r=b=>b==="total"||b==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=o.reduce((b,v)=>{const x=b.get(v.index);return x?x.push(v):b.set(v.index,[v]),b},new Map);s.forEach((b,v)=>{c.push(b),h.get(v)?.forEach(x=>c.push({...x.toJson(),[e]:x.axisLabel}))});const p=[];this.ctx.animationManager.isSkipped()||p.push(XW());const u=this.getCategoryAxis()?.scale,g=this.getValueAxis()?.scale,{isContinuousX:y,xScaleType:f,yScaleType:m}=this.getScaleInformation({xScale:u,yScale:g}),{processedData:S}=await this.requestDataModel(t,c,{props:[BW(e,f,{id:"xValue"}),dc(i,m,{...l,id:"yCurrent"}),dc(i,m,{...l,missingValue:0,id:"yCurrentTotal"}),dc(i,m,{...l,id:"yCurrentPositive",validation:a}),dc(i,m,{...l,id:"yCurrentNegative",validation:n}),zW(i,m,{...l,id:"yPrevious"}),AM(i,m,{id:"yRaw"}),AM("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:r}),...y?[Rs.SMALLEST_KEY_INTERVAL,Rs.LARGEST_KEY_INTERVAL]:[],...p]});this.smallestDataInterval=S.reduced?.smallestKeyInterval,this.largestDataInterval=S.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o],values:s}=e.domain;if(t===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if(a?.def.type==="key"&&a?.def.valueType==="category")return o;const n=t===Wu.Y,r=this.getCategoryAxis().isReversed();return this.padBandExtent(o,r!==n)}else{const a=i.resolveProcessedDataIndexById(this,"yCurrent"),n=s[a],r=[Math.min(0,n[0]),Math.max(0,n[1])];return PW(r)}}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){const{data:t,dataModel:e,processedData:i}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!t||!o||!s||!e||i==null||i.rawData.length===0)return;const{line:a}=this.properties,n=o.scale,r=s.scale,l=this.getBarDirection()===Wu.X,c=this.getBandwidth(o)??10,h=o.isReversed(),p=s.isReversed();if(i.type!=="ungrouped")return;const u={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return u;const g=[],y=e.resolveKeysById(this,"xValue",i),f=e.resolveColumnById(this,"yRaw",i),m=e.resolveColumnById(this,"totalTypeValue",i),S=e.resolveColumnById(this,"yCurrent",i),b=e.resolveColumnById(this,"yPrevious",i),v=e.resolveColumnById(this,"yCurrentTotal",i);function x(C,D,R){return C||D?{cumulativeValue:v[R],trailingValue:D?k:0}:{cumulativeValue:S[R],trailingValue:b[R]}}function M(C,D,R,_,F){return C?_:D?(_??0)-(F??0):R}let k=0;const{xKey:A,yKey:I,xName:O,yName:T}=this.properties;i.rawData.forEach((C,D)=>{const R=m[D],_=this.isSubtotal(R),F=this.isTotal(R),E=F||_,B=y[D];if(B==null)return;const P=Math.round(n.convert(B)),N=f[D],{cumulativeValue:w,trailingValue:z}=x(F,_,D);E&&(k=w??0);const V=Math.round(r.convert(w)),G=Math.round(r.convert(z)),W=M(F,_,N,w,z),H=(W??0)>=0,K=this.getSeriesItemType(H,R),{fill:Q,stroke:st,strokeWidth:tt,label:$}=this.getItemConfig(K),j=H?V:G,q=H?G:V,J=Math.max(tt,Math.abs(q-j)),X={x:l?Math.min(j,q):P,y:l?P:Math.min(j,q),width:l?J:c,height:l?c:J},gt={x:X.x+X.width/2,y:X.y+X.height/2},rt=E?V:G,pt=Math.floor(a.strokeWidth)%2/2,xt=h?V:rt,ze=h?rt:V;let ee,Te;l?(ee={x:xt+pt,y:X.y},Te={x:ze+pt,y:X.y+X.height}):(ee={x:X.x,y:xt+pt},Te={x:X.x+X.width,y:ze+pt});const Ho={x:h?Te.x:ee.x,y:h?Te.y:ee.y,x2:h?ee.x:Te.x,y2:h?ee.y:Te.y,size:0};g.push(Ho);const Pi=K==="subtotal"?"total":K,ws=this.getLabelText($,{itemId:Pi,value:W,datum:C,xKey:A,yKey:I,xName:O,yName:T}),Ra={index:D,series:this,itemId:K,datum:C,datumIndex:D,cumulativeValue:w??0,xValue:B,yValue:W,yKey:I,xKey:A,x:X.x,y:X.y,width:X.width,height:X.height,midPoint:gt,fill:Q,stroke:st,strokeWidth:tt,opacity:1,label:{text:ws,..._W({isUpward:(W??-1)>=0!==p,isVertical:!l,placement:$.placement,padding:$.padding,rect:X})}};u.nodeData.push(Ra),u.labelData.push(Ra)});const L=this.properties.line.enabled;return S!=null&&L&&(u.pointData=g),u}updateSeriesItemTypes(){const{dataModel:t,seriesItemTypes:e,processedData:i}=this;if(!t||!i)return;e.clear();const o=t.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=t.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=t.resolveProcessedDataIndexById(this,"totalTypeValue"),n=i.domain.values[o]??[],r=i.domain.values[s]??[];n.length>0&&e.add("positive"),r.length>0&&e.add("negative");const l=i?.domain.values[a];l&&l.forEach(c=>{(c==="total"||c==="subtotal")&&e.add("total")})}isSubtotal(t){return t==="subtotal"}isTotal(t){return t==="total"}nodeFactory(){return new qW}getSeriesItemType(t,e){return e??(t?"positive":"negative")}getItemConfig(t){switch(t){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}getItemStyle(t,e,i,o){const{id:s,properties:a}=this,n=a.item[i==="subtotal"?"total":i],r=o?a.highlightStyle.item:void 0,{itemStyler:l}=n,{xKey:c,yKey:h}=a,p={fill:r?.fill??n.fill,fillOpacity:r?.fillOpacity??n.fillOpacity,stroke:r?.stroke??n.stroke,strokeWidth:r?.strokeWidth??n.strokeWidth,strokeOpacity:r?.strokeOpacity??n.strokeOpacity,lineDash:r?.lineDash??n.lineDash??[],lineDashOffset:r?.lineDashOffset??n.lineDashOffset,cornerRadius:n.cornerRadius};if(l!=null){const u=this.cachedDatumCallback(DM(t,o?"highlight":"node"),()=>l({seriesId:s,itemId:i,datum:e,xKey:c,yKey:h,highlighted:o,...p}));Object.assign(p,u)}return p}updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o}=this,{yKey:s,highlightStyle:{item:a}}=this.properties,n=this.getCategoryAxis(),r=GW(n?.scale,n?.visibleRange,this.smallestDataInterval,this.largestDataInterval),l=this.getCategoryDirection()===Wu.X;e.each((c,h)=>{const p=h.itemId,{fillOpacity:u,strokeOpacity:g,strokeWidth:y,lineDash:f,lineDashOffset:m,cornerRadius:S,itemStyler:b,shadow:v}=this.getItemConfig(p),x={fill:h.fill,stroke:h.stroke,fillOpacity:u,strokeOpacity:g,lineDash:f,lineDashOffset:m,fillShadow:v,strokeWidth:this.getStrokeWidth(y),cornerRadius:S},M=l?h.width>0:h.height>0,k=FW(this,DM(h.index,"node"),{datum:h,isHighlighted:i,style:x,highlightStyle:a,itemStyler:b,seriesId:o,itemId:h.itemId,value:h.yValue,yKey:s});k.crisp=r,k.visible=M,VW(c,k)})}updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;if(e.length===0)return i.update([]);const o=e.filter(s=>{const{label:a}=this.getItemConfig(s.itemId);return a.enabled});return i.update(o)}updateLabelNodes(t){t.labelSelection.each((e,i)=>{WW(e,this.getItemConfig(i.itemId).label,i.label)})}getTooltipContent(t){const{id:e,dataModel:i,processedData:o,properties:s}=this,{xKey:a,xName:n,yKey:r,yName:l,tooltip:c}=s,h=this.getCategoryAxis(),p=this.getValueAxis();if(!i||!o||o.rawData.length===0||!h||!p)return;const{datumIndex:u}=t,g=o.rawData[u],y=i.resolveKeysById(this,"xValue",o)[u],f=i.resolveColumnById(this,"yRaw",o)[u],m=i.resolveColumnById(this,"yCurrentTotal",o),S=i.resolveColumnById(this,"totalTypeValue",o);if(y==null)return;const b=S[u],v=(f??0)>=0,x=this.getSeriesItemType(v,b);let M;if(this.isTotal(b))M=m[u];else if(this.isSubtotal(b)){M=m[u];for(let A=u-1;A>=0;A-=1)if(this.isSubtotal(S[A])){M=M-m[A];break}}else M=f;const k=this.getItemStyle(String(u),g,x,!1);return c.formatTooltip({heading:h.formatDatum(y),symbol:this.legendItemSymbol(x),data:[{label:l,fallbackLabel:r,value:p.formatDatum(M)}]},{seriesId:e,datum:g,title:l,itemId:x,xKey:a,xName:n,yKey:r,yName:l,...k})}legendItemSymbol(t){const{fill:e,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a}=this.getItemConfig(t);return{marker:{fill:e,stroke:i,fillOpacity:o,strokeOpacity:s,strokeWidth:a}}}getLegendData(t){if(t!=="category")return[];const{id:e,seriesItemTypes:i}=this,o=[],s=n=>n.charAt(0).toUpperCase()+n.substring(1),{showInLegend:a}=this.properties;return i.forEach(n=>{const{name:r}=this.getItemConfig(n);o.push({legendType:"category",id:e,itemId:n,seriesId:e,enabled:!0,label:{text:r??s(n)},symbol:this.legendItemSymbol(n),hideInLegend:!a,isFixed:!0})}),o}toggleSeriesItem(){}animateEmptyUpdateReady({datumSelection:t,labelSelection:e,contextData:i,paths:o}){const s=UW(HW(this.isVertical(),this.axes,"normal"));JW.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s),YW(this,"labels",this.ctx.animationManager,e);const{pointData:a}=i;if(!a)return;const[n]=o;this.isVertical()?this.animateConnectorLinesVertical(n,a):this.animateConnectorLinesHorizontal(n,a)}animateConnectorLinesHorizontal(t,e){const{path:i}=t;this.updateLineNode(t);const o=this.getValueAxis(),s=o?.isReversed(),a=s?(c,h)=>c<h:(c,h)=>c>h,n=o?.scale.convert(0),r=e.reduce((c,h)=>(a(h.x,c)&&(c=h.x),c),s?1/0:0),l=(c,h,p,u,g)=>(c-h)/(p-h)*(g-u)+u;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:n,to:r,ease:Rs.Motion.easeOut,collapsable:!1,onUpdate(c){i.clear(!0),e.forEach((h,p)=>{const u=l(c,n,r,n,h.x),g=l(c,n,r,n,h.x2);p!==0&&i.lineTo(u,h.y),i.moveTo(g,h.y2)}),t.checkPathDirty()}})}animateConnectorLinesVertical(t,e){const{path:i}=t;this.updateLineNode(t);const o=this.getValueAxis(),s=o?.isReversed(),a=s?(c,h)=>c>h:(c,h)=>c<h,n=o?.scale.convert(0),r=e.reduce((c,h)=>(a(h.y,c)&&(c=h.y),c),s?0:1/0),l=(c,h,p,u,g)=>(c-h)/(p-h)*(g-u)+u;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:n,to:r,ease:Rs.Motion.easeOut,collapsable:!1,onUpdate(c){i.clear(!0),e.forEach((h,p)=>{const u=l(c,n,r,n,h.y),g=l(c,n,r,n,h.y2);p!==0&&i.lineTo(h.x,u),i.moveTo(h.x2,g)}),t.checkPathDirty()}})}animateReadyResize(t){super.animateReadyResize(t),this.resetConnectorLinesPath(t)}updatePaths(t){this.resetConnectorLinesPath({contextData:t.contextData,paths:t.paths})}resetConnectorLinesPath({contextData:t,paths:e}){if(e.length===0)return;const[i]=e;this.updateLineNode(i);const{path:o}=i;o.clear(!0);const{pointData:s}=t;s&&(s.forEach((a,n)=>{n!==0&&o.lineTo(a.x,a.y),o.moveTo(a.x2,a.y2)}),i.checkPathDirty())}updateLineNode(t){const{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=this.properties.line;t.setProperties({fill:void 0,stroke:e,strokeWidth:this.getStrokeWidth(i),strokeOpacity:o,lineDash:s,lineDashOffset:a,lineJoin:"round",pointerEvents:Rs.PointerEvents.None})}isLabelEnabled(){const{positive:t,negative:e,total:i}=this.properties.item;return t.label.enabled||e.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t}){return QW(this.contextNodeData?.nodeData[t])}};Uu.className="WaterfallSeries",Uu.type="waterfall";import{_ModuleSupport as Hu}from"ag-charts-community";var Ku={strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:"normal",fontSize:12,fontFamily:Hu.ThemeSymbols.DEFAULT_FONT_FAMILY,color:Hu.ThemeSymbols.DEFAULT_LABEL_COLOUR,formatter:void 0,placement:"outside-end"}},t4={series:{item:{positive:Ku,negative:Ku,total:Ku},line:{stroke:Hu.ThemeSymbols.PALETTE_NEUTRAL_STROKE,strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,toggleSeries:!1}},{ThemeSymbols:Yu,ThemeConstants:pc}=xM,e4={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,moduleFactory:t=>new Uu(t),tooltipDefaults:{range:"exact"},defaultAxes:xM.swapAxisCondition([{type:pc.CARTESIAN_AXIS_TYPE.NUMBER,position:pc.CARTESIAN_POSITION.LEFT},{type:pc.CARTESIAN_AXIS_TYPE.CATEGORY,position:pc.CARTESIAN_POSITION.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:t4,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{fills:s,strokes:a}=t(e);return{line:{stroke:o.neutral.stroke},item:{positive:{fill:s[0],stroke:a[0]},negative:{fill:s[1],stroke:a[1]},total:{fill:s[2],stroke:a[2]}}}}return{line:{stroke:o.neutral.stroke},item:{positive:{fill:o.altUp.fill,stroke:o.altUp.stroke,label:{color:Yu.DEFAULT_LABEL_COLOUR}},negative:{fill:o.altDown.fill,stroke:o.altDown.stroke,label:{color:Yu.DEFAULT_LABEL_COLOUR}},total:{fill:o.neutral.fill,stroke:o.neutral.stroke,label:{color:Yu.DEFAULT_LABEL_COLOUR}}}}}},i4=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-dialog{display:flex;flex-direction:column;font-size:14px}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:var(--ag-charts-input-spacing)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-dialog-tab-color--inactive);margin-bottom:-1px;padding:var(--ag-charts-input-padding) calc(var(--ag-charts-input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:currentColor;color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-input-spacing) * -1)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-input-spacing) * 2);margin:0 calc(var(--ag-charts-input-spacing) * 2);padding:calc(var(--ag-charts-input-spacing) * 2) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:18px}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:12px}.ag-charts-dialog__input-group-label{color:var(--ag-charts-dialog-input-group-label-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-input-background-color--active);border-color:var(--ag-charts-input-border-color--active);color:var(--ag-charts-input-color--active);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-dialog__color-picker-button--multi-color,.ag-charts-dialog__color-picker-button--multi-color:hover{background:linear-gradient(135deg,red 0%,#ff0 calc(100% * 1 / 6),#0f0 calc(100% * 2 / 6),#0ff 50%,#00f calc(100% * 4 / 6),#f0f calc(100% * 5 / 6),red 100%)}.ag-charts-color-picker{width:190px;padding:8px;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>');--multi-color: linear-gradient( 135deg, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:6px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:99px;box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-row{display:flex;gap:8px;align-items:center;margin-bottom:4px;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:99px;box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:99px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button{width:36px;margin-left:var(--inset);height:var(--track-height);border-radius:99px;border:0;background:var(--multi-color);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button--hidden{display:none}.ag-charts-color-picker__multi-color-button--active{box-shadow:inset 0 0 0 1px #0003;outline-offset:1px;outline:2px solid #2196f3}.ag-charts-color-picker__hue-input{flex:1 0 0}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:4px;overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-active-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:2px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-label--multi-color{background:var(--multi-color)}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__line-stroke-width-menu,.ag-charts-annotations__line-style-type-menu,.ag-charts-annotations__text-size-menu{.ag-charts-menu__row:first-child{border-radius:0}}.ag-charts-annotations__stroke-width-button:before{--stroke-width-color: var(--ag-charts-toolbar-foreground-color);background:var(--stroke-width-color);content:"";margin-right:var(--ag-charts-toolbar-button-padding);height:min(var(--stroke-width),20px);width:12px}.ag-charts-annotations__stroke-width-button[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-annotations__color-picker-button{--emblem: var(--color)}.ag-charts-annotations__color-picker-button--multi-color{--emblem: linear-gradient( to right, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-annotations__color-picker-button:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--emblem)}.ag-charts-annotations__color-picker-button[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-annotations__toolbar-menu{min-width:200px}.ag-charts-annotations__text-size-menu{--item-padding: 4px 8px;border-top-left-radius:0;border-top-right-radius:0;width:34px}.ag-charts-annotations__line-stroke-width-menu{--item-padding: 6px;column-gap:6px}.ag-charts-annotations__line-style-type-menu{--item-padding: 6px;column-gap:0}.ag-charts-annotations__axis-button-wrapper{position:absolute;left:0;top:0;user-select:none;font:16px Verdana,sans-serif;overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-annotations);box-sizing:border-box}.ag-charts-annotations__axis-button-wrapper--hidden{display:none}.ag-charts-annotations__axis-button{cursor:pointer;border:none;border-radius:2px;padding:0;line-height:16px;background-color:var(--ag-charts-axis-label-background-color);color:var(--ag-charts-axis-label-color)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-axis-label-color)}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-context-menu{background:#f8f8f8;border:1px solid #babfc7;border-radius:5px;box-shadow:0 1px 4px 1px #babfc766;color:#181d1f;font:13px Verdana,sans-serif;transition:transform .1s ease;white-space:nowrap;z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-context-menu.ag-charts-dark-context-menu{color:#fff;background:#15181c}.ag-charts-context-menu__cover{position:fixed;left:0;top:0}.ag-charts-context-menu__menu{display:flex;flex-direction:column;padding:.5em 0}.ag-charts-context-menu__menu:focus{outline:none}.ag-charts-context-menu__item{background:none;border:none;box-sizing:border-box;font:inherit;padding:.5em 1em;text-align:left;-webkit-appearance:none;-moz-appearance:none}.ag-charts-context-menu__item.ag-charts-dark-context-menu{color:#fff}.ag-charts-context-menu__item:focus{background:#2196f31a}.ag-charts-context-menu__item:focus.ag-charts-dark-context-menu{background:#2196f31a}.ag-charts-context-menu__item:active{background:#2196f333}.ag-charts-context-menu__item:active.ag-charts-dark-context-menu{background:#2196f31a}.ag-charts-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-context-menu__item[aria-disabled=true]{border:none;opacity:.5;text-align:left}.ag-charts-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-charts-context-menu__divider{margin:5px 0;background:#babfc7;height:1px}.ag-charts-context-menu__divider.ag-charts-dark-context-menu{background:#2196f31a}.ag-charts-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font:12px Verdana,sans-serif;overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-charts-crosshair-label-content{padding:0 8px;border-radius:2px;line-height:20px;background-color:var(--ag-charts-axis-label-background-color);color:var(--ag-charts-axis-label-color)}.ag-charts-crosshair-label--hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;outline:none;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--ag-charts-input-placeholder-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}.ag-charts-chart-toolbar__menu{min-width:200px}.ag-charts-range-buttons .ag-charts-toolbar__button{padding:var(--ag-charts-toolbar-button-padding) calc(var(--ag-charts-toolbar-button-padding) * 1.5)}.ag-charts-zoom-buttons{align-items:center;display:flex;height:calc(var(--ag-charts-toolbar-size) + 10px);justify-content:center;overflow:hidden;padding-bottom:10px;pointer-events:none;width:100%;.ag-charts-toolbar{--ag-charts-toolbar-size: var(--ag-charts-toolbar-size-small);--ag-charts-toolbar-font-size: var(--ag-charts-toolbar-font-size-small);--ag-charts-toolbar-button-padding: var(--ag-charts-toolbar-button-padding-small);display:flex;height:var(--ag-charts-toolbar-size);justify-content:center;opacity:1;pointer-events:auto;transition:opacity .2s ease-in-out,transform .4s ease-in-out;.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-button-radius);border-top-left-radius:var(--ag-charts-button-radius)}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-button-radius);border-top-right-radius:var(--ag-charts-button-radius)}.ag-charts-toolbar__label{padding-left:calc(var(--ag-charts-toolbar-gap) / 2);padding-right:calc(var(--ag-charts-toolbar-gap) / 2)}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{padding-left:0}}.ag-charts-toolbar__button--gap{margin-left:var(--ag-charts-toolbar-gap)}.ag-charts-zoom-buttons__toolbar--hidden{opacity:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out}}.ag-charts-shared-toolbar{gap:var(--ag-charts-toolbar-gap);.ag-charts-toolbar__button{border-radius:var(--ag-charts-button-radius);margin:0}}
`;function o4(){wa.moduleRegistry.register(vk,wk,yA,s0,g0,HN,yL,yC,ZC,AR,uE,RE,MB,v0,I0,G0,H0,cL,D1,Iw,A_,e_,$_,PP,uP,GL,f2,IN,mw,SB,Bk,Lz,Cz,hF,MF,nA,eV,pA,vG,UV,e2,WB,jG,o2,aW,I2,DW,e4,lN),wa.enterpriseModule.isEnterprise=!0,wa.enterpriseModule.styles=i4,wa.enterpriseModule.licenseManager=t=>new _s(t.container?.ownerDocument??(typeof document>"u"?void 0:document)),wa.enterpriseModule.injectWatermark=LN}var s4={setLicenseKey(t){_s.setLicenseKey(t)}};function TM(){o4(),BM()}var a4={VERSION:$u,_Scene:wM,_Theme:_M,_Util:PM,create:Ea.create.bind(Ea),createSparkline:Ea.__createSparkline.bind(Ea),setup:TM,setGridContext:_s.setGridContext.bind(_s),setLicenseKey:_s.setLicenseKey.bind(_s),isEnterprise:!0};export{Ea as AgCharts,a4 as AgChartsEnterpriseModule,s4 as LicenseManager,$u as VERSION,TM as setupEnterpriseModules};
